<style> code { white-space: pre-wrap; display: block; background-color: #eee; } </style><b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol</b>
<code>
  1 |     | <span style='background-color: #faa;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>interface AggregatorV3Interface {</span>
  5 |     | <span style='background-color: #eee;'>  function decimals() external view returns (uint8);</span>
  6 |     | <span style='background-color: #eee;'></span>
  7 |     | <span style='background-color: #eee;'>  function description() external view returns (string memory);</span>
  8 |     | <span style='background-color: #eee;'></span>
  9 |     | <span style='background-color: #eee;'>  function version() external view returns (uint256);</span>
 10 |     | <span style='background-color: #eee;'></span>
 11 |     | <span style='background-color: #eee;'>  function getRoundData(uint80 _roundId)</span>
 12 |     | <span style='background-color: #eee;'>    external</span>
 13 |     | <span style='background-color: #eee;'>    view</span>
 14 |     | <span style='background-color: #eee;'>    returns (</span>
 15 |     | <span style='background-color: #eee;'>      uint80 roundId,</span>
 16 |     | <span style='background-color: #eee;'>      int256 answer,</span>
 17 |     | <span style='background-color: #eee;'>      uint256 startedAt,</span>
 18 |     | <span style='background-color: #eee;'>      uint256 updatedAt,</span>
 19 |     | <span style='background-color: #eee;'>      uint80 answeredInRound</span>
 20 |     | <span style='background-color: #eee;'>    );</span>
 21 |     | <span style='background-color: #eee;'></span>
 22 |     | <span style='background-color: #eee;'>  function latestRoundData()</span>
 23 |     | <span style='background-color: #eee;'>    external</span>
 24 |     | <span style='background-color: #eee;'>    view</span>
 25 |     | <span style='background-color: #eee;'>    returns (</span>
 26 |     | <span style='background-color: #eee;'>      uint80 roundId,</span>
 27 |     | <span style='background-color: #eee;'>      int256 answer,</span>
 28 |     | <span style='background-color: #eee;'>      uint256 startedAt,</span>
 29 |     | <span style='background-color: #eee;'>      uint256 updatedAt,</span>
 30 |     | <span style='background-color: #eee;'>      uint80 answeredInRound</span>
 31 |     | <span style='background-color: #eee;'>    );</span>
 32 |     | <span style='background-color: #eee;'>}</span>
 33 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/access/Ownable.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.7.0) (access/Ownable.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>import &quot;../utils/Context.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'></span>
  8 |     | <span style='background-color: #eee;'>/**</span>
  9 |     | <span style='background-color: #eee;'> * @dev Contract module which provides a basic access control mechanism, where</span>
 10 |     | <span style='background-color: #eee;'> * there is an account (an owner) that can be granted exclusive access to</span>
 11 |     | <span style='background-color: #eee;'> * specific functions.</span>
 12 |     | <span style='background-color: #eee;'> *</span>
 13 |     | <span style='background-color: #eee;'> * By default, the owner account will be the one that deploys the contract. This</span>
 14 |     | <span style='background-color: #eee;'> * can later be changed with {transferOwnership}.</span>
 15 |     | <span style='background-color: #eee;'> *</span>
 16 |     | <span style='background-color: #eee;'> * This module is used through inheritance. It will make available the modifier</span>
 17 |     | <span style='background-color: #eee;'> * `onlyOwner`, which can be applied to your functions to restrict their use to</span>
 18 |     | <span style='background-color: #eee;'> * the owner.</span>
 19 |     | <span style='background-color: #eee;'> */</span>
 20 |     | <span style='background-color: #eee;'>abstract contract Ownable is Context {</span>
 21 |     | <span style='background-color: #eee;'>    address private _owner;</span>
 22 |     | <span style='background-color: #eee;'></span>
 23 |     | <span style='background-color: #eee;'>    event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);</span>
 24 |     | <span style='background-color: #eee;'></span>
 25 |     | <span style='background-color: #eee;'>    /**</span>
 26 |     | <span style='background-color: #eee;'>     * @dev Initializes the contract setting the deployer as the initial owner.</span>
 27 |     | <span style='background-color: #eee;'>     */</span>
 28 |     | <span style='background-color: #eee;'>    constructor() {</span>
 29 |     | <span style='background-color: #faa;'>        _transferOwnership(_msgSender());</span>
 30 |     | <span style='background-color: #eee;'>    }</span>
 31 |     | <span style='background-color: #eee;'></span>
 32 |     | <span style='background-color: #eee;'>    /**</span>
 33 |     | <span style='background-color: #eee;'>     * @dev Throws if called by any account other than the owner.</span>
 34 |     | <span style='background-color: #eee;'>     */</span>
 35 |     | <span style='background-color: #faa;'>    modifier onlyOwner() {</span>
 36 |     | <span style='background-color: #eee;'>        _checkOwner();</span>
 37 |     | <span style='background-color: #eee;'>        _;</span>
 38 |     | <span style='background-color: #eee;'>    }</span>
 39 |     | <span style='background-color: #eee;'></span>
 40 |     | <span style='background-color: #eee;'>    /**</span>
 41 |     | <span style='background-color: #eee;'>     * @dev Returns the address of the current owner.</span>
 42 |     | <span style='background-color: #eee;'>     */</span>
 43 |     | <span style='background-color: #eee;'>    function owner() public view virtual returns (address) {</span>
 44 |     | <span style='background-color: #faa;'>        return _owner;</span>
 45 |     | <span style='background-color: #eee;'>    }</span>
 46 |     | <span style='background-color: #eee;'></span>
 47 |     | <span style='background-color: #eee;'>    /**</span>
 48 |     | <span style='background-color: #eee;'>     * @dev Throws if the sender is not the owner.</span>
 49 |     | <span style='background-color: #eee;'>     */</span>
 50 |     | <span style='background-color: #faa;'>    function _checkOwner() internal view virtual {</span>
 51 |     | <span style='background-color: #faa;'>        require(owner() == _msgSender(), &quot;Ownable: caller is not the owner&quot;);</span>
 52 |     | <span style='background-color: #eee;'>    }</span>
 53 |     | <span style='background-color: #eee;'></span>
 54 |     | <span style='background-color: #eee;'>    /**</span>
 55 |     | <span style='background-color: #eee;'>     * @dev Leaves the contract without owner. It will not be possible to call</span>
 56 |     | <span style='background-color: #eee;'>     * `onlyOwner` functions anymore. Can only be called by the current owner.</span>
 57 |     | <span style='background-color: #eee;'>     *</span>
 58 |     | <span style='background-color: #eee;'>     * NOTE: Renouncing ownership will leave the contract without an owner,</span>
 59 |     | <span style='background-color: #eee;'>     * thereby removing any functionality that is only available to the owner.</span>
 60 |     | <span style='background-color: #eee;'>     */</span>
 61 |     | <span style='background-color: #eee;'>    function renounceOwnership() public virtual onlyOwner {</span>
 62 |     | <span style='background-color: #eee;'>        _transferOwnership(address(0));</span>
 63 |     | <span style='background-color: #eee;'>    }</span>
 64 |     | <span style='background-color: #eee;'></span>
 65 |     | <span style='background-color: #eee;'>    /**</span>
 66 |     | <span style='background-color: #eee;'>     * @dev Transfers ownership of the contract to a new account (`newOwner`).</span>
 67 |     | <span style='background-color: #eee;'>     * Can only be called by the current owner.</span>
 68 |     | <span style='background-color: #eee;'>     */</span>
 69 |     | <span style='background-color: #eee;'>    function transferOwnership(address newOwner) public virtual onlyOwner {</span>
 70 |     | <span style='background-color: #faa;'>        require(newOwner != address(0), &quot;Ownable: new owner is the zero address&quot;);</span>
 71 |     | <span style='background-color: #faa;'>        _transferOwnership(newOwner);</span>
 72 |     | <span style='background-color: #eee;'>    }</span>
 73 |     | <span style='background-color: #eee;'></span>
 74 |     | <span style='background-color: #eee;'>    /**</span>
 75 |     | <span style='background-color: #eee;'>     * @dev Transfers ownership of the contract to a new account (`newOwner`).</span>
 76 |     | <span style='background-color: #eee;'>     * Internal function without access restriction.</span>
 77 |     | <span style='background-color: #eee;'>     */</span>
 78 |     | <span style='background-color: #faa;'>    function _transferOwnership(address newOwner) internal virtual {</span>
 79 |     | <span style='background-color: #faa;'>        address oldOwner = _owner;</span>
 80 |     | <span style='background-color: #eee;'>        _owner = newOwner;</span>
 81 |     | <span style='background-color: #faa;'>        emit OwnershipTransferred(oldOwner, newOwner);</span>
 82 |     | <span style='background-color: #eee;'>    }</span>
 83 |     | <span style='background-color: #eee;'>}</span>
 84 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/access/Ownable2Step.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.8.0) (access/Ownable2Step.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>import &quot;./Ownable.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'></span>
  8 |     | <span style='background-color: #eee;'>/**</span>
  9 |     | <span style='background-color: #eee;'> * @dev Contract module which provides access control mechanism, where</span>
 10 |     | <span style='background-color: #eee;'> * there is an account (an owner) that can be granted exclusive access to</span>
 11 |     | <span style='background-color: #eee;'> * specific functions.</span>
 12 |     | <span style='background-color: #eee;'> *</span>
 13 |     | <span style='background-color: #eee;'> * By default, the owner account will be the one that deploys the contract. This</span>
 14 |     | <span style='background-color: #eee;'> * can later be changed with {transferOwnership} and {acceptOwnership}.</span>
 15 |     | <span style='background-color: #eee;'> *</span>
 16 |     | <span style='background-color: #eee;'> * This module is used through inheritance. It will make available all functions</span>
 17 |     | <span style='background-color: #eee;'> * from parent (Ownable).</span>
 18 |     | <span style='background-color: #eee;'> */</span>
 19 |     | <span style='background-color: #eee;'>abstract contract Ownable2Step is Ownable {</span>
 20 |     | <span style='background-color: #eee;'>    address private _pendingOwner;</span>
 21 |     | <span style='background-color: #eee;'></span>
 22 |     | <span style='background-color: #eee;'>    event OwnershipTransferStarted(address indexed previousOwner, address indexed newOwner);</span>
 23 |     | <span style='background-color: #eee;'></span>
 24 |     | <span style='background-color: #eee;'>    /**</span>
 25 |     | <span style='background-color: #eee;'>     * @dev Returns the address of the pending owner.</span>
 26 |     | <span style='background-color: #eee;'>     */</span>
 27 |     | <span style='background-color: #eee;'>    function pendingOwner() public view virtual returns (address) {</span>
 28 |     | <span style='background-color: #faa;'>        return _pendingOwner;</span>
 29 |     | <span style='background-color: #eee;'>    }</span>
 30 |     | <span style='background-color: #eee;'></span>
 31 |     | <span style='background-color: #eee;'>    /**</span>
 32 |     | <span style='background-color: #eee;'>     * @dev Starts the ownership transfer of the contract to a new account. Replaces the pending transfer if there is one.</span>
 33 |     | <span style='background-color: #eee;'>     * Can only be called by the current owner.</span>
 34 |     | <span style='background-color: #eee;'>     */</span>
 35 |     | <span style='background-color: #eee;'>    function transferOwnership(address newOwner) public virtual override onlyOwner {</span>
 36 |     | <span style='background-color: #faa;'>        _pendingOwner = newOwner;</span>
 37 |     | <span style='background-color: #faa;'>        emit OwnershipTransferStarted(owner(), newOwner);</span>
 38 |     | <span style='background-color: #eee;'>    }</span>
 39 |     | <span style='background-color: #eee;'></span>
 40 |     | <span style='background-color: #eee;'>    /**</span>
 41 |     | <span style='background-color: #eee;'>     * @dev Transfers ownership of the contract to a new account (`newOwner`) and deletes any pending owner.</span>
 42 |     | <span style='background-color: #eee;'>     * Internal function without access restriction.</span>
 43 |     | <span style='background-color: #eee;'>     */</span>
 44 |     | <span style='background-color: #eee;'>    function _transferOwnership(address newOwner) internal virtual override {</span>
 45 |     | <span style='background-color: #faa;'>        delete _pendingOwner;</span>
 46 |     | <span style='background-color: #eee;'>        super._transferOwnership(newOwner);</span>
 47 |     | <span style='background-color: #eee;'>    }</span>
 48 |     | <span style='background-color: #eee;'></span>
 49 |     | <span style='background-color: #eee;'>    /**</span>
 50 |     | <span style='background-color: #eee;'>     * @dev The new owner accepts the ownership transfer.</span>
 51 |     | <span style='background-color: #eee;'>     */</span>
 52 |     | <span style='background-color: #eee;'>    function acceptOwnership() external {</span>
 53 |     | <span style='background-color: #eee;'>        address sender = _msgSender();</span>
 54 |     | <span style='background-color: #faa;'>        require(pendingOwner() == sender, &quot;Ownable2Step: caller is not the new owner&quot;);</span>
 55 |     | <span style='background-color: #eee;'>        _transferOwnership(sender);</span>
 56 |     | <span style='background-color: #eee;'>    }</span>
 57 |     | <span style='background-color: #eee;'>}</span>
 58 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/interfaces/IERC1271.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts v4.4.1 (interfaces/IERC1271.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>/**</span>
  7 |     | <span style='background-color: #eee;'> * @dev Interface of the ERC1271 standard signature validation method for</span>
  8 |     | <span style='background-color: #eee;'> * contracts as defined in https://eips.ethereum.org/EIPS/eip-1271[ERC-1271].</span>
  9 |     | <span style='background-color: #eee;'> *</span>
 10 |     | <span style='background-color: #eee;'> * _Available since v4.1._</span>
 11 |     | <span style='background-color: #eee;'> */</span>
 12 |     | <span style='background-color: #eee;'>interface IERC1271 {</span>
 13 |     | <span style='background-color: #eee;'>    /**</span>
 14 |     | <span style='background-color: #eee;'>     * @dev Should return whether the signature provided is valid for the provided data</span>
 15 |     | <span style='background-color: #eee;'>     * @param hash      Hash of the data to be signed</span>
 16 |     | <span style='background-color: #eee;'>     * @param signature Signature byte array associated with _data</span>
 17 |     | <span style='background-color: #eee;'>     */</span>
 18 |     | <span style='background-color: #eee;'>    function isValidSignature(bytes32 hash, bytes memory signature) external view returns (bytes4 magicValue);</span>
 19 |     | <span style='background-color: #eee;'>}</span>
 20 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/interfaces/IERC1363Receiver.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts v4.4.1 (interfaces/IERC1363Receiver.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>interface IERC1363Receiver {</span>
  7 |     | <span style='background-color: #eee;'>    /*</span>
  8 |     | <span style='background-color: #eee;'>     * Note: the ERC-165 identifier for this interface is 0x88a7ca5c.</span>
  9 |     | <span style='background-color: #eee;'>     * 0x88a7ca5c === bytes4(keccak256(&quot;onTransferReceived(address,address,uint256,bytes)&quot;))</span>
 10 |     | <span style='background-color: #eee;'>     */</span>
 11 |     | <span style='background-color: #eee;'></span>
 12 |     | <span style='background-color: #eee;'>    /**</span>
 13 |     | <span style='background-color: #eee;'>     * @notice Handle the receipt of ERC1363 tokens</span>
 14 |     | <span style='background-color: #eee;'>     * @dev Any ERC1363 smart contract calls this function on the recipient</span>
 15 |     | <span style='background-color: #eee;'>     * after a `transfer` or a `transferFrom`. This function MAY throw to revert and reject the</span>
 16 |     | <span style='background-color: #eee;'>     * transfer. Return of other than the magic value MUST result in the</span>
 17 |     | <span style='background-color: #eee;'>     * transaction being reverted.</span>
 18 |     | <span style='background-color: #eee;'>     * Note: the token contract address is always the message sender.</span>
 19 |     | <span style='background-color: #eee;'>     * @param operator address The address which called `transferAndCall` or `transferFromAndCall` function</span>
 20 |     | <span style='background-color: #eee;'>     * @param from address The address which are token transferred from</span>
 21 |     | <span style='background-color: #eee;'>     * @param value uint256 The amount of tokens transferred</span>
 22 |     | <span style='background-color: #eee;'>     * @param data bytes Additional data with no specified format</span>
 23 |     | <span style='background-color: #eee;'>     * @return `bytes4(keccak256(&quot;onTransferReceived(address,address,uint256,bytes)&quot;))`</span>
 24 |     | <span style='background-color: #eee;'>     *  unless throwing</span>
 25 |     | <span style='background-color: #eee;'>     */</span>
 26 |     | <span style='background-color: #eee;'>    function onTransferReceived(</span>
 27 |     | <span style='background-color: #eee;'>        address operator,</span>
 28 |     | <span style='background-color: #eee;'>        address from,</span>
 29 |     | <span style='background-color: #eee;'>        uint256 value,</span>
 30 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 31 |     | <span style='background-color: #eee;'>    ) external returns (bytes4);</span>
 32 |     | <span style='background-color: #eee;'>}</span>
 33 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/proxy/Proxy.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.6.0) (proxy/Proxy.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>/**</span>
  7 |     | <span style='background-color: #eee;'> * @dev This abstract contract provides a fallback function that delegates all calls to another contract using the EVM</span>
  8 |     | <span style='background-color: #eee;'> * instruction `delegatecall`. We refer to the second contract as the _implementation_ behind the proxy, and it has to</span>
  9 |     | <span style='background-color: #eee;'> * be specified by overriding the virtual {_implementation} function.</span>
 10 |     | <span style='background-color: #eee;'> *</span>
 11 |     | <span style='background-color: #eee;'> * Additionally, delegation to the implementation can be triggered manually through the {_fallback} function, or to a</span>
 12 |     | <span style='background-color: #eee;'> * different contract through the {_delegate} function.</span>
 13 |     | <span style='background-color: #eee;'> *</span>
 14 |     | <span style='background-color: #eee;'> * The success and return data of the delegated call will be returned back to the caller of the proxy.</span>
 15 |     | <span style='background-color: #eee;'> */</span>
 16 |     | <span style='background-color: #eee;'>abstract contract Proxy {</span>
 17 |     | <span style='background-color: #eee;'>    /**</span>
 18 |     | <span style='background-color: #eee;'>     * @dev Delegates the current call to `implementation`.</span>
 19 |     | <span style='background-color: #eee;'>     *</span>
 20 |     | <span style='background-color: #eee;'>     * This function does not return to its internal call site, it will return directly to the external caller.</span>
 21 |     | <span style='background-color: #eee;'>     */</span>
 22 |     | <span style='background-color: #faa;'>    function _delegate(address implementation) internal virtual {</span>
 23 |     | <span style='background-color: #faa;'>        assembly {</span>
 24 |     | <span style='background-color: #eee;'>            // Copy msg.data. We take full control of memory in this inline assembly</span>
 25 |     | <span style='background-color: #eee;'>            // block because it will not return to Solidity code. We overwrite the</span>
 26 |     | <span style='background-color: #eee;'>            // Solidity scratch pad at memory position 0.</span>
 27 |     | <span style='background-color: #eee;'>            calldatacopy(0, 0, calldatasize())</span>
 28 |     | <span style='background-color: #eee;'></span>
 29 |     | <span style='background-color: #eee;'>            // Call the implementation.</span>
 30 |     | <span style='background-color: #eee;'>            // out and outsize are 0 because we don&#39;t know the size yet.</span>
 31 |     | <span style='background-color: #eee;'>            let result := delegatecall(gas(), implementation, 0, calldatasize(), 0, 0)</span>
 32 |     | <span style='background-color: #eee;'></span>
 33 |     | <span style='background-color: #eee;'>            // Copy the returned data.</span>
 34 |     | <span style='background-color: #eee;'>            returndatacopy(0, 0, returndatasize())</span>
 35 |     | <span style='background-color: #eee;'></span>
 36 |     | <span style='background-color: #eee;'>            switch result</span>
 37 |     | <span style='background-color: #eee;'>            // delegatecall returns 0 on error.</span>
 38 |     | <span style='background-color: #eee;'>            case 0 {</span>
 39 |     | <span style='background-color: #eee;'>                revert(0, returndatasize())</span>
 40 |     | <span style='background-color: #eee;'>            }</span>
 41 |     | <span style='background-color: #eee;'>            default {</span>
 42 |     | <span style='background-color: #eee;'>                return(0, returndatasize())</span>
 43 |     | <span style='background-color: #eee;'>            }</span>
 44 |     | <span style='background-color: #eee;'>        }</span>
 45 |     | <span style='background-color: #eee;'>    }</span>
 46 |     | <span style='background-color: #eee;'></span>
 47 |     | <span style='background-color: #eee;'>    /**</span>
 48 |     | <span style='background-color: #eee;'>     * @dev This is a virtual function that should be overridden so it returns the address to which the fallback function</span>
 49 |     | <span style='background-color: #eee;'>     * and {_fallback} should delegate.</span>
 50 |     | <span style='background-color: #eee;'>     */</span>
 51 |     | <span style='background-color: #eee;'>    function _implementation() internal view virtual returns (address);</span>
 52 |     | <span style='background-color: #eee;'></span>
 53 |     | <span style='background-color: #eee;'>    /**</span>
 54 |     | <span style='background-color: #eee;'>     * @dev Delegates the current call to the address returned by `_implementation()`.</span>
 55 |     | <span style='background-color: #eee;'>     *</span>
 56 |     | <span style='background-color: #eee;'>     * This function does not return to its internal call site, it will return directly to the external caller.</span>
 57 |     | <span style='background-color: #eee;'>     */</span>
 58 |     | <span style='background-color: #faa;'>    function _fallback() internal virtual {</span>
 59 |     | <span style='background-color: #eee;'>        _beforeFallback();</span>
 60 |     | <span style='background-color: #faa;'>        _delegate(_implementation());</span>
 61 |     | <span style='background-color: #eee;'>    }</span>
 62 |     | <span style='background-color: #eee;'></span>
 63 |     | <span style='background-color: #eee;'>    /**</span>
 64 |     | <span style='background-color: #eee;'>     * @dev Fallback function that delegates calls to the address returned by `_implementation()`. Will run if no other</span>
 65 |     | <span style='background-color: #eee;'>     * function in the contract matches the call data.</span>
 66 |     | <span style='background-color: #eee;'>     */</span>
 67 |     | <span style='background-color: #faa;'>    fallback() external payable virtual {</span>
 68 |     | <span style='background-color: #eee;'>        _fallback();</span>
 69 |     | <span style='background-color: #eee;'>    }</span>
 70 |     | <span style='background-color: #eee;'></span>
 71 |     | <span style='background-color: #eee;'>    /**</span>
 72 |     | <span style='background-color: #eee;'>     * @dev Fallback function that delegates calls to the address returned by `_implementation()`. Will run if call data</span>
 73 |     | <span style='background-color: #eee;'>     * is empty.</span>
 74 |     | <span style='background-color: #eee;'>     */</span>
 75 |     | <span style='background-color: #eee;'>    receive() external payable virtual {</span>
 76 |     | <span style='background-color: #eee;'>        _fallback();</span>
 77 |     | <span style='background-color: #eee;'>    }</span>
 78 |     | <span style='background-color: #eee;'></span>
 79 |     | <span style='background-color: #eee;'>    /**</span>
 80 |     | <span style='background-color: #eee;'>     * @dev Hook that is called before falling back to the implementation. Can happen as part of a manual `_fallback`</span>
 81 |     | <span style='background-color: #eee;'>     * call, or as part of the Solidity `fallback` or `receive` functions.</span>
 82 |     | <span style='background-color: #eee;'>     *</span>
 83 |     | <span style='background-color: #eee;'>     * If overridden should call `super._beforeFallback()`.</span>
 84 |     | <span style='background-color: #eee;'>     */</span>
 85 |     | <span style='background-color: #eee;'>    function _beforeFallback() internal virtual {}</span>
 86 |     | <span style='background-color: #eee;'>}</span>
 87 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/security/Pausable.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.7.0) (security/Pausable.sol)</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>import &quot;../utils/Context.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'></span>
   8 |     | <span style='background-color: #eee;'>/**</span>
   9 |     | <span style='background-color: #eee;'> * @dev Contract module which allows children to implement an emergency stop</span>
  10 |     | <span style='background-color: #eee;'> * mechanism that can be triggered by an authorized account.</span>
  11 |     | <span style='background-color: #eee;'> *</span>
  12 |     | <span style='background-color: #eee;'> * This module is used through inheritance. It will make available the</span>
  13 |     | <span style='background-color: #eee;'> * modifiers `whenNotPaused` and `whenPaused`, which can be applied to</span>
  14 |     | <span style='background-color: #eee;'> * the functions of your contract. Note that they will not be pausable by</span>
  15 |     | <span style='background-color: #eee;'> * simply including this module, only once the modifiers are put in place.</span>
  16 |     | <span style='background-color: #eee;'> */</span>
  17 |     | <span style='background-color: #eee;'>abstract contract Pausable is Context {</span>
  18 |     | <span style='background-color: #eee;'>    /**</span>
  19 |     | <span style='background-color: #eee;'>     * @dev Emitted when the pause is triggered by `account`.</span>
  20 |     | <span style='background-color: #eee;'>     */</span>
  21 |     | <span style='background-color: #eee;'>    event Paused(address account);</span>
  22 |     | <span style='background-color: #eee;'></span>
  23 |     | <span style='background-color: #eee;'>    /**</span>
  24 |     | <span style='background-color: #eee;'>     * @dev Emitted when the pause is lifted by `account`.</span>
  25 |     | <span style='background-color: #eee;'>     */</span>
  26 |     | <span style='background-color: #eee;'>    event Unpaused(address account);</span>
  27 |     | <span style='background-color: #eee;'></span>
  28 |     | <span style='background-color: #eee;'>    bool private _paused;</span>
  29 |     | <span style='background-color: #eee;'></span>
  30 |     | <span style='background-color: #eee;'>    /**</span>
  31 |     | <span style='background-color: #eee;'>     * @dev Initializes the contract in unpaused state.</span>
  32 |     | <span style='background-color: #eee;'>     */</span>
  33 |     | <span style='background-color: #eee;'>    constructor() {</span>
  34 |     | <span style='background-color: #faa;'>        _paused = false;</span>
  35 |     | <span style='background-color: #eee;'>    }</span>
  36 |     | <span style='background-color: #eee;'></span>
  37 |     | <span style='background-color: #eee;'>    /**</span>
  38 |     | <span style='background-color: #eee;'>     * @dev Modifier to make a function callable only when the contract is not paused.</span>
  39 |     | <span style='background-color: #eee;'>     *</span>
  40 |     | <span style='background-color: #eee;'>     * Requirements:</span>
  41 |     | <span style='background-color: #eee;'>     *</span>
  42 |     | <span style='background-color: #eee;'>     * - The contract must not be paused.</span>
  43 |     | <span style='background-color: #eee;'>     */</span>
  44 |     | <span style='background-color: #faa;'>    modifier whenNotPaused() {</span>
  45 |     | <span style='background-color: #eee;'>        _requireNotPaused();</span>
  46 |     | <span style='background-color: #faa;'>        _;</span>
  47 |     | <span style='background-color: #eee;'>    }</span>
  48 |     | <span style='background-color: #eee;'></span>
  49 |     | <span style='background-color: #eee;'>    /**</span>
  50 |     | <span style='background-color: #eee;'>     * @dev Modifier to make a function callable only when the contract is paused.</span>
  51 |     | <span style='background-color: #eee;'>     *</span>
  52 |     | <span style='background-color: #eee;'>     * Requirements:</span>
  53 |     | <span style='background-color: #eee;'>     *</span>
  54 |     | <span style='background-color: #eee;'>     * - The contract must be paused.</span>
  55 |     | <span style='background-color: #eee;'>     */</span>
  56 |     | <span style='background-color: #eee;'>    modifier whenPaused() {</span>
  57 |     | <span style='background-color: #eee;'>        _requirePaused();</span>
  58 |     | <span style='background-color: #eee;'>        _;</span>
  59 |     | <span style='background-color: #eee;'>    }</span>
  60 |     | <span style='background-color: #eee;'></span>
  61 |     | <span style='background-color: #eee;'>    /**</span>
  62 |     | <span style='background-color: #eee;'>     * @dev Returns true if the contract is paused, and false otherwise.</span>
  63 |     | <span style='background-color: #eee;'>     */</span>
  64 |     | <span style='background-color: #eee;'>    function paused() public view virtual returns (bool) {</span>
  65 |     | <span style='background-color: #faa;'>        return _paused;</span>
  66 |     | <span style='background-color: #eee;'>    }</span>
  67 |     | <span style='background-color: #eee;'></span>
  68 |     | <span style='background-color: #eee;'>    /**</span>
  69 |     | <span style='background-color: #eee;'>     * @dev Throws if the contract is paused.</span>
  70 |     | <span style='background-color: #eee;'>     */</span>
  71 |     | <span style='background-color: #faa;'>    function _requireNotPaused() internal view virtual {</span>
  72 |     | <span style='background-color: #eee;'>        require(!paused(), &quot;Pausable: paused&quot;);</span>
  73 |     | <span style='background-color: #eee;'>    }</span>
  74 |     | <span style='background-color: #eee;'></span>
  75 |     | <span style='background-color: #eee;'>    /**</span>
  76 |     | <span style='background-color: #eee;'>     * @dev Throws if the contract is not paused.</span>
  77 |     | <span style='background-color: #eee;'>     */</span>
  78 |     | <span style='background-color: #eee;'>    function _requirePaused() internal view virtual {</span>
  79 |     | <span style='background-color: #eee;'>        require(paused(), &quot;Pausable: not paused&quot;);</span>
  80 |     | <span style='background-color: #eee;'>    }</span>
  81 |     | <span style='background-color: #eee;'></span>
  82 |     | <span style='background-color: #eee;'>    /**</span>
  83 |     | <span style='background-color: #eee;'>     * @dev Triggers stopped state.</span>
  84 |     | <span style='background-color: #eee;'>     *</span>
  85 |     | <span style='background-color: #eee;'>     * Requirements:</span>
  86 |     | <span style='background-color: #eee;'>     *</span>
  87 |     | <span style='background-color: #eee;'>     * - The contract must not be paused.</span>
  88 |     | <span style='background-color: #eee;'>     */</span>
  89 |     | <span style='background-color: #eee;'>    function _pause() internal virtual whenNotPaused {</span>
  90 |     | <span style='background-color: #faa;'>        _paused = true;</span>
  91 |     | <span style='background-color: #faa;'>        emit Paused(_msgSender());</span>
  92 |     | <span style='background-color: #eee;'>    }</span>
  93 |     | <span style='background-color: #eee;'></span>
  94 |     | <span style='background-color: #eee;'>    /**</span>
  95 |     | <span style='background-color: #eee;'>     * @dev Returns to normal state.</span>
  96 |     | <span style='background-color: #eee;'>     *</span>
  97 |     | <span style='background-color: #eee;'>     * Requirements:</span>
  98 |     | <span style='background-color: #eee;'>     *</span>
  99 |     | <span style='background-color: #eee;'>     * - The contract must be paused.</span>
 100 |     | <span style='background-color: #eee;'>     */</span>
 101 |     | <span style='background-color: #eee;'>    function _unpause() internal virtual whenPaused {</span>
 102 |     | <span style='background-color: #eee;'>        _paused = false;</span>
 103 |     | <span style='background-color: #faa;'>        emit Unpaused(_msgSender());</span>
 104 |     | <span style='background-color: #eee;'>    }</span>
 105 |     | <span style='background-color: #eee;'>}</span>
 106 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/token/ERC1155/ERC1155.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.8.0) (token/ERC1155/ERC1155.sol)</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>import &quot;./IERC1155.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'>import &quot;./IERC1155Receiver.sol&quot;;</span>
   8 |     | <span style='background-color: #eee;'>import &quot;./extensions/IERC1155MetadataURI.sol&quot;;</span>
   9 |     | <span style='background-color: #eee;'>import &quot;../../utils/Address.sol&quot;;</span>
  10 |     | <span style='background-color: #eee;'>import &quot;../../utils/Context.sol&quot;;</span>
  11 |     | <span style='background-color: #eee;'>import &quot;../../utils/introspection/ERC165.sol&quot;;</span>
  12 |     | <span style='background-color: #eee;'></span>
  13 |     | <span style='background-color: #eee;'>/**</span>
  14 |     | <span style='background-color: #eee;'> * @dev Implementation of the basic standard multi-token.</span>
  15 |     | <span style='background-color: #eee;'> * See https://eips.ethereum.org/EIPS/eip-1155</span>
  16 |     | <span style='background-color: #eee;'> * Originally based on code by Enjin: https://github.com/enjin/erc-1155</span>
  17 |     | <span style='background-color: #eee;'> *</span>
  18 |     | <span style='background-color: #eee;'> * _Available since v3.1._</span>
  19 |     | <span style='background-color: #faa;'> */</span>
  20 |     | <span style='background-color: #eee;'>contract ERC1155 is Context, ERC165, IERC1155, IERC1155MetadataURI {</span>
  21 |     | <span style='background-color: #eee;'>    using Address for address;</span>
  22 |     | <span style='background-color: #eee;'></span>
  23 |     | <span style='background-color: #eee;'>    // Mapping from token ID to account balances</span>
  24 |     | <span style='background-color: #eee;'>    mapping(uint256 =&gt; mapping(address =&gt; uint256)) private _balances;</span>
  25 |     | <span style='background-color: #eee;'></span>
  26 |     | <span style='background-color: #eee;'>    // Mapping from account to operator approvals</span>
  27 |     | <span style='background-color: #eee;'>    mapping(address =&gt; mapping(address =&gt; bool)) private _operatorApprovals;</span>
  28 |     | <span style='background-color: #eee;'></span>
  29 |     | <span style='background-color: #eee;'>    // Used as the URI for all token types by relying on ID substitution, e.g. https://token-cdn-domain/{id}.json</span>
  30 |     | <span style='background-color: #eee;'>    string private _uri;</span>
  31 |     | <span style='background-color: #eee;'></span>
  32 |     | <span style='background-color: #eee;'>    /**</span>
  33 |     | <span style='background-color: #eee;'>     * @dev See {_setURI}.</span>
  34 |     | <span style='background-color: #eee;'>     */</span>
  35 |     | <span style='background-color: #eee;'>    constructor(string memory uri_) {</span>
  36 |     | <span style='background-color: #eee;'>        _setURI(uri_);</span>
  37 |     | <span style='background-color: #eee;'>    }</span>
  38 |     | <span style='background-color: #eee;'></span>
  39 |     | <span style='background-color: #eee;'>    /**</span>
  40 |     | <span style='background-color: #eee;'>     * @dev See {IERC165-supportsInterface}.</span>
  41 |     | <span style='background-color: #eee;'>     */</span>
  42 |     | <span style='background-color: #eee;'>    function supportsInterface(bytes4 interfaceId) public view virtual override(ERC165, IERC165) returns (bool) {</span>
  43 |     | <span style='background-color: #eee;'>        return</span>
  44 |     | <span style='background-color: #faa;'>            interfaceId == type(IERC1155).interfaceId ||</span>
  45 |     | <span style='background-color: #faa;'>            interfaceId == type(IERC1155MetadataURI).interfaceId ||</span>
  46 |     | <span style='background-color: #eee;'>            super.supportsInterface(interfaceId);</span>
  47 |     | <span style='background-color: #eee;'>    }</span>
  48 |     | <span style='background-color: #eee;'></span>
  49 |     | <span style='background-color: #eee;'>    /**</span>
  50 |     | <span style='background-color: #eee;'>     * @dev See {IERC1155MetadataURI-uri}.</span>
  51 |     | <span style='background-color: #eee;'>     *</span>
  52 |     | <span style='background-color: #eee;'>     * This implementation returns the same URI for *all* token types. It relies</span>
  53 |     | <span style='background-color: #eee;'>     * on the token type ID substitution mechanism</span>
  54 |     | <span style='background-color: #eee;'>     * https://eips.ethereum.org/EIPS/eip-1155#metadata[defined in the EIP].</span>
  55 |     | <span style='background-color: #eee;'>     *</span>
  56 |     | <span style='background-color: #eee;'>     * Clients calling this function must replace the `\{id\}` substring with the</span>
  57 |     | <span style='background-color: #eee;'>     * actual token type ID.</span>
  58 |     | <span style='background-color: #eee;'>     */</span>
  59 |     | <span style='background-color: #eee;'>    function uri(uint256) public view virtual override returns (string memory) {</span>
  60 |     | <span style='background-color: #faa;'>        return _uri;</span>
  61 |     | <span style='background-color: #eee;'>    }</span>
  62 |     | <span style='background-color: #eee;'></span>
  63 |     | <span style='background-color: #eee;'>    /**</span>
  64 |     | <span style='background-color: #eee;'>     * @dev See {IERC1155-balanceOf}.</span>
  65 |     | <span style='background-color: #eee;'>     *</span>
  66 |     | <span style='background-color: #eee;'>     * Requirements:</span>
  67 |     | <span style='background-color: #eee;'>     *</span>
  68 |     | <span style='background-color: #eee;'>     * - `account` cannot be the zero address.</span>
  69 |     | <span style='background-color: #eee;'>     */</span>
  70 |     | <span style='background-color: #faa;'>    function balanceOf(address account, uint256 id) public view virtual override returns (uint256) {</span>
  71 |     | <span style='background-color: #faa;'>        require(account != address(0), &quot;ERC1155: address zero is not a valid owner&quot;);</span>
  72 |     | <span style='background-color: #eee;'>        return _balances[id][account];</span>
  73 |     | <span style='background-color: #eee;'>    }</span>
  74 |     | <span style='background-color: #eee;'></span>
  75 |     | <span style='background-color: #eee;'>    /**</span>
  76 |     | <span style='background-color: #eee;'>     * @dev See {IERC1155-balanceOfBatch}.</span>
  77 |     | <span style='background-color: #eee;'>     *</span>
  78 |     | <span style='background-color: #eee;'>     * Requirements:</span>
  79 |     | <span style='background-color: #eee;'>     *</span>
  80 |     | <span style='background-color: #eee;'>     * - `accounts` and `ids` must have the same length.</span>
  81 |     | <span style='background-color: #eee;'>     */</span>
  82 |     | <span style='background-color: #eee;'>    function balanceOfBatch(address[] memory accounts, uint256[] memory ids)</span>
  83 |     | <span style='background-color: #eee;'>        public</span>
  84 |     | <span style='background-color: #eee;'>        view</span>
  85 |     | <span style='background-color: #eee;'>        virtual</span>
  86 |     | <span style='background-color: #eee;'>        override</span>
  87 |     | <span style='background-color: #eee;'>        returns (uint256[] memory)</span>
  88 |     | <span style='background-color: #eee;'>    {</span>
  89 |     | <span style='background-color: #faa;'>        require(accounts.length == ids.length, &quot;ERC1155: accounts and ids length mismatch&quot;);</span>
  90 |     | <span style='background-color: #eee;'></span>
  91 |     | <span style='background-color: #eee;'>        uint256[] memory batchBalances = new uint256[](accounts.length);</span>
  92 |     | <span style='background-color: #eee;'></span>
  93 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; accounts.length; ++i) {</span>
  94 |     | <span style='background-color: #faa;'>            batchBalances[i] = balanceOf(accounts[i], ids[i]);</span>
  95 |     | <span style='background-color: #eee;'>        }</span>
  96 |     | <span style='background-color: #eee;'></span>
  97 |     | <span style='background-color: #eee;'>        return batchBalances;</span>
  98 |     | <span style='background-color: #eee;'>    }</span>
  99 |     | <span style='background-color: #eee;'></span>
 100 |     | <span style='background-color: #eee;'>    /**</span>
 101 |     | <span style='background-color: #eee;'>     * @dev See {IERC1155-setApprovalForAll}.</span>
 102 |     | <span style='background-color: #eee;'>     */</span>
 103 |     | <span style='background-color: #eee;'>    function setApprovalForAll(address operator, bool approved) public virtual override {</span>
 104 |     | <span style='background-color: #eee;'>        _setApprovalForAll(_msgSender(), operator, approved);</span>
 105 |     | <span style='background-color: #eee;'>    }</span>
 106 |     | <span style='background-color: #eee;'></span>
 107 |     | <span style='background-color: #eee;'>    /**</span>
 108 |     | <span style='background-color: #eee;'>     * @dev See {IERC1155-isApprovedForAll}.</span>
 109 |     | <span style='background-color: #eee;'>     */</span>
 110 |     | <span style='background-color: #eee;'>    function isApprovedForAll(address account, address operator) public view virtual override returns (bool) {</span>
 111 |     | <span style='background-color: #faa;'>        return _operatorApprovals[account][operator];</span>
 112 |     | <span style='background-color: #eee;'>    }</span>
 113 |     | <span style='background-color: #eee;'></span>
 114 |     | <span style='background-color: #eee;'>    /**</span>
 115 |     | <span style='background-color: #eee;'>     * @dev See {IERC1155-safeTransferFrom}.</span>
 116 |     | <span style='background-color: #eee;'>     */</span>
 117 |     | <span style='background-color: #eee;'>    function safeTransferFrom(</span>
 118 |     | <span style='background-color: #eee;'>        address from,</span>
 119 |     | <span style='background-color: #eee;'>        address to,</span>
 120 |     | <span style='background-color: #eee;'>        uint256 id,</span>
 121 |     | <span style='background-color: #eee;'>        uint256 amount,</span>
 122 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 123 |     | <span style='background-color: #eee;'>    ) public virtual override {</span>
 124 |     | <span style='background-color: #faa;'>        require(</span>
 125 |     | <span style='background-color: #faa;'>            from == _msgSender() || isApprovedForAll(from, _msgSender()),</span>
 126 |     | <span style='background-color: #eee;'>            &quot;ERC1155: caller is not token owner or approved&quot;</span>
 127 |     | <span style='background-color: #eee;'>        );</span>
 128 |     | <span style='background-color: #eee;'>        _safeTransferFrom(from, to, id, amount, data);</span>
 129 |     | <span style='background-color: #eee;'>    }</span>
 130 |     | <span style='background-color: #eee;'></span>
 131 |     | <span style='background-color: #eee;'>    /**</span>
 132 |     | <span style='background-color: #eee;'>     * @dev See {IERC1155-safeBatchTransferFrom}.</span>
 133 |     | <span style='background-color: #eee;'>     */</span>
 134 |     | <span style='background-color: #eee;'>    function safeBatchTransferFrom(</span>
 135 |     | <span style='background-color: #eee;'>        address from,</span>
 136 |     | <span style='background-color: #eee;'>        address to,</span>
 137 |     | <span style='background-color: #eee;'>        uint256[] memory ids,</span>
 138 |     | <span style='background-color: #eee;'>        uint256[] memory amounts,</span>
 139 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 140 |     | <span style='background-color: #eee;'>    ) public virtual override {</span>
 141 |     | <span style='background-color: #faa;'>        require(</span>
 142 |     | <span style='background-color: #faa;'>            from == _msgSender() || isApprovedForAll(from, _msgSender()),</span>
 143 |     | <span style='background-color: #eee;'>            &quot;ERC1155: caller is not token owner or approved&quot;</span>
 144 |     | <span style='background-color: #eee;'>        );</span>
 145 |     | <span style='background-color: #eee;'>        _safeBatchTransferFrom(from, to, ids, amounts, data);</span>
 146 |     | <span style='background-color: #eee;'>    }</span>
 147 |     | <span style='background-color: #eee;'></span>
 148 |     | <span style='background-color: #eee;'>    /**</span>
 149 |     | <span style='background-color: #eee;'>     * @dev Transfers `amount` tokens of token type `id` from `from` to `to`.</span>
 150 |     | <span style='background-color: #eee;'>     *</span>
 151 |     | <span style='background-color: #eee;'>     * Emits a {TransferSingle} event.</span>
 152 |     | <span style='background-color: #eee;'>     *</span>
 153 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 154 |     | <span style='background-color: #eee;'>     *</span>
 155 |     | <span style='background-color: #eee;'>     * - `to` cannot be the zero address.</span>
 156 |     | <span style='background-color: #eee;'>     * - `from` must have a balance of tokens of type `id` of at least `amount`.</span>
 157 |     | <span style='background-color: #eee;'>     * - If `to` refers to a smart contract, it must implement {IERC1155Receiver-onERC1155Received} and return the</span>
 158 |     | <span style='background-color: #eee;'>     * acceptance magic value.</span>
 159 |     | <span style='background-color: #eee;'>     */</span>
 160 |     | <span style='background-color: #eee;'>    function _safeTransferFrom(</span>
 161 |     | <span style='background-color: #eee;'>        address from,</span>
 162 |     | <span style='background-color: #eee;'>        address to,</span>
 163 |     | <span style='background-color: #eee;'>        uint256 id,</span>
 164 |     | <span style='background-color: #eee;'>        uint256 amount,</span>
 165 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 166 |     | <span style='background-color: #eee;'>    ) internal virtual {</span>
 167 |     | <span style='background-color: #faa;'>        require(to != address(0), &quot;ERC1155: transfer to the zero address&quot;);</span>
 168 |     | <span style='background-color: #eee;'></span>
 169 |     | <span style='background-color: #eee;'>        address operator = _msgSender();</span>
 170 |     | <span style='background-color: #faa;'>        uint256[] memory ids = _asSingletonArray(id);</span>
 171 |     | <span style='background-color: #faa;'>        uint256[] memory amounts = _asSingletonArray(amount);</span>
 172 |     | <span style='background-color: #eee;'></span>
 173 |     | <span style='background-color: #eee;'>        _beforeTokenTransfer(operator, from, to, ids, amounts, data);</span>
 174 |     | <span style='background-color: #eee;'></span>
 175 |     | <span style='background-color: #eee;'>        uint256 fromBalance = _balances[id][from];</span>
 176 |     | <span style='background-color: #faa;'>        require(fromBalance &gt;= amount, &quot;ERC1155: insufficient balance for transfer&quot;);</span>
 177 |     | <span style='background-color: #eee;'>        unchecked {</span>
 178 |     | <span style='background-color: #eee;'>            _balances[id][from] = fromBalance - amount;</span>
 179 |     | <span style='background-color: #eee;'>        }</span>
 180 |     | <span style='background-color: #faa;'>        _balances[id][to] += amount;</span>
 181 |     | <span style='background-color: #eee;'></span>
 182 |     | <span style='background-color: #faa;'>        emit TransferSingle(operator, from, to, id, amount);</span>
 183 |     | <span style='background-color: #eee;'></span>
 184 |     | <span style='background-color: #eee;'>        _afterTokenTransfer(operator, from, to, ids, amounts, data);</span>
 185 |     | <span style='background-color: #eee;'></span>
 186 |     | <span style='background-color: #eee;'>        _doSafeTransferAcceptanceCheck(operator, from, to, id, amount, data);</span>
 187 |     | <span style='background-color: #eee;'>    }</span>
 188 |     | <span style='background-color: #eee;'></span>
 189 |     | <span style='background-color: #eee;'>    /**</span>
 190 |     | <span style='background-color: #eee;'>     * @dev xref:ROOT:erc1155.adoc#batch-operations[Batched] version of {_safeTransferFrom}.</span>
 191 |     | <span style='background-color: #eee;'>     *</span>
 192 |     | <span style='background-color: #eee;'>     * Emits a {TransferBatch} event.</span>
 193 |     | <span style='background-color: #eee;'>     *</span>
 194 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 195 |     | <span style='background-color: #eee;'>     *</span>
 196 |     | <span style='background-color: #eee;'>     * - If `to` refers to a smart contract, it must implement {IERC1155Receiver-onERC1155BatchReceived} and return the</span>
 197 |     | <span style='background-color: #eee;'>     * acceptance magic value.</span>
 198 |     | <span style='background-color: #eee;'>     */</span>
 199 |     | <span style='background-color: #eee;'>    function _safeBatchTransferFrom(</span>
 200 |     | <span style='background-color: #eee;'>        address from,</span>
 201 |     | <span style='background-color: #eee;'>        address to,</span>
 202 |     | <span style='background-color: #eee;'>        uint256[] memory ids,</span>
 203 |     | <span style='background-color: #eee;'>        uint256[] memory amounts,</span>
 204 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 205 |     | <span style='background-color: #eee;'>    ) internal virtual {</span>
 206 |     | <span style='background-color: #faa;'>        require(ids.length == amounts.length, &quot;ERC1155: ids and amounts length mismatch&quot;);</span>
 207 |     | <span style='background-color: #faa;'>        require(to != address(0), &quot;ERC1155: transfer to the zero address&quot;);</span>
 208 |     | <span style='background-color: #eee;'></span>
 209 |     | <span style='background-color: #eee;'>        address operator = _msgSender();</span>
 210 |     | <span style='background-color: #eee;'></span>
 211 |     | <span style='background-color: #eee;'>        _beforeTokenTransfer(operator, from, to, ids, amounts, data);</span>
 212 |     | <span style='background-color: #eee;'></span>
 213 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; ids.length; ++i) {</span>
 214 |     | <span style='background-color: #faa;'>            uint256 id = ids[i];</span>
 215 |     | <span style='background-color: #faa;'>            uint256 amount = amounts[i];</span>
 216 |     | <span style='background-color: #eee;'></span>
 217 |     | <span style='background-color: #eee;'>            uint256 fromBalance = _balances[id][from];</span>
 218 |     | <span style='background-color: #faa;'>            require(fromBalance &gt;= amount, &quot;ERC1155: insufficient balance for transfer&quot;);</span>
 219 |     | <span style='background-color: #eee;'>            unchecked {</span>
 220 |     | <span style='background-color: #eee;'>                _balances[id][from] = fromBalance - amount;</span>
 221 |     | <span style='background-color: #eee;'>            }</span>
 222 |     | <span style='background-color: #faa;'>            _balances[id][to] += amount;</span>
 223 |     | <span style='background-color: #eee;'>        }</span>
 224 |     | <span style='background-color: #eee;'></span>
 225 |     | <span style='background-color: #faa;'>        emit TransferBatch(operator, from, to, ids, amounts);</span>
 226 |     | <span style='background-color: #eee;'></span>
 227 |     | <span style='background-color: #eee;'>        _afterTokenTransfer(operator, from, to, ids, amounts, data);</span>
 228 |     | <span style='background-color: #eee;'></span>
 229 |     | <span style='background-color: #eee;'>        _doSafeBatchTransferAcceptanceCheck(operator, from, to, ids, amounts, data);</span>
 230 |     | <span style='background-color: #eee;'>    }</span>
 231 |     | <span style='background-color: #eee;'></span>
 232 |     | <span style='background-color: #eee;'>    /**</span>
 233 |     | <span style='background-color: #eee;'>     * @dev Sets a new URI for all token types, by relying on the token type ID</span>
 234 |     | <span style='background-color: #eee;'>     * substitution mechanism</span>
 235 |     | <span style='background-color: #eee;'>     * https://eips.ethereum.org/EIPS/eip-1155#metadata[defined in the EIP].</span>
 236 |     | <span style='background-color: #eee;'>     *</span>
 237 |     | <span style='background-color: #eee;'>     * By this mechanism, any occurrence of the `\{id\}` substring in either the</span>
 238 |     | <span style='background-color: #eee;'>     * URI or any of the amounts in the JSON file at said URI will be replaced by</span>
 239 |     | <span style='background-color: #eee;'>     * clients with the token type ID.</span>
 240 |     | <span style='background-color: #eee;'>     *</span>
 241 |     | <span style='background-color: #eee;'>     * For example, the `https://token-cdn-domain/\{id\}.json` URI would be</span>
 242 |     | <span style='background-color: #eee;'>     * interpreted by clients as</span>
 243 |     | <span style='background-color: #eee;'>     * `https://token-cdn-domain/000000000000000000000000000000000000000000000000000000000004cce0.json`</span>
 244 |     | <span style='background-color: #eee;'>     * for token type ID 0x4cce0.</span>
 245 |     | <span style='background-color: #eee;'>     *</span>
 246 |     | <span style='background-color: #eee;'>     * See {uri}.</span>
 247 |     | <span style='background-color: #eee;'>     *</span>
 248 |     | <span style='background-color: #eee;'>     * Because these URIs cannot be meaningfully represented by the {URI} event,</span>
 249 |     | <span style='background-color: #eee;'>     * this function emits no events.</span>
 250 |     | <span style='background-color: #eee;'>     */</span>
 251 |     | <span style='background-color: #eee;'>    function _setURI(string memory newuri) internal virtual {</span>
 252 |     | <span style='background-color: #faa;'>        _uri = newuri;</span>
 253 |     | <span style='background-color: #eee;'>    }</span>
 254 |     | <span style='background-color: #eee;'></span>
 255 |     | <span style='background-color: #eee;'>    /**</span>
 256 |     | <span style='background-color: #eee;'>     * @dev Creates `amount` tokens of token type `id`, and assigns them to `to`.</span>
 257 |     | <span style='background-color: #eee;'>     *</span>
 258 |     | <span style='background-color: #eee;'>     * Emits a {TransferSingle} event.</span>
 259 |     | <span style='background-color: #eee;'>     *</span>
 260 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 261 |     | <span style='background-color: #eee;'>     *</span>
 262 |     | <span style='background-color: #eee;'>     * - `to` cannot be the zero address.</span>
 263 |     | <span style='background-color: #eee;'>     * - If `to` refers to a smart contract, it must implement {IERC1155Receiver-onERC1155Received} and return the</span>
 264 |     | <span style='background-color: #eee;'>     * acceptance magic value.</span>
 265 |     | <span style='background-color: #eee;'>     */</span>
 266 |     | <span style='background-color: #eee;'>    function _mint(</span>
 267 |     | <span style='background-color: #eee;'>        address to,</span>
 268 |     | <span style='background-color: #eee;'>        uint256 id,</span>
 269 |     | <span style='background-color: #eee;'>        uint256 amount,</span>
 270 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 271 |     | <span style='background-color: #eee;'>    ) internal virtual {</span>
 272 |     | <span style='background-color: #faa;'>        require(to != address(0), &quot;ERC1155: mint to the zero address&quot;);</span>
 273 |     | <span style='background-color: #eee;'></span>
 274 |     | <span style='background-color: #eee;'>        address operator = _msgSender();</span>
 275 |     | <span style='background-color: #faa;'>        uint256[] memory ids = _asSingletonArray(id);</span>
 276 |     | <span style='background-color: #eee;'>        uint256[] memory amounts = _asSingletonArray(amount);</span>
 277 |     | <span style='background-color: #eee;'></span>
 278 |     | <span style='background-color: #eee;'>        _beforeTokenTransfer(operator, address(0), to, ids, amounts, data);</span>
 279 |     | <span style='background-color: #eee;'></span>
 280 |     | <span style='background-color: #eee;'>        _balances[id][to] += amount;</span>
 281 |     | <span style='background-color: #faa;'>        emit TransferSingle(operator, address(0), to, id, amount);</span>
 282 |     | <span style='background-color: #eee;'></span>
 283 |     | <span style='background-color: #eee;'>        _afterTokenTransfer(operator, address(0), to, ids, amounts, data);</span>
 284 |     | <span style='background-color: #eee;'></span>
 285 |     | <span style='background-color: #eee;'>        _doSafeTransferAcceptanceCheck(operator, address(0), to, id, amount, data);</span>
 286 |     | <span style='background-color: #eee;'>    }</span>
 287 |     | <span style='background-color: #eee;'></span>
 288 |     | <span style='background-color: #eee;'>    /**</span>
 289 |     | <span style='background-color: #eee;'>     * @dev xref:ROOT:erc1155.adoc#batch-operations[Batched] version of {_mint}.</span>
 290 |     | <span style='background-color: #eee;'>     *</span>
 291 |     | <span style='background-color: #eee;'>     * Emits a {TransferBatch} event.</span>
 292 |     | <span style='background-color: #eee;'>     *</span>
 293 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 294 |     | <span style='background-color: #eee;'>     *</span>
 295 |     | <span style='background-color: #eee;'>     * - `ids` and `amounts` must have the same length.</span>
 296 |     | <span style='background-color: #eee;'>     * - If `to` refers to a smart contract, it must implement {IERC1155Receiver-onERC1155BatchReceived} and return the</span>
 297 |     | <span style='background-color: #eee;'>     * acceptance magic value.</span>
 298 |     | <span style='background-color: #eee;'>     */</span>
 299 |     | <span style='background-color: #eee;'>    function _mintBatch(</span>
 300 |     | <span style='background-color: #eee;'>        address to,</span>
 301 |     | <span style='background-color: #eee;'>        uint256[] memory ids,</span>
 302 |     | <span style='background-color: #eee;'>        uint256[] memory amounts,</span>
 303 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 304 |     | <span style='background-color: #eee;'>    ) internal virtual {</span>
 305 |     | <span style='background-color: #eee;'>        require(to != address(0), &quot;ERC1155: mint to the zero address&quot;);</span>
 306 |     | <span style='background-color: #eee;'>        require(ids.length == amounts.length, &quot;ERC1155: ids and amounts length mismatch&quot;);</span>
 307 |     | <span style='background-color: #eee;'></span>
 308 |     | <span style='background-color: #eee;'>        address operator = _msgSender();</span>
 309 |     | <span style='background-color: #eee;'></span>
 310 |     | <span style='background-color: #eee;'>        _beforeTokenTransfer(operator, address(0), to, ids, amounts, data);</span>
 311 |     | <span style='background-color: #eee;'></span>
 312 |     | <span style='background-color: #eee;'>        for (uint256 i = 0; i &lt; ids.length; i++) {</span>
 313 |     | <span style='background-color: #eee;'>            _balances[ids[i]][to] += amounts[i];</span>
 314 |     | <span style='background-color: #eee;'>        }</span>
 315 |     | <span style='background-color: #eee;'></span>
 316 |     | <span style='background-color: #eee;'>        emit TransferBatch(operator, address(0), to, ids, amounts);</span>
 317 |     | <span style='background-color: #eee;'></span>
 318 |     | <span style='background-color: #eee;'>        _afterTokenTransfer(operator, address(0), to, ids, amounts, data);</span>
 319 |     | <span style='background-color: #eee;'></span>
 320 |     | <span style='background-color: #eee;'>        _doSafeBatchTransferAcceptanceCheck(operator, address(0), to, ids, amounts, data);</span>
 321 |     | <span style='background-color: #eee;'>    }</span>
 322 |     | <span style='background-color: #eee;'></span>
 323 |     | <span style='background-color: #eee;'>    /**</span>
 324 |     | <span style='background-color: #eee;'>     * @dev Destroys `amount` tokens of token type `id` from `from`</span>
 325 |     | <span style='background-color: #eee;'>     *</span>
 326 |     | <span style='background-color: #eee;'>     * Emits a {TransferSingle} event.</span>
 327 |     | <span style='background-color: #eee;'>     *</span>
 328 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 329 |     | <span style='background-color: #eee;'>     *</span>
 330 |     | <span style='background-color: #eee;'>     * - `from` cannot be the zero address.</span>
 331 |     | <span style='background-color: #eee;'>     * - `from` must have at least `amount` tokens of token type `id`.</span>
 332 |     | <span style='background-color: #eee;'>     */</span>
 333 |     | <span style='background-color: #eee;'>    function _burn(</span>
 334 |     | <span style='background-color: #eee;'>        address from,</span>
 335 |     | <span style='background-color: #eee;'>        uint256 id,</span>
 336 |     | <span style='background-color: #eee;'>        uint256 amount</span>
 337 |     | <span style='background-color: #eee;'>    ) internal virtual {</span>
 338 |     | <span style='background-color: #faa;'>        require(from != address(0), &quot;ERC1155: burn from the zero address&quot;);</span>
 339 |     | <span style='background-color: #eee;'></span>
 340 |     | <span style='background-color: #eee;'>        address operator = _msgSender();</span>
 341 |     | <span style='background-color: #faa;'>        uint256[] memory ids = _asSingletonArray(id);</span>
 342 |     | <span style='background-color: #faa;'>        uint256[] memory amounts = _asSingletonArray(amount);</span>
 343 |     | <span style='background-color: #eee;'></span>
 344 |     | <span style='background-color: #eee;'>        _beforeTokenTransfer(operator, from, address(0), ids, amounts, &quot;&quot;);</span>
 345 |     | <span style='background-color: #eee;'></span>
 346 |     | <span style='background-color: #eee;'>        uint256 fromBalance = _balances[id][from];</span>
 347 |     | <span style='background-color: #faa;'>        require(fromBalance &gt;= amount, &quot;ERC1155: burn amount exceeds balance&quot;);</span>
 348 |     | <span style='background-color: #eee;'>        unchecked {</span>
 349 |     | <span style='background-color: #eee;'>            _balances[id][from] = fromBalance - amount;</span>
 350 |     | <span style='background-color: #eee;'>        }</span>
 351 |     | <span style='background-color: #eee;'></span>
 352 |     | <span style='background-color: #faa;'>        emit TransferSingle(operator, from, address(0), id, amount);</span>
 353 |     | <span style='background-color: #eee;'></span>
 354 |     | <span style='background-color: #eee;'>        _afterTokenTransfer(operator, from, address(0), ids, amounts, &quot;&quot;);</span>
 355 |     | <span style='background-color: #eee;'>    }</span>
 356 |     | <span style='background-color: #eee;'></span>
 357 |     | <span style='background-color: #eee;'>    /**</span>
 358 |     | <span style='background-color: #eee;'>     * @dev xref:ROOT:erc1155.adoc#batch-operations[Batched] version of {_burn}.</span>
 359 |     | <span style='background-color: #eee;'>     *</span>
 360 |     | <span style='background-color: #eee;'>     * Emits a {TransferBatch} event.</span>
 361 |     | <span style='background-color: #eee;'>     *</span>
 362 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 363 |     | <span style='background-color: #eee;'>     *</span>
 364 |     | <span style='background-color: #eee;'>     * - `ids` and `amounts` must have the same length.</span>
 365 |     | <span style='background-color: #eee;'>     */</span>
 366 |     | <span style='background-color: #eee;'>    function _burnBatch(</span>
 367 |     | <span style='background-color: #eee;'>        address from,</span>
 368 |     | <span style='background-color: #eee;'>        uint256[] memory ids,</span>
 369 |     | <span style='background-color: #eee;'>        uint256[] memory amounts</span>
 370 |     | <span style='background-color: #eee;'>    ) internal virtual {</span>
 371 |     | <span style='background-color: #faa;'>        require(from != address(0), &quot;ERC1155: burn from the zero address&quot;);</span>
 372 |     | <span style='background-color: #faa;'>        require(ids.length == amounts.length, &quot;ERC1155: ids and amounts length mismatch&quot;);</span>
 373 |     | <span style='background-color: #eee;'></span>
 374 |     | <span style='background-color: #eee;'>        address operator = _msgSender();</span>
 375 |     | <span style='background-color: #eee;'></span>
 376 |     | <span style='background-color: #eee;'>        _beforeTokenTransfer(operator, from, address(0), ids, amounts, &quot;&quot;);</span>
 377 |     | <span style='background-color: #eee;'></span>
 378 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; ids.length; i++) {</span>
 379 |     | <span style='background-color: #faa;'>            uint256 id = ids[i];</span>
 380 |     | <span style='background-color: #faa;'>            uint256 amount = amounts[i];</span>
 381 |     | <span style='background-color: #eee;'></span>
 382 |     | <span style='background-color: #eee;'>            uint256 fromBalance = _balances[id][from];</span>
 383 |     | <span style='background-color: #faa;'>            require(fromBalance &gt;= amount, &quot;ERC1155: burn amount exceeds balance&quot;);</span>
 384 |     | <span style='background-color: #eee;'>            unchecked {</span>
 385 |     | <span style='background-color: #eee;'>                _balances[id][from] = fromBalance - amount;</span>
 386 |     | <span style='background-color: #eee;'>            }</span>
 387 |     | <span style='background-color: #eee;'>        }</span>
 388 |     | <span style='background-color: #eee;'></span>
 389 |     | <span style='background-color: #faa;'>        emit TransferBatch(operator, from, address(0), ids, amounts);</span>
 390 |     | <span style='background-color: #eee;'></span>
 391 |     | <span style='background-color: #eee;'>        _afterTokenTransfer(operator, from, address(0), ids, amounts, &quot;&quot;);</span>
 392 |     | <span style='background-color: #eee;'>    }</span>
 393 |     | <span style='background-color: #eee;'></span>
 394 |     | <span style='background-color: #eee;'>    /**</span>
 395 |     | <span style='background-color: #eee;'>     * @dev Approve `operator` to operate on all of `owner` tokens</span>
 396 |     | <span style='background-color: #eee;'>     *</span>
 397 |     | <span style='background-color: #eee;'>     * Emits an {ApprovalForAll} event.</span>
 398 |     | <span style='background-color: #eee;'>     */</span>
 399 |     | <span style='background-color: #eee;'>    function _setApprovalForAll(</span>
 400 |     | <span style='background-color: #eee;'>        address owner,</span>
 401 |     | <span style='background-color: #eee;'>        address operator,</span>
 402 |     | <span style='background-color: #eee;'>        bool approved</span>
 403 |     | <span style='background-color: #eee;'>    ) internal virtual {</span>
 404 |     | <span style='background-color: #faa;'>        require(owner != operator, &quot;ERC1155: setting approval status for self&quot;);</span>
 405 |     | <span style='background-color: #faa;'>        _operatorApprovals[owner][operator] = approved;</span>
 406 |     | <span style='background-color: #faa;'>        emit ApprovalForAll(owner, operator, approved);</span>
 407 |     | <span style='background-color: #eee;'>    }</span>
 408 |     | <span style='background-color: #eee;'></span>
 409 |     | <span style='background-color: #eee;'>    /**</span>
 410 |     | <span style='background-color: #eee;'>     * @dev Hook that is called before any token transfer. This includes minting</span>
 411 |     | <span style='background-color: #eee;'>     * and burning, as well as batched variants.</span>
 412 |     | <span style='background-color: #eee;'>     *</span>
 413 |     | <span style='background-color: #eee;'>     * The same hook is called on both single and batched variants. For single</span>
 414 |     | <span style='background-color: #eee;'>     * transfers, the length of the `ids` and `amounts` arrays will be 1.</span>
 415 |     | <span style='background-color: #eee;'>     *</span>
 416 |     | <span style='background-color: #eee;'>     * Calling conditions (for each `id` and `amount` pair):</span>
 417 |     | <span style='background-color: #eee;'>     *</span>
 418 |     | <span style='background-color: #eee;'>     * - When `from` and `to` are both non-zero, `amount` of ``from``&#39;s tokens</span>
 419 |     | <span style='background-color: #eee;'>     * of token type `id` will be  transferred to `to`.</span>
 420 |     | <span style='background-color: #eee;'>     * - When `from` is zero, `amount` tokens of token type `id` will be minted</span>
 421 |     | <span style='background-color: #eee;'>     * for `to`.</span>
 422 |     | <span style='background-color: #eee;'>     * - when `to` is zero, `amount` of ``from``&#39;s tokens of token type `id`</span>
 423 |     | <span style='background-color: #eee;'>     * will be burned.</span>
 424 |     | <span style='background-color: #eee;'>     * - `from` and `to` are never both zero.</span>
 425 |     | <span style='background-color: #eee;'>     * - `ids` and `amounts` have the same, non-zero length.</span>
 426 |     | <span style='background-color: #eee;'>     *</span>
 427 |     | <span style='background-color: #eee;'>     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span>
 428 |     | <span style='background-color: #eee;'>     */</span>
 429 |     | <span style='background-color: #eee;'>    function _beforeTokenTransfer(</span>
 430 |     | <span style='background-color: #eee;'>        address operator,</span>
 431 |     | <span style='background-color: #eee;'>        address from,</span>
 432 |     | <span style='background-color: #eee;'>        address to,</span>
 433 |     | <span style='background-color: #eee;'>        uint256[] memory ids,</span>
 434 |     | <span style='background-color: #eee;'>        uint256[] memory amounts,</span>
 435 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 436 |     | <span style='background-color: #eee;'>    ) internal virtual {}</span>
 437 |     | <span style='background-color: #eee;'></span>
 438 |     | <span style='background-color: #eee;'>    /**</span>
 439 |     | <span style='background-color: #eee;'>     * @dev Hook that is called after any token transfer. This includes minting</span>
 440 |     | <span style='background-color: #eee;'>     * and burning, as well as batched variants.</span>
 441 |     | <span style='background-color: #eee;'>     *</span>
 442 |     | <span style='background-color: #eee;'>     * The same hook is called on both single and batched variants. For single</span>
 443 |     | <span style='background-color: #eee;'>     * transfers, the length of the `id` and `amount` arrays will be 1.</span>
 444 |     | <span style='background-color: #eee;'>     *</span>
 445 |     | <span style='background-color: #eee;'>     * Calling conditions (for each `id` and `amount` pair):</span>
 446 |     | <span style='background-color: #eee;'>     *</span>
 447 |     | <span style='background-color: #eee;'>     * - When `from` and `to` are both non-zero, `amount` of ``from``&#39;s tokens</span>
 448 |     | <span style='background-color: #eee;'>     * of token type `id` will be  transferred to `to`.</span>
 449 |     | <span style='background-color: #eee;'>     * - When `from` is zero, `amount` tokens of token type `id` will be minted</span>
 450 |     | <span style='background-color: #eee;'>     * for `to`.</span>
 451 |     | <span style='background-color: #eee;'>     * - when `to` is zero, `amount` of ``from``&#39;s tokens of token type `id`</span>
 452 |     | <span style='background-color: #eee;'>     * will be burned.</span>
 453 |     | <span style='background-color: #eee;'>     * - `from` and `to` are never both zero.</span>
 454 |     | <span style='background-color: #eee;'>     * - `ids` and `amounts` have the same, non-zero length.</span>
 455 |     | <span style='background-color: #eee;'>     *</span>
 456 |     | <span style='background-color: #eee;'>     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span>
 457 |     | <span style='background-color: #eee;'>     */</span>
 458 |     | <span style='background-color: #eee;'>    function _afterTokenTransfer(</span>
 459 |     | <span style='background-color: #eee;'>        address operator,</span>
 460 |     | <span style='background-color: #eee;'>        address from,</span>
 461 |     | <span style='background-color: #eee;'>        address to,</span>
 462 |     | <span style='background-color: #eee;'>        uint256[] memory ids,</span>
 463 |     | <span style='background-color: #eee;'>        uint256[] memory amounts,</span>
 464 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 465 |     | <span style='background-color: #eee;'>    ) internal virtual {}</span>
 466 |     | <span style='background-color: #eee;'></span>
 467 |     | <span style='background-color: #eee;'>    function _doSafeTransferAcceptanceCheck(</span>
 468 |     | <span style='background-color: #eee;'>        address operator,</span>
 469 |     | <span style='background-color: #eee;'>        address from,</span>
 470 |     | <span style='background-color: #eee;'>        address to,</span>
 471 |     | <span style='background-color: #eee;'>        uint256 id,</span>
 472 |     | <span style='background-color: #eee;'>        uint256 amount,</span>
 473 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 474 |     | <span style='background-color: #eee;'>    ) private {</span>
 475 |     | <span style='background-color: #faa;'>        if (to.isContract()) {</span>
 476 |     | <span style='background-color: #faa;'>            try IERC1155Receiver(to).onERC1155Received(operator, from, id, amount, data) returns (bytes4 response) {</span>
 477 |     | <span style='background-color: #faa;'>                if (response != IERC1155Receiver.onERC1155Received.selector) {</span>
 478 |     | <span style='background-color: #faa;'>                    revert(&quot;ERC1155: ERC1155Receiver rejected tokens&quot;);</span>
 479 |     | <span style='background-color: #eee;'>                }</span>
 480 |     | <span style='background-color: #faa;'>            } catch Error(string memory reason) {</span>
 481 |     | <span style='background-color: #faa;'>                revert(reason);</span>
 482 |     | <span style='background-color: #eee;'>            } catch {</span>
 483 |     | <span style='background-color: #faa;'>                revert(&quot;ERC1155: transfer to non-ERC1155Receiver implementer&quot;);</span>
 484 |     | <span style='background-color: #eee;'>            }</span>
 485 |     | <span style='background-color: #eee;'>        }</span>
 486 |     | <span style='background-color: #eee;'>    }</span>
 487 |     | <span style='background-color: #eee;'></span>
 488 |     | <span style='background-color: #eee;'>    function _doSafeBatchTransferAcceptanceCheck(</span>
 489 |     | <span style='background-color: #eee;'>        address operator,</span>
 490 |     | <span style='background-color: #eee;'>        address from,</span>
 491 |     | <span style='background-color: #eee;'>        address to,</span>
 492 |     | <span style='background-color: #eee;'>        uint256[] memory ids,</span>
 493 |     | <span style='background-color: #eee;'>        uint256[] memory amounts,</span>
 494 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 495 |     | <span style='background-color: #eee;'>    ) private {</span>
 496 |     | <span style='background-color: #faa;'>        if (to.isContract()) {</span>
 497 |     | <span style='background-color: #faa;'>            try IERC1155Receiver(to).onERC1155BatchReceived(operator, from, ids, amounts, data) returns (</span>
 498 |     | <span style='background-color: #eee;'>                bytes4 response</span>
 499 |     | <span style='background-color: #eee;'>            ) {</span>
 500 |     | <span style='background-color: #faa;'>                if (response != IERC1155Receiver.onERC1155BatchReceived.selector) {</span>
 501 |     | <span style='background-color: #eee;'>                    revert(&quot;ERC1155: ERC1155Receiver rejected tokens&quot;);</span>
 502 |     | <span style='background-color: #eee;'>                }</span>
 503 |     | <span style='background-color: #faa;'>            } catch Error(string memory reason) {</span>
 504 |     | <span style='background-color: #faa;'>                revert(reason);</span>
 505 |     | <span style='background-color: #eee;'>            } catch {</span>
 506 |     | <span style='background-color: #eee;'>                revert(&quot;ERC1155: transfer to non-ERC1155Receiver implementer&quot;);</span>
 507 |     | <span style='background-color: #eee;'>            }</span>
 508 |     | <span style='background-color: #eee;'>        }</span>
 509 |     | <span style='background-color: #eee;'>    }</span>
 510 |     | <span style='background-color: #eee;'></span>
 511 |     | <span style='background-color: #faa;'>    function _asSingletonArray(uint256 element) private pure returns (uint256[] memory) {</span>
 512 |     | <span style='background-color: #faa;'>        uint256[] memory array = new uint256[](1);</span>
 513 |     | <span style='background-color: #faa;'>        array[0] = element;</span>
 514 |     | <span style='background-color: #eee;'></span>
 515 |     | <span style='background-color: #eee;'>        return array;</span>
 516 |     | <span style='background-color: #eee;'>    }</span>
 517 |     | <span style='background-color: #eee;'>}</span>
 518 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/token/ERC1155/IERC1155.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.7.0) (token/ERC1155/IERC1155.sol)</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>import &quot;../../utils/introspection/IERC165.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'></span>
   8 |     | <span style='background-color: #eee;'>/**</span>
   9 |     | <span style='background-color: #eee;'> * @dev Required interface of an ERC1155 compliant contract, as defined in the</span>
  10 |     | <span style='background-color: #eee;'> * https://eips.ethereum.org/EIPS/eip-1155[EIP].</span>
  11 |     | <span style='background-color: #eee;'> *</span>
  12 |     | <span style='background-color: #eee;'> * _Available since v3.1._</span>
  13 |     | <span style='background-color: #eee;'> */</span>
  14 |     | <span style='background-color: #eee;'>interface IERC1155 is IERC165 {</span>
  15 |     | <span style='background-color: #eee;'>    /**</span>
  16 |     | <span style='background-color: #eee;'>     * @dev Emitted when `value` tokens of token type `id` are transferred from `from` to `to` by `operator`.</span>
  17 |     | <span style='background-color: #eee;'>     */</span>
  18 |     | <span style='background-color: #eee;'>    event TransferSingle(address indexed operator, address indexed from, address indexed to, uint256 id, uint256 value);</span>
  19 |     | <span style='background-color: #eee;'></span>
  20 |     | <span style='background-color: #eee;'>    /**</span>
  21 |     | <span style='background-color: #eee;'>     * @dev Equivalent to multiple {TransferSingle} events, where `operator`, `from` and `to` are the same for all</span>
  22 |     | <span style='background-color: #eee;'>     * transfers.</span>
  23 |     | <span style='background-color: #eee;'>     */</span>
  24 |     | <span style='background-color: #eee;'>    event TransferBatch(</span>
  25 |     | <span style='background-color: #eee;'>        address indexed operator,</span>
  26 |     | <span style='background-color: #eee;'>        address indexed from,</span>
  27 |     | <span style='background-color: #eee;'>        address indexed to,</span>
  28 |     | <span style='background-color: #eee;'>        uint256[] ids,</span>
  29 |     | <span style='background-color: #eee;'>        uint256[] values</span>
  30 |     | <span style='background-color: #eee;'>    );</span>
  31 |     | <span style='background-color: #eee;'></span>
  32 |     | <span style='background-color: #eee;'>    /**</span>
  33 |     | <span style='background-color: #eee;'>     * @dev Emitted when `account` grants or revokes permission to `operator` to transfer their tokens, according to</span>
  34 |     | <span style='background-color: #eee;'>     * `approved`.</span>
  35 |     | <span style='background-color: #eee;'>     */</span>
  36 |     | <span style='background-color: #eee;'>    event ApprovalForAll(address indexed account, address indexed operator, bool approved);</span>
  37 |     | <span style='background-color: #eee;'></span>
  38 |     | <span style='background-color: #eee;'>    /**</span>
  39 |     | <span style='background-color: #eee;'>     * @dev Emitted when the URI for token type `id` changes to `value`, if it is a non-programmatic URI.</span>
  40 |     | <span style='background-color: #eee;'>     *</span>
  41 |     | <span style='background-color: #eee;'>     * If an {URI} event was emitted for `id`, the standard</span>
  42 |     | <span style='background-color: #eee;'>     * https://eips.ethereum.org/EIPS/eip-1155#metadata-extensions[guarantees] that `value` will equal the value</span>
  43 |     | <span style='background-color: #eee;'>     * returned by {IERC1155MetadataURI-uri}.</span>
  44 |     | <span style='background-color: #eee;'>     */</span>
  45 |     | <span style='background-color: #eee;'>    event URI(string value, uint256 indexed id);</span>
  46 |     | <span style='background-color: #eee;'></span>
  47 |     | <span style='background-color: #eee;'>    /**</span>
  48 |     | <span style='background-color: #eee;'>     * @dev Returns the amount of tokens of token type `id` owned by `account`.</span>
  49 |     | <span style='background-color: #eee;'>     *</span>
  50 |     | <span style='background-color: #eee;'>     * Requirements:</span>
  51 |     | <span style='background-color: #eee;'>     *</span>
  52 |     | <span style='background-color: #eee;'>     * - `account` cannot be the zero address.</span>
  53 |     | <span style='background-color: #eee;'>     */</span>
  54 |     | <span style='background-color: #eee;'>    function balanceOf(address account, uint256 id) external view returns (uint256);</span>
  55 |     | <span style='background-color: #eee;'></span>
  56 |     | <span style='background-color: #eee;'>    /**</span>
  57 |     | <span style='background-color: #eee;'>     * @dev xref:ROOT:erc1155.adoc#batch-operations[Batched] version of {balanceOf}.</span>
  58 |     | <span style='background-color: #eee;'>     *</span>
  59 |     | <span style='background-color: #eee;'>     * Requirements:</span>
  60 |     | <span style='background-color: #eee;'>     *</span>
  61 |     | <span style='background-color: #eee;'>     * - `accounts` and `ids` must have the same length.</span>
  62 |     | <span style='background-color: #eee;'>     */</span>
  63 |     | <span style='background-color: #eee;'>    function balanceOfBatch(address[] calldata accounts, uint256[] calldata ids)</span>
  64 |     | <span style='background-color: #eee;'>        external</span>
  65 |     | <span style='background-color: #eee;'>        view</span>
  66 |     | <span style='background-color: #eee;'>        returns (uint256[] memory);</span>
  67 |     | <span style='background-color: #eee;'></span>
  68 |     | <span style='background-color: #eee;'>    /**</span>
  69 |     | <span style='background-color: #eee;'>     * @dev Grants or revokes permission to `operator` to transfer the caller&#39;s tokens, according to `approved`,</span>
  70 |     | <span style='background-color: #eee;'>     *</span>
  71 |     | <span style='background-color: #eee;'>     * Emits an {ApprovalForAll} event.</span>
  72 |     | <span style='background-color: #eee;'>     *</span>
  73 |     | <span style='background-color: #eee;'>     * Requirements:</span>
  74 |     | <span style='background-color: #eee;'>     *</span>
  75 |     | <span style='background-color: #eee;'>     * - `operator` cannot be the caller.</span>
  76 |     | <span style='background-color: #eee;'>     */</span>
  77 |     | <span style='background-color: #eee;'>    function setApprovalForAll(address operator, bool approved) external;</span>
  78 |     | <span style='background-color: #eee;'></span>
  79 |     | <span style='background-color: #eee;'>    /**</span>
  80 |     | <span style='background-color: #eee;'>     * @dev Returns true if `operator` is approved to transfer ``account``&#39;s tokens.</span>
  81 |     | <span style='background-color: #eee;'>     *</span>
  82 |     | <span style='background-color: #eee;'>     * See {setApprovalForAll}.</span>
  83 |     | <span style='background-color: #eee;'>     */</span>
  84 |     | <span style='background-color: #eee;'>    function isApprovedForAll(address account, address operator) external view returns (bool);</span>
  85 |     | <span style='background-color: #eee;'></span>
  86 |     | <span style='background-color: #eee;'>    /**</span>
  87 |     | <span style='background-color: #eee;'>     * @dev Transfers `amount` tokens of token type `id` from `from` to `to`.</span>
  88 |     | <span style='background-color: #eee;'>     *</span>
  89 |     | <span style='background-color: #eee;'>     * Emits a {TransferSingle} event.</span>
  90 |     | <span style='background-color: #eee;'>     *</span>
  91 |     | <span style='background-color: #eee;'>     * Requirements:</span>
  92 |     | <span style='background-color: #eee;'>     *</span>
  93 |     | <span style='background-color: #eee;'>     * - `to` cannot be the zero address.</span>
  94 |     | <span style='background-color: #eee;'>     * - If the caller is not `from`, it must have been approved to spend ``from``&#39;s tokens via {setApprovalForAll}.</span>
  95 |     | <span style='background-color: #eee;'>     * - `from` must have a balance of tokens of type `id` of at least `amount`.</span>
  96 |     | <span style='background-color: #eee;'>     * - If `to` refers to a smart contract, it must implement {IERC1155Receiver-onERC1155Received} and return the</span>
  97 |     | <span style='background-color: #eee;'>     * acceptance magic value.</span>
  98 |     | <span style='background-color: #eee;'>     */</span>
  99 |     | <span style='background-color: #eee;'>    function safeTransferFrom(</span>
 100 |     | <span style='background-color: #eee;'>        address from,</span>
 101 |     | <span style='background-color: #eee;'>        address to,</span>
 102 |     | <span style='background-color: #eee;'>        uint256 id,</span>
 103 |     | <span style='background-color: #eee;'>        uint256 amount,</span>
 104 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
 105 |     | <span style='background-color: #eee;'>    ) external;</span>
 106 |     | <span style='background-color: #eee;'></span>
 107 |     | <span style='background-color: #eee;'>    /**</span>
 108 |     | <span style='background-color: #eee;'>     * @dev xref:ROOT:erc1155.adoc#batch-operations[Batched] version of {safeTransferFrom}.</span>
 109 |     | <span style='background-color: #eee;'>     *</span>
 110 |     | <span style='background-color: #eee;'>     * Emits a {TransferBatch} event.</span>
 111 |     | <span style='background-color: #eee;'>     *</span>
 112 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 113 |     | <span style='background-color: #eee;'>     *</span>
 114 |     | <span style='background-color: #eee;'>     * - `ids` and `amounts` must have the same length.</span>
 115 |     | <span style='background-color: #eee;'>     * - If `to` refers to a smart contract, it must implement {IERC1155Receiver-onERC1155BatchReceived} and return the</span>
 116 |     | <span style='background-color: #eee;'>     * acceptance magic value.</span>
 117 |     | <span style='background-color: #eee;'>     */</span>
 118 |     | <span style='background-color: #eee;'>    function safeBatchTransferFrom(</span>
 119 |     | <span style='background-color: #eee;'>        address from,</span>
 120 |     | <span style='background-color: #eee;'>        address to,</span>
 121 |     | <span style='background-color: #eee;'>        uint256[] calldata ids,</span>
 122 |     | <span style='background-color: #eee;'>        uint256[] calldata amounts,</span>
 123 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
 124 |     | <span style='background-color: #eee;'>    ) external;</span>
 125 |     | <span style='background-color: #eee;'>}</span>
 126 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/token/ERC1155/IERC1155Receiver.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.5.0) (token/ERC1155/IERC1155Receiver.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>import &quot;../../utils/introspection/IERC165.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'></span>
  8 |     | <span style='background-color: #eee;'>/**</span>
  9 |     | <span style='background-color: #eee;'> * @dev _Available since v3.1._</span>
 10 |     | <span style='background-color: #eee;'> */</span>
 11 |     | <span style='background-color: #eee;'>interface IERC1155Receiver is IERC165 {</span>
 12 |     | <span style='background-color: #eee;'>    /**</span>
 13 |     | <span style='background-color: #eee;'>     * @dev Handles the receipt of a single ERC1155 token type. This function is</span>
 14 |     | <span style='background-color: #eee;'>     * called at the end of a `safeTransferFrom` after the balance has been updated.</span>
 15 |     | <span style='background-color: #eee;'>     *</span>
 16 |     | <span style='background-color: #eee;'>     * NOTE: To accept the transfer, this must return</span>
 17 |     | <span style='background-color: #eee;'>     * `bytes4(keccak256(&quot;onERC1155Received(address,address,uint256,uint256,bytes)&quot;))`</span>
 18 |     | <span style='background-color: #eee;'>     * (i.e. 0xf23a6e61, or its own function selector).</span>
 19 |     | <span style='background-color: #eee;'>     *</span>
 20 |     | <span style='background-color: #eee;'>     * @param operator The address which initiated the transfer (i.e. msg.sender)</span>
 21 |     | <span style='background-color: #eee;'>     * @param from The address which previously owned the token</span>
 22 |     | <span style='background-color: #eee;'>     * @param id The ID of the token being transferred</span>
 23 |     | <span style='background-color: #eee;'>     * @param value The amount of tokens being transferred</span>
 24 |     | <span style='background-color: #eee;'>     * @param data Additional data with no specified format</span>
 25 |     | <span style='background-color: #eee;'>     * @return `bytes4(keccak256(&quot;onERC1155Received(address,address,uint256,uint256,bytes)&quot;))` if transfer is allowed</span>
 26 |     | <span style='background-color: #eee;'>     */</span>
 27 |     | <span style='background-color: #eee;'>    function onERC1155Received(</span>
 28 |     | <span style='background-color: #eee;'>        address operator,</span>
 29 |     | <span style='background-color: #eee;'>        address from,</span>
 30 |     | <span style='background-color: #eee;'>        uint256 id,</span>
 31 |     | <span style='background-color: #eee;'>        uint256 value,</span>
 32 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
 33 |     | <span style='background-color: #eee;'>    ) external returns (bytes4);</span>
 34 |     | <span style='background-color: #eee;'></span>
 35 |     | <span style='background-color: #eee;'>    /**</span>
 36 |     | <span style='background-color: #eee;'>     * @dev Handles the receipt of a multiple ERC1155 token types. This function</span>
 37 |     | <span style='background-color: #eee;'>     * is called at the end of a `safeBatchTransferFrom` after the balances have</span>
 38 |     | <span style='background-color: #eee;'>     * been updated.</span>
 39 |     | <span style='background-color: #eee;'>     *</span>
 40 |     | <span style='background-color: #eee;'>     * NOTE: To accept the transfer(s), this must return</span>
 41 |     | <span style='background-color: #eee;'>     * `bytes4(keccak256(&quot;onERC1155BatchReceived(address,address,uint256[],uint256[],bytes)&quot;))`</span>
 42 |     | <span style='background-color: #eee;'>     * (i.e. 0xbc197c81, or its own function selector).</span>
 43 |     | <span style='background-color: #eee;'>     *</span>
 44 |     | <span style='background-color: #eee;'>     * @param operator The address which initiated the batch transfer (i.e. msg.sender)</span>
 45 |     | <span style='background-color: #eee;'>     * @param from The address which previously owned the token</span>
 46 |     | <span style='background-color: #eee;'>     * @param ids An array containing ids of each token being transferred (order and length must match values array)</span>
 47 |     | <span style='background-color: #eee;'>     * @param values An array containing amounts of each token being transferred (order and length must match ids array)</span>
 48 |     | <span style='background-color: #eee;'>     * @param data Additional data with no specified format</span>
 49 |     | <span style='background-color: #eee;'>     * @return `bytes4(keccak256(&quot;onERC1155BatchReceived(address,address,uint256[],uint256[],bytes)&quot;))` if transfer is allowed</span>
 50 |     | <span style='background-color: #eee;'>     */</span>
 51 |     | <span style='background-color: #eee;'>    function onERC1155BatchReceived(</span>
 52 |     | <span style='background-color: #eee;'>        address operator,</span>
 53 |     | <span style='background-color: #eee;'>        address from,</span>
 54 |     | <span style='background-color: #eee;'>        uint256[] calldata ids,</span>
 55 |     | <span style='background-color: #eee;'>        uint256[] calldata values,</span>
 56 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
 57 |     | <span style='background-color: #eee;'>    ) external returns (bytes4);</span>
 58 |     | <span style='background-color: #eee;'>}</span>
 59 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/token/ERC1155/extensions/ERC1155Burnable.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.8.0) (token/ERC1155/extensions/ERC1155Burnable.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>import &quot;../ERC1155.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'></span>
  8 |     | <span style='background-color: #eee;'>/**</span>
  9 |     | <span style='background-color: #eee;'> * @dev Extension of {ERC1155} that allows token holders to destroy both their</span>
 10 |     | <span style='background-color: #eee;'> * own tokens and those that they have been approved to use.</span>
 11 |     | <span style='background-color: #eee;'> *</span>
 12 |     | <span style='background-color: #eee;'> * _Available since v3.1._</span>
 13 |     | <span style='background-color: #eee;'> */</span>
 14 |     | <span style='background-color: #eee;'>abstract contract ERC1155Burnable is ERC1155 {</span>
 15 |     | <span style='background-color: #eee;'>    function burn(</span>
 16 |     | <span style='background-color: #eee;'>        address account,</span>
 17 |     | <span style='background-color: #eee;'>        uint256 id,</span>
 18 |     | <span style='background-color: #eee;'>        uint256 value</span>
 19 |     | <span style='background-color: #eee;'>    ) public virtual {</span>
 20 |     | <span style='background-color: #faa;'>        require(</span>
 21 |     | <span style='background-color: #faa;'>            account == _msgSender() || isApprovedForAll(account, _msgSender()),</span>
 22 |     | <span style='background-color: #eee;'>            &quot;ERC1155: caller is not token owner or approved&quot;</span>
 23 |     | <span style='background-color: #eee;'>        );</span>
 24 |     | <span style='background-color: #eee;'></span>
 25 |     | <span style='background-color: #eee;'>        _burn(account, id, value);</span>
 26 |     | <span style='background-color: #eee;'>    }</span>
 27 |     | <span style='background-color: #eee;'></span>
 28 |     | <span style='background-color: #eee;'>    function burnBatch(</span>
 29 |     | <span style='background-color: #eee;'>        address account,</span>
 30 |     | <span style='background-color: #eee;'>        uint256[] memory ids,</span>
 31 |     | <span style='background-color: #eee;'>        uint256[] memory values</span>
 32 |     | <span style='background-color: #eee;'>    ) public virtual {</span>
 33 |     | <span style='background-color: #faa;'>        require(</span>
 34 |     | <span style='background-color: #faa;'>            account == _msgSender() || isApprovedForAll(account, _msgSender()),</span>
 35 |     | <span style='background-color: #eee;'>            &quot;ERC1155: caller is not token owner or approved&quot;</span>
 36 |     | <span style='background-color: #eee;'>        );</span>
 37 |     | <span style='background-color: #eee;'></span>
 38 |     | <span style='background-color: #eee;'>        _burnBatch(account, ids, values);</span>
 39 |     | <span style='background-color: #eee;'>    }</span>
 40 |     | <span style='background-color: #eee;'>}</span>
 41 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/token/ERC1155/extensions/IERC1155MetadataURI.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts v4.4.1 (token/ERC1155/extensions/IERC1155MetadataURI.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>import &quot;../IERC1155.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'></span>
  8 |     | <span style='background-color: #eee;'>/**</span>
  9 |     | <span style='background-color: #eee;'> * @dev Interface of the optional ERC1155MetadataExtension interface, as defined</span>
 10 |     | <span style='background-color: #eee;'> * in the https://eips.ethereum.org/EIPS/eip-1155#metadata-extensions[EIP].</span>
 11 |     | <span style='background-color: #eee;'> *</span>
 12 |     | <span style='background-color: #eee;'> * _Available since v3.1._</span>
 13 |     | <span style='background-color: #eee;'> */</span>
 14 |     | <span style='background-color: #eee;'>interface IERC1155MetadataURI is IERC1155 {</span>
 15 |     | <span style='background-color: #eee;'>    /**</span>
 16 |     | <span style='background-color: #eee;'>     * @dev Returns the URI for token type `id`.</span>
 17 |     | <span style='background-color: #eee;'>     *</span>
 18 |     | <span style='background-color: #eee;'>     * If the `\{id\}` substring is present in the URI, it must be replaced by</span>
 19 |     | <span style='background-color: #eee;'>     * clients with the actual token type ID.</span>
 20 |     | <span style='background-color: #eee;'>     */</span>
 21 |     | <span style='background-color: #eee;'>    function uri(uint256 id) external view returns (string memory);</span>
 22 |     | <span style='background-color: #eee;'>}</span>
 23 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/token/ERC1155/utils/ERC1155Receiver.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts v4.4.1 (token/ERC1155/utils/ERC1155Receiver.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>import &quot;../IERC1155Receiver.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'>import &quot;../../../utils/introspection/ERC165.sol&quot;;</span>
  8 |     | <span style='background-color: #eee;'></span>
  9 |     | <span style='background-color: #eee;'>/**</span>
 10 |     | <span style='background-color: #eee;'> * @dev _Available since v3.1._</span>
 11 |     | <span style='background-color: #eee;'> */</span>
 12 |     | <span style='background-color: #eee;'>abstract contract ERC1155Receiver is ERC165, IERC1155Receiver {</span>
 13 |     | <span style='background-color: #eee;'>    /**</span>
 14 |     | <span style='background-color: #eee;'>     * @dev See {IERC165-supportsInterface}.</span>
 15 |     | <span style='background-color: #eee;'>     */</span>
 16 |     | <span style='background-color: #eee;'>    function supportsInterface(bytes4 interfaceId) public view virtual override(ERC165, IERC165) returns (bool) {</span>
 17 |     | <span style='background-color: #faa;'>        return interfaceId == type(IERC1155Receiver).interfaceId || super.supportsInterface(interfaceId);</span>
 18 |     | <span style='background-color: #eee;'>    }</span>
 19 |     | <span style='background-color: #eee;'>}</span>
 20 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/token/ERC20/ERC20.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.8.0) (token/ERC20/ERC20.sol)</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>import &quot;./IERC20.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'>import &quot;./extensions/IERC20Metadata.sol&quot;;</span>
   8 |     | <span style='background-color: #eee;'>import &quot;../../utils/Context.sol&quot;;</span>
   9 |     | <span style='background-color: #eee;'></span>
  10 |     | <span style='background-color: #eee;'>/**</span>
  11 |     | <span style='background-color: #eee;'> * @dev Implementation of the {IERC20} interface.</span>
  12 |     | <span style='background-color: #eee;'> *</span>
  13 |     | <span style='background-color: #eee;'> * This implementation is agnostic to the way tokens are created. This means</span>
  14 |     | <span style='background-color: #eee;'> * that a supply mechanism has to be added in a derived contract using {_mint}.</span>
  15 |     | <span style='background-color: #eee;'> * For a generic mechanism see {ERC20PresetMinterPauser}.</span>
  16 |     | <span style='background-color: #eee;'> *</span>
  17 |     | <span style='background-color: #eee;'> * TIP: For a detailed writeup see our guide</span>
  18 |     | <span style='background-color: #eee;'> * https://forum.openzeppelin.com/t/how-to-implement-erc20-supply-mechanisms/226[How</span>
  19 |     | <span style='background-color: #eee;'> * to implement supply mechanisms].</span>
  20 |     | <span style='background-color: #eee;'> *</span>
  21 |     | <span style='background-color: #eee;'> * We have followed general OpenZeppelin Contracts guidelines: functions revert</span>
  22 |     | <span style='background-color: #eee;'> * instead returning `false` on failure. This behavior is nonetheless</span>
  23 |     | <span style='background-color: #eee;'> * conventional and does not conflict with the expectations of ERC20</span>
  24 |     | <span style='background-color: #eee;'> * applications.</span>
  25 |     | <span style='background-color: #eee;'> *</span>
  26 |     | <span style='background-color: #eee;'> * Additionally, an {Approval} event is emitted on calls to {transferFrom}.</span>
  27 |     | <span style='background-color: #eee;'> * This allows applications to reconstruct the allowance for all accounts just</span>
  28 |     | <span style='background-color: #eee;'> * by listening to said events. Other implementations of the EIP may not emit</span>
  29 |     | <span style='background-color: #eee;'> * these events, as it isn&#39;t required by the specification.</span>
  30 |     | <span style='background-color: #eee;'> *</span>
  31 |     | <span style='background-color: #eee;'> * Finally, the non-standard {decreaseAllowance} and {increaseAllowance}</span>
  32 |     | <span style='background-color: #eee;'> * functions have been added to mitigate the well-known issues around setting</span>
  33 |     | <span style='background-color: #eee;'> * allowances. See {IERC20-approve}.</span>
  34 |     | <span style='background-color: #faa;'> */</span>
  35 |     | <span style='background-color: #eee;'>contract ERC20 is Context, IERC20, IERC20Metadata {</span>
  36 |     | <span style='background-color: #eee;'>    mapping(address =&gt; uint256) private _balances;</span>
  37 |     | <span style='background-color: #eee;'></span>
  38 |     | <span style='background-color: #eee;'>    mapping(address =&gt; mapping(address =&gt; uint256)) private _allowances;</span>
  39 |     | <span style='background-color: #eee;'></span>
  40 |     | <span style='background-color: #eee;'>    uint256 private _totalSupply;</span>
  41 |     | <span style='background-color: #eee;'></span>
  42 |     | <span style='background-color: #eee;'>    string private _name;</span>
  43 |     | <span style='background-color: #eee;'>    string private _symbol;</span>
  44 |     | <span style='background-color: #eee;'></span>
  45 |     | <span style='background-color: #eee;'>    /**</span>
  46 |     | <span style='background-color: #eee;'>     * @dev Sets the values for {name} and {symbol}.</span>
  47 |     | <span style='background-color: #eee;'>     *</span>
  48 |     | <span style='background-color: #eee;'>     * The default value of {decimals} is 18. To select a different value for</span>
  49 |     | <span style='background-color: #eee;'>     * {decimals} you should overload it.</span>
  50 |     | <span style='background-color: #eee;'>     *</span>
  51 |     | <span style='background-color: #eee;'>     * All two of these values are immutable: they can only be set once during</span>
  52 |     | <span style='background-color: #eee;'>     * construction.</span>
  53 |     | <span style='background-color: #eee;'>     */</span>
  54 |     | <span style='background-color: #eee;'>    constructor(string memory name_, string memory symbol_) {</span>
  55 |     | <span style='background-color: #faa;'>        _name = name_;</span>
  56 |     | <span style='background-color: #faa;'>        _symbol = symbol_;</span>
  57 |     | <span style='background-color: #eee;'>    }</span>
  58 |     | <span style='background-color: #eee;'></span>
  59 |     | <span style='background-color: #eee;'>    /**</span>
  60 |     | <span style='background-color: #eee;'>     * @dev Returns the name of the token.</span>
  61 |     | <span style='background-color: #eee;'>     */</span>
  62 |     | <span style='background-color: #eee;'>    function name() public view virtual override returns (string memory) {</span>
  63 |     | <span style='background-color: #faa;'>        return _name;</span>
  64 |     | <span style='background-color: #eee;'>    }</span>
  65 |     | <span style='background-color: #eee;'></span>
  66 |     | <span style='background-color: #eee;'>    /**</span>
  67 |     | <span style='background-color: #eee;'>     * @dev Returns the symbol of the token, usually a shorter version of the</span>
  68 |     | <span style='background-color: #eee;'>     * name.</span>
  69 |     | <span style='background-color: #eee;'>     */</span>
  70 |     | <span style='background-color: #eee;'>    function symbol() public view virtual override returns (string memory) {</span>
  71 |     | <span style='background-color: #eee;'>        return _symbol;</span>
  72 |     | <span style='background-color: #eee;'>    }</span>
  73 |     | <span style='background-color: #eee;'></span>
  74 |     | <span style='background-color: #eee;'>    /**</span>
  75 |     | <span style='background-color: #eee;'>     * @dev Returns the number of decimals used to get its user representation.</span>
  76 |     | <span style='background-color: #eee;'>     * For example, if `decimals` equals `2`, a balance of `505` tokens should</span>
  77 |     | <span style='background-color: #eee;'>     * be displayed to a user as `5.05` (`505 / 10 ** 2`).</span>
  78 |     | <span style='background-color: #eee;'>     *</span>
  79 |     | <span style='background-color: #eee;'>     * Tokens usually opt for a value of 18, imitating the relationship between</span>
  80 |     | <span style='background-color: #eee;'>     * Ether and Wei. This is the value {ERC20} uses, unless this function is</span>
  81 |     | <span style='background-color: #eee;'>     * overridden;</span>
  82 |     | <span style='background-color: #eee;'>     *</span>
  83 |     | <span style='background-color: #eee;'>     * NOTE: This information is only used for _display_ purposes: it in</span>
  84 |     | <span style='background-color: #eee;'>     * no way affects any of the arithmetic of the contract, including</span>
  85 |     | <span style='background-color: #eee;'>     * {IERC20-balanceOf} and {IERC20-transfer}.</span>
  86 |     | <span style='background-color: #eee;'>     */</span>
  87 |     | <span style='background-color: #eee;'>    function decimals() public view virtual override returns (uint8) {</span>
  88 |     | <span style='background-color: #faa;'>        return 18;</span>
  89 |     | <span style='background-color: #eee;'>    }</span>
  90 |     | <span style='background-color: #eee;'></span>
  91 |     | <span style='background-color: #eee;'>    /**</span>
  92 |     | <span style='background-color: #eee;'>     * @dev See {IERC20-totalSupply}.</span>
  93 |     | <span style='background-color: #eee;'>     */</span>
  94 |     | <span style='background-color: #eee;'>    function totalSupply() public view virtual override returns (uint256) {</span>
  95 |     | <span style='background-color: #faa;'>        return _totalSupply;</span>
  96 |     | <span style='background-color: #eee;'>    }</span>
  97 |     | <span style='background-color: #eee;'></span>
  98 |     | <span style='background-color: #eee;'>    /**</span>
  99 |     | <span style='background-color: #eee;'>     * @dev See {IERC20-balanceOf}.</span>
 100 |     | <span style='background-color: #eee;'>     */</span>
 101 |     | <span style='background-color: #eee;'>    function balanceOf(address account) public view virtual override returns (uint256) {</span>
 102 |     | <span style='background-color: #eee;'>        return _balances[account];</span>
 103 |     | <span style='background-color: #eee;'>    }</span>
 104 |     | <span style='background-color: #eee;'></span>
 105 |     | <span style='background-color: #eee;'>    /**</span>
 106 |     | <span style='background-color: #eee;'>     * @dev See {IERC20-transfer}.</span>
 107 |     | <span style='background-color: #eee;'>     *</span>
 108 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 109 |     | <span style='background-color: #eee;'>     *</span>
 110 |     | <span style='background-color: #eee;'>     * - `to` cannot be the zero address.</span>
 111 |     | <span style='background-color: #eee;'>     * - the caller must have a balance of at least `amount`.</span>
 112 |     | <span style='background-color: #eee;'>     */</span>
 113 |     | <span style='background-color: #eee;'>    function transfer(address to, uint256 amount) public virtual override returns (bool) {</span>
 114 |     | <span style='background-color: #eee;'>        address owner = _msgSender();</span>
 115 |     | <span style='background-color: #faa;'>        _transfer(owner, to, amount);</span>
 116 |     | <span style='background-color: #eee;'>        return true;</span>
 117 |     | <span style='background-color: #eee;'>    }</span>
 118 |     | <span style='background-color: #eee;'></span>
 119 |     | <span style='background-color: #eee;'>    /**</span>
 120 |     | <span style='background-color: #eee;'>     * @dev See {IERC20-allowance}.</span>
 121 |     | <span style='background-color: #eee;'>     */</span>
 122 |     | <span style='background-color: #eee;'>    function allowance(address owner, address spender) public view virtual override returns (uint256) {</span>
 123 |     | <span style='background-color: #faa;'>        return _allowances[owner][spender];</span>
 124 |     | <span style='background-color: #eee;'>    }</span>
 125 |     | <span style='background-color: #eee;'></span>
 126 |     | <span style='background-color: #eee;'>    /**</span>
 127 |     | <span style='background-color: #eee;'>     * @dev See {IERC20-approve}.</span>
 128 |     | <span style='background-color: #eee;'>     *</span>
 129 |     | <span style='background-color: #eee;'>     * NOTE: If `amount` is the maximum `uint256`, the allowance is not updated on</span>
 130 |     | <span style='background-color: #eee;'>     * `transferFrom`. This is semantically equivalent to an infinite approval.</span>
 131 |     | <span style='background-color: #eee;'>     *</span>
 132 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 133 |     | <span style='background-color: #eee;'>     *</span>
 134 |     | <span style='background-color: #eee;'>     * - `spender` cannot be the zero address.</span>
 135 |     | <span style='background-color: #eee;'>     */</span>
 136 |     | <span style='background-color: #eee;'>    function approve(address spender, uint256 amount) public virtual override returns (bool) {</span>
 137 |     | <span style='background-color: #eee;'>        address owner = _msgSender();</span>
 138 |     | <span style='background-color: #faa;'>        _approve(owner, spender, amount);</span>
 139 |     | <span style='background-color: #eee;'>        return true;</span>
 140 |     | <span style='background-color: #eee;'>    }</span>
 141 |     | <span style='background-color: #eee;'></span>
 142 |     | <span style='background-color: #eee;'>    /**</span>
 143 |     | <span style='background-color: #eee;'>     * @dev See {IERC20-transferFrom}.</span>
 144 |     | <span style='background-color: #eee;'>     *</span>
 145 |     | <span style='background-color: #eee;'>     * Emits an {Approval} event indicating the updated allowance. This is not</span>
 146 |     | <span style='background-color: #eee;'>     * required by the EIP. See the note at the beginning of {ERC20}.</span>
 147 |     | <span style='background-color: #eee;'>     *</span>
 148 |     | <span style='background-color: #eee;'>     * NOTE: Does not update the allowance if the current allowance</span>
 149 |     | <span style='background-color: #eee;'>     * is the maximum `uint256`.</span>
 150 |     | <span style='background-color: #eee;'>     *</span>
 151 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 152 |     | <span style='background-color: #eee;'>     *</span>
 153 |     | <span style='background-color: #eee;'>     * - `from` and `to` cannot be the zero address.</span>
 154 |     | <span style='background-color: #eee;'>     * - `from` must have a balance of at least `amount`.</span>
 155 |     | <span style='background-color: #eee;'>     * - the caller must have allowance for ``from``&#39;s tokens of at least</span>
 156 |     | <span style='background-color: #eee;'>     * `amount`.</span>
 157 |     | <span style='background-color: #eee;'>     */</span>
 158 |     | <span style='background-color: #eee;'>    function transferFrom(</span>
 159 |     | <span style='background-color: #eee;'>        address from,</span>
 160 |     | <span style='background-color: #eee;'>        address to,</span>
 161 |     | <span style='background-color: #eee;'>        uint256 amount</span>
 162 |     | <span style='background-color: #eee;'>    ) public virtual override returns (bool) {</span>
 163 |     | <span style='background-color: #eee;'>        address spender = _msgSender();</span>
 164 |     | <span style='background-color: #eee;'>        _spendAllowance(from, spender, amount);</span>
 165 |     | <span style='background-color: #faa;'>        _transfer(from, to, amount);</span>
 166 |     | <span style='background-color: #eee;'>        return true;</span>
 167 |     | <span style='background-color: #eee;'>    }</span>
 168 |     | <span style='background-color: #eee;'></span>
 169 |     | <span style='background-color: #eee;'>    /**</span>
 170 |     | <span style='background-color: #eee;'>     * @dev Atomically increases the allowance granted to `spender` by the caller.</span>
 171 |     | <span style='background-color: #eee;'>     *</span>
 172 |     | <span style='background-color: #eee;'>     * This is an alternative to {approve} that can be used as a mitigation for</span>
 173 |     | <span style='background-color: #eee;'>     * problems described in {IERC20-approve}.</span>
 174 |     | <span style='background-color: #eee;'>     *</span>
 175 |     | <span style='background-color: #eee;'>     * Emits an {Approval} event indicating the updated allowance.</span>
 176 |     | <span style='background-color: #eee;'>     *</span>
 177 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 178 |     | <span style='background-color: #eee;'>     *</span>
 179 |     | <span style='background-color: #eee;'>     * - `spender` cannot be the zero address.</span>
 180 |     | <span style='background-color: #eee;'>     */</span>
 181 |     | <span style='background-color: #eee;'>    function increaseAllowance(address spender, uint256 addedValue) public virtual returns (bool) {</span>
 182 |     | <span style='background-color: #eee;'>        address owner = _msgSender();</span>
 183 |     | <span style='background-color: #faa;'>        _approve(owner, spender, allowance(owner, spender) + addedValue);</span>
 184 |     | <span style='background-color: #eee;'>        return true;</span>
 185 |     | <span style='background-color: #eee;'>    }</span>
 186 |     | <span style='background-color: #eee;'></span>
 187 |     | <span style='background-color: #eee;'>    /**</span>
 188 |     | <span style='background-color: #eee;'>     * @dev Atomically decreases the allowance granted to `spender` by the caller.</span>
 189 |     | <span style='background-color: #eee;'>     *</span>
 190 |     | <span style='background-color: #eee;'>     * This is an alternative to {approve} that can be used as a mitigation for</span>
 191 |     | <span style='background-color: #eee;'>     * problems described in {IERC20-approve}.</span>
 192 |     | <span style='background-color: #eee;'>     *</span>
 193 |     | <span style='background-color: #eee;'>     * Emits an {Approval} event indicating the updated allowance.</span>
 194 |     | <span style='background-color: #eee;'>     *</span>
 195 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 196 |     | <span style='background-color: #eee;'>     *</span>
 197 |     | <span style='background-color: #eee;'>     * - `spender` cannot be the zero address.</span>
 198 |     | <span style='background-color: #eee;'>     * - `spender` must have allowance for the caller of at least</span>
 199 |     | <span style='background-color: #eee;'>     * `subtractedValue`.</span>
 200 |     | <span style='background-color: #eee;'>     */</span>
 201 |     | <span style='background-color: #eee;'>    function decreaseAllowance(address spender, uint256 subtractedValue) public virtual returns (bool) {</span>
 202 |     | <span style='background-color: #eee;'>        address owner = _msgSender();</span>
 203 |     | <span style='background-color: #eee;'>        uint256 currentAllowance = allowance(owner, spender);</span>
 204 |     | <span style='background-color: #faa;'>        require(currentAllowance &gt;= subtractedValue, &quot;ERC20: decreased allowance below zero&quot;);</span>
 205 |     | <span style='background-color: #eee;'>        unchecked {</span>
 206 |     | <span style='background-color: #faa;'>            _approve(owner, spender, currentAllowance - subtractedValue);</span>
 207 |     | <span style='background-color: #eee;'>        }</span>
 208 |     | <span style='background-color: #eee;'></span>
 209 |     | <span style='background-color: #eee;'>        return true;</span>
 210 |     | <span style='background-color: #eee;'>    }</span>
 211 |     | <span style='background-color: #eee;'></span>
 212 |     | <span style='background-color: #eee;'>    /**</span>
 213 |     | <span style='background-color: #eee;'>     * @dev Moves `amount` of tokens from `from` to `to`.</span>
 214 |     | <span style='background-color: #eee;'>     *</span>
 215 |     | <span style='background-color: #eee;'>     * This internal function is equivalent to {transfer}, and can be used to</span>
 216 |     | <span style='background-color: #eee;'>     * e.g. implement automatic token fees, slashing mechanisms, etc.</span>
 217 |     | <span style='background-color: #eee;'>     *</span>
 218 |     | <span style='background-color: #eee;'>     * Emits a {Transfer} event.</span>
 219 |     | <span style='background-color: #eee;'>     *</span>
 220 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 221 |     | <span style='background-color: #eee;'>     *</span>
 222 |     | <span style='background-color: #eee;'>     * - `from` cannot be the zero address.</span>
 223 |     | <span style='background-color: #eee;'>     * - `to` cannot be the zero address.</span>
 224 |     | <span style='background-color: #eee;'>     * - `from` must have a balance of at least `amount`.</span>
 225 |     | <span style='background-color: #eee;'>     */</span>
 226 |     | <span style='background-color: #faa;'>    function _transfer(</span>
 227 |     | <span style='background-color: #eee;'>        address from,</span>
 228 |     | <span style='background-color: #eee;'>        address to,</span>
 229 |     | <span style='background-color: #eee;'>        uint256 amount</span>
 230 |     | <span style='background-color: #eee;'>    ) internal virtual {</span>
 231 |     | <span style='background-color: #faa;'>        require(from != address(0), &quot;ERC20: transfer from the zero address&quot;);</span>
 232 |     | <span style='background-color: #faa;'>        require(to != address(0), &quot;ERC20: transfer to the zero address&quot;);</span>
 233 |     | <span style='background-color: #eee;'></span>
 234 |     | <span style='background-color: #eee;'>        _beforeTokenTransfer(from, to, amount);</span>
 235 |     | <span style='background-color: #eee;'></span>
 236 |     | <span style='background-color: #eee;'>        uint256 fromBalance = _balances[from];</span>
 237 |     | <span style='background-color: #faa;'>        require(fromBalance &gt;= amount, &quot;ERC20: transfer amount exceeds balance&quot;);</span>
 238 |     | <span style='background-color: #eee;'>        unchecked {</span>
 239 |     | <span style='background-color: #eee;'>            _balances[from] = fromBalance - amount;</span>
 240 |     | <span style='background-color: #eee;'>            // Overflow not possible: the sum of all balances is capped by totalSupply, and the sum is preserved by</span>
 241 |     | <span style='background-color: #eee;'>            // decrementing then incrementing.</span>
 242 |     | <span style='background-color: #eee;'>            _balances[to] += amount;</span>
 243 |     | <span style='background-color: #eee;'>        }</span>
 244 |     | <span style='background-color: #eee;'></span>
 245 |     | <span style='background-color: #faa;'>        emit Transfer(from, to, amount);</span>
 246 |     | <span style='background-color: #eee;'></span>
 247 |     | <span style='background-color: #eee;'>        _afterTokenTransfer(from, to, amount);</span>
 248 |     | <span style='background-color: #eee;'>    }</span>
 249 |     | <span style='background-color: #eee;'></span>
 250 |     | <span style='background-color: #eee;'>    /** @dev Creates `amount` tokens and assigns them to `account`, increasing</span>
 251 |     | <span style='background-color: #eee;'>     * the total supply.</span>
 252 |     | <span style='background-color: #eee;'>     *</span>
 253 |     | <span style='background-color: #eee;'>     * Emits a {Transfer} event with `from` set to the zero address.</span>
 254 |     | <span style='background-color: #eee;'>     *</span>
 255 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 256 |     | <span style='background-color: #eee;'>     *</span>
 257 |     | <span style='background-color: #eee;'>     * - `account` cannot be the zero address.</span>
 258 |     | <span style='background-color: #eee;'>     */</span>
 259 |     | <span style='background-color: #faa;'>    function _mint(address account, uint256 amount) internal virtual {</span>
 260 |     | <span style='background-color: #faa;'>        require(account != address(0), &quot;ERC20: mint to the zero address&quot;);</span>
 261 |     | <span style='background-color: #eee;'></span>
 262 |     | <span style='background-color: #eee;'>        _beforeTokenTransfer(address(0), account, amount);</span>
 263 |     | <span style='background-color: #eee;'></span>
 264 |     | <span style='background-color: #faa;'>        _totalSupply += amount;</span>
 265 |     | <span style='background-color: #eee;'>        unchecked {</span>
 266 |     | <span style='background-color: #eee;'>            // Overflow not possible: balance + amount is at most totalSupply + amount, which is checked above.</span>
 267 |     | <span style='background-color: #eee;'>            _balances[account] += amount;</span>
 268 |     | <span style='background-color: #eee;'>        }</span>
 269 |     | <span style='background-color: #faa;'>        emit Transfer(address(0), account, amount);</span>
 270 |     | <span style='background-color: #eee;'></span>
 271 |     | <span style='background-color: #eee;'>        _afterTokenTransfer(address(0), account, amount);</span>
 272 |     | <span style='background-color: #eee;'>    }</span>
 273 |     | <span style='background-color: #eee;'></span>
 274 |     | <span style='background-color: #eee;'>    /**</span>
 275 |     | <span style='background-color: #eee;'>     * @dev Destroys `amount` tokens from `account`, reducing the</span>
 276 |     | <span style='background-color: #eee;'>     * total supply.</span>
 277 |     | <span style='background-color: #eee;'>     *</span>
 278 |     | <span style='background-color: #eee;'>     * Emits a {Transfer} event with `to` set to the zero address.</span>
 279 |     | <span style='background-color: #eee;'>     *</span>
 280 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 281 |     | <span style='background-color: #eee;'>     *</span>
 282 |     | <span style='background-color: #eee;'>     * - `account` cannot be the zero address.</span>
 283 |     | <span style='background-color: #eee;'>     * - `account` must have at least `amount` tokens.</span>
 284 |     | <span style='background-color: #eee;'>     */</span>
 285 |     | <span style='background-color: #eee;'>    function _burn(address account, uint256 amount) internal virtual {</span>
 286 |     | <span style='background-color: #faa;'>        require(account != address(0), &quot;ERC20: burn from the zero address&quot;);</span>
 287 |     | <span style='background-color: #eee;'></span>
 288 |     | <span style='background-color: #eee;'>        _beforeTokenTransfer(account, address(0), amount);</span>
 289 |     | <span style='background-color: #eee;'></span>
 290 |     | <span style='background-color: #eee;'>        uint256 accountBalance = _balances[account];</span>
 291 |     | <span style='background-color: #faa;'>        require(accountBalance &gt;= amount, &quot;ERC20: burn amount exceeds balance&quot;);</span>
 292 |     | <span style='background-color: #eee;'>        unchecked {</span>
 293 |     | <span style='background-color: #eee;'>            _balances[account] = accountBalance - amount;</span>
 294 |     | <span style='background-color: #eee;'>            // Overflow not possible: amount &lt;= accountBalance &lt;= totalSupply.</span>
 295 |     | <span style='background-color: #faa;'>            _totalSupply -= amount;</span>
 296 |     | <span style='background-color: #eee;'>        }</span>
 297 |     | <span style='background-color: #eee;'></span>
 298 |     | <span style='background-color: #faa;'>        emit Transfer(account, address(0), amount);</span>
 299 |     | <span style='background-color: #eee;'></span>
 300 |     | <span style='background-color: #eee;'>        _afterTokenTransfer(account, address(0), amount);</span>
 301 |     | <span style='background-color: #eee;'>    }</span>
 302 |     | <span style='background-color: #eee;'></span>
 303 |     | <span style='background-color: #eee;'>    /**</span>
 304 |     | <span style='background-color: #eee;'>     * @dev Sets `amount` as the allowance of `spender` over the `owner` s tokens.</span>
 305 |     | <span style='background-color: #eee;'>     *</span>
 306 |     | <span style='background-color: #eee;'>     * This internal function is equivalent to `approve`, and can be used to</span>
 307 |     | <span style='background-color: #eee;'>     * e.g. set automatic allowances for certain subsystems, etc.</span>
 308 |     | <span style='background-color: #eee;'>     *</span>
 309 |     | <span style='background-color: #eee;'>     * Emits an {Approval} event.</span>
 310 |     | <span style='background-color: #eee;'>     *</span>
 311 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 312 |     | <span style='background-color: #eee;'>     *</span>
 313 |     | <span style='background-color: #eee;'>     * - `owner` cannot be the zero address.</span>
 314 |     | <span style='background-color: #eee;'>     * - `spender` cannot be the zero address.</span>
 315 |     | <span style='background-color: #eee;'>     */</span>
 316 |     | <span style='background-color: #faa;'>    function _approve(</span>
 317 |     | <span style='background-color: #eee;'>        address owner,</span>
 318 |     | <span style='background-color: #eee;'>        address spender,</span>
 319 |     | <span style='background-color: #eee;'>        uint256 amount</span>
 320 |     | <span style='background-color: #eee;'>    ) internal virtual {</span>
 321 |     | <span style='background-color: #faa;'>        require(owner != address(0), &quot;ERC20: approve from the zero address&quot;);</span>
 322 |     | <span style='background-color: #faa;'>        require(spender != address(0), &quot;ERC20: approve to the zero address&quot;);</span>
 323 |     | <span style='background-color: #eee;'></span>
 324 |     | <span style='background-color: #faa;'>        _allowances[owner][spender] = amount;</span>
 325 |     | <span style='background-color: #faa;'>        emit Approval(owner, spender, amount);</span>
 326 |     | <span style='background-color: #eee;'>    }</span>
 327 |     | <span style='background-color: #eee;'></span>
 328 |     | <span style='background-color: #eee;'>    /**</span>
 329 |     | <span style='background-color: #eee;'>     * @dev Updates `owner` s allowance for `spender` based on spent `amount`.</span>
 330 |     | <span style='background-color: #eee;'>     *</span>
 331 |     | <span style='background-color: #eee;'>     * Does not update the allowance amount in case of infinite allowance.</span>
 332 |     | <span style='background-color: #eee;'>     * Revert if not enough allowance is available.</span>
 333 |     | <span style='background-color: #eee;'>     *</span>
 334 |     | <span style='background-color: #eee;'>     * Might emit an {Approval} event.</span>
 335 |     | <span style='background-color: #eee;'>     */</span>
 336 |     | <span style='background-color: #eee;'>    function _spendAllowance(</span>
 337 |     | <span style='background-color: #eee;'>        address owner,</span>
 338 |     | <span style='background-color: #eee;'>        address spender,</span>
 339 |     | <span style='background-color: #eee;'>        uint256 amount</span>
 340 |     | <span style='background-color: #eee;'>    ) internal virtual {</span>
 341 |     | <span style='background-color: #eee;'>        uint256 currentAllowance = allowance(owner, spender);</span>
 342 |     | <span style='background-color: #faa;'>        if (currentAllowance != type(uint256).max) {</span>
 343 |     | <span style='background-color: #faa;'>            require(currentAllowance &gt;= amount, &quot;ERC20: insufficient allowance&quot;);</span>
 344 |     | <span style='background-color: #eee;'>            unchecked {</span>
 345 |     | <span style='background-color: #faa;'>                _approve(owner, spender, currentAllowance - amount);</span>
 346 |     | <span style='background-color: #eee;'>            }</span>
 347 |     | <span style='background-color: #eee;'>        }</span>
 348 |     | <span style='background-color: #eee;'>    }</span>
 349 |     | <span style='background-color: #eee;'></span>
 350 |     | <span style='background-color: #eee;'>    /**</span>
 351 |     | <span style='background-color: #eee;'>     * @dev Hook that is called before any transfer of tokens. This includes</span>
 352 |     | <span style='background-color: #eee;'>     * minting and burning.</span>
 353 |     | <span style='background-color: #eee;'>     *</span>
 354 |     | <span style='background-color: #eee;'>     * Calling conditions:</span>
 355 |     | <span style='background-color: #eee;'>     *</span>
 356 |     | <span style='background-color: #eee;'>     * - when `from` and `to` are both non-zero, `amount` of ``from``&#39;s tokens</span>
 357 |     | <span style='background-color: #eee;'>     * will be transferred to `to`.</span>
 358 |     | <span style='background-color: #eee;'>     * - when `from` is zero, `amount` tokens will be minted for `to`.</span>
 359 |     | <span style='background-color: #eee;'>     * - when `to` is zero, `amount` of ``from``&#39;s tokens will be burned.</span>
 360 |     | <span style='background-color: #eee;'>     * - `from` and `to` are never both zero.</span>
 361 |     | <span style='background-color: #eee;'>     *</span>
 362 |     | <span style='background-color: #eee;'>     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span>
 363 |     | <span style='background-color: #eee;'>     */</span>
 364 |     | <span style='background-color: #eee;'>    function _beforeTokenTransfer(</span>
 365 |     | <span style='background-color: #eee;'>        address from,</span>
 366 |     | <span style='background-color: #eee;'>        address to,</span>
 367 |     | <span style='background-color: #eee;'>        uint256 amount</span>
 368 |     | <span style='background-color: #eee;'>    ) internal virtual {}</span>
 369 |     | <span style='background-color: #eee;'></span>
 370 |     | <span style='background-color: #eee;'>    /**</span>
 371 |     | <span style='background-color: #eee;'>     * @dev Hook that is called after any transfer of tokens. This includes</span>
 372 |     | <span style='background-color: #eee;'>     * minting and burning.</span>
 373 |     | <span style='background-color: #eee;'>     *</span>
 374 |     | <span style='background-color: #eee;'>     * Calling conditions:</span>
 375 |     | <span style='background-color: #eee;'>     *</span>
 376 |     | <span style='background-color: #eee;'>     * - when `from` and `to` are both non-zero, `amount` of ``from``&#39;s tokens</span>
 377 |     | <span style='background-color: #eee;'>     * has been transferred to `to`.</span>
 378 |     | <span style='background-color: #eee;'>     * - when `from` is zero, `amount` tokens have been minted for `to`.</span>
 379 |     | <span style='background-color: #eee;'>     * - when `to` is zero, `amount` of ``from``&#39;s tokens have been burned.</span>
 380 |     | <span style='background-color: #eee;'>     * - `from` and `to` are never both zero.</span>
 381 |     | <span style='background-color: #eee;'>     *</span>
 382 |     | <span style='background-color: #eee;'>     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span>
 383 |     | <span style='background-color: #eee;'>     */</span>
 384 |     | <span style='background-color: #eee;'>    function _afterTokenTransfer(</span>
 385 |     | <span style='background-color: #eee;'>        address from,</span>
 386 |     | <span style='background-color: #eee;'>        address to,</span>
 387 |     | <span style='background-color: #eee;'>        uint256 amount</span>
 388 |     | <span style='background-color: #eee;'>    ) internal virtual {}</span>
 389 |     | <span style='background-color: #eee;'>}</span>
 390 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/token/ERC20/IERC20.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.6.0) (token/ERC20/IERC20.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>/**</span>
  7 |     | <span style='background-color: #eee;'> * @dev Interface of the ERC20 standard as defined in the EIP.</span>
  8 |     | <span style='background-color: #eee;'> */</span>
  9 |     | <span style='background-color: #eee;'>interface IERC20 {</span>
 10 |     | <span style='background-color: #eee;'>    /**</span>
 11 |     | <span style='background-color: #eee;'>     * @dev Emitted when `value` tokens are moved from one account (`from`) to</span>
 12 |     | <span style='background-color: #eee;'>     * another (`to`).</span>
 13 |     | <span style='background-color: #eee;'>     *</span>
 14 |     | <span style='background-color: #eee;'>     * Note that `value` may be zero.</span>
 15 |     | <span style='background-color: #eee;'>     */</span>
 16 |     | <span style='background-color: #eee;'>    event Transfer(address indexed from, address indexed to, uint256 value);</span>
 17 |     | <span style='background-color: #eee;'></span>
 18 |     | <span style='background-color: #eee;'>    /**</span>
 19 |     | <span style='background-color: #eee;'>     * @dev Emitted when the allowance of a `spender` for an `owner` is set by</span>
 20 |     | <span style='background-color: #eee;'>     * a call to {approve}. `value` is the new allowance.</span>
 21 |     | <span style='background-color: #eee;'>     */</span>
 22 |     | <span style='background-color: #eee;'>    event Approval(address indexed owner, address indexed spender, uint256 value);</span>
 23 |     | <span style='background-color: #eee;'></span>
 24 |     | <span style='background-color: #eee;'>    /**</span>
 25 |     | <span style='background-color: #eee;'>     * @dev Returns the amount of tokens in existence.</span>
 26 |     | <span style='background-color: #eee;'>     */</span>
 27 |     | <span style='background-color: #eee;'>    function totalSupply() external view returns (uint256);</span>
 28 |     | <span style='background-color: #eee;'></span>
 29 |     | <span style='background-color: #eee;'>    /**</span>
 30 |     | <span style='background-color: #eee;'>     * @dev Returns the amount of tokens owned by `account`.</span>
 31 |     | <span style='background-color: #eee;'>     */</span>
 32 |     | <span style='background-color: #eee;'>    function balanceOf(address account) external view returns (uint256);</span>
 33 |     | <span style='background-color: #eee;'></span>
 34 |     | <span style='background-color: #eee;'>    /**</span>
 35 |     | <span style='background-color: #eee;'>     * @dev Moves `amount` tokens from the caller&#39;s account to `to`.</span>
 36 |     | <span style='background-color: #eee;'>     *</span>
 37 |     | <span style='background-color: #eee;'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 38 |     | <span style='background-color: #eee;'>     *</span>
 39 |     | <span style='background-color: #eee;'>     * Emits a {Transfer} event.</span>
 40 |     | <span style='background-color: #eee;'>     */</span>
 41 |     | <span style='background-color: #eee;'>    function transfer(address to, uint256 amount) external returns (bool);</span>
 42 |     | <span style='background-color: #eee;'></span>
 43 |     | <span style='background-color: #eee;'>    /**</span>
 44 |     | <span style='background-color: #eee;'>     * @dev Returns the remaining number of tokens that `spender` will be</span>
 45 |     | <span style='background-color: #eee;'>     * allowed to spend on behalf of `owner` through {transferFrom}. This is</span>
 46 |     | <span style='background-color: #eee;'>     * zero by default.</span>
 47 |     | <span style='background-color: #eee;'>     *</span>
 48 |     | <span style='background-color: #eee;'>     * This value changes when {approve} or {transferFrom} are called.</span>
 49 |     | <span style='background-color: #eee;'>     */</span>
 50 |     | <span style='background-color: #eee;'>    function allowance(address owner, address spender) external view returns (uint256);</span>
 51 |     | <span style='background-color: #eee;'></span>
 52 |     | <span style='background-color: #eee;'>    /**</span>
 53 |     | <span style='background-color: #eee;'>     * @dev Sets `amount` as the allowance of `spender` over the caller&#39;s tokens.</span>
 54 |     | <span style='background-color: #eee;'>     *</span>
 55 |     | <span style='background-color: #eee;'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 56 |     | <span style='background-color: #eee;'>     *</span>
 57 |     | <span style='background-color: #eee;'>     * IMPORTANT: Beware that changing an allowance with this method brings the risk</span>
 58 |     | <span style='background-color: #eee;'>     * that someone may use both the old and the new allowance by unfortunate</span>
 59 |     | <span style='background-color: #eee;'>     * transaction ordering. One possible solution to mitigate this race</span>
 60 |     | <span style='background-color: #eee;'>     * condition is to first reduce the spender&#39;s allowance to 0 and set the</span>
 61 |     | <span style='background-color: #eee;'>     * desired value afterwards:</span>
 62 |     | <span style='background-color: #eee;'>     * https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729</span>
 63 |     | <span style='background-color: #eee;'>     *</span>
 64 |     | <span style='background-color: #eee;'>     * Emits an {Approval} event.</span>
 65 |     | <span style='background-color: #eee;'>     */</span>
 66 |     | <span style='background-color: #eee;'>    function approve(address spender, uint256 amount) external returns (bool);</span>
 67 |     | <span style='background-color: #eee;'></span>
 68 |     | <span style='background-color: #eee;'>    /**</span>
 69 |     | <span style='background-color: #eee;'>     * @dev Moves `amount` tokens from `from` to `to` using the</span>
 70 |     | <span style='background-color: #eee;'>     * allowance mechanism. `amount` is then deducted from the caller&#39;s</span>
 71 |     | <span style='background-color: #eee;'>     * allowance.</span>
 72 |     | <span style='background-color: #eee;'>     *</span>
 73 |     | <span style='background-color: #eee;'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 74 |     | <span style='background-color: #eee;'>     *</span>
 75 |     | <span style='background-color: #eee;'>     * Emits a {Transfer} event.</span>
 76 |     | <span style='background-color: #eee;'>     */</span>
 77 |     | <span style='background-color: #eee;'>    function transferFrom(</span>
 78 |     | <span style='background-color: #eee;'>        address from,</span>
 79 |     | <span style='background-color: #eee;'>        address to,</span>
 80 |     | <span style='background-color: #eee;'>        uint256 amount</span>
 81 |     | <span style='background-color: #eee;'>    ) external returns (bool);</span>
 82 |     | <span style='background-color: #eee;'>}</span>
 83 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts v4.4.1 (token/ERC20/extensions/IERC20Metadata.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>import &quot;../IERC20.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'></span>
  8 |     | <span style='background-color: #eee;'>/**</span>
  9 |     | <span style='background-color: #eee;'> * @dev Interface for the optional metadata functions from the ERC20 standard.</span>
 10 |     | <span style='background-color: #eee;'> *</span>
 11 |     | <span style='background-color: #eee;'> * _Available since v4.1._</span>
 12 |     | <span style='background-color: #eee;'> */</span>
 13 |     | <span style='background-color: #eee;'>interface IERC20Metadata is IERC20 {</span>
 14 |     | <span style='background-color: #eee;'>    /**</span>
 15 |     | <span style='background-color: #eee;'>     * @dev Returns the name of the token.</span>
 16 |     | <span style='background-color: #eee;'>     */</span>
 17 |     | <span style='background-color: #eee;'>    function name() external view returns (string memory);</span>
 18 |     | <span style='background-color: #eee;'></span>
 19 |     | <span style='background-color: #eee;'>    /**</span>
 20 |     | <span style='background-color: #eee;'>     * @dev Returns the symbol of the token.</span>
 21 |     | <span style='background-color: #eee;'>     */</span>
 22 |     | <span style='background-color: #eee;'>    function symbol() external view returns (string memory);</span>
 23 |     | <span style='background-color: #eee;'></span>
 24 |     | <span style='background-color: #eee;'>    /**</span>
 25 |     | <span style='background-color: #eee;'>     * @dev Returns the decimals places of the token.</span>
 26 |     | <span style='background-color: #eee;'>     */</span>
 27 |     | <span style='background-color: #eee;'>    function decimals() external view returns (uint8);</span>
 28 |     | <span style='background-color: #eee;'>}</span>
 29 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/token/ERC20/extensions/draft-IERC20Permit.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts v4.4.1 (token/ERC20/extensions/draft-IERC20Permit.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>/**</span>
  7 |     | <span style='background-color: #eee;'> * @dev Interface of the ERC20 Permit extension allowing approvals to be made via signatures, as defined in</span>
  8 |     | <span style='background-color: #eee;'> * https://eips.ethereum.org/EIPS/eip-2612[EIP-2612].</span>
  9 |     | <span style='background-color: #eee;'> *</span>
 10 |     | <span style='background-color: #eee;'> * Adds the {permit} method, which can be used to change an account&#39;s ERC20 allowance (see {IERC20-allowance}) by</span>
 11 |     | <span style='background-color: #eee;'> * presenting a message signed by the account. By not relying on {IERC20-approve}, the token holder account doesn&#39;t</span>
 12 |     | <span style='background-color: #eee;'> * need to send a transaction, and thus is not required to hold Ether at all.</span>
 13 |     | <span style='background-color: #eee;'> */</span>
 14 |     | <span style='background-color: #eee;'>interface IERC20Permit {</span>
 15 |     | <span style='background-color: #eee;'>    /**</span>
 16 |     | <span style='background-color: #eee;'>     * @dev Sets `value` as the allowance of `spender` over ``owner``&#39;s tokens,</span>
 17 |     | <span style='background-color: #eee;'>     * given ``owner``&#39;s signed approval.</span>
 18 |     | <span style='background-color: #eee;'>     *</span>
 19 |     | <span style='background-color: #eee;'>     * IMPORTANT: The same issues {IERC20-approve} has related to transaction</span>
 20 |     | <span style='background-color: #eee;'>     * ordering also apply here.</span>
 21 |     | <span style='background-color: #eee;'>     *</span>
 22 |     | <span style='background-color: #eee;'>     * Emits an {Approval} event.</span>
 23 |     | <span style='background-color: #eee;'>     *</span>
 24 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 25 |     | <span style='background-color: #eee;'>     *</span>
 26 |     | <span style='background-color: #eee;'>     * - `spender` cannot be the zero address.</span>
 27 |     | <span style='background-color: #eee;'>     * - `deadline` must be a timestamp in the future.</span>
 28 |     | <span style='background-color: #eee;'>     * - `v`, `r` and `s` must be a valid `secp256k1` signature from `owner`</span>
 29 |     | <span style='background-color: #eee;'>     * over the EIP712-formatted function arguments.</span>
 30 |     | <span style='background-color: #eee;'>     * - the signature must use ``owner``&#39;s current nonce (see {nonces}).</span>
 31 |     | <span style='background-color: #eee;'>     *</span>
 32 |     | <span style='background-color: #eee;'>     * For more information on the signature format, see the</span>
 33 |     | <span style='background-color: #eee;'>     * https://eips.ethereum.org/EIPS/eip-2612#specification[relevant EIP</span>
 34 |     | <span style='background-color: #eee;'>     * section].</span>
 35 |     | <span style='background-color: #eee;'>     */</span>
 36 |     | <span style='background-color: #eee;'>    function permit(</span>
 37 |     | <span style='background-color: #eee;'>        address owner,</span>
 38 |     | <span style='background-color: #eee;'>        address spender,</span>
 39 |     | <span style='background-color: #eee;'>        uint256 value,</span>
 40 |     | <span style='background-color: #eee;'>        uint256 deadline,</span>
 41 |     | <span style='background-color: #eee;'>        uint8 v,</span>
 42 |     | <span style='background-color: #eee;'>        bytes32 r,</span>
 43 |     | <span style='background-color: #eee;'>        bytes32 s</span>
 44 |     | <span style='background-color: #eee;'>    ) external;</span>
 45 |     | <span style='background-color: #eee;'></span>
 46 |     | <span style='background-color: #eee;'>    /**</span>
 47 |     | <span style='background-color: #eee;'>     * @dev Returns the current nonce for `owner`. This value must be</span>
 48 |     | <span style='background-color: #eee;'>     * included whenever a signature is generated for {permit}.</span>
 49 |     | <span style='background-color: #eee;'>     *</span>
 50 |     | <span style='background-color: #eee;'>     * Every successful call to {permit} increases ``owner``&#39;s nonce by one. This</span>
 51 |     | <span style='background-color: #eee;'>     * prevents a signature from being used multiple times.</span>
 52 |     | <span style='background-color: #eee;'>     */</span>
 53 |     | <span style='background-color: #eee;'>    function nonces(address owner) external view returns (uint256);</span>
 54 |     | <span style='background-color: #eee;'></span>
 55 |     | <span style='background-color: #eee;'>    /**</span>
 56 |     | <span style='background-color: #eee;'>     * @dev Returns the domain separator used in the encoding of the signature for {permit}, as defined by {EIP712}.</span>
 57 |     | <span style='background-color: #eee;'>     */</span>
 58 |     | <span style='background-color: #eee;'>    // solhint-disable-next-line func-name-mixedcase</span>
 59 |     | <span style='background-color: #eee;'>    function DOMAIN_SEPARATOR() external view returns (bytes32);</span>
 60 |     | <span style='background-color: #eee;'>}</span>
 61 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.8.0) (token/ERC20/utils/SafeERC20.sol)</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>import &quot;../IERC20.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'>import &quot;../extensions/draft-IERC20Permit.sol&quot;;</span>
   8 |     | <span style='background-color: #eee;'>import &quot;../../../utils/Address.sol&quot;;</span>
   9 |     | <span style='background-color: #eee;'></span>
  10 |     | <span style='background-color: #eee;'>/**</span>
  11 |     | <span style='background-color: #eee;'> * @title SafeERC20</span>
  12 |     | <span style='background-color: #eee;'> * @dev Wrappers around ERC20 operations that throw on failure (when the token</span>
  13 |     | <span style='background-color: #eee;'> * contract returns false). Tokens that return no value (and instead revert or</span>
  14 |     | <span style='background-color: #eee;'> * throw on failure) are also supported, non-reverting calls are assumed to be</span>
  15 |     | <span style='background-color: #eee;'> * successful.</span>
  16 |     | <span style='background-color: #eee;'> * To use this library you can add a `using SafeERC20 for IERC20;` statement to your contract,</span>
  17 |     | <span style='background-color: #eee;'> * which allows you to call the safe operations as `token.safeTransfer(...)`, etc.</span>
  18 |     | <span style='background-color: #faa;'> */</span>
  19 |     | <span style='background-color: #eee;'>library SafeERC20 {</span>
  20 |     | <span style='background-color: #eee;'>    using Address for address;</span>
  21 |     | <span style='background-color: #eee;'></span>
  22 |     | <span style='background-color: #faa;'>    function safeTransfer(</span>
  23 |     | <span style='background-color: #eee;'>        IERC20 token,</span>
  24 |     | <span style='background-color: #eee;'>        address to,</span>
  25 |     | <span style='background-color: #eee;'>        uint256 value</span>
  26 |     | <span style='background-color: #eee;'>    ) internal {</span>
  27 |     | <span style='background-color: #faa;'>        _callOptionalReturn(token, abi.encodeWithSelector(token.transfer.selector, to, value));</span>
  28 |     | <span style='background-color: #eee;'>    }</span>
  29 |     | <span style='background-color: #eee;'></span>
  30 |     | <span style='background-color: #faa;'>    function safeTransferFrom(</span>
  31 |     | <span style='background-color: #eee;'>        IERC20 token,</span>
  32 |     | <span style='background-color: #eee;'>        address from,</span>
  33 |     | <span style='background-color: #eee;'>        address to,</span>
  34 |     | <span style='background-color: #eee;'>        uint256 value</span>
  35 |     | <span style='background-color: #eee;'>    ) internal {</span>
  36 |     | <span style='background-color: #faa;'>        _callOptionalReturn(token, abi.encodeWithSelector(token.transferFrom.selector, from, to, value));</span>
  37 |     | <span style='background-color: #eee;'>    }</span>
  38 |     | <span style='background-color: #eee;'></span>
  39 |     | <span style='background-color: #eee;'>    /**</span>
  40 |     | <span style='background-color: #eee;'>     * @dev Deprecated. This function has issues similar to the ones found in</span>
  41 |     | <span style='background-color: #eee;'>     * {IERC20-approve}, and its usage is discouraged.</span>
  42 |     | <span style='background-color: #eee;'>     *</span>
  43 |     | <span style='background-color: #eee;'>     * Whenever possible, use {safeIncreaseAllowance} and</span>
  44 |     | <span style='background-color: #eee;'>     * {safeDecreaseAllowance} instead.</span>
  45 |     | <span style='background-color: #eee;'>     */</span>
  46 |     | <span style='background-color: #eee;'>    function safeApprove(</span>
  47 |     | <span style='background-color: #eee;'>        IERC20 token,</span>
  48 |     | <span style='background-color: #eee;'>        address spender,</span>
  49 |     | <span style='background-color: #eee;'>        uint256 value</span>
  50 |     | <span style='background-color: #eee;'>    ) internal {</span>
  51 |     | <span style='background-color: #eee;'>        // safeApprove should only be called when setting an initial allowance,</span>
  52 |     | <span style='background-color: #eee;'>        // or when resetting it to zero. To increase and decrease it, use</span>
  53 |     | <span style='background-color: #eee;'>        // &#39;safeIncreaseAllowance&#39; and &#39;safeDecreaseAllowance&#39;</span>
  54 |     | <span style='background-color: #eee;'>        require(</span>
  55 |     | <span style='background-color: #eee;'>            (value == 0) || (token.allowance(address(this), spender) == 0),</span>
  56 |     | <span style='background-color: #eee;'>            &quot;SafeERC20: approve from non-zero to non-zero allowance&quot;</span>
  57 |     | <span style='background-color: #eee;'>        );</span>
  58 |     | <span style='background-color: #eee;'>        _callOptionalReturn(token, abi.encodeWithSelector(token.approve.selector, spender, value));</span>
  59 |     | <span style='background-color: #eee;'>    }</span>
  60 |     | <span style='background-color: #eee;'></span>
  61 |     | <span style='background-color: #eee;'>    function safeIncreaseAllowance(</span>
  62 |     | <span style='background-color: #eee;'>        IERC20 token,</span>
  63 |     | <span style='background-color: #eee;'>        address spender,</span>
  64 |     | <span style='background-color: #eee;'>        uint256 value</span>
  65 |     | <span style='background-color: #eee;'>    ) internal {</span>
  66 |     | <span style='background-color: #eee;'>        uint256 newAllowance = token.allowance(address(this), spender) + value;</span>
  67 |     | <span style='background-color: #eee;'>        _callOptionalReturn(token, abi.encodeWithSelector(token.approve.selector, spender, newAllowance));</span>
  68 |     | <span style='background-color: #eee;'>    }</span>
  69 |     | <span style='background-color: #eee;'></span>
  70 |     | <span style='background-color: #eee;'>    function safeDecreaseAllowance(</span>
  71 |     | <span style='background-color: #eee;'>        IERC20 token,</span>
  72 |     | <span style='background-color: #eee;'>        address spender,</span>
  73 |     | <span style='background-color: #eee;'>        uint256 value</span>
  74 |     | <span style='background-color: #eee;'>    ) internal {</span>
  75 |     | <span style='background-color: #eee;'>        unchecked {</span>
  76 |     | <span style='background-color: #eee;'>            uint256 oldAllowance = token.allowance(address(this), spender);</span>
  77 |     | <span style='background-color: #eee;'>            require(oldAllowance &gt;= value, &quot;SafeERC20: decreased allowance below zero&quot;);</span>
  78 |     | <span style='background-color: #eee;'>            uint256 newAllowance = oldAllowance - value;</span>
  79 |     | <span style='background-color: #eee;'>            _callOptionalReturn(token, abi.encodeWithSelector(token.approve.selector, spender, newAllowance));</span>
  80 |     | <span style='background-color: #eee;'>        }</span>
  81 |     | <span style='background-color: #eee;'>    }</span>
  82 |     | <span style='background-color: #eee;'></span>
  83 |     | <span style='background-color: #eee;'>    function safePermit(</span>
  84 |     | <span style='background-color: #eee;'>        IERC20Permit token,</span>
  85 |     | <span style='background-color: #eee;'>        address owner,</span>
  86 |     | <span style='background-color: #eee;'>        address spender,</span>
  87 |     | <span style='background-color: #eee;'>        uint256 value,</span>
  88 |     | <span style='background-color: #eee;'>        uint256 deadline,</span>
  89 |     | <span style='background-color: #eee;'>        uint8 v,</span>
  90 |     | <span style='background-color: #eee;'>        bytes32 r,</span>
  91 |     | <span style='background-color: #eee;'>        bytes32 s</span>
  92 |     | <span style='background-color: #eee;'>    ) internal {</span>
  93 |     | <span style='background-color: #eee;'>        uint256 nonceBefore = token.nonces(owner);</span>
  94 |     | <span style='background-color: #eee;'>        token.permit(owner, spender, value, deadline, v, r, s);</span>
  95 |     | <span style='background-color: #eee;'>        uint256 nonceAfter = token.nonces(owner);</span>
  96 |     | <span style='background-color: #eee;'>        require(nonceAfter == nonceBefore + 1, &quot;SafeERC20: permit did not succeed&quot;);</span>
  97 |     | <span style='background-color: #eee;'>    }</span>
  98 |     | <span style='background-color: #eee;'></span>
  99 |     | <span style='background-color: #eee;'>    /**</span>
 100 |     | <span style='background-color: #eee;'>     * @dev Imitates a Solidity high-level call (i.e. a regular function call to a contract), relaxing the requirement</span>
 101 |     | <span style='background-color: #eee;'>     * on the return value: the return value is optional (but if data is returned, it must not be false).</span>
 102 |     | <span style='background-color: #eee;'>     * @param token The token targeted by the call.</span>
 103 |     | <span style='background-color: #eee;'>     * @param data The call data (encoded using abi.encode or one of its variants).</span>
 104 |     | <span style='background-color: #eee;'>     */</span>
 105 |     | <span style='background-color: #faa;'>    function _callOptionalReturn(IERC20 token, bytes memory data) private {</span>
 106 |     | <span style='background-color: #eee;'>        // We need to perform a low level call here, to bypass Solidity&#39;s return data size checking mechanism, since</span>
 107 |     | <span style='background-color: #eee;'>        // we&#39;re implementing it ourselves. We use {Address-functionCall} to perform this call, which verifies that</span>
 108 |     | <span style='background-color: #eee;'>        // the target address contains contract code and also asserts for success in the low-level call.</span>
 109 |     | <span style='background-color: #eee;'></span>
 110 |     | <span style='background-color: #eee;'>        bytes memory returndata = address(token).functionCall(data, &quot;SafeERC20: low-level call failed&quot;);</span>
 111 |     | <span style='background-color: #faa;'>        if (returndata.length &gt; 0) {</span>
 112 |     | <span style='background-color: #eee;'>            // Return data is optional</span>
 113 |     | <span style='background-color: #faa;'>            require(abi.decode(returndata, (bool)), &quot;SafeERC20: ERC20 operation did not succeed&quot;);</span>
 114 |     | <span style='background-color: #eee;'>        }</span>
 115 |     | <span style='background-color: #eee;'>    }</span>
 116 |     | <span style='background-color: #eee;'>}</span>
 117 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/token/ERC721/ERC721.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.8.0) (token/ERC721/ERC721.sol)</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>import &quot;./IERC721.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'>import &quot;./IERC721Receiver.sol&quot;;</span>
   8 |     | <span style='background-color: #eee;'>import &quot;./extensions/IERC721Metadata.sol&quot;;</span>
   9 |     | <span style='background-color: #eee;'>import &quot;../../utils/Address.sol&quot;;</span>
  10 |     | <span style='background-color: #eee;'>import &quot;../../utils/Context.sol&quot;;</span>
  11 |     | <span style='background-color: #eee;'>import &quot;../../utils/Strings.sol&quot;;</span>
  12 |     | <span style='background-color: #eee;'>import &quot;../../utils/introspection/ERC165.sol&quot;;</span>
  13 |     | <span style='background-color: #eee;'></span>
  14 |     | <span style='background-color: #eee;'>/**</span>
  15 |     | <span style='background-color: #eee;'> * @dev Implementation of https://eips.ethereum.org/EIPS/eip-721[ERC721] Non-Fungible Token Standard, including</span>
  16 |     | <span style='background-color: #eee;'> * the Metadata extension, but not including the Enumerable extension, which is available separately as</span>
  17 |     | <span style='background-color: #eee;'> * {ERC721Enumerable}.</span>
  18 |     | <span style='background-color: #faa;'> */</span>
  19 |     | <span style='background-color: #eee;'>contract ERC721 is Context, ERC165, IERC721, IERC721Metadata {</span>
  20 |     | <span style='background-color: #eee;'>    using Address for address;</span>
  21 |     | <span style='background-color: #eee;'>    using Strings for uint256;</span>
  22 |     | <span style='background-color: #eee;'></span>
  23 |     | <span style='background-color: #eee;'>    // Token name</span>
  24 |     | <span style='background-color: #eee;'>    string private _name;</span>
  25 |     | <span style='background-color: #eee;'></span>
  26 |     | <span style='background-color: #eee;'>    // Token symbol</span>
  27 |     | <span style='background-color: #eee;'>    string private _symbol;</span>
  28 |     | <span style='background-color: #eee;'></span>
  29 |     | <span style='background-color: #eee;'>    // Mapping from token ID to owner address</span>
  30 |     | <span style='background-color: #eee;'>    mapping(uint256 =&gt; address) private _owners;</span>
  31 |     | <span style='background-color: #eee;'></span>
  32 |     | <span style='background-color: #eee;'>    // Mapping owner address to token count</span>
  33 |     | <span style='background-color: #eee;'>    mapping(address =&gt; uint256) private _balances;</span>
  34 |     | <span style='background-color: #eee;'></span>
  35 |     | <span style='background-color: #eee;'>    // Mapping from token ID to approved address</span>
  36 |     | <span style='background-color: #eee;'>    mapping(uint256 =&gt; address) private _tokenApprovals;</span>
  37 |     | <span style='background-color: #eee;'></span>
  38 |     | <span style='background-color: #eee;'>    // Mapping from owner to operator approvals</span>
  39 |     | <span style='background-color: #eee;'>    mapping(address =&gt; mapping(address =&gt; bool)) private _operatorApprovals;</span>
  40 |     | <span style='background-color: #eee;'></span>
  41 |     | <span style='background-color: #eee;'>    /**</span>
  42 |     | <span style='background-color: #eee;'>     * @dev Initializes the contract by setting a `name` and a `symbol` to the token collection.</span>
  43 |     | <span style='background-color: #eee;'>     */</span>
  44 |     | <span style='background-color: #eee;'>    constructor(string memory name_, string memory symbol_) {</span>
  45 |     | <span style='background-color: #eee;'>        _name = name_;</span>
  46 |     | <span style='background-color: #eee;'>        _symbol = symbol_;</span>
  47 |     | <span style='background-color: #eee;'>    }</span>
  48 |     | <span style='background-color: #eee;'></span>
  49 |     | <span style='background-color: #eee;'>    /**</span>
  50 |     | <span style='background-color: #eee;'>     * @dev See {IERC165-supportsInterface}.</span>
  51 |     | <span style='background-color: #eee;'>     */</span>
  52 |     | <span style='background-color: #eee;'>    function supportsInterface(bytes4 interfaceId) public view virtual override(ERC165, IERC165) returns (bool) {</span>
  53 |     | <span style='background-color: #eee;'>        return</span>
  54 |     | <span style='background-color: #faa;'>            interfaceId == type(IERC721).interfaceId ||</span>
  55 |     | <span style='background-color: #faa;'>            interfaceId == type(IERC721Metadata).interfaceId ||</span>
  56 |     | <span style='background-color: #eee;'>            super.supportsInterface(interfaceId);</span>
  57 |     | <span style='background-color: #eee;'>    }</span>
  58 |     | <span style='background-color: #eee;'></span>
  59 |     | <span style='background-color: #eee;'>    /**</span>
  60 |     | <span style='background-color: #eee;'>     * @dev See {IERC721-balanceOf}.</span>
  61 |     | <span style='background-color: #eee;'>     */</span>
  62 |     | <span style='background-color: #eee;'>    function balanceOf(address owner) public view virtual override returns (uint256) {</span>
  63 |     | <span style='background-color: #faa;'>        require(owner != address(0), &quot;ERC721: address zero is not a valid owner&quot;);</span>
  64 |     | <span style='background-color: #faa;'>        return _balances[owner];</span>
  65 |     | <span style='background-color: #eee;'>    }</span>
  66 |     | <span style='background-color: #eee;'></span>
  67 |     | <span style='background-color: #eee;'>    /**</span>
  68 |     | <span style='background-color: #eee;'>     * @dev See {IERC721-ownerOf}.</span>
  69 |     | <span style='background-color: #eee;'>     */</span>
  70 |     | <span style='background-color: #faa;'>    function ownerOf(uint256 tokenId) public view virtual override returns (address) {</span>
  71 |     | <span style='background-color: #eee;'>        address owner = _ownerOf(tokenId);</span>
  72 |     | <span style='background-color: #faa;'>        require(owner != address(0), &quot;ERC721: invalid token ID&quot;);</span>
  73 |     | <span style='background-color: #eee;'>        return owner;</span>
  74 |     | <span style='background-color: #eee;'>    }</span>
  75 |     | <span style='background-color: #eee;'></span>
  76 |     | <span style='background-color: #eee;'>    /**</span>
  77 |     | <span style='background-color: #eee;'>     * @dev See {IERC721Metadata-name}.</span>
  78 |     | <span style='background-color: #eee;'>     */</span>
  79 |     | <span style='background-color: #eee;'>    function name() public view virtual override returns (string memory) {</span>
  80 |     | <span style='background-color: #eee;'>        return _name;</span>
  81 |     | <span style='background-color: #eee;'>    }</span>
  82 |     | <span style='background-color: #eee;'></span>
  83 |     | <span style='background-color: #eee;'>    /**</span>
  84 |     | <span style='background-color: #eee;'>     * @dev See {IERC721Metadata-symbol}.</span>
  85 |     | <span style='background-color: #eee;'>     */</span>
  86 |     | <span style='background-color: #eee;'>    function symbol() public view virtual override returns (string memory) {</span>
  87 |     | <span style='background-color: #faa;'>        return _symbol;</span>
  88 |     | <span style='background-color: #eee;'>    }</span>
  89 |     | <span style='background-color: #eee;'></span>
  90 |     | <span style='background-color: #eee;'>    /**</span>
  91 |     | <span style='background-color: #eee;'>     * @dev See {IERC721Metadata-tokenURI}.</span>
  92 |     | <span style='background-color: #eee;'>     */</span>
  93 |     | <span style='background-color: #eee;'>    function tokenURI(uint256 tokenId) public view virtual override returns (string memory) {</span>
  94 |     | <span style='background-color: #faa;'>        _requireMinted(tokenId);</span>
  95 |     | <span style='background-color: #eee;'></span>
  96 |     | <span style='background-color: #eee;'>        string memory baseURI = _baseURI();</span>
  97 |     | <span style='background-color: #eee;'>        return bytes(baseURI).length &gt; 0 ? string(abi.encodePacked(baseURI, tokenId.toString())) : &quot;&quot;;</span>
  98 |     | <span style='background-color: #eee;'>    }</span>
  99 |     | <span style='background-color: #eee;'></span>
 100 |     | <span style='background-color: #eee;'>    /**</span>
 101 |     | <span style='background-color: #eee;'>     * @dev Base URI for computing {tokenURI}. If set, the resulting URI for each</span>
 102 |     | <span style='background-color: #eee;'>     * token will be the concatenation of the `baseURI` and the `tokenId`. Empty</span>
 103 |     | <span style='background-color: #eee;'>     * by default, can be overridden in child contracts.</span>
 104 |     | <span style='background-color: #eee;'>     */</span>
 105 |     | <span style='background-color: #eee;'>    function _baseURI() internal view virtual returns (string memory) {</span>
 106 |     | <span style='background-color: #eee;'>        return &quot;&quot;;</span>
 107 |     | <span style='background-color: #eee;'>    }</span>
 108 |     | <span style='background-color: #eee;'></span>
 109 |     | <span style='background-color: #eee;'>    /**</span>
 110 |     | <span style='background-color: #eee;'>     * @dev See {IERC721-approve}.</span>
 111 |     | <span style='background-color: #eee;'>     */</span>
 112 |     | <span style='background-color: #eee;'>    function approve(address to, uint256 tokenId) public virtual override {</span>
 113 |     | <span style='background-color: #faa;'>        address owner = ERC721.ownerOf(tokenId);</span>
 114 |     | <span style='background-color: #faa;'>        require(to != owner, &quot;ERC721: approval to current owner&quot;);</span>
 115 |     | <span style='background-color: #eee;'></span>
 116 |     | <span style='background-color: #eee;'>        require(</span>
 117 |     | <span style='background-color: #faa;'>            _msgSender() == owner || isApprovedForAll(owner, _msgSender()),</span>
 118 |     | <span style='background-color: #eee;'>            &quot;ERC721: approve caller is not token owner or approved for all&quot;</span>
 119 |     | <span style='background-color: #eee;'>        );</span>
 120 |     | <span style='background-color: #eee;'></span>
 121 |     | <span style='background-color: #eee;'>        _approve(to, tokenId);</span>
 122 |     | <span style='background-color: #eee;'>    }</span>
 123 |     | <span style='background-color: #eee;'></span>
 124 |     | <span style='background-color: #eee;'>    /**</span>
 125 |     | <span style='background-color: #eee;'>     * @dev See {IERC721-getApproved}.</span>
 126 |     | <span style='background-color: #eee;'>     */</span>
 127 |     | <span style='background-color: #faa;'>    function getApproved(uint256 tokenId) public view virtual override returns (address) {</span>
 128 |     | <span style='background-color: #faa;'>        _requireMinted(tokenId);</span>
 129 |     | <span style='background-color: #eee;'></span>
 130 |     | <span style='background-color: #faa;'>        return _tokenApprovals[tokenId];</span>
 131 |     | <span style='background-color: #eee;'>    }</span>
 132 |     | <span style='background-color: #eee;'></span>
 133 |     | <span style='background-color: #eee;'>    /**</span>
 134 |     | <span style='background-color: #eee;'>     * @dev See {IERC721-setApprovalForAll}.</span>
 135 |     | <span style='background-color: #eee;'>     */</span>
 136 |     | <span style='background-color: #eee;'>    function setApprovalForAll(address operator, bool approved) public virtual override {</span>
 137 |     | <span style='background-color: #eee;'>        _setApprovalForAll(_msgSender(), operator, approved);</span>
 138 |     | <span style='background-color: #eee;'>    }</span>
 139 |     | <span style='background-color: #eee;'></span>
 140 |     | <span style='background-color: #eee;'>    /**</span>
 141 |     | <span style='background-color: #eee;'>     * @dev See {IERC721-isApprovedForAll}.</span>
 142 |     | <span style='background-color: #eee;'>     */</span>
 143 |     | <span style='background-color: #eee;'>    function isApprovedForAll(address owner, address operator) public view virtual override returns (bool) {</span>
 144 |     | <span style='background-color: #faa;'>        return _operatorApprovals[owner][operator];</span>
 145 |     | <span style='background-color: #eee;'>    }</span>
 146 |     | <span style='background-color: #eee;'></span>
 147 |     | <span style='background-color: #eee;'>    /**</span>
 148 |     | <span style='background-color: #eee;'>     * @dev See {IERC721-transferFrom}.</span>
 149 |     | <span style='background-color: #eee;'>     */</span>
 150 |     | <span style='background-color: #eee;'>    function transferFrom(</span>
 151 |     | <span style='background-color: #eee;'>        address from,</span>
 152 |     | <span style='background-color: #eee;'>        address to,</span>
 153 |     | <span style='background-color: #eee;'>        uint256 tokenId</span>
 154 |     | <span style='background-color: #eee;'>    ) public virtual override {</span>
 155 |     | <span style='background-color: #eee;'>        //solhint-disable-next-line max-line-length</span>
 156 |     | <span style='background-color: #faa;'>        require(_isApprovedOrOwner(_msgSender(), tokenId), &quot;ERC721: caller is not token owner or approved&quot;);</span>
 157 |     | <span style='background-color: #eee;'></span>
 158 |     | <span style='background-color: #faa;'>        _transfer(from, to, tokenId);</span>
 159 |     | <span style='background-color: #eee;'>    }</span>
 160 |     | <span style='background-color: #eee;'></span>
 161 |     | <span style='background-color: #eee;'>    /**</span>
 162 |     | <span style='background-color: #eee;'>     * @dev See {IERC721-safeTransferFrom}.</span>
 163 |     | <span style='background-color: #eee;'>     */</span>
 164 |     | <span style='background-color: #eee;'>    function safeTransferFrom(</span>
 165 |     | <span style='background-color: #eee;'>        address from,</span>
 166 |     | <span style='background-color: #eee;'>        address to,</span>
 167 |     | <span style='background-color: #eee;'>        uint256 tokenId</span>
 168 |     | <span style='background-color: #eee;'>    ) public virtual override {</span>
 169 |     | <span style='background-color: #faa;'>        safeTransferFrom(from, to, tokenId, &quot;&quot;);</span>
 170 |     | <span style='background-color: #eee;'>    }</span>
 171 |     | <span style='background-color: #eee;'></span>
 172 |     | <span style='background-color: #eee;'>    /**</span>
 173 |     | <span style='background-color: #eee;'>     * @dev See {IERC721-safeTransferFrom}.</span>
 174 |     | <span style='background-color: #eee;'>     */</span>
 175 |     | <span style='background-color: #faa;'>    function safeTransferFrom(</span>
 176 |     | <span style='background-color: #eee;'>        address from,</span>
 177 |     | <span style='background-color: #eee;'>        address to,</span>
 178 |     | <span style='background-color: #eee;'>        uint256 tokenId,</span>
 179 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 180 |     | <span style='background-color: #eee;'>    ) public virtual override {</span>
 181 |     | <span style='background-color: #faa;'>        require(_isApprovedOrOwner(_msgSender(), tokenId), &quot;ERC721: caller is not token owner or approved&quot;);</span>
 182 |     | <span style='background-color: #eee;'>        _safeTransfer(from, to, tokenId, data);</span>
 183 |     | <span style='background-color: #eee;'>    }</span>
 184 |     | <span style='background-color: #eee;'></span>
 185 |     | <span style='background-color: #eee;'>    /**</span>
 186 |     | <span style='background-color: #eee;'>     * @dev Safely transfers `tokenId` token from `from` to `to`, checking first that contract recipients</span>
 187 |     | <span style='background-color: #eee;'>     * are aware of the ERC721 protocol to prevent tokens from being forever locked.</span>
 188 |     | <span style='background-color: #eee;'>     *</span>
 189 |     | <span style='background-color: #eee;'>     * `data` is additional data, it has no specified format and it is sent in call to `to`.</span>
 190 |     | <span style='background-color: #eee;'>     *</span>
 191 |     | <span style='background-color: #eee;'>     * This internal function is equivalent to {safeTransferFrom}, and can be used to e.g.</span>
 192 |     | <span style='background-color: #eee;'>     * implement alternative mechanisms to perform token transfer, such as signature-based.</span>
 193 |     | <span style='background-color: #eee;'>     *</span>
 194 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 195 |     | <span style='background-color: #eee;'>     *</span>
 196 |     | <span style='background-color: #eee;'>     * - `from` cannot be the zero address.</span>
 197 |     | <span style='background-color: #eee;'>     * - `to` cannot be the zero address.</span>
 198 |     | <span style='background-color: #eee;'>     * - `tokenId` token must exist and be owned by `from`.</span>
 199 |     | <span style='background-color: #eee;'>     * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.</span>
 200 |     | <span style='background-color: #eee;'>     *</span>
 201 |     | <span style='background-color: #eee;'>     * Emits a {Transfer} event.</span>
 202 |     | <span style='background-color: #eee;'>     */</span>
 203 |     | <span style='background-color: #eee;'>    function _safeTransfer(</span>
 204 |     | <span style='background-color: #eee;'>        address from,</span>
 205 |     | <span style='background-color: #eee;'>        address to,</span>
 206 |     | <span style='background-color: #eee;'>        uint256 tokenId,</span>
 207 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 208 |     | <span style='background-color: #eee;'>    ) internal virtual {</span>
 209 |     | <span style='background-color: #faa;'>        _transfer(from, to, tokenId);</span>
 210 |     | <span style='background-color: #faa;'>        require(_checkOnERC721Received(from, to, tokenId, data), &quot;ERC721: transfer to non ERC721Receiver implementer&quot;);</span>
 211 |     | <span style='background-color: #eee;'>    }</span>
 212 |     | <span style='background-color: #eee;'></span>
 213 |     | <span style='background-color: #eee;'>    /**</span>
 214 |     | <span style='background-color: #eee;'>     * @dev Returns the owner of the `tokenId`. Does NOT revert if token doesn&#39;t exist</span>
 215 |     | <span style='background-color: #eee;'>     */</span>
 216 |     | <span style='background-color: #eee;'>    function _ownerOf(uint256 tokenId) internal view virtual returns (address) {</span>
 217 |     | <span style='background-color: #faa;'>        return _owners[tokenId];</span>
 218 |     | <span style='background-color: #eee;'>    }</span>
 219 |     | <span style='background-color: #eee;'></span>
 220 |     | <span style='background-color: #eee;'>    /**</span>
 221 |     | <span style='background-color: #eee;'>     * @dev Returns whether `tokenId` exists.</span>
 222 |     | <span style='background-color: #eee;'>     *</span>
 223 |     | <span style='background-color: #eee;'>     * Tokens can be managed by their owner or approved accounts via {approve} or {setApprovalForAll}.</span>
 224 |     | <span style='background-color: #eee;'>     *</span>
 225 |     | <span style='background-color: #eee;'>     * Tokens start existing when they are minted (`_mint`),</span>
 226 |     | <span style='background-color: #eee;'>     * and stop existing when they are burned (`_burn`).</span>
 227 |     | <span style='background-color: #eee;'>     */</span>
 228 |     | <span style='background-color: #faa;'>    function _exists(uint256 tokenId) internal view virtual returns (bool) {</span>
 229 |     | <span style='background-color: #faa;'>        return _ownerOf(tokenId) != address(0);</span>
 230 |     | <span style='background-color: #eee;'>    }</span>
 231 |     | <span style='background-color: #eee;'></span>
 232 |     | <span style='background-color: #eee;'>    /**</span>
 233 |     | <span style='background-color: #eee;'>     * @dev Returns whether `spender` is allowed to manage `tokenId`.</span>
 234 |     | <span style='background-color: #eee;'>     *</span>
 235 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 236 |     | <span style='background-color: #eee;'>     *</span>
 237 |     | <span style='background-color: #eee;'>     * - `tokenId` must exist.</span>
 238 |     | <span style='background-color: #eee;'>     */</span>
 239 |     | <span style='background-color: #faa;'>    function _isApprovedOrOwner(address spender, uint256 tokenId) internal view virtual returns (bool) {</span>
 240 |     | <span style='background-color: #faa;'>        address owner = ERC721.ownerOf(tokenId);</span>
 241 |     | <span style='background-color: #faa;'>        return (spender == owner || isApprovedForAll(owner, spender) || getApproved(tokenId) == spender);</span>
 242 |     | <span style='background-color: #eee;'>    }</span>
 243 |     | <span style='background-color: #eee;'></span>
 244 |     | <span style='background-color: #eee;'>    /**</span>
 245 |     | <span style='background-color: #eee;'>     * @dev Safely mints `tokenId` and transfers it to `to`.</span>
 246 |     | <span style='background-color: #eee;'>     *</span>
 247 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 248 |     | <span style='background-color: #eee;'>     *</span>
 249 |     | <span style='background-color: #eee;'>     * - `tokenId` must not exist.</span>
 250 |     | <span style='background-color: #eee;'>     * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.</span>
 251 |     | <span style='background-color: #eee;'>     *</span>
 252 |     | <span style='background-color: #eee;'>     * Emits a {Transfer} event.</span>
 253 |     | <span style='background-color: #eee;'>     */</span>
 254 |     | <span style='background-color: #eee;'>    function _safeMint(address to, uint256 tokenId) internal virtual {</span>
 255 |     | <span style='background-color: #eee;'>        _safeMint(to, tokenId, &quot;&quot;);</span>
 256 |     | <span style='background-color: #eee;'>    }</span>
 257 |     | <span style='background-color: #eee;'></span>
 258 |     | <span style='background-color: #eee;'>    /**</span>
 259 |     | <span style='background-color: #eee;'>     * @dev Same as {xref-ERC721-_safeMint-address-uint256-}[`_safeMint`], with an additional `data` parameter which is</span>
 260 |     | <span style='background-color: #eee;'>     * forwarded in {IERC721Receiver-onERC721Received} to contract recipients.</span>
 261 |     | <span style='background-color: #eee;'>     */</span>
 262 |     | <span style='background-color: #eee;'>    function _safeMint(</span>
 263 |     | <span style='background-color: #eee;'>        address to,</span>
 264 |     | <span style='background-color: #eee;'>        uint256 tokenId,</span>
 265 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 266 |     | <span style='background-color: #eee;'>    ) internal virtual {</span>
 267 |     | <span style='background-color: #eee;'>        _mint(to, tokenId);</span>
 268 |     | <span style='background-color: #eee;'>        require(</span>
 269 |     | <span style='background-color: #eee;'>            _checkOnERC721Received(address(0), to, tokenId, data),</span>
 270 |     | <span style='background-color: #eee;'>            &quot;ERC721: transfer to non ERC721Receiver implementer&quot;</span>
 271 |     | <span style='background-color: #eee;'>        );</span>
 272 |     | <span style='background-color: #eee;'>    }</span>
 273 |     | <span style='background-color: #eee;'></span>
 274 |     | <span style='background-color: #eee;'>    /**</span>
 275 |     | <span style='background-color: #eee;'>     * @dev Mints `tokenId` and transfers it to `to`.</span>
 276 |     | <span style='background-color: #eee;'>     *</span>
 277 |     | <span style='background-color: #eee;'>     * WARNING: Usage of this method is discouraged, use {_safeMint} whenever possible</span>
 278 |     | <span style='background-color: #eee;'>     *</span>
 279 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 280 |     | <span style='background-color: #eee;'>     *</span>
 281 |     | <span style='background-color: #eee;'>     * - `tokenId` must not exist.</span>
 282 |     | <span style='background-color: #eee;'>     * - `to` cannot be the zero address.</span>
 283 |     | <span style='background-color: #eee;'>     *</span>
 284 |     | <span style='background-color: #eee;'>     * Emits a {Transfer} event.</span>
 285 |     | <span style='background-color: #eee;'>     */</span>
 286 |     | <span style='background-color: #eee;'>    function _mint(address to, uint256 tokenId) internal virtual {</span>
 287 |     | <span style='background-color: #faa;'>        require(to != address(0), &quot;ERC721: mint to the zero address&quot;);</span>
 288 |     | <span style='background-color: #faa;'>        require(!_exists(tokenId), &quot;ERC721: token already minted&quot;);</span>
 289 |     | <span style='background-color: #eee;'></span>
 290 |     | <span style='background-color: #eee;'>        _beforeTokenTransfer(address(0), to, tokenId, 1);</span>
 291 |     | <span style='background-color: #eee;'></span>
 292 |     | <span style='background-color: #eee;'>        // Check that tokenId was not minted by `_beforeTokenTransfer` hook</span>
 293 |     | <span style='background-color: #faa;'>        require(!_exists(tokenId), &quot;ERC721: token already minted&quot;);</span>
 294 |     | <span style='background-color: #eee;'></span>
 295 |     | <span style='background-color: #eee;'>        unchecked {</span>
 296 |     | <span style='background-color: #eee;'>            // Will not overflow unless all 2**256 token ids are minted to the same owner.</span>
 297 |     | <span style='background-color: #eee;'>            // Given that tokens are minted one by one, it is impossible in practice that</span>
 298 |     | <span style='background-color: #eee;'>            // this ever happens. Might change if we allow batch minting.</span>
 299 |     | <span style='background-color: #eee;'>            // The ERC fails to describe this case.</span>
 300 |     | <span style='background-color: #faa;'>            _balances[to] += 1;</span>
 301 |     | <span style='background-color: #eee;'>        }</span>
 302 |     | <span style='background-color: #eee;'></span>
 303 |     | <span style='background-color: #faa;'>        _owners[tokenId] = to;</span>
 304 |     | <span style='background-color: #eee;'></span>
 305 |     | <span style='background-color: #faa;'>        emit Transfer(address(0), to, tokenId);</span>
 306 |     | <span style='background-color: #eee;'></span>
 307 |     | <span style='background-color: #eee;'>        _afterTokenTransfer(address(0), to, tokenId, 1);</span>
 308 |     | <span style='background-color: #eee;'>    }</span>
 309 |     | <span style='background-color: #eee;'></span>
 310 |     | <span style='background-color: #eee;'>    /**</span>
 311 |     | <span style='background-color: #eee;'>     * @dev Destroys `tokenId`.</span>
 312 |     | <span style='background-color: #eee;'>     * The approval is cleared when the token is burned.</span>
 313 |     | <span style='background-color: #eee;'>     * This is an internal function that does not check if the sender is authorized to operate on the token.</span>
 314 |     | <span style='background-color: #eee;'>     *</span>
 315 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 316 |     | <span style='background-color: #eee;'>     *</span>
 317 |     | <span style='background-color: #eee;'>     * - `tokenId` must exist.</span>
 318 |     | <span style='background-color: #eee;'>     *</span>
 319 |     | <span style='background-color: #eee;'>     * Emits a {Transfer} event.</span>
 320 |     | <span style='background-color: #eee;'>     */</span>
 321 |     | <span style='background-color: #eee;'>    function _burn(uint256 tokenId) internal virtual {</span>
 322 |     | <span style='background-color: #eee;'>        address owner = ERC721.ownerOf(tokenId);</span>
 323 |     | <span style='background-color: #eee;'></span>
 324 |     | <span style='background-color: #eee;'>        _beforeTokenTransfer(owner, address(0), tokenId, 1);</span>
 325 |     | <span style='background-color: #eee;'></span>
 326 |     | <span style='background-color: #eee;'>        // Update ownership in case tokenId was transferred by `_beforeTokenTransfer` hook</span>
 327 |     | <span style='background-color: #eee;'>        owner = ERC721.ownerOf(tokenId);</span>
 328 |     | <span style='background-color: #eee;'></span>
 329 |     | <span style='background-color: #eee;'>        // Clear approvals</span>
 330 |     | <span style='background-color: #eee;'>        delete _tokenApprovals[tokenId];</span>
 331 |     | <span style='background-color: #eee;'></span>
 332 |     | <span style='background-color: #eee;'>        unchecked {</span>
 333 |     | <span style='background-color: #eee;'>            // Cannot overflow, as that would require more tokens to be burned/transferred</span>
 334 |     | <span style='background-color: #eee;'>            // out than the owner initially received through minting and transferring in.</span>
 335 |     | <span style='background-color: #eee;'>            _balances[owner] -= 1;</span>
 336 |     | <span style='background-color: #eee;'>        }</span>
 337 |     | <span style='background-color: #eee;'>        delete _owners[tokenId];</span>
 338 |     | <span style='background-color: #eee;'></span>
 339 |     | <span style='background-color: #eee;'>        emit Transfer(owner, address(0), tokenId);</span>
 340 |     | <span style='background-color: #eee;'></span>
 341 |     | <span style='background-color: #eee;'>        _afterTokenTransfer(owner, address(0), tokenId, 1);</span>
 342 |     | <span style='background-color: #eee;'>    }</span>
 343 |     | <span style='background-color: #eee;'></span>
 344 |     | <span style='background-color: #eee;'>    /**</span>
 345 |     | <span style='background-color: #eee;'>     * @dev Transfers `tokenId` from `from` to `to`.</span>
 346 |     | <span style='background-color: #eee;'>     *  As opposed to {transferFrom}, this imposes no restrictions on msg.sender.</span>
 347 |     | <span style='background-color: #eee;'>     *</span>
 348 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 349 |     | <span style='background-color: #eee;'>     *</span>
 350 |     | <span style='background-color: #eee;'>     * - `to` cannot be the zero address.</span>
 351 |     | <span style='background-color: #eee;'>     * - `tokenId` token must be owned by `from`.</span>
 352 |     | <span style='background-color: #eee;'>     *</span>
 353 |     | <span style='background-color: #eee;'>     * Emits a {Transfer} event.</span>
 354 |     | <span style='background-color: #eee;'>     */</span>
 355 |     | <span style='background-color: #faa;'>    function _transfer(</span>
 356 |     | <span style='background-color: #eee;'>        address from,</span>
 357 |     | <span style='background-color: #eee;'>        address to,</span>
 358 |     | <span style='background-color: #eee;'>        uint256 tokenId</span>
 359 |     | <span style='background-color: #eee;'>    ) internal virtual {</span>
 360 |     | <span style='background-color: #faa;'>        require(ERC721.ownerOf(tokenId) == from, &quot;ERC721: transfer from incorrect owner&quot;);</span>
 361 |     | <span style='background-color: #faa;'>        require(to != address(0), &quot;ERC721: transfer to the zero address&quot;);</span>
 362 |     | <span style='background-color: #eee;'></span>
 363 |     | <span style='background-color: #faa;'>        _beforeTokenTransfer(from, to, tokenId, 1);</span>
 364 |     | <span style='background-color: #eee;'></span>
 365 |     | <span style='background-color: #eee;'>        // Check that tokenId was not transferred by `_beforeTokenTransfer` hook</span>
 366 |     | <span style='background-color: #faa;'>        require(ERC721.ownerOf(tokenId) == from, &quot;ERC721: transfer from incorrect owner&quot;);</span>
 367 |     | <span style='background-color: #eee;'></span>
 368 |     | <span style='background-color: #eee;'>        // Clear approvals from the previous owner</span>
 369 |     | <span style='background-color: #faa;'>        delete _tokenApprovals[tokenId];</span>
 370 |     | <span style='background-color: #eee;'></span>
 371 |     | <span style='background-color: #eee;'>        unchecked {</span>
 372 |     | <span style='background-color: #eee;'>            // `_balances[from]` cannot overflow for the same reason as described in `_burn`:</span>
 373 |     | <span style='background-color: #eee;'>            // `from`&#39;s balance is the number of token held, which is at least one before the current</span>
 374 |     | <span style='background-color: #eee;'>            // transfer.</span>
 375 |     | <span style='background-color: #eee;'>            // `_balances[to]` could overflow in the conditions described in `_mint`. That would require</span>
 376 |     | <span style='background-color: #eee;'>            // all 2**256 token ids to be minted, which in practice is impossible.</span>
 377 |     | <span style='background-color: #eee;'>            _balances[from] -= 1;</span>
 378 |     | <span style='background-color: #eee;'>            _balances[to] += 1;</span>
 379 |     | <span style='background-color: #eee;'>        }</span>
 380 |     | <span style='background-color: #faa;'>        _owners[tokenId] = to;</span>
 381 |     | <span style='background-color: #eee;'></span>
 382 |     | <span style='background-color: #faa;'>        emit Transfer(from, to, tokenId);</span>
 383 |     | <span style='background-color: #eee;'></span>
 384 |     | <span style='background-color: #eee;'>        _afterTokenTransfer(from, to, tokenId, 1);</span>
 385 |     | <span style='background-color: #eee;'>    }</span>
 386 |     | <span style='background-color: #eee;'></span>
 387 |     | <span style='background-color: #eee;'>    /**</span>
 388 |     | <span style='background-color: #eee;'>     * @dev Approve `to` to operate on `tokenId`</span>
 389 |     | <span style='background-color: #eee;'>     *</span>
 390 |     | <span style='background-color: #eee;'>     * Emits an {Approval} event.</span>
 391 |     | <span style='background-color: #eee;'>     */</span>
 392 |     | <span style='background-color: #eee;'>    function _approve(address to, uint256 tokenId) internal virtual {</span>
 393 |     | <span style='background-color: #eee;'>        _tokenApprovals[tokenId] = to;</span>
 394 |     | <span style='background-color: #faa;'>        emit Approval(ERC721.ownerOf(tokenId), to, tokenId);</span>
 395 |     | <span style='background-color: #eee;'>    }</span>
 396 |     | <span style='background-color: #eee;'></span>
 397 |     | <span style='background-color: #eee;'>    /**</span>
 398 |     | <span style='background-color: #eee;'>     * @dev Approve `operator` to operate on all of `owner` tokens</span>
 399 |     | <span style='background-color: #eee;'>     *</span>
 400 |     | <span style='background-color: #eee;'>     * Emits an {ApprovalForAll} event.</span>
 401 |     | <span style='background-color: #eee;'>     */</span>
 402 |     | <span style='background-color: #eee;'>    function _setApprovalForAll(</span>
 403 |     | <span style='background-color: #eee;'>        address owner,</span>
 404 |     | <span style='background-color: #eee;'>        address operator,</span>
 405 |     | <span style='background-color: #eee;'>        bool approved</span>
 406 |     | <span style='background-color: #eee;'>    ) internal virtual {</span>
 407 |     | <span style='background-color: #faa;'>        require(owner != operator, &quot;ERC721: approve to caller&quot;);</span>
 408 |     | <span style='background-color: #faa;'>        _operatorApprovals[owner][operator] = approved;</span>
 409 |     | <span style='background-color: #faa;'>        emit ApprovalForAll(owner, operator, approved);</span>
 410 |     | <span style='background-color: #eee;'>    }</span>
 411 |     | <span style='background-color: #eee;'></span>
 412 |     | <span style='background-color: #eee;'>    /**</span>
 413 |     | <span style='background-color: #eee;'>     * @dev Reverts if the `tokenId` has not been minted yet.</span>
 414 |     | <span style='background-color: #eee;'>     */</span>
 415 |     | <span style='background-color: #faa;'>    function _requireMinted(uint256 tokenId) internal view virtual {</span>
 416 |     | <span style='background-color: #faa;'>        require(_exists(tokenId), &quot;ERC721: invalid token ID&quot;);</span>
 417 |     | <span style='background-color: #eee;'>    }</span>
 418 |     | <span style='background-color: #eee;'></span>
 419 |     | <span style='background-color: #eee;'>    /**</span>
 420 |     | <span style='background-color: #eee;'>     * @dev Internal function to invoke {IERC721Receiver-onERC721Received} on a target address.</span>
 421 |     | <span style='background-color: #eee;'>     * The call is not executed if the target address is not a contract.</span>
 422 |     | <span style='background-color: #eee;'>     *</span>
 423 |     | <span style='background-color: #eee;'>     * @param from address representing the previous owner of the given token ID</span>
 424 |     | <span style='background-color: #eee;'>     * @param to target address that will receive the tokens</span>
 425 |     | <span style='background-color: #eee;'>     * @param tokenId uint256 ID of the token to be transferred</span>
 426 |     | <span style='background-color: #eee;'>     * @param data bytes optional data to send along with the call</span>
 427 |     | <span style='background-color: #eee;'>     * @return bool whether the call correctly returned the expected magic value</span>
 428 |     | <span style='background-color: #eee;'>     */</span>
 429 |     | <span style='background-color: #faa;'>    function _checkOnERC721Received(</span>
 430 |     | <span style='background-color: #eee;'>        address from,</span>
 431 |     | <span style='background-color: #eee;'>        address to,</span>
 432 |     | <span style='background-color: #eee;'>        uint256 tokenId,</span>
 433 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 434 |     | <span style='background-color: #eee;'>    ) private returns (bool) {</span>
 435 |     | <span style='background-color: #faa;'>        if (to.isContract()) {</span>
 436 |     | <span style='background-color: #faa;'>            try IERC721Receiver(to).onERC721Received(_msgSender(), from, tokenId, data) returns (bytes4 retval) {</span>
 437 |     | <span style='background-color: #faa;'>                return retval == IERC721Receiver.onERC721Received.selector;</span>
 438 |     | <span style='background-color: #faa;'>            } catch (bytes memory reason) {</span>
 439 |     | <span style='background-color: #faa;'>                if (reason.length == 0) {</span>
 440 |     | <span style='background-color: #faa;'>                    revert(&quot;ERC721: transfer to non ERC721Receiver implementer&quot;);</span>
 441 |     | <span style='background-color: #eee;'>                } else {</span>
 442 |     | <span style='background-color: #eee;'>                    /// @solidity memory-safe-assembly</span>
 443 |     | <span style='background-color: #faa;'>                    assembly {</span>
 444 |     | <span style='background-color: #eee;'>                        revert(add(32, reason), mload(reason))</span>
 445 |     | <span style='background-color: #eee;'>                    }</span>
 446 |     | <span style='background-color: #eee;'>                }</span>
 447 |     | <span style='background-color: #eee;'>            }</span>
 448 |     | <span style='background-color: #eee;'>        } else {</span>
 449 |     | <span style='background-color: #faa;'>            return true;</span>
 450 |     | <span style='background-color: #eee;'>        }</span>
 451 |     | <span style='background-color: #eee;'>    }</span>
 452 |     | <span style='background-color: #eee;'></span>
 453 |     | <span style='background-color: #eee;'>    /**</span>
 454 |     | <span style='background-color: #eee;'>     * @dev Hook that is called before any token transfer. This includes minting and burning. If {ERC721Consecutive} is</span>
 455 |     | <span style='background-color: #eee;'>     * used, the hook may be called as part of a consecutive (batch) mint, as indicated by `batchSize` greater than 1.</span>
 456 |     | <span style='background-color: #eee;'>     *</span>
 457 |     | <span style='background-color: #eee;'>     * Calling conditions:</span>
 458 |     | <span style='background-color: #eee;'>     *</span>
 459 |     | <span style='background-color: #eee;'>     * - When `from` and `to` are both non-zero, ``from``&#39;s tokens will be transferred to `to`.</span>
 460 |     | <span style='background-color: #eee;'>     * - When `from` is zero, the tokens will be minted for `to`.</span>
 461 |     | <span style='background-color: #eee;'>     * - When `to` is zero, ``from``&#39;s tokens will be burned.</span>
 462 |     | <span style='background-color: #eee;'>     * - `from` and `to` are never both zero.</span>
 463 |     | <span style='background-color: #eee;'>     * - `batchSize` is non-zero.</span>
 464 |     | <span style='background-color: #eee;'>     *</span>
 465 |     | <span style='background-color: #eee;'>     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span>
 466 |     | <span style='background-color: #eee;'>     */</span>
 467 |     | <span style='background-color: #eee;'>    function _beforeTokenTransfer(</span>
 468 |     | <span style='background-color: #eee;'>        address from,</span>
 469 |     | <span style='background-color: #eee;'>        address to,</span>
 470 |     | <span style='background-color: #eee;'>        uint256, /* firstTokenId */</span>
 471 |     | <span style='background-color: #eee;'>        uint256 batchSize</span>
 472 |     | <span style='background-color: #eee;'>    ) internal virtual {</span>
 473 |     | <span style='background-color: #eee;'>        if (batchSize &gt; 1) {</span>
 474 |     | <span style='background-color: #eee;'>            if (from != address(0)) {</span>
 475 |     | <span style='background-color: #eee;'>                _balances[from] -= batchSize;</span>
 476 |     | <span style='background-color: #eee;'>            }</span>
 477 |     | <span style='background-color: #eee;'>            if (to != address(0)) {</span>
 478 |     | <span style='background-color: #eee;'>                _balances[to] += batchSize;</span>
 479 |     | <span style='background-color: #eee;'>            }</span>
 480 |     | <span style='background-color: #eee;'>        }</span>
 481 |     | <span style='background-color: #eee;'>    }</span>
 482 |     | <span style='background-color: #eee;'></span>
 483 |     | <span style='background-color: #eee;'>    /**</span>
 484 |     | <span style='background-color: #eee;'>     * @dev Hook that is called after any token transfer. This includes minting and burning. If {ERC721Consecutive} is</span>
 485 |     | <span style='background-color: #eee;'>     * used, the hook may be called as part of a consecutive (batch) mint, as indicated by `batchSize` greater than 1.</span>
 486 |     | <span style='background-color: #eee;'>     *</span>
 487 |     | <span style='background-color: #eee;'>     * Calling conditions:</span>
 488 |     | <span style='background-color: #eee;'>     *</span>
 489 |     | <span style='background-color: #eee;'>     * - When `from` and `to` are both non-zero, ``from``&#39;s tokens were transferred to `to`.</span>
 490 |     | <span style='background-color: #eee;'>     * - When `from` is zero, the tokens were minted for `to`.</span>
 491 |     | <span style='background-color: #eee;'>     * - When `to` is zero, ``from``&#39;s tokens were burned.</span>
 492 |     | <span style='background-color: #eee;'>     * - `from` and `to` are never both zero.</span>
 493 |     | <span style='background-color: #eee;'>     * - `batchSize` is non-zero.</span>
 494 |     | <span style='background-color: #eee;'>     *</span>
 495 |     | <span style='background-color: #eee;'>     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span>
 496 |     | <span style='background-color: #eee;'>     */</span>
 497 |     | <span style='background-color: #eee;'>    function _afterTokenTransfer(</span>
 498 |     | <span style='background-color: #eee;'>        address from,</span>
 499 |     | <span style='background-color: #eee;'>        address to,</span>
 500 |     | <span style='background-color: #eee;'>        uint256 firstTokenId,</span>
 501 |     | <span style='background-color: #eee;'>        uint256 batchSize</span>
 502 |     | <span style='background-color: #eee;'>    ) internal virtual {}</span>
 503 |     | <span style='background-color: #eee;'>}</span>
 504 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/token/ERC721/IERC721.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.8.0) (token/ERC721/IERC721.sol)</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>import &quot;../../utils/introspection/IERC165.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'></span>
   8 |     | <span style='background-color: #eee;'>/**</span>
   9 |     | <span style='background-color: #eee;'> * @dev Required interface of an ERC721 compliant contract.</span>
  10 |     | <span style='background-color: #eee;'> */</span>
  11 |     | <span style='background-color: #eee;'>interface IERC721 is IERC165 {</span>
  12 |     | <span style='background-color: #eee;'>    /**</span>
  13 |     | <span style='background-color: #eee;'>     * @dev Emitted when `tokenId` token is transferred from `from` to `to`.</span>
  14 |     | <span style='background-color: #eee;'>     */</span>
  15 |     | <span style='background-color: #eee;'>    event Transfer(address indexed from, address indexed to, uint256 indexed tokenId);</span>
  16 |     | <span style='background-color: #eee;'></span>
  17 |     | <span style='background-color: #eee;'>    /**</span>
  18 |     | <span style='background-color: #eee;'>     * @dev Emitted when `owner` enables `approved` to manage the `tokenId` token.</span>
  19 |     | <span style='background-color: #eee;'>     */</span>
  20 |     | <span style='background-color: #eee;'>    event Approval(address indexed owner, address indexed approved, uint256 indexed tokenId);</span>
  21 |     | <span style='background-color: #eee;'></span>
  22 |     | <span style='background-color: #eee;'>    /**</span>
  23 |     | <span style='background-color: #eee;'>     * @dev Emitted when `owner` enables or disables (`approved`) `operator` to manage all of its assets.</span>
  24 |     | <span style='background-color: #eee;'>     */</span>
  25 |     | <span style='background-color: #eee;'>    event ApprovalForAll(address indexed owner, address indexed operator, bool approved);</span>
  26 |     | <span style='background-color: #eee;'></span>
  27 |     | <span style='background-color: #eee;'>    /**</span>
  28 |     | <span style='background-color: #eee;'>     * @dev Returns the number of tokens in ``owner``&#39;s account.</span>
  29 |     | <span style='background-color: #eee;'>     */</span>
  30 |     | <span style='background-color: #eee;'>    function balanceOf(address owner) external view returns (uint256 balance);</span>
  31 |     | <span style='background-color: #eee;'></span>
  32 |     | <span style='background-color: #eee;'>    /**</span>
  33 |     | <span style='background-color: #eee;'>     * @dev Returns the owner of the `tokenId` token.</span>
  34 |     | <span style='background-color: #eee;'>     *</span>
  35 |     | <span style='background-color: #eee;'>     * Requirements:</span>
  36 |     | <span style='background-color: #eee;'>     *</span>
  37 |     | <span style='background-color: #eee;'>     * - `tokenId` must exist.</span>
  38 |     | <span style='background-color: #eee;'>     */</span>
  39 |     | <span style='background-color: #eee;'>    function ownerOf(uint256 tokenId) external view returns (address owner);</span>
  40 |     | <span style='background-color: #eee;'></span>
  41 |     | <span style='background-color: #eee;'>    /**</span>
  42 |     | <span style='background-color: #eee;'>     * @dev Safely transfers `tokenId` token from `from` to `to`.</span>
  43 |     | <span style='background-color: #eee;'>     *</span>
  44 |     | <span style='background-color: #eee;'>     * Requirements:</span>
  45 |     | <span style='background-color: #eee;'>     *</span>
  46 |     | <span style='background-color: #eee;'>     * - `from` cannot be the zero address.</span>
  47 |     | <span style='background-color: #eee;'>     * - `to` cannot be the zero address.</span>
  48 |     | <span style='background-color: #eee;'>     * - `tokenId` token must exist and be owned by `from`.</span>
  49 |     | <span style='background-color: #eee;'>     * - If the caller is not `from`, it must be approved to move this token by either {approve} or {setApprovalForAll}.</span>
  50 |     | <span style='background-color: #eee;'>     * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.</span>
  51 |     | <span style='background-color: #eee;'>     *</span>
  52 |     | <span style='background-color: #eee;'>     * Emits a {Transfer} event.</span>
  53 |     | <span style='background-color: #eee;'>     */</span>
  54 |     | <span style='background-color: #eee;'>    function safeTransferFrom(</span>
  55 |     | <span style='background-color: #eee;'>        address from,</span>
  56 |     | <span style='background-color: #eee;'>        address to,</span>
  57 |     | <span style='background-color: #eee;'>        uint256 tokenId,</span>
  58 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
  59 |     | <span style='background-color: #eee;'>    ) external;</span>
  60 |     | <span style='background-color: #eee;'></span>
  61 |     | <span style='background-color: #eee;'>    /**</span>
  62 |     | <span style='background-color: #eee;'>     * @dev Safely transfers `tokenId` token from `from` to `to`, checking first that contract recipients</span>
  63 |     | <span style='background-color: #eee;'>     * are aware of the ERC721 protocol to prevent tokens from being forever locked.</span>
  64 |     | <span style='background-color: #eee;'>     *</span>
  65 |     | <span style='background-color: #eee;'>     * Requirements:</span>
  66 |     | <span style='background-color: #eee;'>     *</span>
  67 |     | <span style='background-color: #eee;'>     * - `from` cannot be the zero address.</span>
  68 |     | <span style='background-color: #eee;'>     * - `to` cannot be the zero address.</span>
  69 |     | <span style='background-color: #eee;'>     * - `tokenId` token must exist and be owned by `from`.</span>
  70 |     | <span style='background-color: #eee;'>     * - If the caller is not `from`, it must have been allowed to move this token by either {approve} or {setApprovalForAll}.</span>
  71 |     | <span style='background-color: #eee;'>     * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.</span>
  72 |     | <span style='background-color: #eee;'>     *</span>
  73 |     | <span style='background-color: #eee;'>     * Emits a {Transfer} event.</span>
  74 |     | <span style='background-color: #eee;'>     */</span>
  75 |     | <span style='background-color: #eee;'>    function safeTransferFrom(</span>
  76 |     | <span style='background-color: #eee;'>        address from,</span>
  77 |     | <span style='background-color: #eee;'>        address to,</span>
  78 |     | <span style='background-color: #eee;'>        uint256 tokenId</span>
  79 |     | <span style='background-color: #eee;'>    ) external;</span>
  80 |     | <span style='background-color: #eee;'></span>
  81 |     | <span style='background-color: #eee;'>    /**</span>
  82 |     | <span style='background-color: #eee;'>     * @dev Transfers `tokenId` token from `from` to `to`.</span>
  83 |     | <span style='background-color: #eee;'>     *</span>
  84 |     | <span style='background-color: #eee;'>     * WARNING: Note that the caller is responsible to confirm that the recipient is capable of receiving ERC721</span>
  85 |     | <span style='background-color: #eee;'>     * or else they may be permanently lost. Usage of {safeTransferFrom} prevents loss, though the caller must</span>
  86 |     | <span style='background-color: #eee;'>     * understand this adds an external call which potentially creates a reentrancy vulnerability.</span>
  87 |     | <span style='background-color: #eee;'>     *</span>
  88 |     | <span style='background-color: #eee;'>     * Requirements:</span>
  89 |     | <span style='background-color: #eee;'>     *</span>
  90 |     | <span style='background-color: #eee;'>     * - `from` cannot be the zero address.</span>
  91 |     | <span style='background-color: #eee;'>     * - `to` cannot be the zero address.</span>
  92 |     | <span style='background-color: #eee;'>     * - `tokenId` token must be owned by `from`.</span>
  93 |     | <span style='background-color: #eee;'>     * - If the caller is not `from`, it must be approved to move this token by either {approve} or {setApprovalForAll}.</span>
  94 |     | <span style='background-color: #eee;'>     *</span>
  95 |     | <span style='background-color: #eee;'>     * Emits a {Transfer} event.</span>
  96 |     | <span style='background-color: #eee;'>     */</span>
  97 |     | <span style='background-color: #eee;'>    function transferFrom(</span>
  98 |     | <span style='background-color: #eee;'>        address from,</span>
  99 |     | <span style='background-color: #eee;'>        address to,</span>
 100 |     | <span style='background-color: #eee;'>        uint256 tokenId</span>
 101 |     | <span style='background-color: #eee;'>    ) external;</span>
 102 |     | <span style='background-color: #eee;'></span>
 103 |     | <span style='background-color: #eee;'>    /**</span>
 104 |     | <span style='background-color: #eee;'>     * @dev Gives permission to `to` to transfer `tokenId` token to another account.</span>
 105 |     | <span style='background-color: #eee;'>     * The approval is cleared when the token is transferred.</span>
 106 |     | <span style='background-color: #eee;'>     *</span>
 107 |     | <span style='background-color: #eee;'>     * Only a single account can be approved at a time, so approving the zero address clears previous approvals.</span>
 108 |     | <span style='background-color: #eee;'>     *</span>
 109 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 110 |     | <span style='background-color: #eee;'>     *</span>
 111 |     | <span style='background-color: #eee;'>     * - The caller must own the token or be an approved operator.</span>
 112 |     | <span style='background-color: #eee;'>     * - `tokenId` must exist.</span>
 113 |     | <span style='background-color: #eee;'>     *</span>
 114 |     | <span style='background-color: #eee;'>     * Emits an {Approval} event.</span>
 115 |     | <span style='background-color: #eee;'>     */</span>
 116 |     | <span style='background-color: #eee;'>    function approve(address to, uint256 tokenId) external;</span>
 117 |     | <span style='background-color: #eee;'></span>
 118 |     | <span style='background-color: #eee;'>    /**</span>
 119 |     | <span style='background-color: #eee;'>     * @dev Approve or remove `operator` as an operator for the caller.</span>
 120 |     | <span style='background-color: #eee;'>     * Operators can call {transferFrom} or {safeTransferFrom} for any token owned by the caller.</span>
 121 |     | <span style='background-color: #eee;'>     *</span>
 122 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 123 |     | <span style='background-color: #eee;'>     *</span>
 124 |     | <span style='background-color: #eee;'>     * - The `operator` cannot be the caller.</span>
 125 |     | <span style='background-color: #eee;'>     *</span>
 126 |     | <span style='background-color: #eee;'>     * Emits an {ApprovalForAll} event.</span>
 127 |     | <span style='background-color: #eee;'>     */</span>
 128 |     | <span style='background-color: #eee;'>    function setApprovalForAll(address operator, bool _approved) external;</span>
 129 |     | <span style='background-color: #eee;'></span>
 130 |     | <span style='background-color: #eee;'>    /**</span>
 131 |     | <span style='background-color: #eee;'>     * @dev Returns the account approved for `tokenId` token.</span>
 132 |     | <span style='background-color: #eee;'>     *</span>
 133 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 134 |     | <span style='background-color: #eee;'>     *</span>
 135 |     | <span style='background-color: #eee;'>     * - `tokenId` must exist.</span>
 136 |     | <span style='background-color: #eee;'>     */</span>
 137 |     | <span style='background-color: #eee;'>    function getApproved(uint256 tokenId) external view returns (address operator);</span>
 138 |     | <span style='background-color: #eee;'></span>
 139 |     | <span style='background-color: #eee;'>    /**</span>
 140 |     | <span style='background-color: #eee;'>     * @dev Returns if the `operator` is allowed to manage all of the assets of `owner`.</span>
 141 |     | <span style='background-color: #eee;'>     *</span>
 142 |     | <span style='background-color: #eee;'>     * See {setApprovalForAll}</span>
 143 |     | <span style='background-color: #eee;'>     */</span>
 144 |     | <span style='background-color: #eee;'>    function isApprovedForAll(address owner, address operator) external view returns (bool);</span>
 145 |     | <span style='background-color: #eee;'>}</span>
 146 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/token/ERC721/IERC721Receiver.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.6.0) (token/ERC721/IERC721Receiver.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>/**</span>
  7 |     | <span style='background-color: #eee;'> * @title ERC721 token receiver interface</span>
  8 |     | <span style='background-color: #eee;'> * @dev Interface for any contract that wants to support safeTransfers</span>
  9 |     | <span style='background-color: #eee;'> * from ERC721 asset contracts.</span>
 10 |     | <span style='background-color: #eee;'> */</span>
 11 |     | <span style='background-color: #eee;'>interface IERC721Receiver {</span>
 12 |     | <span style='background-color: #eee;'>    /**</span>
 13 |     | <span style='background-color: #eee;'>     * @dev Whenever an {IERC721} `tokenId` token is transferred to this contract via {IERC721-safeTransferFrom}</span>
 14 |     | <span style='background-color: #eee;'>     * by `operator` from `from`, this function is called.</span>
 15 |     | <span style='background-color: #eee;'>     *</span>
 16 |     | <span style='background-color: #eee;'>     * It must return its Solidity selector to confirm the token transfer.</span>
 17 |     | <span style='background-color: #eee;'>     * If any other value is returned or the interface is not implemented by the recipient, the transfer will be reverted.</span>
 18 |     | <span style='background-color: #eee;'>     *</span>
 19 |     | <span style='background-color: #eee;'>     * The selector can be obtained in Solidity with `IERC721Receiver.onERC721Received.selector`.</span>
 20 |     | <span style='background-color: #eee;'>     */</span>
 21 |     | <span style='background-color: #eee;'>    function onERC721Received(</span>
 22 |     | <span style='background-color: #eee;'>        address operator,</span>
 23 |     | <span style='background-color: #eee;'>        address from,</span>
 24 |     | <span style='background-color: #eee;'>        uint256 tokenId,</span>
 25 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
 26 |     | <span style='background-color: #eee;'>    ) external returns (bytes4);</span>
 27 |     | <span style='background-color: #eee;'>}</span>
 28 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/token/ERC721/extensions/IERC721Metadata.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts v4.4.1 (token/ERC721/extensions/IERC721Metadata.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>import &quot;../IERC721.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'></span>
  8 |     | <span style='background-color: #eee;'>/**</span>
  9 |     | <span style='background-color: #eee;'> * @title ERC-721 Non-Fungible Token Standard, optional metadata extension</span>
 10 |     | <span style='background-color: #eee;'> * @dev See https://eips.ethereum.org/EIPS/eip-721</span>
 11 |     | <span style='background-color: #eee;'> */</span>
 12 |     | <span style='background-color: #eee;'>interface IERC721Metadata is IERC721 {</span>
 13 |     | <span style='background-color: #eee;'>    /**</span>
 14 |     | <span style='background-color: #eee;'>     * @dev Returns the token collection name.</span>
 15 |     | <span style='background-color: #eee;'>     */</span>
 16 |     | <span style='background-color: #eee;'>    function name() external view returns (string memory);</span>
 17 |     | <span style='background-color: #eee;'></span>
 18 |     | <span style='background-color: #eee;'>    /**</span>
 19 |     | <span style='background-color: #eee;'>     * @dev Returns the token collection symbol.</span>
 20 |     | <span style='background-color: #eee;'>     */</span>
 21 |     | <span style='background-color: #eee;'>    function symbol() external view returns (string memory);</span>
 22 |     | <span style='background-color: #eee;'></span>
 23 |     | <span style='background-color: #eee;'>    /**</span>
 24 |     | <span style='background-color: #eee;'>     * @dev Returns the Uniform Resource Identifier (URI) for `tokenId` token.</span>
 25 |     | <span style='background-color: #eee;'>     */</span>
 26 |     | <span style='background-color: #eee;'>    function tokenURI(uint256 tokenId) external view returns (string memory);</span>
 27 |     | <span style='background-color: #eee;'>}</span>
 28 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/utils/Address.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.8.0) (utils/Address.sol)</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.1;</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>/**</span>
   7 |     | <span style='background-color: #eee;'> * @dev Collection of functions related to the address type</span>
   8 |     | <span style='background-color: #faa;'> */</span>
   9 |     | <span style='background-color: #eee;'>library Address {</span>
  10 |     | <span style='background-color: #eee;'>    /**</span>
  11 |     | <span style='background-color: #eee;'>     * @dev Returns true if `account` is a contract.</span>
  12 |     | <span style='background-color: #eee;'>     *</span>
  13 |     | <span style='background-color: #eee;'>     * [IMPORTANT]</span>
  14 |     | <span style='background-color: #eee;'>     * ====</span>
  15 |     | <span style='background-color: #eee;'>     * It is unsafe to assume that an address for which this function returns</span>
  16 |     | <span style='background-color: #eee;'>     * false is an externally-owned account (EOA) and not a contract.</span>
  17 |     | <span style='background-color: #eee;'>     *</span>
  18 |     | <span style='background-color: #eee;'>     * Among others, `isContract` will return false for the following</span>
  19 |     | <span style='background-color: #eee;'>     * types of addresses:</span>
  20 |     | <span style='background-color: #eee;'>     *</span>
  21 |     | <span style='background-color: #eee;'>     *  - an externally-owned account</span>
  22 |     | <span style='background-color: #eee;'>     *  - a contract in construction</span>
  23 |     | <span style='background-color: #eee;'>     *  - an address where a contract will be created</span>
  24 |     | <span style='background-color: #eee;'>     *  - an address where a contract lived, but was destroyed</span>
  25 |     | <span style='background-color: #eee;'>     * ====</span>
  26 |     | <span style='background-color: #eee;'>     *</span>
  27 |     | <span style='background-color: #eee;'>     * [IMPORTANT]</span>
  28 |     | <span style='background-color: #eee;'>     * ====</span>
  29 |     | <span style='background-color: #eee;'>     * You shouldn&#39;t rely on `isContract` to protect against flash loan attacks!</span>
  30 |     | <span style='background-color: #eee;'>     *</span>
  31 |     | <span style='background-color: #eee;'>     * Preventing calls from contracts is highly discouraged. It breaks composability, breaks support for smart wallets</span>
  32 |     | <span style='background-color: #eee;'>     * like Gnosis Safe, and does not provide security since it can be circumvented by calling from a contract</span>
  33 |     | <span style='background-color: #eee;'>     * constructor.</span>
  34 |     | <span style='background-color: #eee;'>     * ====</span>
  35 |     | <span style='background-color: #eee;'>     */</span>
  36 |     | <span style='background-color: #faa;'>    function isContract(address account) internal view returns (bool) {</span>
  37 |     | <span style='background-color: #eee;'>        // This method relies on extcodesize/address.code.length, which returns 0</span>
  38 |     | <span style='background-color: #eee;'>        // for contracts in construction, since the code is only stored at the end</span>
  39 |     | <span style='background-color: #eee;'>        // of the constructor execution.</span>
  40 |     | <span style='background-color: #eee;'></span>
  41 |     | <span style='background-color: #faa;'>        return account.code.length &gt; 0;</span>
  42 |     | <span style='background-color: #eee;'>    }</span>
  43 |     | <span style='background-color: #eee;'></span>
  44 |     | <span style='background-color: #eee;'>    /**</span>
  45 |     | <span style='background-color: #eee;'>     * @dev Replacement for Solidity&#39;s `transfer`: sends `amount` wei to</span>
  46 |     | <span style='background-color: #eee;'>     * `recipient`, forwarding all available gas and reverting on errors.</span>
  47 |     | <span style='background-color: #eee;'>     *</span>
  48 |     | <span style='background-color: #eee;'>     * https://eips.ethereum.org/EIPS/eip-1884[EIP1884] increases the gas cost</span>
  49 |     | <span style='background-color: #eee;'>     * of certain opcodes, possibly making contracts go over the 2300 gas limit</span>
  50 |     | <span style='background-color: #eee;'>     * imposed by `transfer`, making them unable to receive funds via</span>
  51 |     | <span style='background-color: #eee;'>     * `transfer`. {sendValue} removes this limitation.</span>
  52 |     | <span style='background-color: #eee;'>     *</span>
  53 |     | <span style='background-color: #eee;'>     * https://diligence.consensys.net/posts/2019/09/stop-using-soliditys-transfer-now/[Learn more].</span>
  54 |     | <span style='background-color: #eee;'>     *</span>
  55 |     | <span style='background-color: #eee;'>     * IMPORTANT: because control is transferred to `recipient`, care must be</span>
  56 |     | <span style='background-color: #eee;'>     * taken to not create reentrancy vulnerabilities. Consider using</span>
  57 |     | <span style='background-color: #eee;'>     * {ReentrancyGuard} or the</span>
  58 |     | <span style='background-color: #eee;'>     * https://solidity.readthedocs.io/en/v0.5.11/security-considerations.html#use-the-checks-effects-interactions-pattern[checks-effects-interactions pattern].</span>
  59 |     | <span style='background-color: #eee;'>     */</span>
  60 |     | <span style='background-color: #eee;'>    function sendValue(address payable recipient, uint256 amount) internal {</span>
  61 |     | <span style='background-color: #faa;'>        require(address(this).balance &gt;= amount, &quot;Address: insufficient balance&quot;);</span>
  62 |     | <span style='background-color: #eee;'></span>
  63 |     | <span style='background-color: #faa;'>        (bool success, ) = recipient.call{value: amount}(&quot;&quot;);</span>
  64 |     | <span style='background-color: #eee;'>        require(success, &quot;Address: unable to send value, recipient may have reverted&quot;);</span>
  65 |     | <span style='background-color: #eee;'>    }</span>
  66 |     | <span style='background-color: #eee;'></span>
  67 |     | <span style='background-color: #eee;'>    /**</span>
  68 |     | <span style='background-color: #eee;'>     * @dev Performs a Solidity function call using a low level `call`. A</span>
  69 |     | <span style='background-color: #eee;'>     * plain `call` is an unsafe replacement for a function call: use this</span>
  70 |     | <span style='background-color: #eee;'>     * function instead.</span>
  71 |     | <span style='background-color: #eee;'>     *</span>
  72 |     | <span style='background-color: #eee;'>     * If `target` reverts with a revert reason, it is bubbled up by this</span>
  73 |     | <span style='background-color: #eee;'>     * function (like regular Solidity function calls).</span>
  74 |     | <span style='background-color: #eee;'>     *</span>
  75 |     | <span style='background-color: #eee;'>     * Returns the raw returned data. To convert to the expected return value,</span>
  76 |     | <span style='background-color: #eee;'>     * use https://solidity.readthedocs.io/en/latest/units-and-global-variables.html?highlight=abi.decode#abi-encoding-and-decoding-functions[`abi.decode`].</span>
  77 |     | <span style='background-color: #eee;'>     *</span>
  78 |     | <span style='background-color: #eee;'>     * Requirements:</span>
  79 |     | <span style='background-color: #eee;'>     *</span>
  80 |     | <span style='background-color: #eee;'>     * - `target` must be a contract.</span>
  81 |     | <span style='background-color: #eee;'>     * - calling `target` with `data` must not revert.</span>
  82 |     | <span style='background-color: #eee;'>     *</span>
  83 |     | <span style='background-color: #eee;'>     * _Available since v3.1._</span>
  84 |     | <span style='background-color: #eee;'>     */</span>
  85 |     | <span style='background-color: #eee;'>    function functionCall(address target, bytes memory data) internal returns (bytes memory) {</span>
  86 |     | <span style='background-color: #eee;'>        return functionCallWithValue(target, data, 0, &quot;Address: low-level call failed&quot;);</span>
  87 |     | <span style='background-color: #eee;'>    }</span>
  88 |     | <span style='background-color: #eee;'></span>
  89 |     | <span style='background-color: #eee;'>    /**</span>
  90 |     | <span style='background-color: #eee;'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`], but with</span>
  91 |     | <span style='background-color: #eee;'>     * `errorMessage` as a fallback revert reason when `target` reverts.</span>
  92 |     | <span style='background-color: #eee;'>     *</span>
  93 |     | <span style='background-color: #eee;'>     * _Available since v3.1._</span>
  94 |     | <span style='background-color: #eee;'>     */</span>
  95 |     | <span style='background-color: #eee;'>    function functionCall(</span>
  96 |     | <span style='background-color: #eee;'>        address target,</span>
  97 |     | <span style='background-color: #eee;'>        bytes memory data,</span>
  98 |     | <span style='background-color: #eee;'>        string memory errorMessage</span>
  99 |     | <span style='background-color: #eee;'>    ) internal returns (bytes memory) {</span>
 100 |     | <span style='background-color: #eee;'>        return functionCallWithValue(target, data, 0, errorMessage);</span>
 101 |     | <span style='background-color: #eee;'>    }</span>
 102 |     | <span style='background-color: #eee;'></span>
 103 |     | <span style='background-color: #eee;'>    /**</span>
 104 |     | <span style='background-color: #eee;'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
 105 |     | <span style='background-color: #eee;'>     * but also transferring `value` wei to `target`.</span>
 106 |     | <span style='background-color: #eee;'>     *</span>
 107 |     | <span style='background-color: #eee;'>     * Requirements:</span>
 108 |     | <span style='background-color: #eee;'>     *</span>
 109 |     | <span style='background-color: #eee;'>     * - the calling contract must have an ETH balance of at least `value`.</span>
 110 |     | <span style='background-color: #eee;'>     * - the called Solidity function must be `payable`.</span>
 111 |     | <span style='background-color: #eee;'>     *</span>
 112 |     | <span style='background-color: #eee;'>     * _Available since v3.1._</span>
 113 |     | <span style='background-color: #eee;'>     */</span>
 114 |     | <span style='background-color: #eee;'>    function functionCallWithValue(</span>
 115 |     | <span style='background-color: #eee;'>        address target,</span>
 116 |     | <span style='background-color: #eee;'>        bytes memory data,</span>
 117 |     | <span style='background-color: #eee;'>        uint256 value</span>
 118 |     | <span style='background-color: #eee;'>    ) internal returns (bytes memory) {</span>
 119 |     | <span style='background-color: #eee;'>        return functionCallWithValue(target, data, value, &quot;Address: low-level call with value failed&quot;);</span>
 120 |     | <span style='background-color: #eee;'>    }</span>
 121 |     | <span style='background-color: #eee;'></span>
 122 |     | <span style='background-color: #eee;'>    /**</span>
 123 |     | <span style='background-color: #eee;'>     * @dev Same as {xref-Address-functionCallWithValue-address-bytes-uint256-}[`functionCallWithValue`], but</span>
 124 |     | <span style='background-color: #eee;'>     * with `errorMessage` as a fallback revert reason when `target` reverts.</span>
 125 |     | <span style='background-color: #eee;'>     *</span>
 126 |     | <span style='background-color: #eee;'>     * _Available since v3.1._</span>
 127 |     | <span style='background-color: #eee;'>     */</span>
 128 |     | <span style='background-color: #eee;'>    function functionCallWithValue(</span>
 129 |     | <span style='background-color: #eee;'>        address target,</span>
 130 |     | <span style='background-color: #eee;'>        bytes memory data,</span>
 131 |     | <span style='background-color: #eee;'>        uint256 value,</span>
 132 |     | <span style='background-color: #eee;'>        string memory errorMessage</span>
 133 |     | <span style='background-color: #eee;'>    ) internal returns (bytes memory) {</span>
 134 |     | <span style='background-color: #faa;'>        require(address(this).balance &gt;= value, &quot;Address: insufficient balance for call&quot;);</span>
 135 |     | <span style='background-color: #faa;'>        (bool success, bytes memory returndata) = target.call{value: value}(data);</span>
 136 |     | <span style='background-color: #faa;'>        return verifyCallResultFromTarget(target, success, returndata, errorMessage);</span>
 137 |     | <span style='background-color: #eee;'>    }</span>
 138 |     | <span style='background-color: #eee;'></span>
 139 |     | <span style='background-color: #eee;'>    /**</span>
 140 |     | <span style='background-color: #eee;'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
 141 |     | <span style='background-color: #eee;'>     * but performing a static call.</span>
 142 |     | <span style='background-color: #eee;'>     *</span>
 143 |     | <span style='background-color: #eee;'>     * _Available since v3.3._</span>
 144 |     | <span style='background-color: #eee;'>     */</span>
 145 |     | <span style='background-color: #eee;'>    function functionStaticCall(address target, bytes memory data) internal view returns (bytes memory) {</span>
 146 |     | <span style='background-color: #eee;'>        return functionStaticCall(target, data, &quot;Address: low-level static call failed&quot;);</span>
 147 |     | <span style='background-color: #eee;'>    }</span>
 148 |     | <span style='background-color: #eee;'></span>
 149 |     | <span style='background-color: #eee;'>    /**</span>
 150 |     | <span style='background-color: #eee;'>     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],</span>
 151 |     | <span style='background-color: #eee;'>     * but performing a static call.</span>
 152 |     | <span style='background-color: #eee;'>     *</span>
 153 |     | <span style='background-color: #eee;'>     * _Available since v3.3._</span>
 154 |     | <span style='background-color: #eee;'>     */</span>
 155 |     | <span style='background-color: #eee;'>    function functionStaticCall(</span>
 156 |     | <span style='background-color: #eee;'>        address target,</span>
 157 |     | <span style='background-color: #eee;'>        bytes memory data,</span>
 158 |     | <span style='background-color: #eee;'>        string memory errorMessage</span>
 159 |     | <span style='background-color: #eee;'>    ) internal view returns (bytes memory) {</span>
 160 |     | <span style='background-color: #eee;'>        (bool success, bytes memory returndata) = target.staticcall(data);</span>
 161 |     | <span style='background-color: #eee;'>        return verifyCallResultFromTarget(target, success, returndata, errorMessage);</span>
 162 |     | <span style='background-color: #eee;'>    }</span>
 163 |     | <span style='background-color: #eee;'></span>
 164 |     | <span style='background-color: #eee;'>    /**</span>
 165 |     | <span style='background-color: #eee;'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
 166 |     | <span style='background-color: #eee;'>     * but performing a delegate call.</span>
 167 |     | <span style='background-color: #eee;'>     *</span>
 168 |     | <span style='background-color: #eee;'>     * _Available since v3.4._</span>
 169 |     | <span style='background-color: #eee;'>     */</span>
 170 |     | <span style='background-color: #eee;'>    function functionDelegateCall(address target, bytes memory data) internal returns (bytes memory) {</span>
 171 |     | <span style='background-color: #eee;'>        return functionDelegateCall(target, data, &quot;Address: low-level delegate call failed&quot;);</span>
 172 |     | <span style='background-color: #eee;'>    }</span>
 173 |     | <span style='background-color: #eee;'></span>
 174 |     | <span style='background-color: #eee;'>    /**</span>
 175 |     | <span style='background-color: #eee;'>     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],</span>
 176 |     | <span style='background-color: #eee;'>     * but performing a delegate call.</span>
 177 |     | <span style='background-color: #eee;'>     *</span>
 178 |     | <span style='background-color: #eee;'>     * _Available since v3.4._</span>
 179 |     | <span style='background-color: #eee;'>     */</span>
 180 |     | <span style='background-color: #eee;'>    function functionDelegateCall(</span>
 181 |     | <span style='background-color: #eee;'>        address target,</span>
 182 |     | <span style='background-color: #eee;'>        bytes memory data,</span>
 183 |     | <span style='background-color: #eee;'>        string memory errorMessage</span>
 184 |     | <span style='background-color: #eee;'>    ) internal returns (bytes memory) {</span>
 185 |     | <span style='background-color: #eee;'>        (bool success, bytes memory returndata) = target.delegatecall(data);</span>
 186 |     | <span style='background-color: #eee;'>        return verifyCallResultFromTarget(target, success, returndata, errorMessage);</span>
 187 |     | <span style='background-color: #eee;'>    }</span>
 188 |     | <span style='background-color: #eee;'></span>
 189 |     | <span style='background-color: #eee;'>    /**</span>
 190 |     | <span style='background-color: #eee;'>     * @dev Tool to verify that a low level call to smart-contract was successful, and revert (either by bubbling</span>
 191 |     | <span style='background-color: #eee;'>     * the revert reason or using the provided one) in case of unsuccessful call or if target was not a contract.</span>
 192 |     | <span style='background-color: #eee;'>     *</span>
 193 |     | <span style='background-color: #eee;'>     * _Available since v4.8._</span>
 194 |     | <span style='background-color: #eee;'>     */</span>
 195 |     | <span style='background-color: #faa;'>    function verifyCallResultFromTarget(</span>
 196 |     | <span style='background-color: #eee;'>        address target,</span>
 197 |     | <span style='background-color: #eee;'>        bool success,</span>
 198 |     | <span style='background-color: #eee;'>        bytes memory returndata,</span>
 199 |     | <span style='background-color: #eee;'>        string memory errorMessage</span>
 200 |     | <span style='background-color: #eee;'>    ) internal view returns (bytes memory) {</span>
 201 |     | <span style='background-color: #faa;'>        if (success) {</span>
 202 |     | <span style='background-color: #faa;'>            if (returndata.length == 0) {</span>
 203 |     | <span style='background-color: #eee;'>                // only check isContract if the call was successful and the return data is empty</span>
 204 |     | <span style='background-color: #eee;'>                // otherwise we already know that it was a contract</span>
 205 |     | <span style='background-color: #eee;'>                require(isContract(target), &quot;Address: call to non-contract&quot;);</span>
 206 |     | <span style='background-color: #eee;'>            }</span>
 207 |     | <span style='background-color: #faa;'>            return returndata;</span>
 208 |     | <span style='background-color: #eee;'>        } else {</span>
 209 |     | <span style='background-color: #eee;'>            _revert(returndata, errorMessage);</span>
 210 |     | <span style='background-color: #eee;'>        }</span>
 211 |     | <span style='background-color: #eee;'>    }</span>
 212 |     | <span style='background-color: #eee;'></span>
 213 |     | <span style='background-color: #eee;'>    /**</span>
 214 |     | <span style='background-color: #eee;'>     * @dev Tool to verify that a low level call was successful, and revert if it wasn&#39;t, either by bubbling the</span>
 215 |     | <span style='background-color: #eee;'>     * revert reason or using the provided one.</span>
 216 |     | <span style='background-color: #eee;'>     *</span>
 217 |     | <span style='background-color: #eee;'>     * _Available since v4.3._</span>
 218 |     | <span style='background-color: #eee;'>     */</span>
 219 |     | <span style='background-color: #eee;'>    function verifyCallResult(</span>
 220 |     | <span style='background-color: #eee;'>        bool success,</span>
 221 |     | <span style='background-color: #eee;'>        bytes memory returndata,</span>
 222 |     | <span style='background-color: #eee;'>        string memory errorMessage</span>
 223 |     | <span style='background-color: #eee;'>    ) internal pure returns (bytes memory) {</span>
 224 |     | <span style='background-color: #eee;'>        if (success) {</span>
 225 |     | <span style='background-color: #eee;'>            return returndata;</span>
 226 |     | <span style='background-color: #eee;'>        } else {</span>
 227 |     | <span style='background-color: #eee;'>            _revert(returndata, errorMessage);</span>
 228 |     | <span style='background-color: #eee;'>        }</span>
 229 |     | <span style='background-color: #eee;'>    }</span>
 230 |     | <span style='background-color: #eee;'></span>
 231 |     | <span style='background-color: #eee;'>    function _revert(bytes memory returndata, string memory errorMessage) private pure {</span>
 232 |     | <span style='background-color: #eee;'>        // Look for revert reason and bubble it up if present</span>
 233 |     | <span style='background-color: #faa;'>        if (returndata.length &gt; 0) {</span>
 234 |     | <span style='background-color: #eee;'>            // The easiest way to bubble the revert reason is using memory via assembly</span>
 235 |     | <span style='background-color: #eee;'>            /// @solidity memory-safe-assembly</span>
 236 |     | <span style='background-color: #faa;'>            assembly {</span>
 237 |     | <span style='background-color: #eee;'>                let returndata_size := mload(returndata)</span>
 238 |     | <span style='background-color: #eee;'>                revert(add(32, returndata), returndata_size)</span>
 239 |     | <span style='background-color: #eee;'>            }</span>
 240 |     | <span style='background-color: #eee;'>        } else {</span>
 241 |     | <span style='background-color: #faa;'>            revert(errorMessage);</span>
 242 |     | <span style='background-color: #eee;'>        }</span>
 243 |     | <span style='background-color: #eee;'>    }</span>
 244 |     | <span style='background-color: #eee;'>}</span>
 245 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/utils/Context.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts v4.4.1 (utils/Context.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>/**</span>
  7 |     | <span style='background-color: #eee;'> * @dev Provides information about the current execution context, including the</span>
  8 |     | <span style='background-color: #eee;'> * sender of the transaction and its data. While these are generally available</span>
  9 |     | <span style='background-color: #eee;'> * via msg.sender and msg.data, they should not be accessed in such a direct</span>
 10 |     | <span style='background-color: #eee;'> * manner, since when dealing with meta-transactions the account sending and</span>
 11 |     | <span style='background-color: #eee;'> * paying for execution may not be the actual sender (as far as an application</span>
 12 |     | <span style='background-color: #eee;'> * is concerned).</span>
 13 |     | <span style='background-color: #eee;'> *</span>
 14 |     | <span style='background-color: #eee;'> * This contract is only required for intermediate, library-like contracts.</span>
 15 |     | <span style='background-color: #eee;'> */</span>
 16 |     | <span style='background-color: #eee;'>abstract contract Context {</span>
 17 |     | <span style='background-color: #eee;'>    function _msgSender() internal view virtual returns (address) {</span>
 18 |     | <span style='background-color: #faa;'>        return msg.sender;</span>
 19 |     | <span style='background-color: #eee;'>    }</span>
 20 |     | <span style='background-color: #eee;'></span>
 21 |     | <span style='background-color: #eee;'>    function _msgData() internal view virtual returns (bytes calldata) {</span>
 22 |     | <span style='background-color: #eee;'>        return msg.data;</span>
 23 |     | <span style='background-color: #eee;'>    }</span>
 24 |     | <span style='background-color: #eee;'>}</span>
 25 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/utils/Counters.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts v4.4.1 (utils/Counters.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>/**</span>
  7 |     | <span style='background-color: #eee;'> * @title Counters</span>
  8 |     | <span style='background-color: #eee;'> * @author Matt Condon (@shrugs)</span>
  9 |     | <span style='background-color: #eee;'> * @dev Provides counters that can only be incremented, decremented or reset. This can be used e.g. to track the number</span>
 10 |     | <span style='background-color: #eee;'> * of elements in a mapping, issuing ERC721 ids, or counting request ids.</span>
 11 |     | <span style='background-color: #eee;'> *</span>
 12 |     | <span style='background-color: #eee;'> * Include with `using Counters for Counters.Counter;`</span>
 13 |     | <span style='background-color: #faa;'> */</span>
 14 |     | <span style='background-color: #eee;'>library Counters {</span>
 15 |     | <span style='background-color: #eee;'>    struct Counter {</span>
 16 |     | <span style='background-color: #eee;'>        // This variable should never be directly accessed by users of the library: interactions must be restricted to</span>
 17 |     | <span style='background-color: #eee;'>        // the library&#39;s function. As of Solidity v0.5.2, this cannot be enforced, though there is a proposal to add</span>
 18 |     | <span style='background-color: #eee;'>        // this feature: see https://github.com/ethereum/solidity/issues/4637</span>
 19 |     | <span style='background-color: #eee;'>        uint256 _value; // default: 0</span>
 20 |     | <span style='background-color: #eee;'>    }</span>
 21 |     | <span style='background-color: #eee;'></span>
 22 |     | <span style='background-color: #eee;'>    function current(Counter storage counter) internal view returns (uint256) {</span>
 23 |     | <span style='background-color: #eee;'>        return counter._value;</span>
 24 |     | <span style='background-color: #eee;'>    }</span>
 25 |     | <span style='background-color: #eee;'></span>
 26 |     | <span style='background-color: #eee;'>    function increment(Counter storage counter) internal {</span>
 27 |     | <span style='background-color: #eee;'>        unchecked {</span>
 28 |     | <span style='background-color: #faa;'>            counter._value += 1;</span>
 29 |     | <span style='background-color: #eee;'>        }</span>
 30 |     | <span style='background-color: #eee;'>    }</span>
 31 |     | <span style='background-color: #eee;'></span>
 32 |     | <span style='background-color: #eee;'>    function decrement(Counter storage counter) internal {</span>
 33 |     | <span style='background-color: #eee;'>        uint256 value = counter._value;</span>
 34 |     | <span style='background-color: #eee;'>        require(value &gt; 0, &quot;Counter: decrement overflow&quot;);</span>
 35 |     | <span style='background-color: #eee;'>        unchecked {</span>
 36 |     | <span style='background-color: #eee;'>            counter._value = value - 1;</span>
 37 |     | <span style='background-color: #eee;'>        }</span>
 38 |     | <span style='background-color: #eee;'>    }</span>
 39 |     | <span style='background-color: #eee;'></span>
 40 |     | <span style='background-color: #eee;'>    function reset(Counter storage counter) internal {</span>
 41 |     | <span style='background-color: #eee;'>        counter._value = 0;</span>
 42 |     | <span style='background-color: #eee;'>    }</span>
 43 |     | <span style='background-color: #eee;'>}</span>
 44 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/utils/Strings.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.8.0) (utils/Strings.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>import &quot;./math/Math.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'></span>
  8 |     | <span style='background-color: #eee;'>/**</span>
  9 |     | <span style='background-color: #eee;'> * @dev String operations.</span>
 10 |     | <span style='background-color: #faa;'> */</span>
 11 |     | <span style='background-color: #eee;'>library Strings {</span>
 12 |     | <span style='background-color: #eee;'>    bytes16 private constant _SYMBOLS = &quot;0123456789abcdef&quot;;</span>
 13 |     | <span style='background-color: #eee;'>    uint8 private constant _ADDRESS_LENGTH = 20;</span>
 14 |     | <span style='background-color: #eee;'></span>
 15 |     | <span style='background-color: #eee;'>    /**</span>
 16 |     | <span style='background-color: #eee;'>     * @dev Converts a `uint256` to its ASCII `string` decimal representation.</span>
 17 |     | <span style='background-color: #eee;'>     */</span>
 18 |     | <span style='background-color: #faa;'>    function toString(uint256 value) internal pure returns (string memory) {</span>
 19 |     | <span style='background-color: #eee;'>        unchecked {</span>
 20 |     | <span style='background-color: #faa;'>            uint256 length = Math.log10(value) + 1;</span>
 21 |     | <span style='background-color: #eee;'>            string memory buffer = new string(length);</span>
 22 |     | <span style='background-color: #eee;'>            uint256 ptr;</span>
 23 |     | <span style='background-color: #eee;'>            /// @solidity memory-safe-assembly</span>
 24 |     | <span style='background-color: #faa;'>            assembly {</span>
 25 |     | <span style='background-color: #eee;'>                ptr := add(buffer, add(32, length))</span>
 26 |     | <span style='background-color: #eee;'>            }</span>
 27 |     | <span style='background-color: #faa;'>            while (true) {</span>
 28 |     | <span style='background-color: #eee;'>                ptr--;</span>
 29 |     | <span style='background-color: #eee;'>                /// @solidity memory-safe-assembly</span>
 30 |     | <span style='background-color: #faa;'>                assembly {</span>
 31 |     | <span style='background-color: #eee;'>                    mstore8(ptr, byte(mod(value, 10), _SYMBOLS))</span>
 32 |     | <span style='background-color: #eee;'>                }</span>
 33 |     | <span style='background-color: #eee;'>                value /= 10;</span>
 34 |     | <span style='background-color: #faa;'>                if (value == 0) break;</span>
 35 |     | <span style='background-color: #eee;'>            }</span>
 36 |     | <span style='background-color: #faa;'>            return buffer;</span>
 37 |     | <span style='background-color: #eee;'>        }</span>
 38 |     | <span style='background-color: #eee;'>    }</span>
 39 |     | <span style='background-color: #eee;'></span>
 40 |     | <span style='background-color: #eee;'>    /**</span>
 41 |     | <span style='background-color: #eee;'>     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation.</span>
 42 |     | <span style='background-color: #eee;'>     */</span>
 43 |     | <span style='background-color: #eee;'>    function toHexString(uint256 value) internal pure returns (string memory) {</span>
 44 |     | <span style='background-color: #eee;'>        unchecked {</span>
 45 |     | <span style='background-color: #eee;'>            return toHexString(value, Math.log256(value) + 1);</span>
 46 |     | <span style='background-color: #eee;'>        }</span>
 47 |     | <span style='background-color: #eee;'>    }</span>
 48 |     | <span style='background-color: #eee;'></span>
 49 |     | <span style='background-color: #eee;'>    /**</span>
 50 |     | <span style='background-color: #eee;'>     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation with fixed length.</span>
 51 |     | <span style='background-color: #eee;'>     */</span>
 52 |     | <span style='background-color: #eee;'>    function toHexString(uint256 value, uint256 length) internal pure returns (string memory) {</span>
 53 |     | <span style='background-color: #eee;'>        bytes memory buffer = new bytes(2 * length + 2);</span>
 54 |     | <span style='background-color: #eee;'>        buffer[0] = &quot;0&quot;;</span>
 55 |     | <span style='background-color: #eee;'>        buffer[1] = &quot;x&quot;;</span>
 56 |     | <span style='background-color: #eee;'>        for (uint256 i = 2 * length + 1; i &gt; 1; --i) {</span>
 57 |     | <span style='background-color: #eee;'>            buffer[i] = _SYMBOLS[value &amp; 0xf];</span>
 58 |     | <span style='background-color: #eee;'>            value &gt;&gt;= 4;</span>
 59 |     | <span style='background-color: #eee;'>        }</span>
 60 |     | <span style='background-color: #eee;'>        require(value == 0, &quot;Strings: hex length insufficient&quot;);</span>
 61 |     | <span style='background-color: #eee;'>        return string(buffer);</span>
 62 |     | <span style='background-color: #eee;'>    }</span>
 63 |     | <span style='background-color: #eee;'></span>
 64 |     | <span style='background-color: #eee;'>    /**</span>
 65 |     | <span style='background-color: #eee;'>     * @dev Converts an `address` with fixed length of 20 bytes to its not checksummed ASCII `string` hexadecimal representation.</span>
 66 |     | <span style='background-color: #eee;'>     */</span>
 67 |     | <span style='background-color: #eee;'>    function toHexString(address addr) internal pure returns (string memory) {</span>
 68 |     | <span style='background-color: #eee;'>        return toHexString(uint256(uint160(addr)), _ADDRESS_LENGTH);</span>
 69 |     | <span style='background-color: #eee;'>    }</span>
 70 |     | <span style='background-color: #eee;'>}</span>
 71 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/utils/cryptography/ECDSA.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.8.0) (utils/cryptography/ECDSA.sol)</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>import &quot;../Strings.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'></span>
   8 |     | <span style='background-color: #eee;'>/**</span>
   9 |     | <span style='background-color: #eee;'> * @dev Elliptic Curve Digital Signature Algorithm (ECDSA) operations.</span>
  10 |     | <span style='background-color: #eee;'> *</span>
  11 |     | <span style='background-color: #eee;'> * These functions can be used to verify that a message was signed by the holder</span>
  12 |     | <span style='background-color: #eee;'> * of the private keys of a given address.</span>
  13 |     | <span style='background-color: #faa;'> */</span>
  14 |     | <span style='background-color: #eee;'>library ECDSA {</span>
  15 |     | <span style='background-color: #eee;'>    enum RecoverError {</span>
  16 |     | <span style='background-color: #eee;'>        NoError,</span>
  17 |     | <span style='background-color: #eee;'>        InvalidSignature,</span>
  18 |     | <span style='background-color: #eee;'>        InvalidSignatureLength,</span>
  19 |     | <span style='background-color: #eee;'>        InvalidSignatureS,</span>
  20 |     | <span style='background-color: #eee;'>        InvalidSignatureV // Deprecated in v4.8</span>
  21 |     | <span style='background-color: #eee;'>    }</span>
  22 |     | <span style='background-color: #eee;'></span>
  23 |     | <span style='background-color: #faa;'>    function _throwError(RecoverError error) private pure {</span>
  24 |     | <span style='background-color: #faa;'>        if (error == RecoverError.NoError) {</span>
  25 |     | <span style='background-color: #faa;'>            return; // no error: do nothing</span>
  26 |     | <span style='background-color: #faa;'>        } else if (error == RecoverError.InvalidSignature) {</span>
  27 |     | <span style='background-color: #faa;'>            revert(&quot;ECDSA: invalid signature&quot;);</span>
  28 |     | <span style='background-color: #faa;'>        } else if (error == RecoverError.InvalidSignatureLength) {</span>
  29 |     | <span style='background-color: #faa;'>            revert(&quot;ECDSA: invalid signature length&quot;);</span>
  30 |     | <span style='background-color: #faa;'>        } else if (error == RecoverError.InvalidSignatureS) {</span>
  31 |     | <span style='background-color: #faa;'>            revert(&quot;ECDSA: invalid signature &#39;s&#39; value&quot;);</span>
  32 |     | <span style='background-color: #eee;'>        }</span>
  33 |     | <span style='background-color: #eee;'>    }</span>
  34 |     | <span style='background-color: #eee;'></span>
  35 |     | <span style='background-color: #eee;'>    /**</span>
  36 |     | <span style='background-color: #eee;'>     * @dev Returns the address that signed a hashed message (`hash`) with</span>
  37 |     | <span style='background-color: #eee;'>     * `signature` or error string. This address can then be used for verification purposes.</span>
  38 |     | <span style='background-color: #eee;'>     *</span>
  39 |     | <span style='background-color: #eee;'>     * The `ecrecover` EVM opcode allows for malleable (non-unique) signatures:</span>
  40 |     | <span style='background-color: #eee;'>     * this function rejects them by requiring the `s` value to be in the lower</span>
  41 |     | <span style='background-color: #eee;'>     * half order, and the `v` value to be either 27 or 28.</span>
  42 |     | <span style='background-color: #eee;'>     *</span>
  43 |     | <span style='background-color: #eee;'>     * IMPORTANT: `hash` _must_ be the result of a hash operation for the</span>
  44 |     | <span style='background-color: #eee;'>     * verification to be secure: it is possible to craft signatures that</span>
  45 |     | <span style='background-color: #eee;'>     * recover to arbitrary addresses for non-hashed data. A safe way to ensure</span>
  46 |     | <span style='background-color: #eee;'>     * this is by receiving a hash of the original message (which may otherwise</span>
  47 |     | <span style='background-color: #eee;'>     * be too long), and then calling {toEthSignedMessageHash} on it.</span>
  48 |     | <span style='background-color: #eee;'>     *</span>
  49 |     | <span style='background-color: #eee;'>     * Documentation for signature generation:</span>
  50 |     | <span style='background-color: #eee;'>     * - with https://web3js.readthedocs.io/en/v1.3.4/web3-eth-accounts.html#sign[Web3.js]</span>
  51 |     | <span style='background-color: #eee;'>     * - with https://docs.ethers.io/v5/api/signer/#Signer-signMessage[ethers]</span>
  52 |     | <span style='background-color: #eee;'>     *</span>
  53 |     | <span style='background-color: #eee;'>     * _Available since v4.3._</span>
  54 |     | <span style='background-color: #eee;'>     */</span>
  55 |     | <span style='background-color: #faa;'>    function tryRecover(bytes32 hash, bytes memory signature) internal pure returns (address, RecoverError) {</span>
  56 |     | <span style='background-color: #faa;'>        if (signature.length == 65) {</span>
  57 |     | <span style='background-color: #eee;'>            bytes32 r;</span>
  58 |     | <span style='background-color: #eee;'>            bytes32 s;</span>
  59 |     | <span style='background-color: #eee;'>            uint8 v;</span>
  60 |     | <span style='background-color: #eee;'>            // ecrecover takes the signature parameters, and the only way to get them</span>
  61 |     | <span style='background-color: #eee;'>            // currently is to use assembly.</span>
  62 |     | <span style='background-color: #eee;'>            /// @solidity memory-safe-assembly</span>
  63 |     | <span style='background-color: #faa;'>            assembly {</span>
  64 |     | <span style='background-color: #eee;'>                r := mload(add(signature, 0x20))</span>
  65 |     | <span style='background-color: #eee;'>                s := mload(add(signature, 0x40))</span>
  66 |     | <span style='background-color: #eee;'>                v := byte(0, mload(add(signature, 0x60)))</span>
  67 |     | <span style='background-color: #eee;'>            }</span>
  68 |     | <span style='background-color: #faa;'>            return tryRecover(hash, v, r, s);</span>
  69 |     | <span style='background-color: #eee;'>        } else {</span>
  70 |     | <span style='background-color: #faa;'>            return (address(0), RecoverError.InvalidSignatureLength);</span>
  71 |     | <span style='background-color: #eee;'>        }</span>
  72 |     | <span style='background-color: #eee;'>    }</span>
  73 |     | <span style='background-color: #eee;'></span>
  74 |     | <span style='background-color: #eee;'>    /**</span>
  75 |     | <span style='background-color: #eee;'>     * @dev Returns the address that signed a hashed message (`hash`) with</span>
  76 |     | <span style='background-color: #eee;'>     * `signature`. This address can then be used for verification purposes.</span>
  77 |     | <span style='background-color: #eee;'>     *</span>
  78 |     | <span style='background-color: #eee;'>     * The `ecrecover` EVM opcode allows for malleable (non-unique) signatures:</span>
  79 |     | <span style='background-color: #eee;'>     * this function rejects them by requiring the `s` value to be in the lower</span>
  80 |     | <span style='background-color: #eee;'>     * half order, and the `v` value to be either 27 or 28.</span>
  81 |     | <span style='background-color: #eee;'>     *</span>
  82 |     | <span style='background-color: #eee;'>     * IMPORTANT: `hash` _must_ be the result of a hash operation for the</span>
  83 |     | <span style='background-color: #eee;'>     * verification to be secure: it is possible to craft signatures that</span>
  84 |     | <span style='background-color: #eee;'>     * recover to arbitrary addresses for non-hashed data. A safe way to ensure</span>
  85 |     | <span style='background-color: #eee;'>     * this is by receiving a hash of the original message (which may otherwise</span>
  86 |     | <span style='background-color: #eee;'>     * be too long), and then calling {toEthSignedMessageHash} on it.</span>
  87 |     | <span style='background-color: #eee;'>     */</span>
  88 |     | <span style='background-color: #eee;'>    function recover(bytes32 hash, bytes memory signature) internal pure returns (address) {</span>
  89 |     | <span style='background-color: #faa;'>        (address recovered, RecoverError error) = tryRecover(hash, signature);</span>
  90 |     | <span style='background-color: #faa;'>        _throwError(error);</span>
  91 |     | <span style='background-color: #eee;'>        return recovered;</span>
  92 |     | <span style='background-color: #eee;'>    }</span>
  93 |     | <span style='background-color: #eee;'></span>
  94 |     | <span style='background-color: #eee;'>    /**</span>
  95 |     | <span style='background-color: #eee;'>     * @dev Overload of {ECDSA-tryRecover} that receives the `r` and `vs` short-signature fields separately.</span>
  96 |     | <span style='background-color: #eee;'>     *</span>
  97 |     | <span style='background-color: #eee;'>     * See https://eips.ethereum.org/EIPS/eip-2098[EIP-2098 short signatures]</span>
  98 |     | <span style='background-color: #eee;'>     *</span>
  99 |     | <span style='background-color: #eee;'>     * _Available since v4.3._</span>
 100 |     | <span style='background-color: #eee;'>     */</span>
 101 |     | <span style='background-color: #eee;'>    function tryRecover(</span>
 102 |     | <span style='background-color: #eee;'>        bytes32 hash,</span>
 103 |     | <span style='background-color: #eee;'>        bytes32 r,</span>
 104 |     | <span style='background-color: #eee;'>        bytes32 vs</span>
 105 |     | <span style='background-color: #eee;'>    ) internal pure returns (address, RecoverError) {</span>
 106 |     | <span style='background-color: #eee;'>        bytes32 s = vs &amp; bytes32(0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff);</span>
 107 |     | <span style='background-color: #eee;'>        uint8 v = uint8((uint256(vs) &gt;&gt; 255) + 27);</span>
 108 |     | <span style='background-color: #eee;'>        return tryRecover(hash, v, r, s);</span>
 109 |     | <span style='background-color: #eee;'>    }</span>
 110 |     | <span style='background-color: #eee;'></span>
 111 |     | <span style='background-color: #eee;'>    /**</span>
 112 |     | <span style='background-color: #eee;'>     * @dev Overload of {ECDSA-recover} that receives the `r and `vs` short-signature fields separately.</span>
 113 |     | <span style='background-color: #eee;'>     *</span>
 114 |     | <span style='background-color: #eee;'>     * _Available since v4.2._</span>
 115 |     | <span style='background-color: #eee;'>     */</span>
 116 |     | <span style='background-color: #eee;'>    function recover(</span>
 117 |     | <span style='background-color: #eee;'>        bytes32 hash,</span>
 118 |     | <span style='background-color: #eee;'>        bytes32 r,</span>
 119 |     | <span style='background-color: #eee;'>        bytes32 vs</span>
 120 |     | <span style='background-color: #eee;'>    ) internal pure returns (address) {</span>
 121 |     | <span style='background-color: #eee;'>        (address recovered, RecoverError error) = tryRecover(hash, r, vs);</span>
 122 |     | <span style='background-color: #eee;'>        _throwError(error);</span>
 123 |     | <span style='background-color: #eee;'>        return recovered;</span>
 124 |     | <span style='background-color: #eee;'>    }</span>
 125 |     | <span style='background-color: #eee;'></span>
 126 |     | <span style='background-color: #eee;'>    /**</span>
 127 |     | <span style='background-color: #eee;'>     * @dev Overload of {ECDSA-tryRecover} that receives the `v`,</span>
 128 |     | <span style='background-color: #eee;'>     * `r` and `s` signature fields separately.</span>
 129 |     | <span style='background-color: #eee;'>     *</span>
 130 |     | <span style='background-color: #eee;'>     * _Available since v4.3._</span>
 131 |     | <span style='background-color: #eee;'>     */</span>
 132 |     | <span style='background-color: #faa;'>    function tryRecover(</span>
 133 |     | <span style='background-color: #eee;'>        bytes32 hash,</span>
 134 |     | <span style='background-color: #eee;'>        uint8 v,</span>
 135 |     | <span style='background-color: #eee;'>        bytes32 r,</span>
 136 |     | <span style='background-color: #eee;'>        bytes32 s</span>
 137 |     | <span style='background-color: #eee;'>    ) internal pure returns (address, RecoverError) {</span>
 138 |     | <span style='background-color: #eee;'>        // EIP-2 still allows signature malleability for ecrecover(). Remove this possibility and make the signature</span>
 139 |     | <span style='background-color: #eee;'>        // unique. Appendix F in the Ethereum Yellow paper (https://ethereum.github.io/yellowpaper/paper.pdf), defines</span>
 140 |     | <span style='background-color: #eee;'>        // the valid range for s in (301): 0 &lt; s &lt; secp256k1n  2 + 1, and for v in (302): v  {27, 28}. Most</span>
 141 |     | <span style='background-color: #eee;'>        // signatures from current libraries generate a unique signature with an s-value in the lower half order.</span>
 142 |     | <span style='background-color: #eee;'>        //</span>
 143 |     | <span style='background-color: #eee;'>        // If your library generates malleable signatures, such as s-values in the upper range, calculate a new s-value</span>
 144 |     | <span style='background-color: #eee;'>        // with 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141 - s1 and flip v from 27 to 28 or</span>
 145 |     | <span style='background-color: #eee;'>        // vice versa. If your library also generates signatures with 0/1 for v instead 27/28, add 27 to v to accept</span>
 146 |     | <span style='background-color: #eee;'>        // these malleable signatures as well.</span>
 147 |     | <span style='background-color: #faa;'>        if (uint256(s) &gt; 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0) {</span>
 148 |     | <span style='background-color: #faa;'>            return (address(0), RecoverError.InvalidSignatureS);</span>
 149 |     | <span style='background-color: #eee;'>        }</span>
 150 |     | <span style='background-color: #eee;'></span>
 151 |     | <span style='background-color: #eee;'>        // If the signature is valid (and not malleable), return the signer address</span>
 152 |     | <span style='background-color: #faa;'>        address signer = ecrecover(hash, v, r, s);</span>
 153 |     | <span style='background-color: #faa;'>        if (signer == address(0)) {</span>
 154 |     | <span style='background-color: #faa;'>            return (address(0), RecoverError.InvalidSignature);</span>
 155 |     | <span style='background-color: #eee;'>        }</span>
 156 |     | <span style='background-color: #eee;'></span>
 157 |     | <span style='background-color: #faa;'>        return (signer, RecoverError.NoError);</span>
 158 |     | <span style='background-color: #eee;'>    }</span>
 159 |     | <span style='background-color: #eee;'></span>
 160 |     | <span style='background-color: #eee;'>    /**</span>
 161 |     | <span style='background-color: #eee;'>     * @dev Overload of {ECDSA-recover} that receives the `v`,</span>
 162 |     | <span style='background-color: #eee;'>     * `r` and `s` signature fields separately.</span>
 163 |     | <span style='background-color: #eee;'>     */</span>
 164 |     | <span style='background-color: #eee;'>    function recover(</span>
 165 |     | <span style='background-color: #eee;'>        bytes32 hash,</span>
 166 |     | <span style='background-color: #eee;'>        uint8 v,</span>
 167 |     | <span style='background-color: #eee;'>        bytes32 r,</span>
 168 |     | <span style='background-color: #eee;'>        bytes32 s</span>
 169 |     | <span style='background-color: #eee;'>    ) internal pure returns (address) {</span>
 170 |     | <span style='background-color: #eee;'>        (address recovered, RecoverError error) = tryRecover(hash, v, r, s);</span>
 171 |     | <span style='background-color: #eee;'>        _throwError(error);</span>
 172 |     | <span style='background-color: #eee;'>        return recovered;</span>
 173 |     | <span style='background-color: #eee;'>    }</span>
 174 |     | <span style='background-color: #eee;'></span>
 175 |     | <span style='background-color: #eee;'>    /**</span>
 176 |     | <span style='background-color: #eee;'>     * @dev Returns an Ethereum Signed Message, created from a `hash`. This</span>
 177 |     | <span style='background-color: #eee;'>     * produces hash corresponding to the one signed with the</span>
 178 |     | <span style='background-color: #eee;'>     * https://eth.wiki/json-rpc/API#eth_sign[`eth_sign`]</span>
 179 |     | <span style='background-color: #eee;'>     * JSON-RPC method as part of EIP-191.</span>
 180 |     | <span style='background-color: #eee;'>     *</span>
 181 |     | <span style='background-color: #eee;'>     * See {recover}.</span>
 182 |     | <span style='background-color: #eee;'>     */</span>
 183 |     | <span style='background-color: #eee;'>    function toEthSignedMessageHash(bytes32 hash) internal pure returns (bytes32) {</span>
 184 |     | <span style='background-color: #eee;'>        // 32 is the length in bytes of hash,</span>
 185 |     | <span style='background-color: #eee;'>        // enforced by the type signature above</span>
 186 |     | <span style='background-color: #eee;'>        return keccak256(abi.encodePacked(&quot;\x19Ethereum Signed Message:\n32&quot;, hash));</span>
 187 |     | <span style='background-color: #eee;'>    }</span>
 188 |     | <span style='background-color: #eee;'></span>
 189 |     | <span style='background-color: #eee;'>    /**</span>
 190 |     | <span style='background-color: #eee;'>     * @dev Returns an Ethereum Signed Message, created from `s`. This</span>
 191 |     | <span style='background-color: #eee;'>     * produces hash corresponding to the one signed with the</span>
 192 |     | <span style='background-color: #eee;'>     * https://eth.wiki/json-rpc/API#eth_sign[`eth_sign`]</span>
 193 |     | <span style='background-color: #eee;'>     * JSON-RPC method as part of EIP-191.</span>
 194 |     | <span style='background-color: #eee;'>     *</span>
 195 |     | <span style='background-color: #eee;'>     * See {recover}.</span>
 196 |     | <span style='background-color: #eee;'>     */</span>
 197 |     | <span style='background-color: #eee;'>    function toEthSignedMessageHash(bytes memory s) internal pure returns (bytes32) {</span>
 198 |     | <span style='background-color: #eee;'>        return keccak256(abi.encodePacked(&quot;\x19Ethereum Signed Message:\n&quot;, Strings.toString(s.length), s));</span>
 199 |     | <span style='background-color: #eee;'>    }</span>
 200 |     | <span style='background-color: #eee;'></span>
 201 |     | <span style='background-color: #eee;'>    /**</span>
 202 |     | <span style='background-color: #eee;'>     * @dev Returns an Ethereum Signed Typed Data, created from a</span>
 203 |     | <span style='background-color: #eee;'>     * `domainSeparator` and a `structHash`. This produces hash corresponding</span>
 204 |     | <span style='background-color: #eee;'>     * to the one signed with the</span>
 205 |     | <span style='background-color: #eee;'>     * https://eips.ethereum.org/EIPS/eip-712[`eth_signTypedData`]</span>
 206 |     | <span style='background-color: #eee;'>     * JSON-RPC method as part of EIP-712.</span>
 207 |     | <span style='background-color: #eee;'>     *</span>
 208 |     | <span style='background-color: #eee;'>     * See {recover}.</span>
 209 |     | <span style='background-color: #eee;'>     */</span>
 210 |     | <span style='background-color: #eee;'>    function toTypedDataHash(bytes32 domainSeparator, bytes32 structHash) internal pure returns (bytes32) {</span>
 211 |     | <span style='background-color: #faa;'>        return keccak256(abi.encodePacked(&quot;\x19\x01&quot;, domainSeparator, structHash));</span>
 212 |     | <span style='background-color: #eee;'>    }</span>
 213 |     | <span style='background-color: #eee;'>}</span>
 214 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/utils/cryptography/EIP712.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.8.0) (utils/cryptography/EIP712.sol)</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>import &quot;./ECDSA.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'></span>
   8 |     | <span style='background-color: #eee;'>/**</span>
   9 |     | <span style='background-color: #eee;'> * @dev https://eips.ethereum.org/EIPS/eip-712[EIP 712] is a standard for hashing and signing of typed structured data.</span>
  10 |     | <span style='background-color: #eee;'> *</span>
  11 |     | <span style='background-color: #eee;'> * The encoding specified in the EIP is very generic, and such a generic implementation in Solidity is not feasible,</span>
  12 |     | <span style='background-color: #eee;'> * thus this contract does not implement the encoding itself. Protocols need to implement the type-specific encoding</span>
  13 |     | <span style='background-color: #eee;'> * they need in their contracts using a combination of `abi.encode` and `keccak256`.</span>
  14 |     | <span style='background-color: #eee;'> *</span>
  15 |     | <span style='background-color: #eee;'> * This contract implements the EIP 712 domain separator ({_domainSeparatorV4}) that is used as part of the encoding</span>
  16 |     | <span style='background-color: #eee;'> * scheme, and the final step of the encoding to obtain the message digest that is then signed via ECDSA</span>
  17 |     | <span style='background-color: #eee;'> * ({_hashTypedDataV4}).</span>
  18 |     | <span style='background-color: #eee;'> *</span>
  19 |     | <span style='background-color: #eee;'> * The implementation of the domain separator was designed to be as efficient as possible while still properly updating</span>
  20 |     | <span style='background-color: #eee;'> * the chain id to protect against replay attacks on an eventual fork of the chain.</span>
  21 |     | <span style='background-color: #eee;'> *</span>
  22 |     | <span style='background-color: #eee;'> * NOTE: This contract implements the version of the encoding known as &quot;v4&quot;, as implemented by the JSON RPC method</span>
  23 |     | <span style='background-color: #eee;'> * https://docs.metamask.io/guide/signing-data.html[`eth_signTypedDataV4` in MetaMask].</span>
  24 |     | <span style='background-color: #eee;'> *</span>
  25 |     | <span style='background-color: #eee;'> * _Available since v3.4._</span>
  26 |     | <span style='background-color: #eee;'> */</span>
  27 |     | <span style='background-color: #eee;'>abstract contract EIP712 {</span>
  28 |     | <span style='background-color: #eee;'>    /* solhint-disable var-name-mixedcase */</span>
  29 |     | <span style='background-color: #eee;'>    // Cache the domain separator as an immutable value, but also store the chain id that it corresponds to, in order to</span>
  30 |     | <span style='background-color: #eee;'>    // invalidate the cached domain separator if the chain id changes.</span>
  31 |     | <span style='background-color: #eee;'>    bytes32 private immutable _CACHED_DOMAIN_SEPARATOR;</span>
  32 |     | <span style='background-color: #eee;'>    uint256 private immutable _CACHED_CHAIN_ID;</span>
  33 |     | <span style='background-color: #eee;'>    address private immutable _CACHED_THIS;</span>
  34 |     | <span style='background-color: #eee;'></span>
  35 |     | <span style='background-color: #eee;'>    bytes32 private immutable _HASHED_NAME;</span>
  36 |     | <span style='background-color: #eee;'>    bytes32 private immutable _HASHED_VERSION;</span>
  37 |     | <span style='background-color: #eee;'>    bytes32 private immutable _TYPE_HASH;</span>
  38 |     | <span style='background-color: #eee;'></span>
  39 |     | <span style='background-color: #eee;'>    /* solhint-enable var-name-mixedcase */</span>
  40 |     | <span style='background-color: #eee;'></span>
  41 |     | <span style='background-color: #eee;'>    /**</span>
  42 |     | <span style='background-color: #eee;'>     * @dev Initializes the domain separator and parameter caches.</span>
  43 |     | <span style='background-color: #eee;'>     *</span>
  44 |     | <span style='background-color: #eee;'>     * The meaning of `name` and `version` is specified in</span>
  45 |     | <span style='background-color: #eee;'>     * https://eips.ethereum.org/EIPS/eip-712#definition-of-domainseparator[EIP 712]:</span>
  46 |     | <span style='background-color: #eee;'>     *</span>
  47 |     | <span style='background-color: #eee;'>     * - `name`: the user readable name of the signing domain, i.e. the name of the DApp or the protocol.</span>
  48 |     | <span style='background-color: #eee;'>     * - `version`: the current major version of the signing domain.</span>
  49 |     | <span style='background-color: #eee;'>     *</span>
  50 |     | <span style='background-color: #eee;'>     * NOTE: These parameters cannot be changed except through a xref:learn::upgrading-smart-contracts.adoc[smart</span>
  51 |     | <span style='background-color: #eee;'>     * contract upgrade].</span>
  52 |     | <span style='background-color: #eee;'>     */</span>
  53 |     | <span style='background-color: #eee;'>    constructor(string memory name, string memory version) {</span>
  54 |     | <span style='background-color: #faa;'>        bytes32 hashedName = keccak256(bytes(name));</span>
  55 |     | <span style='background-color: #faa;'>        bytes32 hashedVersion = keccak256(bytes(version));</span>
  56 |     | <span style='background-color: #faa;'>        bytes32 typeHash = keccak256(</span>
  57 |     | <span style='background-color: #eee;'>            &quot;EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)&quot;</span>
  58 |     | <span style='background-color: #eee;'>        );</span>
  59 |     | <span style='background-color: #faa;'>        _HASHED_NAME = hashedName;</span>
  60 |     | <span style='background-color: #faa;'>        _HASHED_VERSION = hashedVersion;</span>
  61 |     | <span style='background-color: #faa;'>        _CACHED_CHAIN_ID = block.chainid;</span>
  62 |     | <span style='background-color: #faa;'>        _CACHED_DOMAIN_SEPARATOR = _buildDomainSeparator(typeHash, hashedName, hashedVersion);</span>
  63 |     | <span style='background-color: #faa;'>        _CACHED_THIS = address(this);</span>
  64 |     | <span style='background-color: #faa;'>        _TYPE_HASH = typeHash;</span>
  65 |     | <span style='background-color: #eee;'>    }</span>
  66 |     | <span style='background-color: #eee;'></span>
  67 |     | <span style='background-color: #eee;'>    /**</span>
  68 |     | <span style='background-color: #eee;'>     * @dev Returns the domain separator for the current chain.</span>
  69 |     | <span style='background-color: #eee;'>     */</span>
  70 |     | <span style='background-color: #faa;'>    function _domainSeparatorV4() internal view returns (bytes32) {</span>
  71 |     | <span style='background-color: #faa;'>        if (address(this) == _CACHED_THIS &amp;&amp; block.chainid == _CACHED_CHAIN_ID) {</span>
  72 |     | <span style='background-color: #faa;'>            return _CACHED_DOMAIN_SEPARATOR;</span>
  73 |     | <span style='background-color: #eee;'>        } else {</span>
  74 |     | <span style='background-color: #faa;'>            return _buildDomainSeparator(_TYPE_HASH, _HASHED_NAME, _HASHED_VERSION);</span>
  75 |     | <span style='background-color: #eee;'>        }</span>
  76 |     | <span style='background-color: #eee;'>    }</span>
  77 |     | <span style='background-color: #eee;'></span>
  78 |     | <span style='background-color: #eee;'>    function _buildDomainSeparator(</span>
  79 |     | <span style='background-color: #eee;'>        bytes32 typeHash,</span>
  80 |     | <span style='background-color: #eee;'>        bytes32 nameHash,</span>
  81 |     | <span style='background-color: #eee;'>        bytes32 versionHash</span>
  82 |     | <span style='background-color: #eee;'>    ) private view returns (bytes32) {</span>
  83 |     | <span style='background-color: #faa;'>        return keccak256(abi.encode(typeHash, nameHash, versionHash, block.chainid, address(this)));</span>
  84 |     | <span style='background-color: #eee;'>    }</span>
  85 |     | <span style='background-color: #eee;'></span>
  86 |     | <span style='background-color: #eee;'>    /**</span>
  87 |     | <span style='background-color: #eee;'>     * @dev Given an already https://eips.ethereum.org/EIPS/eip-712#definition-of-hashstruct[hashed struct], this</span>
  88 |     | <span style='background-color: #eee;'>     * function returns the hash of the fully encoded EIP712 message for this domain.</span>
  89 |     | <span style='background-color: #eee;'>     *</span>
  90 |     | <span style='background-color: #eee;'>     * This hash can be used together with {ECDSA-recover} to obtain the signer of a message. For example:</span>
  91 |     | <span style='background-color: #eee;'>     *</span>
  92 |     | <span style='background-color: #eee;'>     * ```solidity</span>
  93 |     | <span style='background-color: #eee;'>     * bytes32 digest = _hashTypedDataV4(keccak256(abi.encode(</span>
  94 |     | <span style='background-color: #eee;'>     *     keccak256(&quot;Mail(address to,string contents)&quot;),</span>
  95 |     | <span style='background-color: #eee;'>     *     mailTo,</span>
  96 |     | <span style='background-color: #eee;'>     *     keccak256(bytes(mailContents))</span>
  97 |     | <span style='background-color: #eee;'>     * )));</span>
  98 |     | <span style='background-color: #eee;'>     * address signer = ECDSA.recover(digest, signature);</span>
  99 |     | <span style='background-color: #eee;'>     * ```</span>
 100 |     | <span style='background-color: #eee;'>     */</span>
 101 |     | <span style='background-color: #faa;'>    function _hashTypedDataV4(bytes32 structHash) internal view virtual returns (bytes32) {</span>
 102 |     | <span style='background-color: #faa;'>        return ECDSA.toTypedDataHash(_domainSeparatorV4(), structHash);</span>
 103 |     | <span style='background-color: #eee;'>    }</span>
 104 |     | <span style='background-color: #eee;'>}</span>
 105 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/utils/cryptography/SignatureChecker.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.8.0) (utils/cryptography/SignatureChecker.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>import &quot;./ECDSA.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'>import &quot;../Address.sol&quot;;</span>
  8 |     | <span style='background-color: #eee;'>import &quot;../../interfaces/IERC1271.sol&quot;;</span>
  9 |     | <span style='background-color: #eee;'></span>
 10 |     | <span style='background-color: #eee;'>/**</span>
 11 |     | <span style='background-color: #eee;'> * @dev Signature verification helper that can be used instead of `ECDSA.recover` to seamlessly support both ECDSA</span>
 12 |     | <span style='background-color: #eee;'> * signatures from externally owned accounts (EOAs) as well as ERC1271 signatures from smart contract wallets like</span>
 13 |     | <span style='background-color: #eee;'> * Argent and Gnosis Safe.</span>
 14 |     | <span style='background-color: #eee;'> *</span>
 15 |     | <span style='background-color: #eee;'> * _Available since v4.1._</span>
 16 |     | <span style='background-color: #faa;'> */</span>
 17 |     | <span style='background-color: #eee;'>library SignatureChecker {</span>
 18 |     | <span style='background-color: #eee;'>    /**</span>
 19 |     | <span style='background-color: #eee;'>     * @dev Checks if a signature is valid for a given signer and data hash. If the signer is a smart contract, the</span>
 20 |     | <span style='background-color: #eee;'>     * signature is validated against that smart contract using ERC1271, otherwise it&#39;s validated using `ECDSA.recover`.</span>
 21 |     | <span style='background-color: #eee;'>     *</span>
 22 |     | <span style='background-color: #eee;'>     * NOTE: Unlike ECDSA signatures, contract signatures are revocable, and the outcome of this function can thus</span>
 23 |     | <span style='background-color: #eee;'>     * change through time. It could return true at block N and false at block N+1 (or the opposite).</span>
 24 |     | <span style='background-color: #eee;'>     */</span>
 25 |     | <span style='background-color: #faa;'>    function isValidSignatureNow(</span>
 26 |     | <span style='background-color: #eee;'>        address signer,</span>
 27 |     | <span style='background-color: #eee;'>        bytes32 hash,</span>
 28 |     | <span style='background-color: #eee;'>        bytes memory signature</span>
 29 |     | <span style='background-color: #eee;'>    ) internal view returns (bool) {</span>
 30 |     | <span style='background-color: #faa;'>        (address recovered, ECDSA.RecoverError error) = ECDSA.tryRecover(hash, signature);</span>
 31 |     | <span style='background-color: #faa;'>        if (error == ECDSA.RecoverError.NoError &amp;&amp; recovered == signer) {</span>
 32 |     | <span style='background-color: #faa;'>            return true;</span>
 33 |     | <span style='background-color: #eee;'>        }</span>
 34 |     | <span style='background-color: #eee;'></span>
 35 |     | <span style='background-color: #faa;'>        (bool success, bytes memory result) = signer.staticcall(</span>
 36 |     | <span style='background-color: #faa;'>            abi.encodeWithSelector(IERC1271.isValidSignature.selector, hash, signature)</span>
 37 |     | <span style='background-color: #eee;'>        );</span>
 38 |     | <span style='background-color: #faa;'>        return (success &amp;&amp;</span>
 39 |     | <span style='background-color: #faa;'>            result.length == 32 &amp;&amp;</span>
 40 |     | <span style='background-color: #faa;'>            abi.decode(result, (bytes32)) == bytes32(IERC1271.isValidSignature.selector));</span>
 41 |     | <span style='background-color: #eee;'>    }</span>
 42 |     | <span style='background-color: #eee;'>}</span>
 43 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/utils/introspection/ERC165.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts v4.4.1 (utils/introspection/ERC165.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>import &quot;./IERC165.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'></span>
  8 |     | <span style='background-color: #eee;'>/**</span>
  9 |     | <span style='background-color: #eee;'> * @dev Implementation of the {IERC165} interface.</span>
 10 |     | <span style='background-color: #eee;'> *</span>
 11 |     | <span style='background-color: #eee;'> * Contracts that want to implement ERC165 should inherit from this contract and override {supportsInterface} to check</span>
 12 |     | <span style='background-color: #eee;'> * for the additional interface id that will be supported. For example:</span>
 13 |     | <span style='background-color: #eee;'> *</span>
 14 |     | <span style='background-color: #eee;'> * ```solidity</span>
 15 |     | <span style='background-color: #eee;'> * function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {</span>
 16 |     | <span style='background-color: #eee;'> *     return interfaceId == type(MyInterface).interfaceId || super.supportsInterface(interfaceId);</span>
 17 |     | <span style='background-color: #eee;'> * }</span>
 18 |     | <span style='background-color: #eee;'> * ```</span>
 19 |     | <span style='background-color: #eee;'> *</span>
 20 |     | <span style='background-color: #eee;'> * Alternatively, {ERC165Storage} provides an easier to use but more expensive implementation.</span>
 21 |     | <span style='background-color: #eee;'> */</span>
 22 |     | <span style='background-color: #eee;'>abstract contract ERC165 is IERC165 {</span>
 23 |     | <span style='background-color: #eee;'>    /**</span>
 24 |     | <span style='background-color: #eee;'>     * @dev See {IERC165-supportsInterface}.</span>
 25 |     | <span style='background-color: #eee;'>     */</span>
 26 |     | <span style='background-color: #eee;'>    function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {</span>
 27 |     | <span style='background-color: #faa;'>        return interfaceId == type(IERC165).interfaceId;</span>
 28 |     | <span style='background-color: #eee;'>    }</span>
 29 |     | <span style='background-color: #eee;'>}</span>
 30 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/utils/introspection/IERC165.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts v4.4.1 (utils/introspection/IERC165.sol)</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>/**</span>
  7 |     | <span style='background-color: #eee;'> * @dev Interface of the ERC165 standard, as defined in the</span>
  8 |     | <span style='background-color: #eee;'> * https://eips.ethereum.org/EIPS/eip-165[EIP].</span>
  9 |     | <span style='background-color: #eee;'> *</span>
 10 |     | <span style='background-color: #eee;'> * Implementers can declare support of contract interfaces, which can then be</span>
 11 |     | <span style='background-color: #eee;'> * queried by others ({ERC165Checker}).</span>
 12 |     | <span style='background-color: #eee;'> *</span>
 13 |     | <span style='background-color: #eee;'> * For an implementation, see {ERC165}.</span>
 14 |     | <span style='background-color: #eee;'> */</span>
 15 |     | <span style='background-color: #eee;'>interface IERC165 {</span>
 16 |     | <span style='background-color: #eee;'>    /**</span>
 17 |     | <span style='background-color: #eee;'>     * @dev Returns true if this contract implements the interface defined by</span>
 18 |     | <span style='background-color: #eee;'>     * `interfaceId`. See the corresponding</span>
 19 |     | <span style='background-color: #eee;'>     * https://eips.ethereum.org/EIPS/eip-165#how-interfaces-are-identified[EIP section]</span>
 20 |     | <span style='background-color: #eee;'>     * to learn more about how these ids are created.</span>
 21 |     | <span style='background-color: #eee;'>     *</span>
 22 |     | <span style='background-color: #eee;'>     * This function call must use less than 30 000 gas.</span>
 23 |     | <span style='background-color: #eee;'>     */</span>
 24 |     | <span style='background-color: #eee;'>    function supportsInterface(bytes4 interfaceId) external view returns (bool);</span>
 25 |     | <span style='background-color: #eee;'>}</span>
 26 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/utils/math/Math.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.8.0) (utils/math/Math.sol)</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>/**</span>
   7 |     | <span style='background-color: #eee;'> * @dev Standard math utilities missing in the Solidity language.</span>
   8 |     | <span style='background-color: #eee;'> */</span>
   9 |     | <span style='background-color: #eee;'>library Math {</span>
  10 |     | <span style='background-color: #eee;'>    enum Rounding {</span>
  11 |     | <span style='background-color: #eee;'>        Down, // Toward negative infinity</span>
  12 |     | <span style='background-color: #eee;'>        Up, // Toward infinity</span>
  13 |     | <span style='background-color: #eee;'>        Zero // Toward zero</span>
  14 |     | <span style='background-color: #eee;'>    }</span>
  15 |     | <span style='background-color: #eee;'></span>
  16 |     | <span style='background-color: #eee;'>    /**</span>
  17 |     | <span style='background-color: #eee;'>     * @dev Returns the largest of two numbers.</span>
  18 |     | <span style='background-color: #eee;'>     */</span>
  19 |     | <span style='background-color: #eee;'>    function max(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  20 |     | <span style='background-color: #eee;'>        return a &gt; b ? a : b;</span>
  21 |     | <span style='background-color: #eee;'>    }</span>
  22 |     | <span style='background-color: #eee;'></span>
  23 |     | <span style='background-color: #eee;'>    /**</span>
  24 |     | <span style='background-color: #eee;'>     * @dev Returns the smallest of two numbers.</span>
  25 |     | <span style='background-color: #eee;'>     */</span>
  26 |     | <span style='background-color: #eee;'>    function min(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  27 |     | <span style='background-color: #eee;'>        return a &lt; b ? a : b;</span>
  28 |     | <span style='background-color: #eee;'>    }</span>
  29 |     | <span style='background-color: #eee;'></span>
  30 |     | <span style='background-color: #eee;'>    /**</span>
  31 |     | <span style='background-color: #eee;'>     * @dev Returns the average of two numbers. The result is rounded towards</span>
  32 |     | <span style='background-color: #eee;'>     * zero.</span>
  33 |     | <span style='background-color: #eee;'>     */</span>
  34 |     | <span style='background-color: #eee;'>    function average(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  35 |     | <span style='background-color: #eee;'>        // (a + b) / 2 can overflow.</span>
  36 |     | <span style='background-color: #eee;'>        return (a &amp; b) + (a ^ b) / 2;</span>
  37 |     | <span style='background-color: #eee;'>    }</span>
  38 |     | <span style='background-color: #eee;'></span>
  39 |     | <span style='background-color: #eee;'>    /**</span>
  40 |     | <span style='background-color: #eee;'>     * @dev Returns the ceiling of the division of two numbers.</span>
  41 |     | <span style='background-color: #eee;'>     *</span>
  42 |     | <span style='background-color: #eee;'>     * This differs from standard division with `/` in that it rounds up instead</span>
  43 |     | <span style='background-color: #eee;'>     * of rounding down.</span>
  44 |     | <span style='background-color: #eee;'>     */</span>
  45 |     | <span style='background-color: #eee;'>    function ceilDiv(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  46 |     | <span style='background-color: #eee;'>        // (a + b - 1) / b can overflow on addition, so we distribute.</span>
  47 |     | <span style='background-color: #eee;'>        return a == 0 ? 0 : (a - 1) / b + 1;</span>
  48 |     | <span style='background-color: #eee;'>    }</span>
  49 |     | <span style='background-color: #eee;'></span>
  50 |     | <span style='background-color: #eee;'>    /**</span>
  51 |     | <span style='background-color: #eee;'>     * @notice Calculates floor(x * y / denominator) with full precision. Throws if result overflows a uint256 or denominator == 0</span>
  52 |     | <span style='background-color: #eee;'>     * @dev Original credit to Remco Bloemen under MIT license (https://xn--2-umb.com/21/muldiv)</span>
  53 |     | <span style='background-color: #eee;'>     * with further edits by Uniswap Labs also under MIT license.</span>
  54 |     | <span style='background-color: #eee;'>     */</span>
  55 |     | <span style='background-color: #eee;'>    function mulDiv(</span>
  56 |     | <span style='background-color: #eee;'>        uint256 x,</span>
  57 |     | <span style='background-color: #eee;'>        uint256 y,</span>
  58 |     | <span style='background-color: #eee;'>        uint256 denominator</span>
  59 |     | <span style='background-color: #eee;'>    ) internal pure returns (uint256 result) {</span>
  60 |     | <span style='background-color: #eee;'>        unchecked {</span>
  61 |     | <span style='background-color: #eee;'>            // 512-bit multiply [prod1 prod0] = x * y. Compute the product mod 2^256 and mod 2^256 - 1, then use</span>
  62 |     | <span style='background-color: #eee;'>            // use the Chinese Remainder Theorem to reconstruct the 512 bit result. The result is stored in two 256</span>
  63 |     | <span style='background-color: #eee;'>            // variables such that product = prod1 * 2^256 + prod0.</span>
  64 |     | <span style='background-color: #eee;'>            uint256 prod0; // Least significant 256 bits of the product</span>
  65 |     | <span style='background-color: #eee;'>            uint256 prod1; // Most significant 256 bits of the product</span>
  66 |     | <span style='background-color: #eee;'>            assembly {</span>
  67 |     | <span style='background-color: #eee;'>                let mm := mulmod(x, y, not(0))</span>
  68 |     | <span style='background-color: #eee;'>                prod0 := mul(x, y)</span>
  69 |     | <span style='background-color: #eee;'>                prod1 := sub(sub(mm, prod0), lt(mm, prod0))</span>
  70 |     | <span style='background-color: #eee;'>            }</span>
  71 |     | <span style='background-color: #eee;'></span>
  72 |     | <span style='background-color: #eee;'>            // Handle non-overflow cases, 256 by 256 division.</span>
  73 |     | <span style='background-color: #eee;'>            if (prod1 == 0) {</span>
  74 |     | <span style='background-color: #eee;'>                return prod0 / denominator;</span>
  75 |     | <span style='background-color: #eee;'>            }</span>
  76 |     | <span style='background-color: #eee;'></span>
  77 |     | <span style='background-color: #eee;'>            // Make sure the result is less than 2^256. Also prevents denominator == 0.</span>
  78 |     | <span style='background-color: #eee;'>            require(denominator &gt; prod1);</span>
  79 |     | <span style='background-color: #eee;'></span>
  80 |     | <span style='background-color: #eee;'>            ///////////////////////////////////////////////</span>
  81 |     | <span style='background-color: #eee;'>            // 512 by 256 division.</span>
  82 |     | <span style='background-color: #eee;'>            ///////////////////////////////////////////////</span>
  83 |     | <span style='background-color: #eee;'></span>
  84 |     | <span style='background-color: #eee;'>            // Make division exact by subtracting the remainder from [prod1 prod0].</span>
  85 |     | <span style='background-color: #eee;'>            uint256 remainder;</span>
  86 |     | <span style='background-color: #eee;'>            assembly {</span>
  87 |     | <span style='background-color: #eee;'>                // Compute remainder using mulmod.</span>
  88 |     | <span style='background-color: #eee;'>                remainder := mulmod(x, y, denominator)</span>
  89 |     | <span style='background-color: #eee;'></span>
  90 |     | <span style='background-color: #eee;'>                // Subtract 256 bit number from 512 bit number.</span>
  91 |     | <span style='background-color: #eee;'>                prod1 := sub(prod1, gt(remainder, prod0))</span>
  92 |     | <span style='background-color: #eee;'>                prod0 := sub(prod0, remainder)</span>
  93 |     | <span style='background-color: #eee;'>            }</span>
  94 |     | <span style='background-color: #eee;'></span>
  95 |     | <span style='background-color: #eee;'>            // Factor powers of two out of denominator and compute largest power of two divisor of denominator. Always &gt;= 1.</span>
  96 |     | <span style='background-color: #eee;'>            // See https://cs.stackexchange.com/q/138556/92363.</span>
  97 |     | <span style='background-color: #eee;'></span>
  98 |     | <span style='background-color: #eee;'>            // Does not overflow because the denominator cannot be zero at this stage in the function.</span>
  99 |     | <span style='background-color: #eee;'>            uint256 twos = denominator &amp; (~denominator + 1);</span>
 100 |     | <span style='background-color: #eee;'>            assembly {</span>
 101 |     | <span style='background-color: #eee;'>                // Divide denominator by twos.</span>
 102 |     | <span style='background-color: #eee;'>                denominator := div(denominator, twos)</span>
 103 |     | <span style='background-color: #eee;'></span>
 104 |     | <span style='background-color: #eee;'>                // Divide [prod1 prod0] by twos.</span>
 105 |     | <span style='background-color: #eee;'>                prod0 := div(prod0, twos)</span>
 106 |     | <span style='background-color: #eee;'></span>
 107 |     | <span style='background-color: #eee;'>                // Flip twos such that it is 2^256 / twos. If twos is zero, then it becomes one.</span>
 108 |     | <span style='background-color: #eee;'>                twos := add(div(sub(0, twos), twos), 1)</span>
 109 |     | <span style='background-color: #eee;'>            }</span>
 110 |     | <span style='background-color: #eee;'></span>
 111 |     | <span style='background-color: #eee;'>            // Shift in bits from prod1 into prod0.</span>
 112 |     | <span style='background-color: #eee;'>            prod0 |= prod1 * twos;</span>
 113 |     | <span style='background-color: #eee;'></span>
 114 |     | <span style='background-color: #eee;'>            // Invert denominator mod 2^256. Now that denominator is an odd number, it has an inverse modulo 2^256 such</span>
 115 |     | <span style='background-color: #eee;'>            // that denominator * inv = 1 mod 2^256. Compute the inverse by starting with a seed that is correct for</span>
 116 |     | <span style='background-color: #eee;'>            // four bits. That is, denominator * inv = 1 mod 2^4.</span>
 117 |     | <span style='background-color: #eee;'>            uint256 inverse = (3 * denominator) ^ 2;</span>
 118 |     | <span style='background-color: #eee;'></span>
 119 |     | <span style='background-color: #eee;'>            // Use the Newton-Raphson iteration to improve the precision. Thanks to Hensel&#39;s lifting lemma, this also works</span>
 120 |     | <span style='background-color: #eee;'>            // in modular arithmetic, doubling the correct bits in each step.</span>
 121 |     | <span style='background-color: #eee;'>            inverse *= 2 - denominator * inverse; // inverse mod 2^8</span>
 122 |     | <span style='background-color: #eee;'>            inverse *= 2 - denominator * inverse; // inverse mod 2^16</span>
 123 |     | <span style='background-color: #eee;'>            inverse *= 2 - denominator * inverse; // inverse mod 2^32</span>
 124 |     | <span style='background-color: #eee;'>            inverse *= 2 - denominator * inverse; // inverse mod 2^64</span>
 125 |     | <span style='background-color: #eee;'>            inverse *= 2 - denominator * inverse; // inverse mod 2^128</span>
 126 |     | <span style='background-color: #eee;'>            inverse *= 2 - denominator * inverse; // inverse mod 2^256</span>
 127 |     | <span style='background-color: #eee;'></span>
 128 |     | <span style='background-color: #eee;'>            // Because the division is now exact we can divide by multiplying with the modular inverse of denominator.</span>
 129 |     | <span style='background-color: #eee;'>            // This will give us the correct result modulo 2^256. Since the preconditions guarantee that the outcome is</span>
 130 |     | <span style='background-color: #eee;'>            // less than 2^256, this is the final result. We don&#39;t need to compute the high bits of the result and prod1</span>
 131 |     | <span style='background-color: #eee;'>            // is no longer required.</span>
 132 |     | <span style='background-color: #eee;'>            result = prod0 * inverse;</span>
 133 |     | <span style='background-color: #eee;'>            return result;</span>
 134 |     | <span style='background-color: #eee;'>        }</span>
 135 |     | <span style='background-color: #eee;'>    }</span>
 136 |     | <span style='background-color: #eee;'></span>
 137 |     | <span style='background-color: #eee;'>    /**</span>
 138 |     | <span style='background-color: #eee;'>     * @notice Calculates x * y / denominator with full precision, following the selected rounding direction.</span>
 139 |     | <span style='background-color: #eee;'>     */</span>
 140 |     | <span style='background-color: #eee;'>    function mulDiv(</span>
 141 |     | <span style='background-color: #eee;'>        uint256 x,</span>
 142 |     | <span style='background-color: #eee;'>        uint256 y,</span>
 143 |     | <span style='background-color: #eee;'>        uint256 denominator,</span>
 144 |     | <span style='background-color: #eee;'>        Rounding rounding</span>
 145 |     | <span style='background-color: #eee;'>    ) internal pure returns (uint256) {</span>
 146 |     | <span style='background-color: #eee;'>        uint256 result = mulDiv(x, y, denominator);</span>
 147 |     | <span style='background-color: #eee;'>        if (rounding == Rounding.Up &amp;&amp; mulmod(x, y, denominator) &gt; 0) {</span>
 148 |     | <span style='background-color: #eee;'>            result += 1;</span>
 149 |     | <span style='background-color: #eee;'>        }</span>
 150 |     | <span style='background-color: #eee;'>        return result;</span>
 151 |     | <span style='background-color: #eee;'>    }</span>
 152 |     | <span style='background-color: #eee;'></span>
 153 |     | <span style='background-color: #eee;'>    /**</span>
 154 |     | <span style='background-color: #eee;'>     * @dev Returns the square root of a number. If the number is not a perfect square, the value is rounded down.</span>
 155 |     | <span style='background-color: #eee;'>     *</span>
 156 |     | <span style='background-color: #eee;'>     * Inspired by Henry S. Warren, Jr.&#39;s &quot;Hacker&#39;s Delight&quot; (Chapter 11).</span>
 157 |     | <span style='background-color: #eee;'>     */</span>
 158 |     | <span style='background-color: #eee;'>    function sqrt(uint256 a) internal pure returns (uint256) {</span>
 159 |     | <span style='background-color: #eee;'>        if (a == 0) {</span>
 160 |     | <span style='background-color: #eee;'>            return 0;</span>
 161 |     | <span style='background-color: #eee;'>        }</span>
 162 |     | <span style='background-color: #eee;'></span>
 163 |     | <span style='background-color: #eee;'>        // For our first guess, we get the biggest power of 2 which is smaller than the square root of the target.</span>
 164 |     | <span style='background-color: #eee;'>        //</span>
 165 |     | <span style='background-color: #eee;'>        // We know that the &quot;msb&quot; (most significant bit) of our target number `a` is a power of 2 such that we have</span>
 166 |     | <span style='background-color: #eee;'>        // `msb(a) &lt;= a &lt; 2*msb(a)`. This value can be written `msb(a)=2**k` with `k=log2(a)`.</span>
 167 |     | <span style='background-color: #eee;'>        //</span>
 168 |     | <span style='background-color: #eee;'>        // This can be rewritten `2**log2(a) &lt;= a &lt; 2**(log2(a) + 1)`</span>
 169 |     | <span style='background-color: #eee;'>        //  `sqrt(2**k) &lt;= sqrt(a) &lt; sqrt(2**(k+1))`</span>
 170 |     | <span style='background-color: #eee;'>        //  `2**(k/2) &lt;= sqrt(a) &lt; 2**((k+1)/2) &lt;= 2**(k/2 + 1)`</span>
 171 |     | <span style='background-color: #eee;'>        //</span>
 172 |     | <span style='background-color: #eee;'>        // Consequently, `2**(log2(a) / 2)` is a good first approximation of `sqrt(a)` with at least 1 correct bit.</span>
 173 |     | <span style='background-color: #eee;'>        uint256 result = 1 &lt;&lt; (log2(a) &gt;&gt; 1);</span>
 174 |     | <span style='background-color: #eee;'></span>
 175 |     | <span style='background-color: #eee;'>        // At this point `result` is an estimation with one bit of precision. We know the true value is a uint128,</span>
 176 |     | <span style='background-color: #eee;'>        // since it is the square root of a uint256. Newton&#39;s method converges quadratically (precision doubles at</span>
 177 |     | <span style='background-color: #eee;'>        // every iteration). We thus need at most 7 iteration to turn our partial result with one bit of precision</span>
 178 |     | <span style='background-color: #eee;'>        // into the expected uint128 result.</span>
 179 |     | <span style='background-color: #eee;'>        unchecked {</span>
 180 |     | <span style='background-color: #eee;'>            result = (result + a / result) &gt;&gt; 1;</span>
 181 |     | <span style='background-color: #eee;'>            result = (result + a / result) &gt;&gt; 1;</span>
 182 |     | <span style='background-color: #eee;'>            result = (result + a / result) &gt;&gt; 1;</span>
 183 |     | <span style='background-color: #eee;'>            result = (result + a / result) &gt;&gt; 1;</span>
 184 |     | <span style='background-color: #eee;'>            result = (result + a / result) &gt;&gt; 1;</span>
 185 |     | <span style='background-color: #eee;'>            result = (result + a / result) &gt;&gt; 1;</span>
 186 |     | <span style='background-color: #eee;'>            result = (result + a / result) &gt;&gt; 1;</span>
 187 |     | <span style='background-color: #eee;'>            return min(result, a / result);</span>
 188 |     | <span style='background-color: #eee;'>        }</span>
 189 |     | <span style='background-color: #eee;'>    }</span>
 190 |     | <span style='background-color: #eee;'></span>
 191 |     | <span style='background-color: #eee;'>    /**</span>
 192 |     | <span style='background-color: #eee;'>     * @notice Calculates sqrt(a), following the selected rounding direction.</span>
 193 |     | <span style='background-color: #eee;'>     */</span>
 194 |     | <span style='background-color: #eee;'>    function sqrt(uint256 a, Rounding rounding) internal pure returns (uint256) {</span>
 195 |     | <span style='background-color: #eee;'>        unchecked {</span>
 196 |     | <span style='background-color: #eee;'>            uint256 result = sqrt(a);</span>
 197 |     | <span style='background-color: #eee;'>            return result + (rounding == Rounding.Up &amp;&amp; result * result &lt; a ? 1 : 0);</span>
 198 |     | <span style='background-color: #eee;'>        }</span>
 199 |     | <span style='background-color: #eee;'>    }</span>
 200 |     | <span style='background-color: #eee;'></span>
 201 |     | <span style='background-color: #eee;'>    /**</span>
 202 |     | <span style='background-color: #eee;'>     * @dev Return the log in base 2, rounded down, of a positive value.</span>
 203 |     | <span style='background-color: #eee;'>     * Returns 0 if given 0.</span>
 204 |     | <span style='background-color: #eee;'>     */</span>
 205 |     | <span style='background-color: #eee;'>    function log2(uint256 value) internal pure returns (uint256) {</span>
 206 |     | <span style='background-color: #eee;'>        uint256 result = 0;</span>
 207 |     | <span style='background-color: #eee;'>        unchecked {</span>
 208 |     | <span style='background-color: #eee;'>            if (value &gt;&gt; 128 &gt; 0) {</span>
 209 |     | <span style='background-color: #eee;'>                value &gt;&gt;= 128;</span>
 210 |     | <span style='background-color: #eee;'>                result += 128;</span>
 211 |     | <span style='background-color: #eee;'>            }</span>
 212 |     | <span style='background-color: #eee;'>            if (value &gt;&gt; 64 &gt; 0) {</span>
 213 |     | <span style='background-color: #eee;'>                value &gt;&gt;= 64;</span>
 214 |     | <span style='background-color: #eee;'>                result += 64;</span>
 215 |     | <span style='background-color: #eee;'>            }</span>
 216 |     | <span style='background-color: #eee;'>            if (value &gt;&gt; 32 &gt; 0) {</span>
 217 |     | <span style='background-color: #eee;'>                value &gt;&gt;= 32;</span>
 218 |     | <span style='background-color: #eee;'>                result += 32;</span>
 219 |     | <span style='background-color: #eee;'>            }</span>
 220 |     | <span style='background-color: #eee;'>            if (value &gt;&gt; 16 &gt; 0) {</span>
 221 |     | <span style='background-color: #eee;'>                value &gt;&gt;= 16;</span>
 222 |     | <span style='background-color: #eee;'>                result += 16;</span>
 223 |     | <span style='background-color: #eee;'>            }</span>
 224 |     | <span style='background-color: #eee;'>            if (value &gt;&gt; 8 &gt; 0) {</span>
 225 |     | <span style='background-color: #eee;'>                value &gt;&gt;= 8;</span>
 226 |     | <span style='background-color: #eee;'>                result += 8;</span>
 227 |     | <span style='background-color: #eee;'>            }</span>
 228 |     | <span style='background-color: #eee;'>            if (value &gt;&gt; 4 &gt; 0) {</span>
 229 |     | <span style='background-color: #eee;'>                value &gt;&gt;= 4;</span>
 230 |     | <span style='background-color: #eee;'>                result += 4;</span>
 231 |     | <span style='background-color: #eee;'>            }</span>
 232 |     | <span style='background-color: #eee;'>            if (value &gt;&gt; 2 &gt; 0) {</span>
 233 |     | <span style='background-color: #eee;'>                value &gt;&gt;= 2;</span>
 234 |     | <span style='background-color: #eee;'>                result += 2;</span>
 235 |     | <span style='background-color: #eee;'>            }</span>
 236 |     | <span style='background-color: #eee;'>            if (value &gt;&gt; 1 &gt; 0) {</span>
 237 |     | <span style='background-color: #eee;'>                result += 1;</span>
 238 |     | <span style='background-color: #eee;'>            }</span>
 239 |     | <span style='background-color: #eee;'>        }</span>
 240 |     | <span style='background-color: #eee;'>        return result;</span>
 241 |     | <span style='background-color: #eee;'>    }</span>
 242 |     | <span style='background-color: #eee;'></span>
 243 |     | <span style='background-color: #eee;'>    /**</span>
 244 |     | <span style='background-color: #eee;'>     * @dev Return the log in base 2, following the selected rounding direction, of a positive value.</span>
 245 |     | <span style='background-color: #eee;'>     * Returns 0 if given 0.</span>
 246 |     | <span style='background-color: #eee;'>     */</span>
 247 |     | <span style='background-color: #eee;'>    function log2(uint256 value, Rounding rounding) internal pure returns (uint256) {</span>
 248 |     | <span style='background-color: #eee;'>        unchecked {</span>
 249 |     | <span style='background-color: #eee;'>            uint256 result = log2(value);</span>
 250 |     | <span style='background-color: #eee;'>            return result + (rounding == Rounding.Up &amp;&amp; 1 &lt;&lt; result &lt; value ? 1 : 0);</span>
 251 |     | <span style='background-color: #eee;'>        }</span>
 252 |     | <span style='background-color: #eee;'>    }</span>
 253 |     | <span style='background-color: #eee;'></span>
 254 |     | <span style='background-color: #eee;'>    /**</span>
 255 |     | <span style='background-color: #eee;'>     * @dev Return the log in base 10, rounded down, of a positive value.</span>
 256 |     | <span style='background-color: #eee;'>     * Returns 0 if given 0.</span>
 257 |     | <span style='background-color: #eee;'>     */</span>
 258 |     | <span style='background-color: #eee;'>    function log10(uint256 value) internal pure returns (uint256) {</span>
 259 |     | <span style='background-color: #faa;'>        uint256 result = 0;</span>
 260 |     | <span style='background-color: #eee;'>        unchecked {</span>
 261 |     | <span style='background-color: #faa;'>            if (value &gt;= 10**64) {</span>
 262 |     | <span style='background-color: #eee;'>                value /= 10**64;</span>
 263 |     | <span style='background-color: #faa;'>                result += 64;</span>
 264 |     | <span style='background-color: #eee;'>            }</span>
 265 |     | <span style='background-color: #faa;'>            if (value &gt;= 10**32) {</span>
 266 |     | <span style='background-color: #eee;'>                value /= 10**32;</span>
 267 |     | <span style='background-color: #faa;'>                result += 32;</span>
 268 |     | <span style='background-color: #eee;'>            }</span>
 269 |     | <span style='background-color: #faa;'>            if (value &gt;= 10**16) {</span>
 270 |     | <span style='background-color: #eee;'>                value /= 10**16;</span>
 271 |     | <span style='background-color: #faa;'>                result += 16;</span>
 272 |     | <span style='background-color: #eee;'>            }</span>
 273 |     | <span style='background-color: #faa;'>            if (value &gt;= 10**8) {</span>
 274 |     | <span style='background-color: #eee;'>                value /= 10**8;</span>
 275 |     | <span style='background-color: #faa;'>                result += 8;</span>
 276 |     | <span style='background-color: #eee;'>            }</span>
 277 |     | <span style='background-color: #faa;'>            if (value &gt;= 10**4) {</span>
 278 |     | <span style='background-color: #eee;'>                value /= 10**4;</span>
 279 |     | <span style='background-color: #faa;'>                result += 4;</span>
 280 |     | <span style='background-color: #eee;'>            }</span>
 281 |     | <span style='background-color: #faa;'>            if (value &gt;= 10**2) {</span>
 282 |     | <span style='background-color: #eee;'>                value /= 10**2;</span>
 283 |     | <span style='background-color: #faa;'>                result += 2;</span>
 284 |     | <span style='background-color: #eee;'>            }</span>
 285 |     | <span style='background-color: #faa;'>            if (value &gt;= 10**1) {</span>
 286 |     | <span style='background-color: #faa;'>                result += 1;</span>
 287 |     | <span style='background-color: #eee;'>            }</span>
 288 |     | <span style='background-color: #eee;'>        }</span>
 289 |     | <span style='background-color: #eee;'>        return result;</span>
 290 |     | <span style='background-color: #eee;'>    }</span>
 291 |     | <span style='background-color: #eee;'></span>
 292 |     | <span style='background-color: #eee;'>    /**</span>
 293 |     | <span style='background-color: #eee;'>     * @dev Return the log in base 10, following the selected rounding direction, of a positive value.</span>
 294 |     | <span style='background-color: #eee;'>     * Returns 0 if given 0.</span>
 295 |     | <span style='background-color: #eee;'>     */</span>
 296 |     | <span style='background-color: #eee;'>    function log10(uint256 value, Rounding rounding) internal pure returns (uint256) {</span>
 297 |     | <span style='background-color: #eee;'>        unchecked {</span>
 298 |     | <span style='background-color: #eee;'>            uint256 result = log10(value);</span>
 299 |     | <span style='background-color: #eee;'>            return result + (rounding == Rounding.Up &amp;&amp; 10**result &lt; value ? 1 : 0);</span>
 300 |     | <span style='background-color: #eee;'>        }</span>
 301 |     | <span style='background-color: #eee;'>    }</span>
 302 |     | <span style='background-color: #eee;'></span>
 303 |     | <span style='background-color: #eee;'>    /**</span>
 304 |     | <span style='background-color: #eee;'>     * @dev Return the log in base 256, rounded down, of a positive value.</span>
 305 |     | <span style='background-color: #eee;'>     * Returns 0 if given 0.</span>
 306 |     | <span style='background-color: #eee;'>     *</span>
 307 |     | <span style='background-color: #eee;'>     * Adding one to the result gives the number of pairs of hex symbols needed to represent `value` as a hex string.</span>
 308 |     | <span style='background-color: #eee;'>     */</span>
 309 |     | <span style='background-color: #eee;'>    function log256(uint256 value) internal pure returns (uint256) {</span>
 310 |     | <span style='background-color: #eee;'>        uint256 result = 0;</span>
 311 |     | <span style='background-color: #eee;'>        unchecked {</span>
 312 |     | <span style='background-color: #eee;'>            if (value &gt;&gt; 128 &gt; 0) {</span>
 313 |     | <span style='background-color: #eee;'>                value &gt;&gt;= 128;</span>
 314 |     | <span style='background-color: #eee;'>                result += 16;</span>
 315 |     | <span style='background-color: #eee;'>            }</span>
 316 |     | <span style='background-color: #eee;'>            if (value &gt;&gt; 64 &gt; 0) {</span>
 317 |     | <span style='background-color: #eee;'>                value &gt;&gt;= 64;</span>
 318 |     | <span style='background-color: #eee;'>                result += 8;</span>
 319 |     | <span style='background-color: #eee;'>            }</span>
 320 |     | <span style='background-color: #eee;'>            if (value &gt;&gt; 32 &gt; 0) {</span>
 321 |     | <span style='background-color: #eee;'>                value &gt;&gt;= 32;</span>
 322 |     | <span style='background-color: #eee;'>                result += 4;</span>
 323 |     | <span style='background-color: #eee;'>            }</span>
 324 |     | <span style='background-color: #eee;'>            if (value &gt;&gt; 16 &gt; 0) {</span>
 325 |     | <span style='background-color: #eee;'>                value &gt;&gt;= 16;</span>
 326 |     | <span style='background-color: #eee;'>                result += 2;</span>
 327 |     | <span style='background-color: #eee;'>            }</span>
 328 |     | <span style='background-color: #eee;'>            if (value &gt;&gt; 8 &gt; 0) {</span>
 329 |     | <span style='background-color: #eee;'>                result += 1;</span>
 330 |     | <span style='background-color: #eee;'>            }</span>
 331 |     | <span style='background-color: #eee;'>        }</span>
 332 |     | <span style='background-color: #eee;'>        return result;</span>
 333 |     | <span style='background-color: #eee;'>    }</span>
 334 |     | <span style='background-color: #eee;'></span>
 335 |     | <span style='background-color: #eee;'>    /**</span>
 336 |     | <span style='background-color: #eee;'>     * @dev Return the log in base 10, following the selected rounding direction, of a positive value.</span>
 337 |     | <span style='background-color: #eee;'>     * Returns 0 if given 0.</span>
 338 |     | <span style='background-color: #eee;'>     */</span>
 339 |     | <span style='background-color: #eee;'>    function log256(uint256 value, Rounding rounding) internal pure returns (uint256) {</span>
 340 |     | <span style='background-color: #eee;'>        unchecked {</span>
 341 |     | <span style='background-color: #eee;'>            uint256 result = log256(value);</span>
 342 |     | <span style='background-color: #eee;'>            return result + (rounding == Rounding.Up &amp;&amp; 1 &lt;&lt; (result * 8) &lt; value ? 1 : 0);</span>
 343 |     | <span style='background-color: #eee;'>        }</span>
 344 |     | <span style='background-color: #eee;'>    }</span>
 345 |     | <span style='background-color: #eee;'>}</span>
 346 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@openzeppelin/contracts/utils/structs/BitMaps.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span style='background-color: #eee;'>// OpenZeppelin Contracts (last updated v4.8.0) (utils/structs/BitMaps.sol)</span>
  3 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.0;</span>
  4 |     | <span style='background-color: #eee;'></span>
  5 |     | <span style='background-color: #eee;'>/**</span>
  6 |     | <span style='background-color: #eee;'> * @dev Library for managing uint256 to bool mapping in a compact and efficient way, providing the keys are sequential.</span>
  7 |     | <span style='background-color: #eee;'> * Largely inspired by Uniswap&#39;s https://github.com/Uniswap/merkle-distributor/blob/master/contracts/MerkleDistributor.sol[merkle-distributor].</span>
  8 |     | <span style='background-color: #faa;'> */</span>
  9 |     | <span style='background-color: #eee;'>library BitMaps {</span>
 10 |     | <span style='background-color: #eee;'>    struct BitMap {</span>
 11 |     | <span style='background-color: #eee;'>        mapping(uint256 =&gt; uint256) _data;</span>
 12 |     | <span style='background-color: #eee;'>    }</span>
 13 |     | <span style='background-color: #eee;'></span>
 14 |     | <span style='background-color: #eee;'>    /**</span>
 15 |     | <span style='background-color: #eee;'>     * @dev Returns whether the bit at `index` is set.</span>
 16 |     | <span style='background-color: #eee;'>     */</span>
 17 |     | <span style='background-color: #faa;'>    function get(BitMap storage bitmap, uint256 index) internal view returns (bool) {</span>
 18 |     | <span style='background-color: #faa;'>        uint256 bucket = index &gt;&gt; 8;</span>
 19 |     | <span style='background-color: #faa;'>        uint256 mask = 1 &lt;&lt; (index &amp; 0xff);</span>
 20 |     | <span style='background-color: #faa;'>        return bitmap._data[bucket] &amp; mask != 0;</span>
 21 |     | <span style='background-color: #eee;'>    }</span>
 22 |     | <span style='background-color: #eee;'></span>
 23 |     | <span style='background-color: #eee;'>    /**</span>
 24 |     | <span style='background-color: #eee;'>     * @dev Sets the bit at `index` to the boolean `value`.</span>
 25 |     | <span style='background-color: #eee;'>     */</span>
 26 |     | <span style='background-color: #eee;'>    function setTo(</span>
 27 |     | <span style='background-color: #eee;'>        BitMap storage bitmap,</span>
 28 |     | <span style='background-color: #eee;'>        uint256 index,</span>
 29 |     | <span style='background-color: #eee;'>        bool value</span>
 30 |     | <span style='background-color: #eee;'>    ) internal {</span>
 31 |     | <span style='background-color: #eee;'>        if (value) {</span>
 32 |     | <span style='background-color: #eee;'>            set(bitmap, index);</span>
 33 |     | <span style='background-color: #eee;'>        } else {</span>
 34 |     | <span style='background-color: #eee;'>            unset(bitmap, index);</span>
 35 |     | <span style='background-color: #eee;'>        }</span>
 36 |     | <span style='background-color: #eee;'>    }</span>
 37 |     | <span style='background-color: #eee;'></span>
 38 |     | <span style='background-color: #eee;'>    /**</span>
 39 |     | <span style='background-color: #eee;'>     * @dev Sets the bit at `index`.</span>
 40 |     | <span style='background-color: #eee;'>     */</span>
 41 |     | <span style='background-color: #eee;'>    function set(BitMap storage bitmap, uint256 index) internal {</span>
 42 |     | <span style='background-color: #faa;'>        uint256 bucket = index &gt;&gt; 8;</span>
 43 |     | <span style='background-color: #faa;'>        uint256 mask = 1 &lt;&lt; (index &amp; 0xff);</span>
 44 |     | <span style='background-color: #faa;'>        bitmap._data[bucket] |= mask;</span>
 45 |     | <span style='background-color: #eee;'>    }</span>
 46 |     | <span style='background-color: #eee;'></span>
 47 |     | <span style='background-color: #eee;'>    /**</span>
 48 |     | <span style='background-color: #eee;'>     * @dev Unsets the bit at `index`.</span>
 49 |     | <span style='background-color: #eee;'>     */</span>
 50 |     | <span style='background-color: #eee;'>    function unset(BitMap storage bitmap, uint256 index) internal {</span>
 51 |     | <span style='background-color: #eee;'>        uint256 bucket = index &gt;&gt; 8;</span>
 52 |     | <span style='background-color: #eee;'>        uint256 mask = 1 &lt;&lt; (index &amp; 0xff);</span>
 53 |     | <span style='background-color: #eee;'>        bitmap._data[bucket] &amp;= ~mask;</span>
 54 |     | <span style='background-color: #eee;'>    }</span>
 55 |     | <span style='background-color: #eee;'>}</span>
 56 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@uniswap/lib/contracts/libraries/TransferHelper.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-3.0-or-later</span>
  2 |     | <span style='background-color: #eee;'></span>
  3 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.6.0;</span>
  4 |     | <span style='background-color: #eee;'></span>
  5 |     | <span style='background-color: #faa;'>// helper methods for interacting with ERC20 tokens and sending ETH that do not consistently return true/false</span>
  6 |     | <span style='background-color: #eee;'>library TransferHelper {</span>
  7 |     | <span style='background-color: #eee;'>    function safeApprove(</span>
  8 |     | <span style='background-color: #eee;'>        address token,</span>
  9 |     | <span style='background-color: #eee;'>        address to,</span>
 10 |     | <span style='background-color: #eee;'>        uint256 value</span>
 11 |     | <span style='background-color: #eee;'>    ) internal {</span>
 12 |     | <span style='background-color: #eee;'>        // bytes4(keccak256(bytes(&#39;approve(address,uint256)&#39;)));</span>
 13 |     | <span style='background-color: #eee;'>        (bool success, bytes memory data) = token.call(abi.encodeWithSelector(0x095ea7b3, to, value));</span>
 14 |     | <span style='background-color: #eee;'>        require(</span>
 15 |     | <span style='background-color: #eee;'>            success &amp;&amp; (data.length == 0 || abi.decode(data, (bool))),</span>
 16 |     | <span style='background-color: #eee;'>            &#39;TransferHelper::safeApprove: approve failed&#39;</span>
 17 |     | <span style='background-color: #eee;'>        );</span>
 18 |     | <span style='background-color: #eee;'>    }</span>
 19 |     | <span style='background-color: #eee;'></span>
 20 |     | <span style='background-color: #eee;'>    function safeTransfer(</span>
 21 |     | <span style='background-color: #eee;'>        address token,</span>
 22 |     | <span style='background-color: #eee;'>        address to,</span>
 23 |     | <span style='background-color: #eee;'>        uint256 value</span>
 24 |     | <span style='background-color: #eee;'>    ) internal {</span>
 25 |     | <span style='background-color: #eee;'>        // bytes4(keccak256(bytes(&#39;transfer(address,uint256)&#39;)));</span>
 26 |     | <span style='background-color: #eee;'>        (bool success, bytes memory data) = token.call(abi.encodeWithSelector(0xa9059cbb, to, value));</span>
 27 |     | <span style='background-color: #eee;'>        require(</span>
 28 |     | <span style='background-color: #eee;'>            success &amp;&amp; (data.length == 0 || abi.decode(data, (bool))),</span>
 29 |     | <span style='background-color: #eee;'>            &#39;TransferHelper::safeTransfer: transfer failed&#39;</span>
 30 |     | <span style='background-color: #eee;'>        );</span>
 31 |     | <span style='background-color: #eee;'>    }</span>
 32 |     | <span style='background-color: #eee;'></span>
 33 |     | <span style='background-color: #eee;'>    function safeTransferFrom(</span>
 34 |     | <span style='background-color: #eee;'>        address token,</span>
 35 |     | <span style='background-color: #eee;'>        address from,</span>
 36 |     | <span style='background-color: #eee;'>        address to,</span>
 37 |     | <span style='background-color: #eee;'>        uint256 value</span>
 38 |     | <span style='background-color: #eee;'>    ) internal {</span>
 39 |     | <span style='background-color: #eee;'>        // bytes4(keccak256(bytes(&#39;transferFrom(address,address,uint256)&#39;)));</span>
 40 |     | <span style='background-color: #faa;'>        (bool success, bytes memory data) = token.call(abi.encodeWithSelector(0x23b872dd, from, to, value));</span>
 41 |     | <span style='background-color: #eee;'>        require(</span>
 42 |     | <span style='background-color: #faa;'>            success &amp;&amp; (data.length == 0 || abi.decode(data, (bool))),</span>
 43 |     | <span style='background-color: #eee;'>            &#39;TransferHelper::transferFrom: transferFrom failed&#39;</span>
 44 |     | <span style='background-color: #eee;'>        );</span>
 45 |     | <span style='background-color: #eee;'>    }</span>
 46 |     | <span style='background-color: #eee;'></span>
 47 |     | <span style='background-color: #eee;'>    function safeTransferETH(address to, uint256 value) internal {</span>
 48 |     | <span style='background-color: #eee;'>        (bool success, ) = to.call{value: value}(new bytes(0));</span>
 49 |     | <span style='background-color: #eee;'>        require(success, &#39;TransferHelper::safeTransferETH: ETH transfer failed&#39;);</span>
 50 |     | <span style='background-color: #eee;'>    }</span>
 51 |     | <span style='background-color: #eee;'>}</span>
 52 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@uniswap/v2-core/contracts/interfaces/IUniswapV2Callee.sol</b>
<code>
 1 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.5.0;</span>
 2 |     | <span style='background-color: #eee;'></span>
 3 |     | <span style='background-color: #eee;'>interface IUniswapV2Callee {</span>
 4 |     | <span style='background-color: #eee;'>    function uniswapV2Call(address sender, uint amount0, uint amount1, bytes calldata data) external;</span>
 5 |     | <span style='background-color: #eee;'>}</span>
 6 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@uniswap/v2-core/contracts/interfaces/IUniswapV2ERC20.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.5.0;</span>
  2 |     | <span style='background-color: #eee;'></span>
  3 |     | <span style='background-color: #eee;'>interface IUniswapV2ERC20 {</span>
  4 |     | <span style='background-color: #eee;'>    event Approval(address indexed owner, address indexed spender, uint value);</span>
  5 |     | <span style='background-color: #eee;'>    event Transfer(address indexed from, address indexed to, uint value);</span>
  6 |     | <span style='background-color: #eee;'></span>
  7 |     | <span style='background-color: #eee;'>    function name() external pure returns (string memory);</span>
  8 |     | <span style='background-color: #eee;'>    function symbol() external pure returns (string memory);</span>
  9 |     | <span style='background-color: #eee;'>    function decimals() external pure returns (uint8);</span>
 10 |     | <span style='background-color: #eee;'>    function totalSupply() external view returns (uint);</span>
 11 |     | <span style='background-color: #eee;'>    function balanceOf(address owner) external view returns (uint);</span>
 12 |     | <span style='background-color: #eee;'>    function allowance(address owner, address spender) external view returns (uint);</span>
 13 |     | <span style='background-color: #eee;'></span>
 14 |     | <span style='background-color: #eee;'>    function approve(address spender, uint value) external returns (bool);</span>
 15 |     | <span style='background-color: #eee;'>    function transfer(address to, uint value) external returns (bool);</span>
 16 |     | <span style='background-color: #eee;'>    function transferFrom(address from, address to, uint value) external returns (bool);</span>
 17 |     | <span style='background-color: #eee;'></span>
 18 |     | <span style='background-color: #eee;'>    function DOMAIN_SEPARATOR() external view returns (bytes32);</span>
 19 |     | <span style='background-color: #eee;'>    function PERMIT_TYPEHASH() external pure returns (bytes32);</span>
 20 |     | <span style='background-color: #eee;'>    function nonces(address owner) external view returns (uint);</span>
 21 |     | <span style='background-color: #eee;'></span>
 22 |     | <span style='background-color: #eee;'>    function permit(address owner, address spender, uint value, uint deadline, uint8 v, bytes32 r, bytes32 s) external;</span>
 23 |     | <span style='background-color: #eee;'>}</span>
 24 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@uniswap/v2-core/contracts/interfaces/IUniswapV2Factory.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.5.0;</span>
  2 |     | <span style='background-color: #eee;'></span>
  3 |     | <span style='background-color: #eee;'>interface IUniswapV2Factory {</span>
  4 |     | <span style='background-color: #eee;'>    event PairCreated(address indexed token0, address indexed token1, address pair, uint);</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>    function feeTo() external view returns (address);</span>
  7 |     | <span style='background-color: #eee;'>    function feeToSetter() external view returns (address);</span>
  8 |     | <span style='background-color: #eee;'></span>
  9 |     | <span style='background-color: #eee;'>    function getPair(address tokenA, address tokenB) external view returns (address pair);</span>
 10 |     | <span style='background-color: #eee;'>    function allPairs(uint) external view returns (address pair);</span>
 11 |     | <span style='background-color: #eee;'>    function allPairsLength() external view returns (uint);</span>
 12 |     | <span style='background-color: #eee;'></span>
 13 |     | <span style='background-color: #eee;'>    function createPair(address tokenA, address tokenB) external returns (address pair);</span>
 14 |     | <span style='background-color: #eee;'></span>
 15 |     | <span style='background-color: #eee;'>    function setFeeTo(address) external;</span>
 16 |     | <span style='background-color: #eee;'>    function setFeeToSetter(address) external;</span>
 17 |     | <span style='background-color: #eee;'>}</span>
 18 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@uniswap/v3-core/contracts/interfaces/IUniswapV3Factory.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-2.0-or-later</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.5.0;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>/// @title The interface for the Uniswap V3 Factory</span>
  5 |     | <span style='background-color: #eee;'>/// @notice The Uniswap V3 Factory facilitates creation of Uniswap V3 pools and control over the protocol fees</span>
  6 |     | <span style='background-color: #eee;'>interface IUniswapV3Factory {</span>
  7 |     | <span style='background-color: #eee;'>    /// @notice Emitted when the owner of the factory is changed</span>
  8 |     | <span style='background-color: #eee;'>    /// @param oldOwner The owner before the owner was changed</span>
  9 |     | <span style='background-color: #eee;'>    /// @param newOwner The owner after the owner was changed</span>
 10 |     | <span style='background-color: #eee;'>    event OwnerChanged(address indexed oldOwner, address indexed newOwner);</span>
 11 |     | <span style='background-color: #eee;'></span>
 12 |     | <span style='background-color: #eee;'>    /// @notice Emitted when a pool is created</span>
 13 |     | <span style='background-color: #eee;'>    /// @param token0 The first token of the pool by address sort order</span>
 14 |     | <span style='background-color: #eee;'>    /// @param token1 The second token of the pool by address sort order</span>
 15 |     | <span style='background-color: #eee;'>    /// @param fee The fee collected upon every swap in the pool, denominated in hundredths of a bip</span>
 16 |     | <span style='background-color: #eee;'>    /// @param tickSpacing The minimum number of ticks between initialized ticks</span>
 17 |     | <span style='background-color: #eee;'>    /// @param pool The address of the created pool</span>
 18 |     | <span style='background-color: #eee;'>    event PoolCreated(</span>
 19 |     | <span style='background-color: #eee;'>        address indexed token0,</span>
 20 |     | <span style='background-color: #eee;'>        address indexed token1,</span>
 21 |     | <span style='background-color: #eee;'>        uint24 indexed fee,</span>
 22 |     | <span style='background-color: #eee;'>        int24 tickSpacing,</span>
 23 |     | <span style='background-color: #eee;'>        address pool</span>
 24 |     | <span style='background-color: #eee;'>    );</span>
 25 |     | <span style='background-color: #eee;'></span>
 26 |     | <span style='background-color: #eee;'>    /// @notice Emitted when a new fee amount is enabled for pool creation via the factory</span>
 27 |     | <span style='background-color: #eee;'>    /// @param fee The enabled fee, denominated in hundredths of a bip</span>
 28 |     | <span style='background-color: #eee;'>    /// @param tickSpacing The minimum number of ticks between initialized ticks for pools created with the given fee</span>
 29 |     | <span style='background-color: #eee;'>    event FeeAmountEnabled(uint24 indexed fee, int24 indexed tickSpacing);</span>
 30 |     | <span style='background-color: #eee;'></span>
 31 |     | <span style='background-color: #eee;'>    /// @notice Returns the current owner of the factory</span>
 32 |     | <span style='background-color: #eee;'>    /// @dev Can be changed by the current owner via setOwner</span>
 33 |     | <span style='background-color: #eee;'>    /// @return The address of the factory owner</span>
 34 |     | <span style='background-color: #eee;'>    function owner() external view returns (address);</span>
 35 |     | <span style='background-color: #eee;'></span>
 36 |     | <span style='background-color: #eee;'>    /// @notice Returns the tick spacing for a given fee amount, if enabled, or 0 if not enabled</span>
 37 |     | <span style='background-color: #eee;'>    /// @dev A fee amount can never be removed, so this value should be hard coded or cached in the calling context</span>
 38 |     | <span style='background-color: #eee;'>    /// @param fee The enabled fee, denominated in hundredths of a bip. Returns 0 in case of unenabled fee</span>
 39 |     | <span style='background-color: #eee;'>    /// @return The tick spacing</span>
 40 |     | <span style='background-color: #eee;'>    function feeAmountTickSpacing(uint24 fee) external view returns (int24);</span>
 41 |     | <span style='background-color: #eee;'></span>
 42 |     | <span style='background-color: #eee;'>    /// @notice Returns the pool address for a given pair of tokens and a fee, or address 0 if it does not exist</span>
 43 |     | <span style='background-color: #eee;'>    /// @dev tokenA and tokenB may be passed in either token0/token1 or token1/token0 order</span>
 44 |     | <span style='background-color: #eee;'>    /// @param tokenA The contract address of either token0 or token1</span>
 45 |     | <span style='background-color: #eee;'>    /// @param tokenB The contract address of the other token</span>
 46 |     | <span style='background-color: #eee;'>    /// @param fee The fee collected upon every swap in the pool, denominated in hundredths of a bip</span>
 47 |     | <span style='background-color: #eee;'>    /// @return pool The pool address</span>
 48 |     | <span style='background-color: #eee;'>    function getPool(</span>
 49 |     | <span style='background-color: #eee;'>        address tokenA,</span>
 50 |     | <span style='background-color: #eee;'>        address tokenB,</span>
 51 |     | <span style='background-color: #eee;'>        uint24 fee</span>
 52 |     | <span style='background-color: #eee;'>    ) external view returns (address pool);</span>
 53 |     | <span style='background-color: #eee;'></span>
 54 |     | <span style='background-color: #eee;'>    /// @notice Creates a pool for the given two tokens and fee</span>
 55 |     | <span style='background-color: #eee;'>    /// @param tokenA One of the two tokens in the desired pool</span>
 56 |     | <span style='background-color: #eee;'>    /// @param tokenB The other of the two tokens in the desired pool</span>
 57 |     | <span style='background-color: #eee;'>    /// @param fee The desired fee for the pool</span>
 58 |     | <span style='background-color: #eee;'>    /// @dev tokenA and tokenB may be passed in either order: token0/token1 or token1/token0. tickSpacing is retrieved</span>
 59 |     | <span style='background-color: #eee;'>    /// from the fee. The call will revert if the pool already exists, the fee is invalid, or the token arguments</span>
 60 |     | <span style='background-color: #eee;'>    /// are invalid.</span>
 61 |     | <span style='background-color: #eee;'>    /// @return pool The address of the newly created pool</span>
 62 |     | <span style='background-color: #eee;'>    function createPool(</span>
 63 |     | <span style='background-color: #eee;'>        address tokenA,</span>
 64 |     | <span style='background-color: #eee;'>        address tokenB,</span>
 65 |     | <span style='background-color: #eee;'>        uint24 fee</span>
 66 |     | <span style='background-color: #eee;'>    ) external returns (address pool);</span>
 67 |     | <span style='background-color: #eee;'></span>
 68 |     | <span style='background-color: #eee;'>    /// @notice Updates the owner of the factory</span>
 69 |     | <span style='background-color: #eee;'>    /// @dev Must be called by the current owner</span>
 70 |     | <span style='background-color: #eee;'>    /// @param _owner The new owner of the factory</span>
 71 |     | <span style='background-color: #eee;'>    function setOwner(address _owner) external;</span>
 72 |     | <span style='background-color: #eee;'></span>
 73 |     | <span style='background-color: #eee;'>    /// @notice Enables a fee amount with the given tickSpacing</span>
 74 |     | <span style='background-color: #eee;'>    /// @dev Fee amounts may never be removed once enabled</span>
 75 |     | <span style='background-color: #eee;'>    /// @param fee The fee amount to enable, denominated in hundredths of a bip (i.e. 1e-6)</span>
 76 |     | <span style='background-color: #eee;'>    /// @param tickSpacing The spacing between ticks to be enforced for all pools created with the given fee amount</span>
 77 |     | <span style='background-color: #eee;'>    function enableFeeAmount(uint24 fee, int24 tickSpacing) external;</span>
 78 |     | <span style='background-color: #eee;'>}</span>
 79 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@uniswap/v3-core/contracts/interfaces/IUniswapV3Pool.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-2.0-or-later</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.5.0;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &#39;./pool/IUniswapV3PoolImmutables.sol&#39;;</span>
  5 |     | <span style='background-color: #eee;'>import &#39;./pool/IUniswapV3PoolState.sol&#39;;</span>
  6 |     | <span style='background-color: #eee;'>import &#39;./pool/IUniswapV3PoolDerivedState.sol&#39;;</span>
  7 |     | <span style='background-color: #eee;'>import &#39;./pool/IUniswapV3PoolActions.sol&#39;;</span>
  8 |     | <span style='background-color: #eee;'>import &#39;./pool/IUniswapV3PoolOwnerActions.sol&#39;;</span>
  9 |     | <span style='background-color: #eee;'>import &#39;./pool/IUniswapV3PoolEvents.sol&#39;;</span>
 10 |     | <span style='background-color: #eee;'></span>
 11 |     | <span style='background-color: #eee;'>/// @title The interface for a Uniswap V3 Pool</span>
 12 |     | <span style='background-color: #eee;'>/// @notice A Uniswap pool facilitates swapping and automated market making between any two assets that strictly conform</span>
 13 |     | <span style='background-color: #eee;'>/// to the ERC20 specification</span>
 14 |     | <span style='background-color: #eee;'>/// @dev The pool interface is broken up into many smaller pieces</span>
 15 |     | <span style='background-color: #eee;'>interface IUniswapV3Pool is</span>
 16 |     | <span style='background-color: #eee;'>    IUniswapV3PoolImmutables,</span>
 17 |     | <span style='background-color: #eee;'>    IUniswapV3PoolState,</span>
 18 |     | <span style='background-color: #eee;'>    IUniswapV3PoolDerivedState,</span>
 19 |     | <span style='background-color: #eee;'>    IUniswapV3PoolActions,</span>
 20 |     | <span style='background-color: #eee;'>    IUniswapV3PoolOwnerActions,</span>
 21 |     | <span style='background-color: #eee;'>    IUniswapV3PoolEvents</span>
 22 |     | <span style='background-color: #eee;'>{</span>
 23 |     | <span style='background-color: #eee;'></span>
 24 |     | <span style='background-color: #eee;'>}</span>
 25 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@uniswap/v3-core/contracts/interfaces/callback/IUniswapV3SwapCallback.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-2.0-or-later</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.5.0;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>/// @title Callback for IUniswapV3PoolActions#swap</span>
  5 |     | <span style='background-color: #eee;'>/// @notice Any contract that calls IUniswapV3PoolActions#swap must implement this interface</span>
  6 |     | <span style='background-color: #eee;'>interface IUniswapV3SwapCallback {</span>
  7 |     | <span style='background-color: #eee;'>    /// @notice Called to `msg.sender` after executing a swap via IUniswapV3Pool#swap.</span>
  8 |     | <span style='background-color: #eee;'>    /// @dev In the implementation you must pay the pool tokens owed for the swap.</span>
  9 |     | <span style='background-color: #eee;'>    /// The caller of this method must be checked to be a UniswapV3Pool deployed by the canonical UniswapV3Factory.</span>
 10 |     | <span style='background-color: #eee;'>    /// amount0Delta and amount1Delta can both be 0 if no tokens were swapped.</span>
 11 |     | <span style='background-color: #eee;'>    /// @param amount0Delta The amount of token0 that was sent (negative) or must be received (positive) by the pool by</span>
 12 |     | <span style='background-color: #eee;'>    /// the end of the swap. If positive, the callback must send that amount of token0 to the pool.</span>
 13 |     | <span style='background-color: #eee;'>    /// @param amount1Delta The amount of token1 that was sent (negative) or must be received (positive) by the pool by</span>
 14 |     | <span style='background-color: #eee;'>    /// the end of the swap. If positive, the callback must send that amount of token1 to the pool.</span>
 15 |     | <span style='background-color: #eee;'>    /// @param data Any data passed through by the caller via the IUniswapV3PoolActions#swap call</span>
 16 |     | <span style='background-color: #eee;'>    function uniswapV3SwapCallback(</span>
 17 |     | <span style='background-color: #eee;'>        int256 amount0Delta,</span>
 18 |     | <span style='background-color: #eee;'>        int256 amount1Delta,</span>
 19 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
 20 |     | <span style='background-color: #eee;'>    ) external;</span>
 21 |     | <span style='background-color: #eee;'>}</span>
 22 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@uniswap/v3-core/contracts/interfaces/pool/IUniswapV3PoolActions.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-2.0-or-later</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.5.0;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>/// @title Permissionless pool actions</span>
   5 |     | <span style='background-color: #eee;'>/// @notice Contains pool methods that can be called by anyone</span>
   6 |     | <span style='background-color: #eee;'>interface IUniswapV3PoolActions {</span>
   7 |     | <span style='background-color: #eee;'>    /// @notice Sets the initial price for the pool</span>
   8 |     | <span style='background-color: #eee;'>    /// @dev Price is represented as a sqrt(amountToken1/amountToken0) Q64.96 value</span>
   9 |     | <span style='background-color: #eee;'>    /// @param sqrtPriceX96 the initial sqrt price of the pool as a Q64.96</span>
  10 |     | <span style='background-color: #eee;'>    function initialize(uint160 sqrtPriceX96) external;</span>
  11 |     | <span style='background-color: #eee;'></span>
  12 |     | <span style='background-color: #eee;'>    /// @notice Adds liquidity for the given recipient/tickLower/tickUpper position</span>
  13 |     | <span style='background-color: #eee;'>    /// @dev The caller of this method receives a callback in the form of IUniswapV3MintCallback#uniswapV3MintCallback</span>
  14 |     | <span style='background-color: #eee;'>    /// in which they must pay any token0 or token1 owed for the liquidity. The amount of token0/token1 due depends</span>
  15 |     | <span style='background-color: #eee;'>    /// on tickLower, tickUpper, the amount of liquidity, and the current price.</span>
  16 |     | <span style='background-color: #eee;'>    /// @param recipient The address for which the liquidity will be created</span>
  17 |     | <span style='background-color: #eee;'>    /// @param tickLower The lower tick of the position in which to add liquidity</span>
  18 |     | <span style='background-color: #eee;'>    /// @param tickUpper The upper tick of the position in which to add liquidity</span>
  19 |     | <span style='background-color: #eee;'>    /// @param amount The amount of liquidity to mint</span>
  20 |     | <span style='background-color: #eee;'>    /// @param data Any data that should be passed through to the callback</span>
  21 |     | <span style='background-color: #eee;'>    /// @return amount0 The amount of token0 that was paid to mint the given amount of liquidity. Matches the value in the callback</span>
  22 |     | <span style='background-color: #eee;'>    /// @return amount1 The amount of token1 that was paid to mint the given amount of liquidity. Matches the value in the callback</span>
  23 |     | <span style='background-color: #eee;'>    function mint(</span>
  24 |     | <span style='background-color: #eee;'>        address recipient,</span>
  25 |     | <span style='background-color: #eee;'>        int24 tickLower,</span>
  26 |     | <span style='background-color: #eee;'>        int24 tickUpper,</span>
  27 |     | <span style='background-color: #eee;'>        uint128 amount,</span>
  28 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
  29 |     | <span style='background-color: #eee;'>    ) external returns (uint256 amount0, uint256 amount1);</span>
  30 |     | <span style='background-color: #eee;'></span>
  31 |     | <span style='background-color: #eee;'>    /// @notice Collects tokens owed to a position</span>
  32 |     | <span style='background-color: #eee;'>    /// @dev Does not recompute fees earned, which must be done either via mint or burn of any amount of liquidity.</span>
  33 |     | <span style='background-color: #eee;'>    /// Collect must be called by the position owner. To withdraw only token0 or only token1, amount0Requested or</span>
  34 |     | <span style='background-color: #eee;'>    /// amount1Requested may be set to zero. To withdraw all tokens owed, caller may pass any value greater than the</span>
  35 |     | <span style='background-color: #eee;'>    /// actual tokens owed, e.g. type(uint128).max. Tokens owed may be from accumulated swap fees or burned liquidity.</span>
  36 |     | <span style='background-color: #eee;'>    /// @param recipient The address which should receive the fees collected</span>
  37 |     | <span style='background-color: #eee;'>    /// @param tickLower The lower tick of the position for which to collect fees</span>
  38 |     | <span style='background-color: #eee;'>    /// @param tickUpper The upper tick of the position for which to collect fees</span>
  39 |     | <span style='background-color: #eee;'>    /// @param amount0Requested How much token0 should be withdrawn from the fees owed</span>
  40 |     | <span style='background-color: #eee;'>    /// @param amount1Requested How much token1 should be withdrawn from the fees owed</span>
  41 |     | <span style='background-color: #eee;'>    /// @return amount0 The amount of fees collected in token0</span>
  42 |     | <span style='background-color: #eee;'>    /// @return amount1 The amount of fees collected in token1</span>
  43 |     | <span style='background-color: #eee;'>    function collect(</span>
  44 |     | <span style='background-color: #eee;'>        address recipient,</span>
  45 |     | <span style='background-color: #eee;'>        int24 tickLower,</span>
  46 |     | <span style='background-color: #eee;'>        int24 tickUpper,</span>
  47 |     | <span style='background-color: #eee;'>        uint128 amount0Requested,</span>
  48 |     | <span style='background-color: #eee;'>        uint128 amount1Requested</span>
  49 |     | <span style='background-color: #eee;'>    ) external returns (uint128 amount0, uint128 amount1);</span>
  50 |     | <span style='background-color: #eee;'></span>
  51 |     | <span style='background-color: #eee;'>    /// @notice Burn liquidity from the sender and account tokens owed for the liquidity to the position</span>
  52 |     | <span style='background-color: #eee;'>    /// @dev Can be used to trigger a recalculation of fees owed to a position by calling with an amount of 0</span>
  53 |     | <span style='background-color: #eee;'>    /// @dev Fees must be collected separately via a call to #collect</span>
  54 |     | <span style='background-color: #eee;'>    /// @param tickLower The lower tick of the position for which to burn liquidity</span>
  55 |     | <span style='background-color: #eee;'>    /// @param tickUpper The upper tick of the position for which to burn liquidity</span>
  56 |     | <span style='background-color: #eee;'>    /// @param amount How much liquidity to burn</span>
  57 |     | <span style='background-color: #eee;'>    /// @return amount0 The amount of token0 sent to the recipient</span>
  58 |     | <span style='background-color: #eee;'>    /// @return amount1 The amount of token1 sent to the recipient</span>
  59 |     | <span style='background-color: #eee;'>    function burn(</span>
  60 |     | <span style='background-color: #eee;'>        int24 tickLower,</span>
  61 |     | <span style='background-color: #eee;'>        int24 tickUpper,</span>
  62 |     | <span style='background-color: #eee;'>        uint128 amount</span>
  63 |     | <span style='background-color: #eee;'>    ) external returns (uint256 amount0, uint256 amount1);</span>
  64 |     | <span style='background-color: #eee;'></span>
  65 |     | <span style='background-color: #eee;'>    /// @notice Swap token0 for token1, or token1 for token0</span>
  66 |     | <span style='background-color: #eee;'>    /// @dev The caller of this method receives a callback in the form of IUniswapV3SwapCallback#uniswapV3SwapCallback</span>
  67 |     | <span style='background-color: #eee;'>    /// @param recipient The address to receive the output of the swap</span>
  68 |     | <span style='background-color: #eee;'>    /// @param zeroForOne The direction of the swap, true for token0 to token1, false for token1 to token0</span>
  69 |     | <span style='background-color: #eee;'>    /// @param amountSpecified The amount of the swap, which implicitly configures the swap as exact input (positive), or exact output (negative)</span>
  70 |     | <span style='background-color: #eee;'>    /// @param sqrtPriceLimitX96 The Q64.96 sqrt price limit. If zero for one, the price cannot be less than this</span>
  71 |     | <span style='background-color: #eee;'>    /// value after the swap. If one for zero, the price cannot be greater than this value after the swap</span>
  72 |     | <span style='background-color: #eee;'>    /// @param data Any data to be passed through to the callback</span>
  73 |     | <span style='background-color: #eee;'>    /// @return amount0 The delta of the balance of token0 of the pool, exact when negative, minimum when positive</span>
  74 |     | <span style='background-color: #eee;'>    /// @return amount1 The delta of the balance of token1 of the pool, exact when negative, minimum when positive</span>
  75 |     | <span style='background-color: #eee;'>    function swap(</span>
  76 |     | <span style='background-color: #eee;'>        address recipient,</span>
  77 |     | <span style='background-color: #eee;'>        bool zeroForOne,</span>
  78 |     | <span style='background-color: #eee;'>        int256 amountSpecified,</span>
  79 |     | <span style='background-color: #eee;'>        uint160 sqrtPriceLimitX96,</span>
  80 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
  81 |     | <span style='background-color: #eee;'>    ) external returns (int256 amount0, int256 amount1);</span>
  82 |     | <span style='background-color: #eee;'></span>
  83 |     | <span style='background-color: #eee;'>    /// @notice Receive token0 and/or token1 and pay it back, plus a fee, in the callback</span>
  84 |     | <span style='background-color: #eee;'>    /// @dev The caller of this method receives a callback in the form of IUniswapV3FlashCallback#uniswapV3FlashCallback</span>
  85 |     | <span style='background-color: #eee;'>    /// @dev Can be used to donate underlying tokens pro-rata to currently in-range liquidity providers by calling</span>
  86 |     | <span style='background-color: #eee;'>    /// with 0 amount{0,1} and sending the donation amount(s) from the callback</span>
  87 |     | <span style='background-color: #eee;'>    /// @param recipient The address which will receive the token0 and token1 amounts</span>
  88 |     | <span style='background-color: #eee;'>    /// @param amount0 The amount of token0 to send</span>
  89 |     | <span style='background-color: #eee;'>    /// @param amount1 The amount of token1 to send</span>
  90 |     | <span style='background-color: #eee;'>    /// @param data Any data to be passed through to the callback</span>
  91 |     | <span style='background-color: #eee;'>    function flash(</span>
  92 |     | <span style='background-color: #eee;'>        address recipient,</span>
  93 |     | <span style='background-color: #eee;'>        uint256 amount0,</span>
  94 |     | <span style='background-color: #eee;'>        uint256 amount1,</span>
  95 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
  96 |     | <span style='background-color: #eee;'>    ) external;</span>
  97 |     | <span style='background-color: #eee;'></span>
  98 |     | <span style='background-color: #eee;'>    /// @notice Increase the maximum number of price and liquidity observations that this pool will store</span>
  99 |     | <span style='background-color: #eee;'>    /// @dev This method is no-op if the pool already has an observationCardinalityNext greater than or equal to</span>
 100 |     | <span style='background-color: #eee;'>    /// the input observationCardinalityNext.</span>
 101 |     | <span style='background-color: #eee;'>    /// @param observationCardinalityNext The desired minimum number of observations for the pool to store</span>
 102 |     | <span style='background-color: #eee;'>    function increaseObservationCardinalityNext(uint16 observationCardinalityNext) external;</span>
 103 |     | <span style='background-color: #eee;'>}</span>
 104 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@uniswap/v3-core/contracts/interfaces/pool/IUniswapV3PoolDerivedState.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-2.0-or-later</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.5.0;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>/// @title Pool state that is not stored</span>
  5 |     | <span style='background-color: #eee;'>/// @notice Contains view functions to provide information about the pool that is computed rather than stored on the</span>
  6 |     | <span style='background-color: #eee;'>/// blockchain. The functions here may have variable gas costs.</span>
  7 |     | <span style='background-color: #eee;'>interface IUniswapV3PoolDerivedState {</span>
  8 |     | <span style='background-color: #eee;'>    /// @notice Returns the cumulative tick and liquidity as of each timestamp `secondsAgo` from the current block timestamp</span>
  9 |     | <span style='background-color: #eee;'>    /// @dev To get a time weighted average tick or liquidity-in-range, you must call this with two values, one representing</span>
 10 |     | <span style='background-color: #eee;'>    /// the beginning of the period and another for the end of the period. E.g., to get the last hour time-weighted average tick,</span>
 11 |     | <span style='background-color: #eee;'>    /// you must call it with secondsAgos = [3600, 0].</span>
 12 |     | <span style='background-color: #eee;'>    /// @dev The time weighted average tick represents the geometric time weighted average price of the pool, in</span>
 13 |     | <span style='background-color: #eee;'>    /// log base sqrt(1.0001) of token1 / token0. The TickMath library can be used to go from a tick value to a ratio.</span>
 14 |     | <span style='background-color: #eee;'>    /// @param secondsAgos From how long ago each cumulative tick and liquidity value should be returned</span>
 15 |     | <span style='background-color: #eee;'>    /// @return tickCumulatives Cumulative tick values as of each `secondsAgos` from the current block timestamp</span>
 16 |     | <span style='background-color: #eee;'>    /// @return secondsPerLiquidityCumulativeX128s Cumulative seconds per liquidity-in-range value as of each `secondsAgos` from the current block</span>
 17 |     | <span style='background-color: #eee;'>    /// timestamp</span>
 18 |     | <span style='background-color: #eee;'>    function observe(uint32[] calldata secondsAgos)</span>
 19 |     | <span style='background-color: #eee;'>        external</span>
 20 |     | <span style='background-color: #eee;'>        view</span>
 21 |     | <span style='background-color: #eee;'>        returns (int56[] memory tickCumulatives, uint160[] memory secondsPerLiquidityCumulativeX128s);</span>
 22 |     | <span style='background-color: #eee;'></span>
 23 |     | <span style='background-color: #eee;'>    /// @notice Returns a snapshot of the tick cumulative, seconds per liquidity and seconds inside a tick range</span>
 24 |     | <span style='background-color: #eee;'>    /// @dev Snapshots must only be compared to other snapshots, taken over a period for which a position existed.</span>
 25 |     | <span style='background-color: #eee;'>    /// I.e., snapshots cannot be compared if a position is not held for the entire period between when the first</span>
 26 |     | <span style='background-color: #eee;'>    /// snapshot is taken and the second snapshot is taken.</span>
 27 |     | <span style='background-color: #eee;'>    /// @param tickLower The lower tick of the range</span>
 28 |     | <span style='background-color: #eee;'>    /// @param tickUpper The upper tick of the range</span>
 29 |     | <span style='background-color: #eee;'>    /// @return tickCumulativeInside The snapshot of the tick accumulator for the range</span>
 30 |     | <span style='background-color: #eee;'>    /// @return secondsPerLiquidityInsideX128 The snapshot of seconds per liquidity for the range</span>
 31 |     | <span style='background-color: #eee;'>    /// @return secondsInside The snapshot of seconds per liquidity for the range</span>
 32 |     | <span style='background-color: #eee;'>    function snapshotCumulativesInside(int24 tickLower, int24 tickUpper)</span>
 33 |     | <span style='background-color: #eee;'>        external</span>
 34 |     | <span style='background-color: #eee;'>        view</span>
 35 |     | <span style='background-color: #eee;'>        returns (</span>
 36 |     | <span style='background-color: #eee;'>            int56 tickCumulativeInside,</span>
 37 |     | <span style='background-color: #eee;'>            uint160 secondsPerLiquidityInsideX128,</span>
 38 |     | <span style='background-color: #eee;'>            uint32 secondsInside</span>
 39 |     | <span style='background-color: #eee;'>        );</span>
 40 |     | <span style='background-color: #eee;'>}</span>
 41 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@uniswap/v3-core/contracts/interfaces/pool/IUniswapV3PoolEvents.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-2.0-or-later</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.5.0;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>/// @title Events emitted by a pool</span>
   5 |     | <span style='background-color: #eee;'>/// @notice Contains all events emitted by the pool</span>
   6 |     | <span style='background-color: #eee;'>interface IUniswapV3PoolEvents {</span>
   7 |     | <span style='background-color: #eee;'>    /// @notice Emitted exactly once by a pool when #initialize is first called on the pool</span>
   8 |     | <span style='background-color: #eee;'>    /// @dev Mint/Burn/Swap cannot be emitted by the pool before Initialize</span>
   9 |     | <span style='background-color: #eee;'>    /// @param sqrtPriceX96 The initial sqrt price of the pool, as a Q64.96</span>
  10 |     | <span style='background-color: #eee;'>    /// @param tick The initial tick of the pool, i.e. log base 1.0001 of the starting price of the pool</span>
  11 |     | <span style='background-color: #eee;'>    event Initialize(uint160 sqrtPriceX96, int24 tick);</span>
  12 |     | <span style='background-color: #eee;'></span>
  13 |     | <span style='background-color: #eee;'>    /// @notice Emitted when liquidity is minted for a given position</span>
  14 |     | <span style='background-color: #eee;'>    /// @param sender The address that minted the liquidity</span>
  15 |     | <span style='background-color: #eee;'>    /// @param owner The owner of the position and recipient of any minted liquidity</span>
  16 |     | <span style='background-color: #eee;'>    /// @param tickLower The lower tick of the position</span>
  17 |     | <span style='background-color: #eee;'>    /// @param tickUpper The upper tick of the position</span>
  18 |     | <span style='background-color: #eee;'>    /// @param amount The amount of liquidity minted to the position range</span>
  19 |     | <span style='background-color: #eee;'>    /// @param amount0 How much token0 was required for the minted liquidity</span>
  20 |     | <span style='background-color: #eee;'>    /// @param amount1 How much token1 was required for the minted liquidity</span>
  21 |     | <span style='background-color: #eee;'>    event Mint(</span>
  22 |     | <span style='background-color: #eee;'>        address sender,</span>
  23 |     | <span style='background-color: #eee;'>        address indexed owner,</span>
  24 |     | <span style='background-color: #eee;'>        int24 indexed tickLower,</span>
  25 |     | <span style='background-color: #eee;'>        int24 indexed tickUpper,</span>
  26 |     | <span style='background-color: #eee;'>        uint128 amount,</span>
  27 |     | <span style='background-color: #eee;'>        uint256 amount0,</span>
  28 |     | <span style='background-color: #eee;'>        uint256 amount1</span>
  29 |     | <span style='background-color: #eee;'>    );</span>
  30 |     | <span style='background-color: #eee;'></span>
  31 |     | <span style='background-color: #eee;'>    /// @notice Emitted when fees are collected by the owner of a position</span>
  32 |     | <span style='background-color: #eee;'>    /// @dev Collect events may be emitted with zero amount0 and amount1 when the caller chooses not to collect fees</span>
  33 |     | <span style='background-color: #eee;'>    /// @param owner The owner of the position for which fees are collected</span>
  34 |     | <span style='background-color: #eee;'>    /// @param tickLower The lower tick of the position</span>
  35 |     | <span style='background-color: #eee;'>    /// @param tickUpper The upper tick of the position</span>
  36 |     | <span style='background-color: #eee;'>    /// @param amount0 The amount of token0 fees collected</span>
  37 |     | <span style='background-color: #eee;'>    /// @param amount1 The amount of token1 fees collected</span>
  38 |     | <span style='background-color: #eee;'>    event Collect(</span>
  39 |     | <span style='background-color: #eee;'>        address indexed owner,</span>
  40 |     | <span style='background-color: #eee;'>        address recipient,</span>
  41 |     | <span style='background-color: #eee;'>        int24 indexed tickLower,</span>
  42 |     | <span style='background-color: #eee;'>        int24 indexed tickUpper,</span>
  43 |     | <span style='background-color: #eee;'>        uint128 amount0,</span>
  44 |     | <span style='background-color: #eee;'>        uint128 amount1</span>
  45 |     | <span style='background-color: #eee;'>    );</span>
  46 |     | <span style='background-color: #eee;'></span>
  47 |     | <span style='background-color: #eee;'>    /// @notice Emitted when a position&#39;s liquidity is removed</span>
  48 |     | <span style='background-color: #eee;'>    /// @dev Does not withdraw any fees earned by the liquidity position, which must be withdrawn via #collect</span>
  49 |     | <span style='background-color: #eee;'>    /// @param owner The owner of the position for which liquidity is removed</span>
  50 |     | <span style='background-color: #eee;'>    /// @param tickLower The lower tick of the position</span>
  51 |     | <span style='background-color: #eee;'>    /// @param tickUpper The upper tick of the position</span>
  52 |     | <span style='background-color: #eee;'>    /// @param amount The amount of liquidity to remove</span>
  53 |     | <span style='background-color: #eee;'>    /// @param amount0 The amount of token0 withdrawn</span>
  54 |     | <span style='background-color: #eee;'>    /// @param amount1 The amount of token1 withdrawn</span>
  55 |     | <span style='background-color: #eee;'>    event Burn(</span>
  56 |     | <span style='background-color: #eee;'>        address indexed owner,</span>
  57 |     | <span style='background-color: #eee;'>        int24 indexed tickLower,</span>
  58 |     | <span style='background-color: #eee;'>        int24 indexed tickUpper,</span>
  59 |     | <span style='background-color: #eee;'>        uint128 amount,</span>
  60 |     | <span style='background-color: #eee;'>        uint256 amount0,</span>
  61 |     | <span style='background-color: #eee;'>        uint256 amount1</span>
  62 |     | <span style='background-color: #eee;'>    );</span>
  63 |     | <span style='background-color: #eee;'></span>
  64 |     | <span style='background-color: #eee;'>    /// @notice Emitted by the pool for any swaps between token0 and token1</span>
  65 |     | <span style='background-color: #eee;'>    /// @param sender The address that initiated the swap call, and that received the callback</span>
  66 |     | <span style='background-color: #eee;'>    /// @param recipient The address that received the output of the swap</span>
  67 |     | <span style='background-color: #eee;'>    /// @param amount0 The delta of the token0 balance of the pool</span>
  68 |     | <span style='background-color: #eee;'>    /// @param amount1 The delta of the token1 balance of the pool</span>
  69 |     | <span style='background-color: #eee;'>    /// @param sqrtPriceX96 The sqrt(price) of the pool after the swap, as a Q64.96</span>
  70 |     | <span style='background-color: #eee;'>    /// @param liquidity The liquidity of the pool after the swap</span>
  71 |     | <span style='background-color: #eee;'>    /// @param tick The log base 1.0001 of price of the pool after the swap</span>
  72 |     | <span style='background-color: #eee;'>    event Swap(</span>
  73 |     | <span style='background-color: #eee;'>        address indexed sender,</span>
  74 |     | <span style='background-color: #eee;'>        address indexed recipient,</span>
  75 |     | <span style='background-color: #eee;'>        int256 amount0,</span>
  76 |     | <span style='background-color: #eee;'>        int256 amount1,</span>
  77 |     | <span style='background-color: #eee;'>        uint160 sqrtPriceX96,</span>
  78 |     | <span style='background-color: #eee;'>        uint128 liquidity,</span>
  79 |     | <span style='background-color: #eee;'>        int24 tick</span>
  80 |     | <span style='background-color: #eee;'>    );</span>
  81 |     | <span style='background-color: #eee;'></span>
  82 |     | <span style='background-color: #eee;'>    /// @notice Emitted by the pool for any flashes of token0/token1</span>
  83 |     | <span style='background-color: #eee;'>    /// @param sender The address that initiated the swap call, and that received the callback</span>
  84 |     | <span style='background-color: #eee;'>    /// @param recipient The address that received the tokens from flash</span>
  85 |     | <span style='background-color: #eee;'>    /// @param amount0 The amount of token0 that was flashed</span>
  86 |     | <span style='background-color: #eee;'>    /// @param amount1 The amount of token1 that was flashed</span>
  87 |     | <span style='background-color: #eee;'>    /// @param paid0 The amount of token0 paid for the flash, which can exceed the amount0 plus the fee</span>
  88 |     | <span style='background-color: #eee;'>    /// @param paid1 The amount of token1 paid for the flash, which can exceed the amount1 plus the fee</span>
  89 |     | <span style='background-color: #eee;'>    event Flash(</span>
  90 |     | <span style='background-color: #eee;'>        address indexed sender,</span>
  91 |     | <span style='background-color: #eee;'>        address indexed recipient,</span>
  92 |     | <span style='background-color: #eee;'>        uint256 amount0,</span>
  93 |     | <span style='background-color: #eee;'>        uint256 amount1,</span>
  94 |     | <span style='background-color: #eee;'>        uint256 paid0,</span>
  95 |     | <span style='background-color: #eee;'>        uint256 paid1</span>
  96 |     | <span style='background-color: #eee;'>    );</span>
  97 |     | <span style='background-color: #eee;'></span>
  98 |     | <span style='background-color: #eee;'>    /// @notice Emitted by the pool for increases to the number of observations that can be stored</span>
  99 |     | <span style='background-color: #eee;'>    /// @dev observationCardinalityNext is not the observation cardinality until an observation is written at the index</span>
 100 |     | <span style='background-color: #eee;'>    /// just before a mint/swap/burn.</span>
 101 |     | <span style='background-color: #eee;'>    /// @param observationCardinalityNextOld The previous value of the next observation cardinality</span>
 102 |     | <span style='background-color: #eee;'>    /// @param observationCardinalityNextNew The updated value of the next observation cardinality</span>
 103 |     | <span style='background-color: #eee;'>    event IncreaseObservationCardinalityNext(</span>
 104 |     | <span style='background-color: #eee;'>        uint16 observationCardinalityNextOld,</span>
 105 |     | <span style='background-color: #eee;'>        uint16 observationCardinalityNextNew</span>
 106 |     | <span style='background-color: #eee;'>    );</span>
 107 |     | <span style='background-color: #eee;'></span>
 108 |     | <span style='background-color: #eee;'>    /// @notice Emitted when the protocol fee is changed by the pool</span>
 109 |     | <span style='background-color: #eee;'>    /// @param feeProtocol0Old The previous value of the token0 protocol fee</span>
 110 |     | <span style='background-color: #eee;'>    /// @param feeProtocol1Old The previous value of the token1 protocol fee</span>
 111 |     | <span style='background-color: #eee;'>    /// @param feeProtocol0New The updated value of the token0 protocol fee</span>
 112 |     | <span style='background-color: #eee;'>    /// @param feeProtocol1New The updated value of the token1 protocol fee</span>
 113 |     | <span style='background-color: #eee;'>    event SetFeeProtocol(uint8 feeProtocol0Old, uint8 feeProtocol1Old, uint8 feeProtocol0New, uint8 feeProtocol1New);</span>
 114 |     | <span style='background-color: #eee;'></span>
 115 |     | <span style='background-color: #eee;'>    /// @notice Emitted when the collected protocol fees are withdrawn by the factory owner</span>
 116 |     | <span style='background-color: #eee;'>    /// @param sender The address that collects the protocol fees</span>
 117 |     | <span style='background-color: #eee;'>    /// @param recipient The address that receives the collected protocol fees</span>
 118 |     | <span style='background-color: #eee;'>    /// @param amount0 The amount of token0 protocol fees that is withdrawn</span>
 119 |     | <span style='background-color: #eee;'>    /// @param amount0 The amount of token1 protocol fees that is withdrawn</span>
 120 |     | <span style='background-color: #eee;'>    event CollectProtocol(address indexed sender, address indexed recipient, uint128 amount0, uint128 amount1);</span>
 121 |     | <span style='background-color: #eee;'>}</span>
 122 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@uniswap/v3-core/contracts/interfaces/pool/IUniswapV3PoolImmutables.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-2.0-or-later</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.5.0;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>/// @title Pool state that never changes</span>
  5 |     | <span style='background-color: #eee;'>/// @notice These parameters are fixed for a pool forever, i.e., the methods will always return the same values</span>
  6 |     | <span style='background-color: #eee;'>interface IUniswapV3PoolImmutables {</span>
  7 |     | <span style='background-color: #eee;'>    /// @notice The contract that deployed the pool, which must adhere to the IUniswapV3Factory interface</span>
  8 |     | <span style='background-color: #eee;'>    /// @return The contract address</span>
  9 |     | <span style='background-color: #eee;'>    function factory() external view returns (address);</span>
 10 |     | <span style='background-color: #eee;'></span>
 11 |     | <span style='background-color: #eee;'>    /// @notice The first of the two tokens of the pool, sorted by address</span>
 12 |     | <span style='background-color: #eee;'>    /// @return The token contract address</span>
 13 |     | <span style='background-color: #eee;'>    function token0() external view returns (address);</span>
 14 |     | <span style='background-color: #eee;'></span>
 15 |     | <span style='background-color: #eee;'>    /// @notice The second of the two tokens of the pool, sorted by address</span>
 16 |     | <span style='background-color: #eee;'>    /// @return The token contract address</span>
 17 |     | <span style='background-color: #eee;'>    function token1() external view returns (address);</span>
 18 |     | <span style='background-color: #eee;'></span>
 19 |     | <span style='background-color: #eee;'>    /// @notice The pool&#39;s fee in hundredths of a bip, i.e. 1e-6</span>
 20 |     | <span style='background-color: #eee;'>    /// @return The fee</span>
 21 |     | <span style='background-color: #eee;'>    function fee() external view returns (uint24);</span>
 22 |     | <span style='background-color: #eee;'></span>
 23 |     | <span style='background-color: #eee;'>    /// @notice The pool tick spacing</span>
 24 |     | <span style='background-color: #eee;'>    /// @dev Ticks can only be used at multiples of this value, minimum of 1 and always positive</span>
 25 |     | <span style='background-color: #eee;'>    /// e.g.: a tickSpacing of 3 means ticks can be initialized every 3rd tick, i.e., ..., -6, -3, 0, 3, 6, ...</span>
 26 |     | <span style='background-color: #eee;'>    /// This value is an int24 to avoid casting even though it is always positive.</span>
 27 |     | <span style='background-color: #eee;'>    /// @return The tick spacing</span>
 28 |     | <span style='background-color: #eee;'>    function tickSpacing() external view returns (int24);</span>
 29 |     | <span style='background-color: #eee;'></span>
 30 |     | <span style='background-color: #eee;'>    /// @notice The maximum amount of position liquidity that can use any tick in the range</span>
 31 |     | <span style='background-color: #eee;'>    /// @dev This parameter is enforced per tick to prevent liquidity from overflowing a uint128 at any point, and</span>
 32 |     | <span style='background-color: #eee;'>    /// also prevents out-of-range liquidity from being used to prevent adding in-range liquidity to a pool</span>
 33 |     | <span style='background-color: #eee;'>    /// @return The max amount of liquidity per tick</span>
 34 |     | <span style='background-color: #eee;'>    function maxLiquidityPerTick() external view returns (uint128);</span>
 35 |     | <span style='background-color: #eee;'>}</span>
 36 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@uniswap/v3-core/contracts/interfaces/pool/IUniswapV3PoolOwnerActions.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-2.0-or-later</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.5.0;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>/// @title Permissioned pool actions</span>
  5 |     | <span style='background-color: #eee;'>/// @notice Contains pool methods that may only be called by the factory owner</span>
  6 |     | <span style='background-color: #eee;'>interface IUniswapV3PoolOwnerActions {</span>
  7 |     | <span style='background-color: #eee;'>    /// @notice Set the denominator of the protocol&#39;s % share of the fees</span>
  8 |     | <span style='background-color: #eee;'>    /// @param feeProtocol0 new protocol fee for token0 of the pool</span>
  9 |     | <span style='background-color: #eee;'>    /// @param feeProtocol1 new protocol fee for token1 of the pool</span>
 10 |     | <span style='background-color: #eee;'>    function setFeeProtocol(uint8 feeProtocol0, uint8 feeProtocol1) external;</span>
 11 |     | <span style='background-color: #eee;'></span>
 12 |     | <span style='background-color: #eee;'>    /// @notice Collect the protocol fee accrued to the pool</span>
 13 |     | <span style='background-color: #eee;'>    /// @param recipient The address to which collected protocol fees should be sent</span>
 14 |     | <span style='background-color: #eee;'>    /// @param amount0Requested The maximum amount of token0 to send, can be 0 to collect fees in only token1</span>
 15 |     | <span style='background-color: #eee;'>    /// @param amount1Requested The maximum amount of token1 to send, can be 0 to collect fees in only token0</span>
 16 |     | <span style='background-color: #eee;'>    /// @return amount0 The protocol fee collected in token0</span>
 17 |     | <span style='background-color: #eee;'>    /// @return amount1 The protocol fee collected in token1</span>
 18 |     | <span style='background-color: #eee;'>    function collectProtocol(</span>
 19 |     | <span style='background-color: #eee;'>        address recipient,</span>
 20 |     | <span style='background-color: #eee;'>        uint128 amount0Requested,</span>
 21 |     | <span style='background-color: #eee;'>        uint128 amount1Requested</span>
 22 |     | <span style='background-color: #eee;'>    ) external returns (uint128 amount0, uint128 amount1);</span>
 23 |     | <span style='background-color: #eee;'>}</span>
 24 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@uniswap/v3-core/contracts/interfaces/pool/IUniswapV3PoolState.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-2.0-or-later</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.5.0;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>/// @title Pool state that can change</span>
   5 |     | <span style='background-color: #eee;'>/// @notice These methods compose the pool&#39;s state, and can change with any frequency including multiple times</span>
   6 |     | <span style='background-color: #eee;'>/// per transaction</span>
   7 |     | <span style='background-color: #eee;'>interface IUniswapV3PoolState {</span>
   8 |     | <span style='background-color: #eee;'>    /// @notice The 0th storage slot in the pool stores many values, and is exposed as a single method to save gas</span>
   9 |     | <span style='background-color: #eee;'>    /// when accessed externally.</span>
  10 |     | <span style='background-color: #eee;'>    /// @return sqrtPriceX96 The current price of the pool as a sqrt(token1/token0) Q64.96 value</span>
  11 |     | <span style='background-color: #eee;'>    /// tick The current tick of the pool, i.e. according to the last tick transition that was run.</span>
  12 |     | <span style='background-color: #eee;'>    /// This value may not always be equal to SqrtTickMath.getTickAtSqrtRatio(sqrtPriceX96) if the price is on a tick</span>
  13 |     | <span style='background-color: #eee;'>    /// boundary.</span>
  14 |     | <span style='background-color: #eee;'>    /// observationIndex The index of the last oracle observation that was written,</span>
  15 |     | <span style='background-color: #eee;'>    /// observationCardinality The current maximum number of observations stored in the pool,</span>
  16 |     | <span style='background-color: #eee;'>    /// observationCardinalityNext The next maximum number of observations, to be updated when the observation.</span>
  17 |     | <span style='background-color: #eee;'>    /// feeProtocol The protocol fee for both tokens of the pool.</span>
  18 |     | <span style='background-color: #eee;'>    /// Encoded as two 4 bit values, where the protocol fee of token1 is shifted 4 bits and the protocol fee of token0</span>
  19 |     | <span style='background-color: #eee;'>    /// is the lower 4 bits. Used as the denominator of a fraction of the swap fee, e.g. 4 means 1/4th of the swap fee.</span>
  20 |     | <span style='background-color: #eee;'>    /// unlocked Whether the pool is currently locked to reentrancy</span>
  21 |     | <span style='background-color: #eee;'>    function slot0()</span>
  22 |     | <span style='background-color: #eee;'>        external</span>
  23 |     | <span style='background-color: #eee;'>        view</span>
  24 |     | <span style='background-color: #eee;'>        returns (</span>
  25 |     | <span style='background-color: #eee;'>            uint160 sqrtPriceX96,</span>
  26 |     | <span style='background-color: #eee;'>            int24 tick,</span>
  27 |     | <span style='background-color: #eee;'>            uint16 observationIndex,</span>
  28 |     | <span style='background-color: #eee;'>            uint16 observationCardinality,</span>
  29 |     | <span style='background-color: #eee;'>            uint16 observationCardinalityNext,</span>
  30 |     | <span style='background-color: #eee;'>            uint8 feeProtocol,</span>
  31 |     | <span style='background-color: #eee;'>            bool unlocked</span>
  32 |     | <span style='background-color: #eee;'>        );</span>
  33 |     | <span style='background-color: #eee;'></span>
  34 |     | <span style='background-color: #eee;'>    /// @notice The fee growth as a Q128.128 fees of token0 collected per unit of liquidity for the entire life of the pool</span>
  35 |     | <span style='background-color: #eee;'>    /// @dev This value can overflow the uint256</span>
  36 |     | <span style='background-color: #eee;'>    function feeGrowthGlobal0X128() external view returns (uint256);</span>
  37 |     | <span style='background-color: #eee;'></span>
  38 |     | <span style='background-color: #eee;'>    /// @notice The fee growth as a Q128.128 fees of token1 collected per unit of liquidity for the entire life of the pool</span>
  39 |     | <span style='background-color: #eee;'>    /// @dev This value can overflow the uint256</span>
  40 |     | <span style='background-color: #eee;'>    function feeGrowthGlobal1X128() external view returns (uint256);</span>
  41 |     | <span style='background-color: #eee;'></span>
  42 |     | <span style='background-color: #eee;'>    /// @notice The amounts of token0 and token1 that are owed to the protocol</span>
  43 |     | <span style='background-color: #eee;'>    /// @dev Protocol fees will never exceed uint128 max in either token</span>
  44 |     | <span style='background-color: #eee;'>    function protocolFees() external view returns (uint128 token0, uint128 token1);</span>
  45 |     | <span style='background-color: #eee;'></span>
  46 |     | <span style='background-color: #eee;'>    /// @notice The currently in range liquidity available to the pool</span>
  47 |     | <span style='background-color: #eee;'>    /// @dev This value has no relationship to the total liquidity across all ticks</span>
  48 |     | <span style='background-color: #eee;'>    function liquidity() external view returns (uint128);</span>
  49 |     | <span style='background-color: #eee;'></span>
  50 |     | <span style='background-color: #eee;'>    /// @notice Look up information about a specific tick in the pool</span>
  51 |     | <span style='background-color: #eee;'>    /// @param tick The tick to look up</span>
  52 |     | <span style='background-color: #eee;'>    /// @return liquidityGross the total amount of position liquidity that uses the pool either as tick lower or</span>
  53 |     | <span style='background-color: #eee;'>    /// tick upper,</span>
  54 |     | <span style='background-color: #eee;'>    /// liquidityNet how much liquidity changes when the pool price crosses the tick,</span>
  55 |     | <span style='background-color: #eee;'>    /// feeGrowthOutside0X128 the fee growth on the other side of the tick from the current tick in token0,</span>
  56 |     | <span style='background-color: #eee;'>    /// feeGrowthOutside1X128 the fee growth on the other side of the tick from the current tick in token1,</span>
  57 |     | <span style='background-color: #eee;'>    /// tickCumulativeOutside the cumulative tick value on the other side of the tick from the current tick</span>
  58 |     | <span style='background-color: #eee;'>    /// secondsPerLiquidityOutsideX128 the seconds spent per liquidity on the other side of the tick from the current tick,</span>
  59 |     | <span style='background-color: #eee;'>    /// secondsOutside the seconds spent on the other side of the tick from the current tick,</span>
  60 |     | <span style='background-color: #eee;'>    /// initialized Set to true if the tick is initialized, i.e. liquidityGross is greater than 0, otherwise equal to false.</span>
  61 |     | <span style='background-color: #eee;'>    /// Outside values can only be used if the tick is initialized, i.e. if liquidityGross is greater than 0.</span>
  62 |     | <span style='background-color: #eee;'>    /// In addition, these values are only relative and must be used only in comparison to previous snapshots for</span>
  63 |     | <span style='background-color: #eee;'>    /// a specific position.</span>
  64 |     | <span style='background-color: #eee;'>    function ticks(int24 tick)</span>
  65 |     | <span style='background-color: #eee;'>        external</span>
  66 |     | <span style='background-color: #eee;'>        view</span>
  67 |     | <span style='background-color: #eee;'>        returns (</span>
  68 |     | <span style='background-color: #eee;'>            uint128 liquidityGross,</span>
  69 |     | <span style='background-color: #eee;'>            int128 liquidityNet,</span>
  70 |     | <span style='background-color: #eee;'>            uint256 feeGrowthOutside0X128,</span>
  71 |     | <span style='background-color: #eee;'>            uint256 feeGrowthOutside1X128,</span>
  72 |     | <span style='background-color: #eee;'>            int56 tickCumulativeOutside,</span>
  73 |     | <span style='background-color: #eee;'>            uint160 secondsPerLiquidityOutsideX128,</span>
  74 |     | <span style='background-color: #eee;'>            uint32 secondsOutside,</span>
  75 |     | <span style='background-color: #eee;'>            bool initialized</span>
  76 |     | <span style='background-color: #eee;'>        );</span>
  77 |     | <span style='background-color: #eee;'></span>
  78 |     | <span style='background-color: #eee;'>    /// @notice Returns 256 packed tick initialized boolean values. See TickBitmap for more information</span>
  79 |     | <span style='background-color: #eee;'>    function tickBitmap(int16 wordPosition) external view returns (uint256);</span>
  80 |     | <span style='background-color: #eee;'></span>
  81 |     | <span style='background-color: #eee;'>    /// @notice Returns the information about a position by the position&#39;s key</span>
  82 |     | <span style='background-color: #eee;'>    /// @param key The position&#39;s key is a hash of a preimage composed by the owner, tickLower and tickUpper</span>
  83 |     | <span style='background-color: #eee;'>    /// @return _liquidity The amount of liquidity in the position,</span>
  84 |     | <span style='background-color: #eee;'>    /// Returns feeGrowthInside0LastX128 fee growth of token0 inside the tick range as of the last mint/burn/poke,</span>
  85 |     | <span style='background-color: #eee;'>    /// Returns feeGrowthInside1LastX128 fee growth of token1 inside the tick range as of the last mint/burn/poke,</span>
  86 |     | <span style='background-color: #eee;'>    /// Returns tokensOwed0 the computed amount of token0 owed to the position as of the last mint/burn/poke,</span>
  87 |     | <span style='background-color: #eee;'>    /// Returns tokensOwed1 the computed amount of token1 owed to the position as of the last mint/burn/poke</span>
  88 |     | <span style='background-color: #eee;'>    function positions(bytes32 key)</span>
  89 |     | <span style='background-color: #eee;'>        external</span>
  90 |     | <span style='background-color: #eee;'>        view</span>
  91 |     | <span style='background-color: #eee;'>        returns (</span>
  92 |     | <span style='background-color: #eee;'>            uint128 _liquidity,</span>
  93 |     | <span style='background-color: #eee;'>            uint256 feeGrowthInside0LastX128,</span>
  94 |     | <span style='background-color: #eee;'>            uint256 feeGrowthInside1LastX128,</span>
  95 |     | <span style='background-color: #eee;'>            uint128 tokensOwed0,</span>
  96 |     | <span style='background-color: #eee;'>            uint128 tokensOwed1</span>
  97 |     | <span style='background-color: #eee;'>        );</span>
  98 |     | <span style='background-color: #eee;'></span>
  99 |     | <span style='background-color: #eee;'>    /// @notice Returns data about a specific observation index</span>
 100 |     | <span style='background-color: #eee;'>    /// @param index The element of the observations array to fetch</span>
 101 |     | <span style='background-color: #eee;'>    /// @dev You most likely want to use #observe() instead of this method to get an observation as of some amount of time</span>
 102 |     | <span style='background-color: #eee;'>    /// ago, rather than at a specific index in the array.</span>
 103 |     | <span style='background-color: #eee;'>    /// @return blockTimestamp The timestamp of the observation,</span>
 104 |     | <span style='background-color: #eee;'>    /// Returns tickCumulative the tick multiplied by seconds elapsed for the life of the pool as of the observation timestamp,</span>
 105 |     | <span style='background-color: #eee;'>    /// Returns secondsPerLiquidityCumulativeX128 the seconds per in range liquidity for the life of the pool as of the observation timestamp,</span>
 106 |     | <span style='background-color: #eee;'>    /// Returns initialized whether the observation has been initialized and the values are safe to use</span>
 107 |     | <span style='background-color: #eee;'>    function observations(uint256 index)</span>
 108 |     | <span style='background-color: #eee;'>        external</span>
 109 |     | <span style='background-color: #eee;'>        view</span>
 110 |     | <span style='background-color: #eee;'>        returns (</span>
 111 |     | <span style='background-color: #eee;'>            uint32 blockTimestamp,</span>
 112 |     | <span style='background-color: #eee;'>            int56 tickCumulative,</span>
 113 |     | <span style='background-color: #eee;'>            uint160 secondsPerLiquidityCumulativeX128,</span>
 114 |     | <span style='background-color: #eee;'>            bool initialized</span>
 115 |     | <span style='background-color: #eee;'>        );</span>
 116 |     | <span style='background-color: #eee;'>}</span>
 117 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@uniswap/v3-core/contracts/libraries/FixedPoint96.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-2.0-or-later</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.4.0;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>/// @title FixedPoint96</span>
  5 |     | <span style='background-color: #eee;'>/// @notice A library for handling binary fixed point numbers, see https://en.wikipedia.org/wiki/Q_(number_format)</span>
  6 |     | <span style='background-color: #faa;'>/// @dev Used in SqrtPriceMath.sol</span>
  7 |     | <span style='background-color: #eee;'>library FixedPoint96 {</span>
  8 |     | <span style='background-color: #eee;'>    uint8 internal constant RESOLUTION = 96;</span>
  9 |     | <span style='background-color: #faa;'>    uint256 internal constant Q96 = 0x1000000000000000000000000;</span>
 10 |     | <span style='background-color: #eee;'>}</span>
 11 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/@uniswap/v3-periphery/contracts/interfaces/ISwapRouter.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-2.0-or-later</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.7.5;</span>
  3 |     | <span style='background-color: #eee;'>pragma abicoder v2;</span>
  4 |     | <span style='background-color: #eee;'></span>
  5 |     | <span style='background-color: #eee;'>import &#39;@uniswap/v3-core/contracts/interfaces/callback/IUniswapV3SwapCallback.sol&#39;;</span>
  6 |     | <span style='background-color: #eee;'></span>
  7 |     | <span style='background-color: #eee;'>/// @title Router token swapping functionality</span>
  8 |     | <span style='background-color: #eee;'>/// @notice Functions for swapping tokens via Uniswap V3</span>
  9 |     | <span style='background-color: #eee;'>interface ISwapRouter is IUniswapV3SwapCallback {</span>
 10 |     | <span style='background-color: #eee;'>    struct ExactInputSingleParams {</span>
 11 |     | <span style='background-color: #eee;'>        address tokenIn;</span>
 12 |     | <span style='background-color: #eee;'>        address tokenOut;</span>
 13 |     | <span style='background-color: #eee;'>        uint24 fee;</span>
 14 |     | <span style='background-color: #eee;'>        address recipient;</span>
 15 |     | <span style='background-color: #eee;'>        uint256 deadline;</span>
 16 |     | <span style='background-color: #eee;'>        uint256 amountIn;</span>
 17 |     | <span style='background-color: #eee;'>        uint256 amountOutMinimum;</span>
 18 |     | <span style='background-color: #eee;'>        uint160 sqrtPriceLimitX96;</span>
 19 |     | <span style='background-color: #eee;'>    }</span>
 20 |     | <span style='background-color: #eee;'></span>
 21 |     | <span style='background-color: #eee;'>    /// @notice Swaps `amountIn` of one token for as much as possible of another token</span>
 22 |     | <span style='background-color: #eee;'>    /// @param params The parameters necessary for the swap, encoded as `ExactInputSingleParams` in calldata</span>
 23 |     | <span style='background-color: #eee;'>    /// @return amountOut The amount of the received token</span>
 24 |     | <span style='background-color: #eee;'>    function exactInputSingle(ExactInputSingleParams calldata params) external payable returns (uint256 amountOut);</span>
 25 |     | <span style='background-color: #eee;'></span>
 26 |     | <span style='background-color: #eee;'>    struct ExactInputParams {</span>
 27 |     | <span style='background-color: #eee;'>        bytes path;</span>
 28 |     | <span style='background-color: #eee;'>        address recipient;</span>
 29 |     | <span style='background-color: #eee;'>        uint256 deadline;</span>
 30 |     | <span style='background-color: #eee;'>        uint256 amountIn;</span>
 31 |     | <span style='background-color: #eee;'>        uint256 amountOutMinimum;</span>
 32 |     | <span style='background-color: #eee;'>    }</span>
 33 |     | <span style='background-color: #eee;'></span>
 34 |     | <span style='background-color: #eee;'>    /// @notice Swaps `amountIn` of one token for as much as possible of another along the specified path</span>
 35 |     | <span style='background-color: #eee;'>    /// @param params The parameters necessary for the multi-hop swap, encoded as `ExactInputParams` in calldata</span>
 36 |     | <span style='background-color: #eee;'>    /// @return amountOut The amount of the received token</span>
 37 |     | <span style='background-color: #eee;'>    function exactInput(ExactInputParams calldata params) external payable returns (uint256 amountOut);</span>
 38 |     | <span style='background-color: #eee;'></span>
 39 |     | <span style='background-color: #eee;'>    struct ExactOutputSingleParams {</span>
 40 |     | <span style='background-color: #eee;'>        address tokenIn;</span>
 41 |     | <span style='background-color: #eee;'>        address tokenOut;</span>
 42 |     | <span style='background-color: #eee;'>        uint24 fee;</span>
 43 |     | <span style='background-color: #eee;'>        address recipient;</span>
 44 |     | <span style='background-color: #eee;'>        uint256 deadline;</span>
 45 |     | <span style='background-color: #eee;'>        uint256 amountOut;</span>
 46 |     | <span style='background-color: #eee;'>        uint256 amountInMaximum;</span>
 47 |     | <span style='background-color: #eee;'>        uint160 sqrtPriceLimitX96;</span>
 48 |     | <span style='background-color: #eee;'>    }</span>
 49 |     | <span style='background-color: #eee;'></span>
 50 |     | <span style='background-color: #eee;'>    /// @notice Swaps as little as possible of one token for `amountOut` of another token</span>
 51 |     | <span style='background-color: #eee;'>    /// @param params The parameters necessary for the swap, encoded as `ExactOutputSingleParams` in calldata</span>
 52 |     | <span style='background-color: #eee;'>    /// @return amountIn The amount of the input token</span>
 53 |     | <span style='background-color: #eee;'>    function exactOutputSingle(ExactOutputSingleParams calldata params) external payable returns (uint256 amountIn);</span>
 54 |     | <span style='background-color: #eee;'></span>
 55 |     | <span style='background-color: #eee;'>    struct ExactOutputParams {</span>
 56 |     | <span style='background-color: #eee;'>        bytes path;</span>
 57 |     | <span style='background-color: #eee;'>        address recipient;</span>
 58 |     | <span style='background-color: #eee;'>        uint256 deadline;</span>
 59 |     | <span style='background-color: #eee;'>        uint256 amountOut;</span>
 60 |     | <span style='background-color: #eee;'>        uint256 amountInMaximum;</span>
 61 |     | <span style='background-color: #eee;'>    }</span>
 62 |     | <span style='background-color: #eee;'></span>
 63 |     | <span style='background-color: #eee;'>    /// @notice Swaps as little as possible of one token for `amountOut` of another along the specified path (reversed)</span>
 64 |     | <span style='background-color: #eee;'>    /// @param params The parameters necessary for the multi-hop swap, encoded as `ExactOutputParams` in calldata</span>
 65 |     | <span style='background-color: #eee;'>    /// @return amountIn The amount of the input token</span>
 66 |     | <span style='background-color: #eee;'>    function exactOutput(ExactOutputParams calldata params) external payable returns (uint256 amountIn);</span>
 67 |     | <span style='background-color: #eee;'>}</span>
 68 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/dos/DOS.sol</b>
<code>
    1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
    2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
    3 |     | <span style='background-color: #eee;'></span>
    4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/proxy/Proxy.sol&quot;;</span>
    5 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
    6 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol&quot;;</span>
    7 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC721/ERC721.sol&quot;;</span>
    8 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC721/IERC721Receiver.sol&quot;;</span>
    9 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span>
   10 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/security/Pausable.sol&quot;;</span>
   11 |     | <span style='background-color: #eee;'>import &quot;../lib/FsUtils.sol&quot;;</span>
   12 |     | <span style='background-color: #eee;'>import &quot;../lib/FsMath.sol&quot;;</span>
   13 |     | <span style='background-color: #eee;'>import &quot;../interfaces/IDOS.sol&quot;;</span>
   14 |     | <span style='background-color: #eee;'>import &quot;../interfaces/IERC20ValueOracle.sol&quot;;</span>
   15 |     | <span style='background-color: #eee;'>import &quot;../interfaces/INFTValueOracle.sol&quot;;</span>
   16 |     | <span style='background-color: #eee;'>import {PERMIT2, IPermit2} from &quot;../external/interfaces/IPermit2.sol&quot;;</span>
   17 |     | <span style='background-color: #eee;'>import {DSafeProxy} from &quot;./DSafeProxy.sol&quot;;</span>
   18 |     | <span style='background-color: #eee;'>import {IVersionManager} from &quot;../interfaces/IVersionManager.sol&quot;;</span>
   19 |     | <span style='background-color: #eee;'>import &quot;../lib/Call.sol&quot;;</span>
   20 |     | <span style='background-color: #eee;'>import &quot;../lib/ImmutableGovernance.sol&quot;;</span>
   21 |     | <span style='background-color: #eee;'>import {IERC1363SpenderExtended, IERC1363ReceiverExtended} from &quot;../interfaces/IERC1363-extended.sol&quot;;</span>
   22 |     | <span style='background-color: #eee;'></span>
   23 |     | <span style='background-color: #eee;'>/// @notice Sender is not approved to spend dSafe erc20</span>
   24 |     | <span style='background-color: #eee;'>error NotApprovedOrOwner();</span>
   25 |     | <span style='background-color: #eee;'>/// @notice Sender is not the owner of the dSafe;</span>
   26 |     | <span style='background-color: #eee;'>/// @param sender The address of the sender</span>
   27 |     | <span style='background-color: #eee;'>/// @param owner The address of the owner</span>
   28 |     | <span style='background-color: #eee;'>error NotOwner(address sender, address owner);</span>
   29 |     | <span style='background-color: #eee;'>/// @notice Transfer amount exceeds allowance</span>
   30 |     | <span style='background-color: #eee;'>error InsufficientAllowance();</span>
   31 |     | <span style='background-color: #eee;'>/// @notice Cannot approve self as spender</span>
   32 |     | <span style='background-color: #eee;'>error SelfApproval();</span>
   33 |     | <span style='background-color: #eee;'>/// @notice The receiving address is not a contract</span>
   34 |     | <span style='background-color: #eee;'>error ReceiverNotContract();</span>
   35 |     | <span style='background-color: #eee;'>/// @notice The receiver does not implement the required interface</span>
   36 |     | <span style='background-color: #eee;'>error ReceiverNoImplementation();</span>
   37 |     | <span style='background-color: #eee;'>/// @notice The receiver did not return the correct value - transaction failed</span>
   38 |     | <span style='background-color: #eee;'>error WrongDataReturned();</span>
   39 |     | <span style='background-color: #eee;'>/// @notice Asset is not an NFT</span>
   40 |     | <span style='background-color: #eee;'>error NotNFT();</span>
   41 |     | <span style='background-color: #eee;'>/// @notice NFT must be in the user&#39;s dSafe</span>
   42 |     | <span style='background-color: #eee;'>error NFTNotInDSafe();</span>
   43 |     | <span style='background-color: #eee;'>/// @notice NFT must be owned the the user or user&#39;s dSafe</span>
   44 |     | <span style='background-color: #eee;'>error NotNFTOwner();</span>
   45 |     | <span style='background-color: #eee;'>/// @notice Asset is not registered</span>
   46 |     | <span style='background-color: #eee;'>/// @param token The unregistered asset</span>
   47 |     | <span style='background-color: #eee;'>error NotRegistered(address token);</span>
   48 |     | <span style='background-color: #eee;'>/// @notice Only dSafe can call this function</span>
   49 |     | <span style='background-color: #eee;'>error OnlyDSafe();</span>
   50 |     | <span style='background-color: #eee;'>/// @notice Recipient is not a valid dSafe</span>
   51 |     | <span style='background-color: #eee;'>error DSafeNonExistent();</span>
   52 |     | <span style='background-color: #eee;'>/// @notice Operation leaves dSafe insolvent</span>
   53 |     | <span style='background-color: #eee;'>error Insolvent();</span>
   54 |     | <span style='background-color: #eee;'>/// @notice The address is not a registered ERC20</span>
   55 |     | <span style='background-color: #eee;'>error NotERC20();</span>
   56 |     | <span style='background-color: #eee;'></span>
   57 |     | <span style='background-color: #eee;'>// ERC20 standard token</span>
   58 |     | <span style='background-color: #eee;'>// ERC721 single non-fungible token support</span>
   59 |     | <span style='background-color: #eee;'>// ERC677 transferAndCall (transferAndCall2 extension)</span>
   60 |     | <span style='background-color: #eee;'>// ERC165 interface support (solidity IDOS.interfaceId)</span>
   61 |     | <span style='background-color: #eee;'>// ERC777 token send</span>
   62 |     | <span style='background-color: #eee;'>// ERC1155 multi-token support</span>
   63 |     | <span style='background-color: #eee;'>// ERC1363 payable token (approveAndCall/transferAndCall)</span>
   64 |     | <span style='background-color: #eee;'>// ERC1820 interface registry support</span>
   65 |     | <span style='background-color: #eee;'>// EIP2612 permit support (uniswap permit2)</span>
   66 |     | <span style='background-color: #eee;'>/*</span>
   67 |     | <span style='background-color: #eee;'> * NFTs are stored in an array of nfts owned by some dSafe. To prevent looping over arrays we need to</span>
   68 |     | <span style='background-color: #eee;'> * know the following information for each NFT in the system (erc721, tokenId, dSafe, array index).</span>
   69 |     | <span style='background-color: #eee;'> * Given the expensive nature of storage on the EVM we want to store all information as small as possible.</span>
   70 |     | <span style='background-color: #eee;'> * The pair (erc721, tokenId) is describes a particular NFT but would take two storage slots (as a token id)</span>
   71 |     | <span style='background-color: #eee;'> * is 256 bits. The erc721 address is 160 bits however we only allow pre-approved erc721 contracts, so in</span>
   72 |     | <span style='background-color: #eee;'> * practice 16 bits would be enough to store an index into the allowed erc721 contracts. We can hash (erc721 + tokenId)</span>
   73 |     | <span style='background-color: #eee;'> * to get a unique number but that requires storing both tokenId, erc721 and array index. Instead we hash into</span>
   74 |     | <span style='background-color: #eee;'> * 224 (256 - 32) bits which is still sufficiently large to avoid collisions. This leaves 32 bits for additional</span>
   75 |     | <span style='background-color: #eee;'> * information. The 16 LSB are used to store the index in the dSafe array. The 16 RSB are used to store</span>
   76 |     | <span style='background-color: #eee;'> * the 16 RSB of the tokenId. This allows us to store the tokenId + array index in a single storage slot as a map</span>
   77 |     | <span style='background-color: #eee;'> * from NFTId to NFTData. Note that the index in the dSafe array might change and thus cannot be part of</span>
   78 |     | <span style='background-color: #eee;'> * NFTId and thus has to be stored as part of NFTData, requiring the splitting of tokenId.</span>
   79 |     | <span style='background-color: #eee;'> */</span>
   80 |     | <span style='background-color: #eee;'></span>
   81 |     | <span style='background-color: #eee;'>struct NFTTokenData {</span>
   82 |     | <span style='background-color: #eee;'>    uint240 tokenId; // 240 LSB of the tokenId of the NFT</span>
   83 |     | <span style='background-color: #eee;'>    uint16 dSafeIdx; // index in dSafe NFT array</span>
   84 |     | <span style='background-color: #eee;'>    address approvedSpender; // approved spender for ERC721</span>
   85 |     | <span style='background-color: #eee;'>}</span>
   86 |     | <span style='background-color: #eee;'></span>
   87 |     | <span style='background-color: #eee;'>struct ERC20Pool {</span>
   88 |     | <span style='background-color: #eee;'>    int256 tokens;</span>
   89 |     | <span style='background-color: #eee;'>    int256 shares;</span>
   90 |     | <span style='background-color: #eee;'>}</span>
   91 |     | <span style='background-color: #eee;'></span>
   92 |     | <span style='background-color: #eee;'>struct ERC20Info {</span>
   93 |     | <span style='background-color: #eee;'>    address erc20Contract;</span>
   94 |     | <span style='background-color: #eee;'>    IERC20ValueOracle valueOracle;</span>
   95 |     | <span style='background-color: #eee;'>    ERC20Pool collateral;</span>
   96 |     | <span style='background-color: #eee;'>    ERC20Pool debt;</span>
   97 |     | <span style='background-color: #eee;'>    uint256 baseRate;</span>
   98 |     | <span style='background-color: #eee;'>    uint256 slope1;</span>
   99 |     | <span style='background-color: #eee;'>    uint256 slope2;</span>
  100 |     | <span style='background-color: #eee;'>    uint256 targetUtilization;</span>
  101 |     | <span style='background-color: #eee;'>    uint256 timestamp;</span>
  102 |     | <span style='background-color: #eee;'>}</span>
  103 |     | <span style='background-color: #eee;'></span>
  104 |     | <span style='background-color: #eee;'>struct ERC721Info {</span>
  105 |     | <span style='background-color: #eee;'>    address erc721Contract;</span>
  106 |     | <span style='background-color: #eee;'>    INFTValueOracle valueOracle;</span>
  107 |     | <span style='background-color: #eee;'>}</span>
  108 |     | <span style='background-color: #eee;'></span>
  109 |     | <span style='background-color: #eee;'>struct ContractData {</span>
  110 |     | <span style='background-color: #eee;'>    uint16 idx;</span>
  111 |     | <span style='background-color: #eee;'>    ContractKind kind; // 0 invalid, 1 ERC20, 2 ERC721</span>
  112 |     | <span style='background-color: #eee;'>}</span>
  113 |     | <span style='background-color: #eee;'></span>
  114 |     | <span style='background-color: #eee;'>enum ContractKind {</span>
  115 |     | <span style='background-color: #eee;'>    Invalid,</span>
  116 |     | <span style='background-color: #eee;'>    ERC20,</span>
  117 |     | <span style='background-color: #eee;'>    ERC721</span>
  118 |     | <span style='background-color: #eee;'>}</span>
  119 |     | <span style='background-color: #eee;'></span>
  120 |     | <span style='background-color: #eee;'>// We will initialize the system so that 0 is the base currency</span>
  121 |     | <span style='background-color: #eee;'>// in which the system calculates value.</span>
  122 |     | <span style='background-color: #eee;'>uint16 constant K_NUMERAIRE_IDX = 0;</span>
  123 |     | <span style='background-color: #faa;'></span>
  124 |     | <span style='background-color: #eee;'>library DSafeLib {</span>
  125 |     | <span style='background-color: #eee;'>    type NFTId is uint256; // 16 bits (tokenId) + 224 bits (hash) + 16 bits (erc721 index)</span>
  126 |     | <span style='background-color: #eee;'></span>
  127 |     | <span style='background-color: #eee;'>    struct DSafe {</span>
  128 |     | <span style='background-color: #eee;'>        address owner;</span>
  129 |     | <span style='background-color: #eee;'>        mapping(uint16 =&gt; ERC20Share) erc20Share;</span>
  130 |     | <span style='background-color: #eee;'>        NFTId[] nfts;</span>
  131 |     | <span style='background-color: #eee;'>        // bitmask of DOS indexes of ERC20 present in a dSafe. `1` can be increased on updates</span>
  132 |     | <span style='background-color: #eee;'>        uint256[1] dAccountErc20Idxs;</span>
  133 |     | <span style='background-color: #eee;'>    }</span>
  134 |     | <span style='background-color: #eee;'></span>
  135 |     | <span style='background-color: #faa;'>    function removeERC20IdxFromDAccount(DSafe storage dSafe, uint16 erc20Idx) internal {</span>
  136 |     | <span style='background-color: #faa;'>        dSafe.dAccountErc20Idxs[erc20Idx &gt;&gt; 8] &amp;= ~(1 &lt;&lt; (erc20Idx &amp; 255));</span>
  137 |     | <span style='background-color: #eee;'>    }</span>
  138 |     | <span style='background-color: #eee;'></span>
  139 |     | <span style='background-color: #eee;'>    function accERC20IdxToDAccount(DSafe storage dSafe, uint16 erc20Idx) internal {</span>
  140 |     | <span style='background-color: #faa;'>        dSafe.dAccountErc20Idxs[erc20Idx &gt;&gt; 8] |= (1 &lt;&lt; (erc20Idx &amp; 255));</span>
  141 |     | <span style='background-color: #eee;'>    }</span>
  142 |     | <span style='background-color: #eee;'></span>
  143 |     | <span style='background-color: #eee;'>    function extractPosition(</span>
  144 |     | <span style='background-color: #eee;'>        ERC20Pool storage pool,</span>
  145 |     | <span style='background-color: #eee;'>        ERC20Share shares</span>
  146 |     | <span style='background-color: #eee;'>    ) internal returns (int256 tokens) {</span>
  147 |     | <span style='background-color: #faa;'>        tokens = computeERC20(pool, shares);</span>
  148 |     | <span style='background-color: #faa;'>        pool.tokens -= tokens;</span>
  149 |     | <span style='background-color: #faa;'>        pool.shares -= ERC20Share.unwrap(shares);</span>
  150 |     | <span style='background-color: #eee;'>    }</span>
  151 |     | <span style='background-color: #eee;'></span>
  152 |     | <span style='background-color: #eee;'>    function insertPosition(ERC20Pool storage pool, int256 tokens) internal returns (ERC20Share) {</span>
  153 |     | <span style='background-color: #eee;'>        int256 shares;</span>
  154 |     | <span style='background-color: #faa;'>        if (pool.shares == 0) {</span>
  155 |     | <span style='background-color: #eee;'>            FsUtils.Assert(pool.tokens == 0);</span>
  156 |     | <span style='background-color: #faa;'>            shares = tokens;</span>
  157 |     | <span style='background-color: #eee;'>        } else {</span>
  158 |     | <span style='background-color: #faa;'>            shares = (pool.shares * tokens) / pool.tokens;</span>
  159 |     | <span style='background-color: #eee;'>        }</span>
  160 |     | <span style='background-color: #faa;'>        pool.tokens += tokens;</span>
  161 |     | <span style='background-color: #faa;'>        pool.shares += shares;</span>
  162 |     | <span style='background-color: #eee;'>        return ERC20Share.wrap(shares);</span>
  163 |     | <span style='background-color: #eee;'>    }</span>
  164 |     | <span style='background-color: #eee;'></span>
  165 |     | <span style='background-color: #faa;'>    function extractNFT(</span>
  166 |     | <span style='background-color: #eee;'>        DSafe storage dSafe,</span>
  167 |     | <span style='background-color: #eee;'>        NFTId nftId,</span>
  168 |     | <span style='background-color: #eee;'>        mapping(NFTId =&gt; NFTTokenData) storage map</span>
  169 |     | <span style='background-color: #eee;'>    ) internal {</span>
  170 |     | <span style='background-color: #faa;'>        uint16 idx = map[nftId].dSafeIdx;</span>
  171 |     | <span style='background-color: #faa;'>        map[nftId].approvedSpender = address(0); // remove approval</span>
  172 |     | <span style='background-color: #faa;'>        bool userOwnsNFT = dSafe.nfts.length &gt; 0 &amp;&amp;</span>
  173 |     | <span style='background-color: #faa;'>            NFTId.unwrap(dSafe.nfts[idx]) == NFTId.unwrap(nftId);</span>
  174 |     | <span style='background-color: #faa;'>        if (!userOwnsNFT) {</span>
  175 |     | <span style='background-color: #faa;'>            revert NFTNotInDSafe();</span>
  176 |     | <span style='background-color: #eee;'>        }</span>
  177 |     | <span style='background-color: #faa;'>        if (idx == dSafe.nfts.length - 1) {</span>
  178 |     | <span style='background-color: #faa;'>            dSafe.nfts.pop();</span>
  179 |     | <span style='background-color: #eee;'>        } else {</span>
  180 |     | <span style='background-color: #faa;'>            NFTId lastNFTId = dSafe.nfts[dSafe.nfts.length - 1];</span>
  181 |     | <span style='background-color: #faa;'>            map[lastNFTId].dSafeIdx = idx;</span>
  182 |     | <span style='background-color: #faa;'>            dSafe.nfts.pop();</span>
  183 |     | <span style='background-color: #eee;'>        }</span>
  184 |     | <span style='background-color: #eee;'>    }</span>
  185 |     | <span style='background-color: #eee;'></span>
  186 |     | <span style='background-color: #faa;'>    function insertNFT(</span>
  187 |     | <span style='background-color: #eee;'>        DSafe storage dSafe,</span>
  188 |     | <span style='background-color: #eee;'>        NFTId nftId,</span>
  189 |     | <span style='background-color: #eee;'>        mapping(NFTId =&gt; NFTTokenData) storage map</span>
  190 |     | <span style='background-color: #eee;'>    ) internal {</span>
  191 |     | <span style='background-color: #faa;'>        uint16 idx = uint16(dSafe.nfts.length);</span>
  192 |     | <span style='background-color: #eee;'>        dSafe.nfts.push(nftId);</span>
  193 |     | <span style='background-color: #faa;'>        map[nftId].dSafeIdx = idx;</span>
  194 |     | <span style='background-color: #eee;'>    }</span>
  195 |     | <span style='background-color: #eee;'></span>
  196 |     | <span style='background-color: #faa;'>    function getERC20s(DSafe storage dSafe) internal view returns (uint16[] memory erc20s) {</span>
  197 |     | <span style='background-color: #faa;'>        uint256 numberOfERC20 = 0;</span>
  198 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; dSafe.dAccountErc20Idxs.length; i++) {</span>
  199 |     | <span style='background-color: #faa;'>            numberOfERC20 += FsMath.bitCount(dSafe.dAccountErc20Idxs[i]);</span>
  200 |     | <span style='background-color: #eee;'>        }</span>
  201 |     | <span style='background-color: #faa;'>        erc20s = new uint16[](numberOfERC20);</span>
  202 |     | <span style='background-color: #eee;'>        uint256 idx = 0;</span>
  203 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; dSafe.dAccountErc20Idxs.length; i++) {</span>
  204 |     | <span style='background-color: #faa;'>            uint256 mask = dSafe.dAccountErc20Idxs[i];</span>
  205 |     | <span style='background-color: #faa;'>            for (uint256 j = 0; j &lt; 256; j++) {</span>
  206 |     | <span style='background-color: #eee;'>                uint256 x = mask &gt;&gt; j;</span>
  207 |     | <span style='background-color: #faa;'>                if (x == 0) break;</span>
  208 |     | <span style='background-color: #faa;'>                if ((x &amp; 1) != 0) {</span>
  209 |     | <span style='background-color: #faa;'>                    erc20s[idx++] = uint16(i * 256 + j);</span>
  210 |     | <span style='background-color: #eee;'>                }</span>
  211 |     | <span style='background-color: #eee;'>            }</span>
  212 |     | <span style='background-color: #eee;'>        }</span>
  213 |     | <span style='background-color: #eee;'>    }</span>
  214 |     | <span style='background-color: #eee;'></span>
  215 |     | <span style='background-color: #faa;'>    function computeERC20(</span>
  216 |     | <span style='background-color: #eee;'>        ERC20Pool storage pool,</span>
  217 |     | <span style='background-color: #eee;'>        ERC20Share sharesWrapped</span>
  218 |     | <span style='background-color: #eee;'>    ) internal view returns (int256 tokens) {</span>
  219 |     | <span style='background-color: #eee;'>        int256 shares = ERC20Share.unwrap(sharesWrapped);</span>
  220 |     | <span style='background-color: #faa;'>        if (shares == 0) return 0;</span>
  221 |     | <span style='background-color: #faa;'>        FsUtils.Assert(pool.shares != 0);</span>
  222 |     | <span style='background-color: #faa;'>        return (pool.tokens * shares) / pool.shares;</span>
  223 |     | <span style='background-color: #eee;'>    }</span>
  224 |     | <span style='background-color: #eee;'>}</span>
  225 |     | <span style='background-color: #eee;'></span>
  226 |     | <span style='background-color: #eee;'>/// @title DOS State</span>
  227 |     | <span style='background-color: #faa;'>/// @notice Contract holds the configuration state for DOS</span>
  228 |     | <span style='background-color: #eee;'>contract DOSState is Pausable {</span>
  229 |     | <span style='background-color: #eee;'>    using DSafeLib for ERC20Pool;</span>
  230 |     | <span style='background-color: #eee;'></span>
  231 |     | <span style='background-color: #eee;'>    IVersionManager public versionManager;</span>
  232 |     | <span style='background-color: #eee;'>    /// @notice mapping between dSafe address and DOS-specific dSafe data</span>
  233 |     | <span style='background-color: #faa;'>    mapping(address =&gt; DSafeLib.DSafe) public dSafes;</span>
  234 |     | <span style='background-color: #eee;'></span>
  235 |     | <span style='background-color: #eee;'>    /// @notice mapping between dSafe address and an instance of deployed dSafeLogic contract.</span>
  236 |     | <span style='background-color: #eee;'>    /// It means that this specific dSafeLogic version is setup to operate the dSafe.</span>
  237 |     | <span style='background-color: #eee;'>    // @dev this could be a mapping to a version index instead of the implementation address</span>
  238 |     | <span style='background-color: #faa;'>    mapping(address =&gt; address) public dSafeLogic;</span>
  239 |     | <span style='background-color: #eee;'></span>
  240 |     | <span style='background-color: #eee;'>    /// @notice mapping from</span>
  241 |     | <span style='background-color: #eee;'>    /// dSafe owner address =&gt; ERC20 address =&gt; dSafe spender address =&gt; allowed amount of ERC20.</span>
  242 |     | <span style='background-color: #eee;'>    /// It represent the allowance of `spender` to transfer up to `amount` of `erc20` balance of</span>
  243 |     | <span style='background-color: #eee;'>    /// owner&#39;s dAccount to some other dAccount. E.g. 123 =&gt; abc =&gt; 456 =&gt; 1000, means that</span>
  244 |     | <span style='background-color: #eee;'>    /// dSafe 456 can transfer up to 1000 of abc tokens from dAccount of dSafe 123 to some other dAccount.</span>
  245 |     | <span style='background-color: #eee;'>    /// Note, that no ERC20 are actually getting transferred - dAccount is a DOS concept, and</span>
  246 |     | <span style='background-color: #eee;'>    /// corresponding tokens are owned by DOS</span>
  247 |     | <span style='background-color: #faa;'>    mapping(address =&gt; mapping(address =&gt; mapping(address =&gt; uint256))) public allowances;</span>
  248 |     | <span style='background-color: #eee;'></span>
  249 |     | <span style='background-color: #eee;'>    /// @notice Whether a spender is approved to operate a dSafe&#39;s NFTs for a specific collection</span>
  250 |     | <span style='background-color: #eee;'>    /// @dev Mapping from dSafe owner address =&gt; NFT address =&gt; spender address =&gt; bool</span>
  251 |     | <span style='background-color: #eee;'>    /// @dev erc721 &amp; erc1155 operator approvals</span>
  252 |     | <span style='background-color: #faa;'>    mapping(address =&gt; mapping(address =&gt; mapping(address =&gt; bool))) public operatorApprovals;</span>
  253 |     | <span style='background-color: #eee;'></span>
  254 |     | <span style='background-color: #faa;'>    mapping(DSafeLib.NFTId =&gt; NFTTokenData) public tokenDataByNFTId;</span>
  255 |     | <span style='background-color: #eee;'></span>
  256 |     | <span style='background-color: #faa;'>    ERC20Info[] public erc20Infos;</span>
  257 |     | <span style='background-color: #faa;'>    ERC721Info[] public erc721Infos;</span>
  258 |     | <span style='background-color: #eee;'></span>
  259 |     | <span style='background-color: #eee;'>    /// @notice mapping of ERC20 or ERC721 address =&gt; DOS asset idx and contract kind.</span>
  260 |     | <span style='background-color: #eee;'>    /// idx is the index of the ERC20 in `erc20Infos` or ERC721 in `erc721Infos`</span>
  261 |     | <span style='background-color: #eee;'>    /// kind is ContractKind enum, that here can be ERC20 or ERC721</span>
  262 |     | <span style='background-color: #faa;'>    mapping(address =&gt; ContractData) public infoIdx;</span>
  263 |     | <span style='background-color: #eee;'></span>
  264 |     | <span style='background-color: #faa;'>    IDOSConfig.Config public config;</span>
  265 |     | <span style='background-color: #eee;'></span>
  266 |     | <span style='background-color: #faa;'>    modifier onlyDSafe() {</span>
  267 |     | <span style='background-color: #faa;'>        if (dSafes[msg.sender].owner == address(0)) {</span>
  268 |     | <span style='background-color: #faa;'>            revert OnlyDSafe();</span>
  269 |     | <span style='background-color: #eee;'>        }</span>
  270 |     | <span style='background-color: #eee;'>        _;</span>
  271 |     | <span style='background-color: #eee;'>    }</span>
  272 |     | <span style='background-color: #eee;'></span>
  273 |     | <span style='background-color: #faa;'>    modifier dSafeExists(address dSafe) {</span>
  274 |     | <span style='background-color: #faa;'>        if (dSafes[dSafe].owner == address(0)) {</span>
  275 |     | <span style='background-color: #faa;'>            revert DSafeNonExistent();</span>
  276 |     | <span style='background-color: #eee;'>        }</span>
  277 |     | <span style='background-color: #faa;'>        _;</span>
  278 |     | <span style='background-color: #eee;'>    }</span>
  279 |     | <span style='background-color: #eee;'></span>
  280 |     | <span style='background-color: #faa;'>    function getBalance(</span>
  281 |     | <span style='background-color: #eee;'>        ERC20Share shares,</span>
  282 |     | <span style='background-color: #eee;'>        ERC20Info storage erc20Info</span>
  283 |     | <span style='background-color: #eee;'>    ) internal view returns (int256) {</span>
  284 |     | <span style='background-color: #faa;'>        ERC20Pool storage pool = ERC20Share.unwrap(shares) &gt; 0</span>
  285 |     | <span style='background-color: #faa;'>            ? erc20Info.collateral</span>
  286 |     | <span style='background-color: #faa;'>            : erc20Info.debt;</span>
  287 |     | <span style='background-color: #faa;'>        return pool.computeERC20(shares);</span>
  288 |     | <span style='background-color: #eee;'>    }</span>
  289 |     | <span style='background-color: #eee;'></span>
  290 |     | <span style='background-color: #faa;'>    function getNFTData(</span>
  291 |     | <span style='background-color: #eee;'>        DSafeLib.NFTId nftId</span>
  292 |     | <span style='background-color: #eee;'>    ) internal view returns (uint16 erc721Idx, uint256 tokenId) {</span>
  293 |     | <span style='background-color: #eee;'>        uint256 unwrappedId = DSafeLib.NFTId.unwrap(nftId);</span>
  294 |     | <span style='background-color: #eee;'>        erc721Idx = uint16(unwrappedId);</span>
  295 |     | <span style='background-color: #faa;'>        tokenId = tokenDataByNFTId[nftId].tokenId | ((unwrappedId &gt;&gt; 240) &lt;&lt; 240);</span>
  296 |     | <span style='background-color: #eee;'>    }</span>
  297 |     | <span style='background-color: #eee;'></span>
  298 |     | <span style='background-color: #faa;'>    function getERC20Info(IERC20 erc20) internal view returns (ERC20Info storage, uint16) {</span>
  299 |     | <span style='background-color: #faa;'>        if (infoIdx[address(erc20)].kind != ContractKind.ERC20) {</span>
  300 |     | <span style='background-color: #faa;'>            revert NotRegistered(address(erc20));</span>
  301 |     | <span style='background-color: #eee;'>        }</span>
  302 |     | <span style='background-color: #faa;'>        uint16 idx = infoIdx[address(erc20)].idx;</span>
  303 |     | <span style='background-color: #faa;'>        return (erc20Infos[idx], idx);</span>
  304 |     | <span style='background-color: #eee;'>    }</span>
  305 |     | <span style='background-color: #eee;'></span>
  306 |     | <span style='background-color: #eee;'>    function getERC721Info(IERC721 erc721) internal view returns (ERC721Info storage, uint16) {</span>
  307 |     | <span style='background-color: #eee;'>        if (infoIdx[address(erc721)].kind != ContractKind.ERC721) {</span>
  308 |     | <span style='background-color: #eee;'>            revert NotRegistered(address(erc721));</span>
  309 |     | <span style='background-color: #eee;'>        }</span>
  310 |     | <span style='background-color: #eee;'>        uint16 idx = infoIdx[address(erc721)].idx;</span>
  311 |     | <span style='background-color: #eee;'>        return (erc721Infos[idx], idx);</span>
  312 |     | <span style='background-color: #eee;'>    }</span>
  313 |     | <span style='background-color: #eee;'>}</span>
  314 |     | <span style='background-color: #eee;'></span>
  315 |     | <span style='background-color: #faa;'>/// @title DeFi OS (DOS)</span>
  316 |     | <span style='background-color: #eee;'>contract DOS is DOSState, IDOSCore, IERC721Receiver, Proxy {</span>
  317 |     | <span style='background-color: #eee;'>    using DSafeLib for DSafeLib.DSafe;</span>
  318 |     | <span style='background-color: #eee;'>    using DSafeLib for ERC20Pool;</span>
  319 |     | <span style='background-color: #eee;'>    using SafeERC20 for IERC20;</span>
  320 |     | <span style='background-color: #eee;'>    using Address for address;</span>
  321 |     | <span style='background-color: #eee;'></span>
  322 |     | <span style='background-color: #eee;'>    address immutable dosConfigAddress;</span>
  323 |     | <span style='background-color: #eee;'></span>
  324 |     | <span style='background-color: #eee;'>    modifier onlyRegisteredNFT(address nftContract, uint256 tokenId) {</span>
  325 |     | <span style='background-color: #eee;'>        // how can we be sure that Oracle would have a price for any possible tokenId?</span>
  326 |     | <span style='background-color: #eee;'>        // maybe we should check first if Oracle can return a value for this specific NFT?</span>
  327 |     | <span style='background-color: #faa;'>        if (infoIdx[nftContract].kind == ContractKind.Invalid) {</span>
  328 |     | <span style='background-color: #faa;'>            revert NotRegistered(nftContract);</span>
  329 |     | <span style='background-color: #eee;'>        }</span>
  330 |     | <span style='background-color: #faa;'>        _;</span>
  331 |     | <span style='background-color: #eee;'>    }</span>
  332 |     | <span style='background-color: #eee;'></span>
  333 |     | <span style='background-color: #faa;'>    modifier onlyNFTOwner(address nftContract, uint256 tokenId) {</span>
  334 |     | <span style='background-color: #faa;'>        address _owner = ERC721(nftContract).ownerOf(tokenId);</span>
  335 |     | <span style='background-color: #faa;'>        bool isOwner = _owner == msg.sender || _owner == dSafes[msg.sender].owner;</span>
  336 |     | <span style='background-color: #faa;'>        if (!isOwner) {</span>
  337 |     | <span style='background-color: #faa;'>            revert NotNFTOwner();</span>
  338 |     | <span style='background-color: #eee;'>        }</span>
  339 |     | <span style='background-color: #faa;'>        _;</span>
  340 |     | <span style='background-color: #eee;'>    }</span>
  341 |     | <span style='background-color: #eee;'></span>
  342 |     | <span style='background-color: #eee;'>    constructor(address _dosConfig, address _versionManager) {</span>
  343 |     | <span style='background-color: #faa;'>        versionManager = IVersionManager(FsUtils.nonNull(_versionManager));</span>
  344 |     | <span style='background-color: #faa;'>        dosConfigAddress = FsUtils.nonNull(_dosConfig);</span>
  345 |     | <span style='background-color: #eee;'>    }</span>
  346 |     | <span style='background-color: #eee;'></span>
  347 |     | <span style='background-color: #eee;'>    /// @notice top up the dAccount owned by dSafe `to` with `amount` of `erc20`</span>
  348 |     | <span style='background-color: #eee;'>    /// @param erc20 Address of the ERC20 token to be transferred</span>
  349 |     | <span style='background-color: #eee;'>    /// @param to Address of the dSafe that dAccount should be top up</span>
  350 |     | <span style='background-color: #eee;'>    /// @param amount The amount of `erc20` to be sent</span>
  351 |     | <span style='background-color: #faa;'>    function depositERC20ForSafe(</span>
  352 |     | <span style='background-color: #eee;'>        address erc20,</span>
  353 |     | <span style='background-color: #eee;'>        address to,</span>
  354 |     | <span style='background-color: #eee;'>        uint256 amount</span>
  355 |     | <span style='background-color: #eee;'>    ) external override dSafeExists(to) whenNotPaused {</span>
  356 |     | <span style='background-color: #faa;'>        if (amount == 0) return;</span>
  357 |     | <span style='background-color: #faa;'>        (, uint16 erc20Idx) = getERC20Info(IERC20(erc20));</span>
  358 |     | <span style='background-color: #faa;'>        int256 signedAmount = FsMath.safeCastToSigned(amount);</span>
  359 |     | <span style='background-color: #faa;'>        _dAccountERC20ChangeBy(to, erc20Idx, signedAmount);</span>
  360 |     | <span style='background-color: #faa;'>        emit IDOSCore.ERC20BalanceChanged(erc20, to, signedAmount);</span>
  361 |     | <span style='background-color: #faa;'>        IERC20(erc20).safeTransferFrom(msg.sender, address(this), amount);</span>
  362 |     | <span style='background-color: #eee;'>    }</span>
  363 |     | <span style='background-color: #eee;'></span>
  364 |     | <span style='background-color: #eee;'>    /// @notice deposit `amount` of `erc20` to dAccount from dSafe</span>
  365 |     | <span style='background-color: #eee;'>    /// @param erc20 Address of the ERC20 token to be transferred</span>
  366 |     | <span style='background-color: #eee;'>    /// @param amount The amount of `erc20` to be transferred</span>
  367 |     | <span style='background-color: #faa;'>    function depositERC20(IERC20 erc20, uint256 amount) external override onlyDSafe whenNotPaused {</span>
  368 |     | <span style='background-color: #faa;'>        if (amount == 0) return;</span>
  369 |     | <span style='background-color: #faa;'>        (, uint16 erc20Idx) = getERC20Info(erc20);</span>
  370 |     | <span style='background-color: #faa;'>        int256 signedAmount = FsMath.safeCastToSigned(amount);</span>
  371 |     | <span style='background-color: #faa;'>        _dAccountERC20ChangeBy(msg.sender, erc20Idx, signedAmount);</span>
  372 |     | <span style='background-color: #faa;'>        emit IDOSCore.ERC20BalanceChanged(address(erc20), msg.sender, signedAmount);</span>
  373 |     | <span style='background-color: #faa;'>        erc20.safeTransferFrom(msg.sender, address(this), amount);</span>
  374 |     | <span style='background-color: #eee;'>    }</span>
  375 |     | <span style='background-color: #eee;'></span>
  376 |     | <span style='background-color: #eee;'>    /// @notice deposit `amount` of `erc20` from dAccount tp dSafe</span>
  377 |     | <span style='background-color: #eee;'>    /// @param erc20 Address of the ERC20 token to be transferred</span>
  378 |     | <span style='background-color: #eee;'>    /// @param amount The amount of `erc20` to be transferred</span>
  379 |     | <span style='background-color: #eee;'>    function withdrawERC20(IERC20 erc20, uint256 amount) external override onlyDSafe whenNotPaused {</span>
  380 |     | <span style='background-color: #faa;'>        (, uint16 erc20Idx) = getERC20Info(erc20);</span>
  381 |     | <span style='background-color: #faa;'>        int256 signedAmount = FsMath.safeCastToSigned(amount);</span>
  382 |     | <span style='background-color: #faa;'>        _dAccountERC20ChangeBy(msg.sender, erc20Idx, -signedAmount);</span>
  383 |     | <span style='background-color: #faa;'>        emit IDOSCore.ERC20BalanceChanged(address(erc20), msg.sender, -signedAmount);</span>
  384 |     | <span style='background-color: #faa;'>        erc20.safeTransfer(msg.sender, amount);</span>
  385 |     | <span style='background-color: #eee;'>    }</span>
  386 |     | <span style='background-color: #eee;'></span>
  387 |     | <span style='background-color: #eee;'>    /// @notice deposit all `erc20s` from dSafe to dAccount</span>
  388 |     | <span style='background-color: #eee;'>    /// @param erc20s Array of addresses of ERC20 to be transferred</span>
  389 |     | <span style='background-color: #eee;'>    function depositFull(IERC20[] calldata erc20s) external override onlyDSafe whenNotPaused {</span>
  390 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; erc20s.length; i++) {</span>
  391 |     | <span style='background-color: #faa;'>            (ERC20Info storage erc20Info, uint16 erc20Idx) = getERC20Info(erc20s[i]);</span>
  392 |     | <span style='background-color: #faa;'>            IERC20 erc20 = IERC20(erc20Info.erc20Contract);</span>
  393 |     | <span style='background-color: #faa;'>            uint256 amount = erc20.balanceOf(msg.sender);</span>
  394 |     | <span style='background-color: #faa;'>            int256 signedAmount = FsMath.safeCastToSigned(amount);</span>
  395 |     | <span style='background-color: #faa;'>            _dAccountERC20ChangeBy(msg.sender, erc20Idx, signedAmount);</span>
  396 |     | <span style='background-color: #faa;'>            emit IDOSCore.ERC20BalanceChanged(address(erc20), msg.sender, signedAmount);</span>
  397 |     | <span style='background-color: #faa;'>            erc20.safeTransferFrom(msg.sender, address(this), amount);</span>
  398 |     | <span style='background-color: #eee;'>        }</span>
  399 |     | <span style='background-color: #eee;'>    }</span>
  400 |     | <span style='background-color: #eee;'></span>
  401 |     | <span style='background-color: #eee;'>    /// @notice withdraw all `erc20s` from dAccount to dSafe</span>
  402 |     | <span style='background-color: #eee;'>    /// @param erc20s Array of addresses of ERC20 to be transferred</span>
  403 |     | <span style='background-color: #eee;'>    function withdrawFull(IERC20[] calldata erc20s) external onlyDSafe whenNotPaused {</span>
  404 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; erc20s.length; i++) {</span>
  405 |     | <span style='background-color: #faa;'>            (ERC20Info storage erc20Info, uint16 erc20Idx) = getERC20Info(erc20s[i]);</span>
  406 |     | <span style='background-color: #faa;'>            IERC20 erc20 = IERC20(erc20Info.erc20Contract);</span>
  407 |     | <span style='background-color: #faa;'>            int256 amount = _dAccountERC20Clear(msg.sender, erc20Idx);</span>
  408 |     | <span style='background-color: #faa;'>            require(amount &gt;= 0, &quot;Can&#39;t withdraw debt&quot;);</span>
  409 |     | <span style='background-color: #faa;'>            emit IDOSCore.ERC20BalanceChanged(address(erc20), msg.sender, amount);</span>
  410 |     | <span style='background-color: #faa;'>            erc20.safeTransfer(msg.sender, uint256(amount));</span>
  411 |     | <span style='background-color: #eee;'>        }</span>
  412 |     | <span style='background-color: #eee;'>    }</span>
  413 |     | <span style='background-color: #eee;'></span>
  414 |     | <span style='background-color: #eee;'>    /// @notice deposit ERC721 `erc721Contract` token `tokenId` from dSafe to dAccount</span>
  415 |     | <span style='background-color: #eee;'>    /// @dev the part when we track the ownership of deposit NFT to a specific dAccount is in</span>
  416 |     | <span style='background-color: #eee;'>    /// `onERC721Received` function of this contract</span>
  417 |     | <span style='background-color: #eee;'>    /// @param erc721Contract The address of the ERC721 contract that the token belongs to</span>
  418 |     | <span style='background-color: #eee;'>    /// @param tokenId The id of the token to be transferred</span>
  419 |     | <span style='background-color: #faa;'>    function depositERC721(</span>
  420 |     | <span style='background-color: #eee;'>        address erc721Contract,</span>
  421 |     | <span style='background-color: #eee;'>        uint256 tokenId</span>
  422 |     | <span style='background-color: #eee;'>    )</span>
  423 |     | <span style='background-color: #eee;'>        external</span>
  424 |     | <span style='background-color: #eee;'>        override</span>
  425 |     | <span style='background-color: #eee;'>        onlyDSafe</span>
  426 |     | <span style='background-color: #eee;'>        whenNotPaused</span>
  427 |     | <span style='background-color: #eee;'>        onlyRegisteredNFT(erc721Contract, tokenId)</span>
  428 |     | <span style='background-color: #eee;'>        onlyNFTOwner(erc721Contract, tokenId)</span>
  429 |     | <span style='background-color: #eee;'>    {</span>
  430 |     | <span style='background-color: #faa;'>        address _owner = ERC721(erc721Contract).ownerOf(tokenId);</span>
  431 |     | <span style='background-color: #faa;'>        emit IDOSCore.ERC721Deposited(erc721Contract, msg.sender, tokenId);</span>
  432 |     | <span style='background-color: #faa;'>        ERC721(erc721Contract).safeTransferFrom(</span>
  433 |     | <span style='background-color: #eee;'>            _owner,</span>
  434 |     | <span style='background-color: #faa;'>            address(this),</span>
  435 |     | <span style='background-color: #eee;'>            tokenId,</span>
  436 |     | <span style='background-color: #faa;'>            abi.encode(msg.sender)</span>
  437 |     | <span style='background-color: #eee;'>        );</span>
  438 |     | <span style='background-color: #eee;'>    }</span>
  439 |     | <span style='background-color: #eee;'></span>
  440 |     | <span style='background-color: #eee;'>    /// @notice withdraw ERC721 `nftContract` token `tokenId` from dAccount to dSafe</span>
  441 |     | <span style='background-color: #eee;'>    /// @param erc721 The address of the ERC721 contract that the token belongs to</span>
  442 |     | <span style='background-color: #eee;'>    /// @param tokenId The id of the token to be transferred</span>
  443 |     | <span style='background-color: #eee;'>    function withdrawERC721(</span>
  444 |     | <span style='background-color: #eee;'>        address erc721,</span>
  445 |     | <span style='background-color: #eee;'>        uint256 tokenId</span>
  446 |     | <span style='background-color: #eee;'>    ) external override onlyDSafe whenNotPaused {</span>
  447 |     | <span style='background-color: #faa;'>        DSafeLib.NFTId nftId = _getNFTId(erc721, tokenId);</span>
  448 |     | <span style='background-color: #eee;'></span>
  449 |     | <span style='background-color: #faa;'>        dSafes[msg.sender].extractNFT(nftId, tokenDataByNFTId);</span>
  450 |     | <span style='background-color: #faa;'>        delete tokenDataByNFTId[nftId];</span>
  451 |     | <span style='background-color: #faa;'>        emit IDOSCore.ERC721Withdrawn(erc721, msg.sender, tokenId);</span>
  452 |     | <span style='background-color: #eee;'></span>
  453 |     | <span style='background-color: #faa;'>        ERC721(erc721).safeTransferFrom(address(this), msg.sender, tokenId);</span>
  454 |     | <span style='background-color: #eee;'>    }</span>
  455 |     | <span style='background-color: #eee;'></span>
  456 |     | <span style='background-color: #eee;'>    /// @notice transfer `amount` of `erc20` from dAccount of caller dSafe to dAccount of `to` dSafe</span>
  457 |     | <span style='background-color: #eee;'>    /// @param erc20 Address of the ERC20 token to be transferred</span>
  458 |     | <span style='background-color: #eee;'>    /// @param to dSafe address, whose dAccount is the transfer target</span>
  459 |     | <span style='background-color: #eee;'>    /// @param amount The amount of `erc20` to be transferred</span>
  460 |     | <span style='background-color: #faa;'>    function transferERC20(</span>
  461 |     | <span style='background-color: #eee;'>        IERC20 erc20,</span>
  462 |     | <span style='background-color: #eee;'>        address to,</span>
  463 |     | <span style='background-color: #eee;'>        uint256 amount</span>
  464 |     | <span style='background-color: #eee;'>    ) external override onlyDSafe whenNotPaused dSafeExists(to) {</span>
  465 |     | <span style='background-color: #faa;'>        if (amount == 0) return;</span>
  466 |     | <span style='background-color: #faa;'>        _transferERC20(erc20, msg.sender, to, FsMath.safeCastToSigned(amount));</span>
  467 |     | <span style='background-color: #eee;'>    }</span>
  468 |     | <span style='background-color: #eee;'></span>
  469 |     | <span style='background-color: #eee;'>    /// @notice transfer NFT `erc721` token `tokenId` from dAccount of caller dSafe to dAccount of</span>
  470 |     | <span style='background-color: #eee;'>    /// `to` dSafe</span>
  471 |     | <span style='background-color: #eee;'>    /// @param erc721 The address of the ERC721 contract that the token belongs to</span>
  472 |     | <span style='background-color: #eee;'>    /// @param tokenId The id of the token to be transferred</span>
  473 |     | <span style='background-color: #eee;'>    /// @param to dSafe address, whose dAccount is the transfer target</span>
  474 |     | <span style='background-color: #eee;'>    function transferERC721(</span>
  475 |     | <span style='background-color: #eee;'>        address erc721,</span>
  476 |     | <span style='background-color: #eee;'>        uint256 tokenId,</span>
  477 |     | <span style='background-color: #eee;'>        address to</span>
  478 |     | <span style='background-color: #eee;'>    ) external override onlyDSafe whenNotPaused dSafeExists(to) {</span>
  479 |     | <span style='background-color: #faa;'>        DSafeLib.NFTId nftId = _getNFTId(erc721, tokenId);</span>
  480 |     | <span style='background-color: #faa;'>        _transferNFT(nftId, msg.sender, to);</span>
  481 |     | <span style='background-color: #eee;'>    }</span>
  482 |     | <span style='background-color: #eee;'></span>
  483 |     | <span style='background-color: #eee;'>    /// @notice Transfer ERC20 tokens from dAccount to another dAccount</span>
  484 |     | <span style='background-color: #eee;'>    /// @dev Note: Allowance must be set with approveERC20</span>
  485 |     | <span style='background-color: #eee;'>    /// @param erc20 The index of the ERC20 token in erc20Infos array</span>
  486 |     | <span style='background-color: #eee;'>    /// @param from The address of the dSafe to transfer from</span>
  487 |     | <span style='background-color: #eee;'>    /// @param to The address of the dSafe to transfer to</span>
  488 |     | <span style='background-color: #eee;'>    /// @param amount The amount of tokens to transfer</span>
  489 |     | <span style='background-color: #eee;'>    /// @return true, when the transfer has been successfully finished without been reverted</span>
  490 |     | <span style='background-color: #eee;'>    function transferFromERC20(</span>
  491 |     | <span style='background-color: #eee;'>        address erc20,</span>
  492 |     | <span style='background-color: #eee;'>        address from,</span>
  493 |     | <span style='background-color: #eee;'>        address to,</span>
  494 |     | <span style='background-color: #eee;'>        uint256 amount</span>
  495 |     | <span style='background-color: #eee;'>    ) external override whenNotPaused dSafeExists(from) dSafeExists(to) returns (bool) {</span>
  496 |     | <span style='background-color: #faa;'>        address spender = msg.sender;</span>
  497 |     | <span style='background-color: #eee;'>        _spendAllowance(erc20, from, spender, amount);</span>
  498 |     | <span style='background-color: #faa;'>        _transferERC20(IERC20(erc20), from, to, FsMath.safeCastToSigned(amount));</span>
  499 |     | <span style='background-color: #eee;'>        return true;</span>
  500 |     | <span style='background-color: #eee;'>    }</span>
  501 |     | <span style='background-color: #eee;'></span>
  502 |     | <span style='background-color: #eee;'>    /// @notice Transfer ERC721 tokens from dAccount to another dAccount</span>
  503 |     | <span style='background-color: #eee;'>    /// @param collection The address of the ERC721 token</span>
  504 |     | <span style='background-color: #eee;'>    /// @param from The address of the dSafe to transfer from</span>
  505 |     | <span style='background-color: #eee;'>    /// @param to The address of the dSafe to transfer to</span>
  506 |     | <span style='background-color: #eee;'>    /// @param tokenId The id of the token to transfer</span>
  507 |     | <span style='background-color: #eee;'>    function transferFromERC721(</span>
  508 |     | <span style='background-color: #eee;'>        address collection,</span>
  509 |     | <span style='background-color: #eee;'>        address from,</span>
  510 |     | <span style='background-color: #eee;'>        address to,</span>
  511 |     | <span style='background-color: #eee;'>        uint256 tokenId</span>
  512 |     | <span style='background-color: #eee;'>    ) external override onlyDSafe whenNotPaused dSafeExists(to) {</span>
  513 |     | <span style='background-color: #faa;'>        DSafeLib.NFTId nftId = _getNFTId(collection, tokenId);</span>
  514 |     | <span style='background-color: #faa;'>        if (!_isApprovedOrOwner(msg.sender, from, nftId)) {</span>
  515 |     | <span style='background-color: #faa;'>            revert NotApprovedOrOwner();</span>
  516 |     | <span style='background-color: #eee;'>        }</span>
  517 |     | <span style='background-color: #faa;'>        _transferNFT(nftId, from, to);</span>
  518 |     | <span style='background-color: #eee;'>    }</span>
  519 |     | <span style='background-color: #eee;'></span>
  520 |     | <span style='background-color: #eee;'>    /// @notice Liquidate an undercollateralized position</span>
  521 |     | <span style='background-color: #eee;'>    /// @dev if dAccount of `dSafe` has more debt then collateral then this function will</span>
  522 |     | <span style='background-color: #eee;'>    /// transfer all debt and collateral ERC20s and ERC721 from dAccount of `dSafe` to dAccount of</span>
  523 |     | <span style='background-color: #eee;'>    /// caller. Considering that market price of collateral is higher then market price of debt,</span>
  524 |     | <span style='background-color: #eee;'>    /// a friction of that difference would be sent back to liquidated dAccount in DOS base currency.</span>
  525 |     | <span style='background-color: #eee;'>    ///   More specific - &quot;some fraction&quot; is `liqFraction` parameter of DOS.</span>
  526 |     | <span style='background-color: #eee;'>    ///   Considering that call to this function would create debt on caller (debt is less then</span>
  527 |     | <span style='background-color: #eee;'>    /// gains, yet still), consider using `liquify` instead, that would liquidate and use</span>
  528 |     | <span style='background-color: #eee;'>    /// obtained assets to cover all created debt</span>
  529 |     | <span style='background-color: #eee;'>    ///   If dAccount of `dSafe` has less debt then collateral then the transaction will be reverted</span>
  530 |     | <span style='background-color: #eee;'>    /// @param dSafe The address of dSafe whose dAccount to be liquidate</span>
  531 |     | <span style='background-color: #eee;'>    function liquidate(address dSafe) external override onlyDSafe whenNotPaused dSafeExists(dSafe) {</span>
  532 |     | <span style='background-color: #eee;'>        (int256 totalValue, int256 collateral, int256 debt) = getRiskAdjustedPositionValues(dSafe);</span>
  533 |     | <span style='background-color: #faa;'>        require(collateral &lt; debt, &quot;DSafe is not liquidatable&quot;);</span>
  534 |     | <span style='background-color: #faa;'>        uint16[] memory dSafeERC20s = dSafes[dSafe].getERC20s();</span>
  535 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; dSafeERC20s.length; i++) {</span>
  536 |     | <span style='background-color: #faa;'>            uint16 erc20Idx = dSafeERC20s[i];</span>
  537 |     | <span style='background-color: #faa;'>            _transferAllERC20(erc20Idx, dSafe, msg.sender);</span>
  538 |     | <span style='background-color: #eee;'>        }</span>
  539 |     | <span style='background-color: #faa;'>        while (dSafes[dSafe].nfts.length &gt; 0) {</span>
  540 |     | <span style='background-color: #faa;'>            _transferNFT(dSafes[dSafe].nfts[dSafes[dSafe].nfts.length - 1], dSafe, msg.sender);</span>
  541 |     | <span style='background-color: #eee;'>        }</span>
  542 |     | <span style='background-color: #faa;'>        if (totalValue &gt; 0) {</span>
  543 |     | <span style='background-color: #eee;'>            // totalValue of the liquidated dSafe is split between liquidatable and liquidator:</span>
  544 |     | <span style='background-color: #eee;'>            // totalValue * (1 - liqFraction) - reward of the liquidator, and</span>
  545 |     | <span style='background-color: #eee;'>            // totalValue * liqFraction - change, liquidator is sending back to liquidatable</span>
  546 |     | <span style='background-color: #faa;'>            int256 percentUnderwater = (collateral * 1 ether) / debt;</span>
  547 |     | <span style='background-color: #faa;'>            int256 leftover = ((totalValue * config.liqFraction * percentUnderwater) / 1 ether) /</span>
  548 |     | <span style='background-color: #eee;'>                1 ether;</span>
  549 |     | <span style='background-color: #eee;'>            _transferERC20(</span>
  550 |     | <span style='background-color: #faa;'>                IERC20(erc20Infos[K_NUMERAIRE_IDX].erc20Contract),</span>
  551 |     | <span style='background-color: #eee;'>                msg.sender,</span>
  552 |     | <span style='background-color: #eee;'>                dSafe,</span>
  553 |     | <span style='background-color: #faa;'>                leftover</span>
  554 |     | <span style='background-color: #eee;'>            );</span>
  555 |     | <span style='background-color: #eee;'>        }</span>
  556 |     | <span style='background-color: #faa;'>        emit IDOSCore.SafeLiquidated(dSafe, msg.sender);</span>
  557 |     | <span style='background-color: #eee;'>    }</span>
  558 |     | <span style='background-color: #eee;'></span>
  559 |     | <span style='background-color: #eee;'>    /// @notice Execute a batch of calls</span>
  560 |     | <span style='background-color: #eee;'>    /// @dev execute a batch of commands on DOS from the name of dSafe owner. Eventual state of</span>
  561 |     | <span style='background-color: #eee;'>    /// dAccount and DOS must be solvent, i.e. debt on dAccount cannot exceed collateral</span>
  562 |     | <span style='background-color: #eee;'>    /// and DOS reserve/debt must be sufficient</span>
  563 |     | <span style='background-color: #eee;'>    /// @param calls An array of transaction calls</span>
  564 |     | <span style='background-color: #faa;'>    function executeBatch(Call[] memory calls) external override onlyDSafe whenNotPaused {</span>
  565 |     | <span style='background-color: #faa;'>        DSafeProxy(payable(msg.sender)).executeBatch(calls);</span>
  566 |     | <span style='background-color: #faa;'>        if (!isSolvent(msg.sender)) {</span>
  567 |     | <span style='background-color: #faa;'>            revert Insolvent();</span>
  568 |     | <span style='background-color: #eee;'>        }</span>
  569 |     | <span style='background-color: #eee;'>    }</span>
  570 |     | <span style='background-color: #eee;'></span>
  571 |     | <span style='background-color: #eee;'>    /// @notice ERC721 transfer callback</span>
  572 |     | <span style='background-color: #eee;'>    /// @dev it&#39;s a callback, required to be implemented by IERC721Receiver interface for the</span>
  573 |     | <span style='background-color: #eee;'>    /// contract to be able to receive ERC721 NFTs.</span>
  574 |     | <span style='background-color: #eee;'>    /// We are using it to track what dAccount owns what NFT.</span>
  575 |     | <span style='background-color: #eee;'>    /// `return this.onERC721Received.selector;` is mandatory part for the NFT transfer to work -</span>
  576 |     | <span style='background-color: #eee;'>    /// not a part of our business logic</span>
  577 |     | <span style='background-color: #eee;'>    /// @param - operator The address which called `safeTransferFrom` function</span>
  578 |     | <span style='background-color: #eee;'>    /// @param from The address which previously owned the token</span>
  579 |     | <span style='background-color: #eee;'>    /// @param tokenId The NFT identifier which is being transferred</span>
  580 |     | <span style='background-color: #eee;'>    /// @param data Additional data with no specified format</span>
  581 |     | <span style='background-color: #eee;'>    /// @return `bytes4(keccak256(&quot;onERC721Received(address,address,uint256,bytes)&quot;))`</span>
  582 |     | <span style='background-color: #eee;'>    function onERC721Received(</span>
  583 |     | <span style='background-color: #eee;'>        address /* operator */,</span>
  584 |     | <span style='background-color: #eee;'>        address from,</span>
  585 |     | <span style='background-color: #eee;'>        uint256 tokenId,</span>
  586 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
  587 |     | <span style='background-color: #eee;'>    ) external override whenNotPaused returns (bytes4) {</span>
  588 |     | <span style='background-color: #faa;'>        DSafeLib.NFTId nftId = _getNFTId(msg.sender, tokenId);</span>
  589 |     | <span style='background-color: #faa;'>        if (data.length != 0) {</span>
  590 |     | <span style='background-color: #faa;'>            from = abi.decode(data, (address));</span>
  591 |     | <span style='background-color: #eee;'>        }</span>
  592 |     | <span style='background-color: #faa;'>        require(dSafes[from].owner != address(0), &quot;DSafe does not exist&quot;);</span>
  593 |     | <span style='background-color: #faa;'>        tokenDataByNFTId[nftId].tokenId = uint240(tokenId);</span>
  594 |     | <span style='background-color: #faa;'>        dSafes[from].insertNFT(nftId, tokenDataByNFTId);</span>
  595 |     | <span style='background-color: #eee;'>        return this.onERC721Received.selector;</span>
  596 |     | <span style='background-color: #eee;'>    }</span>
  597 |     | <span style='background-color: #eee;'></span>
  598 |     | <span style='background-color: #eee;'>    /// @notice Approve an array of tokens and then call `onApprovalReceived` on spender</span>
  599 |     | <span style='background-color: #eee;'>    /// @param approvals An array of ERC20 tokens with amounts, or ERC721 contracts with tokenIds</span>
  600 |     | <span style='background-color: #eee;'>    /// @param spender The address of the spender dSafe</span>
  601 |     | <span style='background-color: #eee;'>    /// @param data Additional data with no specified format, sent in call to `spender`</span>
  602 |     | <span style='background-color: #faa;'>    function approveAndCall(</span>
  603 |     | <span style='background-color: #eee;'>        Approval[] calldata approvals,</span>
  604 |     | <span style='background-color: #eee;'>        address spender,</span>
  605 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
  606 |     | <span style='background-color: #eee;'>    ) external override onlyDSafe whenNotPaused {</span>
  607 |     | <span style='background-color: #faa;'>        uint256[] memory prev = new uint256[](approvals.length);</span>
  608 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; approvals.length; i++) {</span>
  609 |     | <span style='background-color: #faa;'>            prev[i] = _approve(</span>
  610 |     | <span style='background-color: #eee;'>                msg.sender,</span>
  611 |     | <span style='background-color: #eee;'>                spender,</span>
  612 |     | <span style='background-color: #faa;'>                approvals[i].ercContract,</span>
  613 |     | <span style='background-color: #faa;'>                approvals[i].amountOrTokenId,</span>
  614 |     | <span style='background-color: #eee;'>                spender</span>
  615 |     | <span style='background-color: #eee;'>            );</span>
  616 |     | <span style='background-color: #eee;'>        }</span>
  617 |     | <span style='background-color: #faa;'>        if (!_checkOnApprovalReceived(msg.sender, 0, spender, data)) {</span>
  618 |     | <span style='background-color: #faa;'>            revert WrongDataReturned();</span>
  619 |     | <span style='background-color: #eee;'>        }</span>
  620 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; approvals.length; i++) {</span>
  621 |     | <span style='background-color: #faa;'>            _approve(msg.sender, spender, approvals[i].ercContract, prev[i], address(0)); // reset allowance</span>
  622 |     | <span style='background-color: #eee;'>        }</span>
  623 |     | <span style='background-color: #eee;'>    }</span>
  624 |     | <span style='background-color: #eee;'></span>
  625 |     | <span style='background-color: #eee;'>    /// @notice provides the specific version of dSafeLogic contract that is associated with `dSafe`</span>
  626 |     | <span style='background-color: #eee;'>    /// @param dSafe Address of dSafe whose dSafeLogic contract should be returned</span>
  627 |     | <span style='background-color: #eee;'>    /// @return the address of the dSafeLogic contract that is associated with the `dSafe`</span>
  628 |     | <span style='background-color: #eee;'>    function getImplementation(address dSafe) external view override returns (address) {</span>
  629 |     | <span style='background-color: #eee;'>        // not using msg.sender since this is an external view function</span>
  630 |     | <span style='background-color: #faa;'>        return dSafeLogic[dSafe];</span>
  631 |     | <span style='background-color: #eee;'>    }</span>
  632 |     | <span style='background-color: #eee;'></span>
  633 |     | <span style='background-color: #eee;'>    /// @notice provides the owner of `dSafe`. Owner of the dSafe is the address who created the dSafe</span>
  634 |     | <span style='background-color: #eee;'>    /// @param dSafe The address of dSafe whose owner should be returned</span>
  635 |     | <span style='background-color: #eee;'>    /// @return the owner address of the `dSafe`. Owner is the one who created the `dSafe`</span>
  636 |     | <span style='background-color: #eee;'>    function getDSafeOwner(address dSafe) external view override returns (address) {</span>
  637 |     | <span style='background-color: #eee;'>        return dSafes[dSafe].owner;</span>
  638 |     | <span style='background-color: #eee;'>    }</span>
  639 |     | <span style='background-color: #eee;'></span>
  640 |     | <span style='background-color: #eee;'>    /// @notice returns the collateral, debt and total value of `dSafeAddress`.</span>
  641 |     | <span style='background-color: #eee;'>    /// @dev Notice that both collateral and debt has some coefficients on the actual amount of deposit</span>
  642 |     | <span style='background-color: #eee;'>    /// and loan assets! E.g.</span>
  643 |     | <span style='background-color: #eee;'>    /// for a deposit of 1 ETH the collateral would be equivalent to like 0.8 ETH, and</span>
  644 |     | <span style='background-color: #eee;'>    /// for a loan of 1 ETH the debt would be equivalent to like 1.2 ETH.</span>
  645 |     | <span style='background-color: #eee;'>    /// At the same time, totalValue is the unmodified difference between deposits and loans.</span>
  646 |     | <span style='background-color: #eee;'>    /// @param dSafeAddress The address of dSafe whose collateral, debt and total value would be returned</span>
  647 |     | <span style='background-color: #eee;'>    /// @return totalValue The difference between equivalents of deposit and loan assets</span>
  648 |     | <span style='background-color: #eee;'>    /// @return collateral The sum of deposited assets multiplied by their collateral factors</span>
  649 |     | <span style='background-color: #eee;'>    /// @return debt The sum of borrowed assets multiplied by their borrow factors</span>
  650 |     | <span style='background-color: #faa;'>    function getRiskAdjustedPositionValues(</span>
  651 |     | <span style='background-color: #eee;'>        address dSafeAddress</span>
  652 |     | <span style='background-color: #eee;'>    )</span>
  653 |     | <span style='background-color: #eee;'>        public</span>
  654 |     | <span style='background-color: #eee;'>        view</span>
  655 |     | <span style='background-color: #eee;'>        override</span>
  656 |     | <span style='background-color: #eee;'>        dSafeExists(dSafeAddress)</span>
  657 |     | <span style='background-color: #faa;'>        returns (int256 totalValue, int256 collateral, int256 debt)</span>
  658 |     | <span style='background-color: #eee;'>    {</span>
  659 |     | <span style='background-color: #faa;'>        DSafeLib.DSafe storage dSafe = dSafes[dSafeAddress];</span>
  660 |     | <span style='background-color: #faa;'>        uint16[] memory erc20Idxs = dSafe.getERC20s();</span>
  661 |     | <span style='background-color: #faa;'>        totalValue = 0;</span>
  662 |     | <span style='background-color: #faa;'>        collateral = 0;</span>
  663 |     | <span style='background-color: #faa;'>        debt = 0;</span>
  664 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; erc20Idxs.length; i++) {</span>
  665 |     | <span style='background-color: #faa;'>            uint16 erc20Idx = erc20Idxs[i];</span>
  666 |     | <span style='background-color: #faa;'>            ERC20Info storage erc20Info = erc20Infos[erc20Idx];</span>
  667 |     | <span style='background-color: #faa;'>            int256 balance = getBalance(dSafe.erc20Share[erc20Idx], erc20Info);</span>
  668 |     | <span style='background-color: #faa;'>            (int256 value, int256 riskAdjustedValue) = erc20Info.valueOracle.calcValue(balance);</span>
  669 |     | <span style='background-color: #faa;'>            totalValue += value;</span>
  670 |     | <span style='background-color: #faa;'>            if (balance &gt;= 0) {</span>
  671 |     | <span style='background-color: #faa;'>                collateral += riskAdjustedValue;</span>
  672 |     | <span style='background-color: #eee;'>            } else {</span>
  673 |     | <span style='background-color: #faa;'>                debt -= riskAdjustedValue;</span>
  674 |     | <span style='background-color: #eee;'>            }</span>
  675 |     | <span style='background-color: #eee;'>        }</span>
  676 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; dSafe.nfts.length; i++) {</span>
  677 |     | <span style='background-color: #faa;'>            DSafeLib.NFTId nftId = dSafe.nfts[i];</span>
  678 |     | <span style='background-color: #faa;'>            (uint16 erc721Idx, uint256 tokenId) = getNFTData(nftId);</span>
  679 |     | <span style='background-color: #faa;'>            ERC721Info storage nftInfo = erc721Infos[erc721Idx];</span>
  680 |     | <span style='background-color: #faa;'>            (int256 nftValue, int256 nftRiskAdjustedValue) = nftInfo.valueOracle.calcValue(tokenId);</span>
  681 |     | <span style='background-color: #faa;'>            totalValue += nftValue;</span>
  682 |     | <span style='background-color: #faa;'>            collateral += nftRiskAdjustedValue;</span>
  683 |     | <span style='background-color: #eee;'>        }</span>
  684 |     | <span style='background-color: #eee;'>    }</span>
  685 |     | <span style='background-color: #eee;'></span>
  686 |     | <span style='background-color: #eee;'>    /// @notice Returns the approved address for a token, or zero if no address set</span>
  687 |     | <span style='background-color: #eee;'>    /// @param collection The address of the ERC721 token</span>
  688 |     | <span style='background-color: #eee;'>    /// @param tokenId The id of the token to query</span>
  689 |     | <span style='background-color: #eee;'>    /// @return The dSafe address that is allowed to transfer the ERC721 token</span>
  690 |     | <span style='background-color: #eee;'>    function getApproved(</span>
  691 |     | <span style='background-color: #eee;'>        address collection,</span>
  692 |     | <span style='background-color: #eee;'>        uint256 tokenId</span>
  693 |     | <span style='background-color: #eee;'>    ) public view override returns (address) {</span>
  694 |     | <span style='background-color: #faa;'>        DSafeLib.NFTId nftId = _getNFTId(collection, tokenId);</span>
  695 |     | <span style='background-color: #faa;'>        return tokenDataByNFTId[nftId].approvedSpender;</span>
  696 |     | <span style='background-color: #eee;'>    }</span>
  697 |     | <span style='background-color: #eee;'></span>
  698 |     | <span style='background-color: #eee;'>    /// @notice Returns if the `operator` is allowed to manage all of the erc721s of `owner` on the `collection` contract</span>
  699 |     | <span style='background-color: #eee;'>    /// @param collection The address of the collection contract</span>
  700 |     | <span style='background-color: #eee;'>    /// @param _owner The address of the dSafe owner</span>
  701 |     | <span style='background-color: #eee;'>    /// @param spender The address of the dSafe spender</span>
  702 |     | <span style='background-color: #eee;'>    /// @return if the `spender` is allowed to operate the assets of `collection` of `_owner`</span>
  703 |     | <span style='background-color: #eee;'>    function isApprovedForAll(</span>
  704 |     | <span style='background-color: #eee;'>        address collection,</span>
  705 |     | <span style='background-color: #eee;'>        address _owner,</span>
  706 |     | <span style='background-color: #eee;'>        address spender</span>
  707 |     | <span style='background-color: #eee;'>    ) public view override returns (bool) {</span>
  708 |     | <span style='background-color: #faa;'>        return operatorApprovals[collection][_owner][spender];</span>
  709 |     | <span style='background-color: #eee;'>    }</span>
  710 |     | <span style='background-color: #eee;'></span>
  711 |     | <span style='background-color: #eee;'>    /// @notice Returns the remaining amount of tokens that `spender` will be allowed to spend on</span>
  712 |     | <span style='background-color: #eee;'>    /// behalf of `owner` through {transferFrom}</span>
  713 |     | <span style='background-color: #eee;'>    /// @dev This value changes when {approve} or {transferFrom} are called</span>
  714 |     | <span style='background-color: #eee;'>    /// @param erc20 The address of the ERC20 to be checked</span>
  715 |     | <span style='background-color: #eee;'>    /// @param _owner The dSafe address whose `erc20` are allowed to be transferred by `spender`</span>
  716 |     | <span style='background-color: #eee;'>    /// @param spender The dSafe address who is allowed to spend `erc20` of `_owner`</span>
  717 |     | <span style='background-color: #eee;'>    /// @return the remaining amount of tokens that `spender` will be allowed to spend on</span>
  718 |     | <span style='background-color: #eee;'>    /// behalf of `owner` through {transferFrom}</span>
  719 |     | <span style='background-color: #faa;'>    function allowance(</span>
  720 |     | <span style='background-color: #eee;'>        address erc20,</span>
  721 |     | <span style='background-color: #eee;'>        address _owner,</span>
  722 |     | <span style='background-color: #eee;'>        address spender</span>
  723 |     | <span style='background-color: #eee;'>    ) public view override returns (uint256) {</span>
  724 |     | <span style='background-color: #faa;'>        if (_owner == spender) return type(uint256).max;</span>
  725 |     | <span style='background-color: #faa;'>        return allowances[_owner][erc20][spender];</span>
  726 |     | <span style='background-color: #eee;'>    }</span>
  727 |     | <span style='background-color: #eee;'></span>
  728 |     | <span style='background-color: #eee;'>    /// @notice Compute the interest rate of `underlying`</span>
  729 |     | <span style='background-color: #eee;'>    /// @param erc20Idx The underlying asset</span>
  730 |     | <span style='background-color: #eee;'>    /// @return The interest rate of `erc20Idx`</span>
  731 |     | <span style='background-color: #faa;'>    function computeInterestRate(uint16 erc20Idx) public view override returns (int96) {</span>
  732 |     | <span style='background-color: #faa;'>        ERC20Info memory erc20Info = erc20Infos[erc20Idx];</span>
  733 |     | <span style='background-color: #faa;'>        uint256 debt = FsMath.safeCastToUnsigned(-erc20Info.debt.tokens); // question: is debt ever positive?</span>
  734 |     | <span style='background-color: #faa;'>        uint256 collateral = FsMath.safeCastToUnsigned(erc20Info.collateral.tokens); // question: is collateral ever negative?</span>
  735 |     | <span style='background-color: #faa;'>        uint256 leverage = FsMath.safeCastToUnsigned(config.fractionalReserveLeverage);</span>
  736 |     | <span style='background-color: #faa;'>        uint256 poolAssets = debt + collateral;</span>
  737 |     | <span style='background-color: #eee;'></span>
  738 |     | <span style='background-color: #faa;'>        uint256 ir = erc20Info.baseRate;</span>
  739 |     | <span style='background-color: #eee;'>        uint256 utilization; // utilization of the pool</span>
  740 |     | <span style='background-color: #faa;'>        if (poolAssets == 0)</span>
  741 |     | <span style='background-color: #faa;'>            utilization = 0; // if there are no assets, utilization is 0</span>
  742 |     | <span style='background-color: #faa;'>        else utilization = uint256((debt * 1e18) / ((collateral - debt) / leverage));</span>
  743 |     | <span style='background-color: #eee;'></span>
  744 |     | <span style='background-color: #faa;'>        if (utilization &lt;= erc20Info.targetUtilization) {</span>
  745 |     | <span style='background-color: #faa;'>            ir += (utilization * erc20Info.slope1) / 1e15;</span>
  746 |     | <span style='background-color: #eee;'>        } else {</span>
  747 |     | <span style='background-color: #faa;'>            ir += (erc20Info.targetUtilization * erc20Info.slope1) / 1e15;</span>
  748 |     | <span style='background-color: #faa;'>            ir += ((erc20Info.slope2 * (utilization - erc20Info.targetUtilization)) / 1e15);</span>
  749 |     | <span style='background-color: #eee;'>        }</span>
  750 |     | <span style='background-color: #eee;'></span>
  751 |     | <span style='background-color: #eee;'>        return int96(int256(ir));</span>
  752 |     | <span style='background-color: #eee;'>    }</span>
  753 |     | <span style='background-color: #eee;'></span>
  754 |     | <span style='background-color: #faa;'>    function _approve(</span>
  755 |     | <span style='background-color: #eee;'>        address _owner,</span>
  756 |     | <span style='background-color: #eee;'>        address spender,</span>
  757 |     | <span style='background-color: #eee;'>        address ercContract,</span>
  758 |     | <span style='background-color: #eee;'>        uint256 amountOrTokenId,</span>
  759 |     | <span style='background-color: #eee;'>        address erc721Spender</span>
  760 |     | <span style='background-color: #eee;'>    ) internal returns (uint256 prev) {</span>
  761 |     | <span style='background-color: #faa;'>        FsUtils.Assert(spender != address(0));</span>
  762 |     | <span style='background-color: #faa;'>        ContractData memory data = infoIdx[ercContract];</span>
  763 |     | <span style='background-color: #faa;'>        if (data.kind == ContractKind.ERC20) {</span>
  764 |     | <span style='background-color: #faa;'>            prev = allowance(ercContract, _owner, spender);</span>
  765 |     | <span style='background-color: #faa;'>            allowances[_owner][ercContract][spender] = amountOrTokenId;</span>
  766 |     | <span style='background-color: #faa;'>        } else if (data.kind == ContractKind.ERC721) {</span>
  767 |     | <span style='background-color: #faa;'>            prev = amountOrTokenId;</span>
  768 |     | <span style='background-color: #faa;'>            tokenDataByNFTId[_getNFTId(ercContract, amountOrTokenId)]</span>
  769 |     | <span style='background-color: #eee;'>                .approvedSpender = erc721Spender;</span>
  770 |     | <span style='background-color: #eee;'>        } else {</span>
  771 |     | <span style='background-color: #eee;'>            FsUtils.Assert(false);</span>
  772 |     | <span style='background-color: #eee;'>        }</span>
  773 |     | <span style='background-color: #eee;'>    }</span>
  774 |     | <span style='background-color: #eee;'></span>
  775 |     | <span style='background-color: #eee;'>    /// @dev changes the quantity of `erc20` by `amount` that are allowed to transfer from dAccount</span>
  776 |     | <span style='background-color: #eee;'>    /// of dSafe `_owner` by dSafe `spender`</span>
  777 |     | <span style='background-color: #eee;'>    function _spendAllowance(</span>
  778 |     | <span style='background-color: #eee;'>        address erc20,</span>
  779 |     | <span style='background-color: #eee;'>        address _owner,</span>
  780 |     | <span style='background-color: #eee;'>        address spender,</span>
  781 |     | <span style='background-color: #eee;'>        uint256 amount</span>
  782 |     | <span style='background-color: #eee;'>    ) internal {</span>
  783 |     | <span style='background-color: #faa;'>        uint256 currentAllowance = allowance(erc20, _owner, spender);</span>
  784 |     | <span style='background-color: #faa;'>        if (currentAllowance != type(uint256).max) {</span>
  785 |     | <span style='background-color: #faa;'>            if (currentAllowance &lt; amount) {</span>
  786 |     | <span style='background-color: #faa;'>                revert InsufficientAllowance();</span>
  787 |     | <span style='background-color: #eee;'>            }</span>
  788 |     | <span style='background-color: #eee;'>            unchecked {</span>
  789 |     | <span style='background-color: #faa;'>                allowances[_owner][erc20][spender] = currentAllowance - amount;</span>
  790 |     | <span style='background-color: #eee;'>            }</span>
  791 |     | <span style='background-color: #eee;'>        }</span>
  792 |     | <span style='background-color: #eee;'>    }</span>
  793 |     | <span style='background-color: #eee;'></span>
  794 |     | <span style='background-color: #eee;'>    /**</span>
  795 |     | <span style='background-color: #eee;'>     * @dev Internal function to invoke {IERC1363Receiver-onApprovalReceived} on a target address</span>
  796 |     | <span style='background-color: #eee;'>     *  The call is not executed if the target address is not a contract</span>
  797 |     | <span style='background-color: #eee;'>     * @param spender address The address which will spend the funds</span>
  798 |     | <span style='background-color: #eee;'>     * @param amount uint256 The amount of tokens to be spent</span>
  799 |     | <span style='background-color: #eee;'>     * @param data bytes Optional data to send along with the call</span>
  800 |     | <span style='background-color: #eee;'>     * @return whether the call correctly returned the expected magic value</span>
  801 |     | <span style='background-color: #eee;'>     */</span>
  802 |     | <span style='background-color: #faa;'>    function _checkOnApprovalReceived(</span>
  803 |     | <span style='background-color: #eee;'>        address spender, // safe</span>
  804 |     | <span style='background-color: #eee;'>        uint256 amount,</span>
  805 |     | <span style='background-color: #eee;'>        address target, // router</span>
  806 |     | <span style='background-color: #eee;'>        bytes memory data</span>
  807 |     | <span style='background-color: #eee;'>    ) internal returns (bool) {</span>
  808 |     | <span style='background-color: #faa;'>        if (!spender.isContract()) {</span>
  809 |     | <span style='background-color: #faa;'>            revert ReceiverNotContract();</span>
  810 |     | <span style='background-color: #eee;'>        }</span>
  811 |     | <span style='background-color: #eee;'></span>
  812 |     | <span style='background-color: #faa;'>        Call memory call = Call({to: target, callData: data, value: msg.value});</span>
  813 |     | <span style='background-color: #eee;'></span>
  814 |     | <span style='background-color: #faa;'>        try IERC1363SpenderExtended(spender).onApprovalReceived(msg.sender, amount, call) returns (</span>
  815 |     | <span style='background-color: #eee;'>            bytes4 retval</span>
  816 |     | <span style='background-color: #eee;'>        ) {</span>
  817 |     | <span style='background-color: #faa;'>            return retval == IERC1363SpenderExtended.onApprovalReceived.selector;</span>
  818 |     | <span style='background-color: #faa;'>        } catch (bytes memory reason) {</span>
  819 |     | <span style='background-color: #faa;'>            if (reason.length == 0) {</span>
  820 |     | <span style='background-color: #faa;'>                revert ReceiverNoImplementation();</span>
  821 |     | <span style='background-color: #eee;'>            } else {</span>
  822 |     | <span style='background-color: #faa;'>                FsUtils.revertBytes(reason);</span>
  823 |     | <span style='background-color: #eee;'>            }</span>
  824 |     | <span style='background-color: #eee;'>        }</span>
  825 |     | <span style='background-color: #eee;'>    }</span>
  826 |     | <span style='background-color: #eee;'></span>
  827 |     | <span style='background-color: #eee;'>    /// @dev transfer ERC20 balances between dAccounts.</span>
  828 |     | <span style='background-color: #eee;'>    /// Because all ERC20 tokens on dAccounts are owned by DOS, no tokens are getting transferred -</span>
  829 |     | <span style='background-color: #eee;'>    /// all changes are inside DOS contract state</span>
  830 |     | <span style='background-color: #eee;'>    /// @param erc20 The address of ERC20 token balance to transfer</span>
  831 |     | <span style='background-color: #eee;'>    /// @param from The address of dSafe whose dAccount balance should be decreased by `amount`</span>
  832 |     | <span style='background-color: #eee;'>    /// @param to The address of dSafe whose dAccount balance should be increased by `amount`</span>
  833 |     | <span style='background-color: #eee;'>    /// @param amount The amount of `erc20` by witch the balance of</span>
  834 |     | <span style='background-color: #eee;'>    /// dAccount of dSafe `from` should be decreased and</span>
  835 |     | <span style='background-color: #eee;'>    /// dAccount of dSafe `to` should be increased.</span>
  836 |     | <span style='background-color: #eee;'>    /// Note that amount it can be negative</span>
  837 |     | <span style='background-color: #faa;'>    function _transferERC20(IERC20 erc20, address from, address to, int256 amount) internal {</span>
  838 |     | <span style='background-color: #faa;'>        (, uint16 erc20Idx) = getERC20Info(erc20);</span>
  839 |     | <span style='background-color: #faa;'>        _dAccountERC20ChangeBy(from, erc20Idx, -amount);</span>
  840 |     | <span style='background-color: #faa;'>        _dAccountERC20ChangeBy(to, erc20Idx, amount);</span>
  841 |     | <span style='background-color: #faa;'>        emit IDOSCore.ERC20Transfer(address(erc20), from, to, amount);</span>
  842 |     | <span style='background-color: #eee;'>    }</span>
  843 |     | <span style='background-color: #eee;'></span>
  844 |     | <span style='background-color: #eee;'>    /// @dev transfer ERC721 NFT ownership between dAccounts.</span>
  845 |     | <span style='background-color: #eee;'>    /// Because all ERC721 NFTs on dAccounts are owned by DOS, no NFT is getting transferred - all</span>
  846 |     | <span style='background-color: #eee;'>    /// changes are inside DOS contract state</span>
  847 |     | <span style='background-color: #faa;'>    function _transferNFT(DSafeLib.NFTId nftId, address from, address to) internal {</span>
  848 |     | <span style='background-color: #faa;'>        dSafes[from].extractNFT(nftId, tokenDataByNFTId);</span>
  849 |     | <span style='background-color: #faa;'>        dSafes[to].insertNFT(nftId, tokenDataByNFTId);</span>
  850 |     | <span style='background-color: #faa;'>        emit ERC721Transferred(DSafeLib.NFTId.unwrap(nftId), from, to);</span>
  851 |     | <span style='background-color: #eee;'>    }</span>
  852 |     | <span style='background-color: #eee;'></span>
  853 |     | <span style='background-color: #eee;'>    /// @dev transfer all `erc20Idx` from `from` to `to`</span>
  854 |     | <span style='background-color: #faa;'>    function _transferAllERC20(uint16 erc20Idx, address from, address to) internal {</span>
  855 |     | <span style='background-color: #faa;'>        int256 amount = _dAccountERC20Clear(from, erc20Idx);</span>
  856 |     | <span style='background-color: #faa;'>        _dAccountERC20ChangeBy(to, erc20Idx, amount);</span>
  857 |     | <span style='background-color: #faa;'>        address erc20 = erc20Infos[erc20Idx].erc20Contract;</span>
  858 |     | <span style='background-color: #faa;'>        emit IDOSCore.ERC20Transfer(erc20, from, to, amount);</span>
  859 |     | <span style='background-color: #eee;'>    }</span>
  860 |     | <span style='background-color: #eee;'></span>
  861 |     | <span style='background-color: #faa;'>    function _dAccountERC20ChangeBy(address dSafeAddress, uint16 erc20Idx, int256 amount) internal {</span>
  862 |     | <span style='background-color: #faa;'>        _updateInterest(erc20Idx);</span>
  863 |     | <span style='background-color: #faa;'>        DSafeLib.DSafe storage dSafe = dSafes[dSafeAddress];</span>
  864 |     | <span style='background-color: #faa;'>        ERC20Share shares = dSafe.erc20Share[erc20Idx];</span>
  865 |     | <span style='background-color: #faa;'>        ERC20Info storage erc20Info = erc20Infos[erc20Idx];</span>
  866 |     | <span style='background-color: #faa;'>        int256 currentAmount = _extractPosition(shares, erc20Info);</span>
  867 |     | <span style='background-color: #faa;'>        int256 newAmount = currentAmount + amount;</span>
  868 |     | <span style='background-color: #faa;'>        dSafe.erc20Share[erc20Idx] = _insertPosition(newAmount, dSafe, erc20Idx);</span>
  869 |     | <span style='background-color: #eee;'>    }</span>
  870 |     | <span style='background-color: #eee;'></span>
  871 |     | <span style='background-color: #faa;'>    function _dAccountERC20Clear(address dSafeAddress, uint16 erc20Idx) internal returns (int256) {</span>
  872 |     | <span style='background-color: #faa;'>        _updateInterest(erc20Idx);</span>
  873 |     | <span style='background-color: #faa;'>        DSafeLib.DSafe storage dSafe = dSafes[dSafeAddress];</span>
  874 |     | <span style='background-color: #faa;'>        ERC20Share shares = dSafe.erc20Share[erc20Idx];</span>
  875 |     | <span style='background-color: #faa;'>        int256 erc20Amount = _extractPosition(shares, erc20Infos[erc20Idx]);</span>
  876 |     | <span style='background-color: #faa;'>        dSafe.erc20Share[erc20Idx] = ERC20Share.wrap(0);</span>
  877 |     | <span style='background-color: #faa;'>        dSafe.removeERC20IdxFromDAccount(erc20Idx);</span>
  878 |     | <span style='background-color: #eee;'>        return erc20Amount;</span>
  879 |     | <span style='background-color: #eee;'>    }</span>
  880 |     | <span style='background-color: #eee;'></span>
  881 |     | <span style='background-color: #faa;'>    function _extractPosition(</span>
  882 |     | <span style='background-color: #eee;'>        ERC20Share sharesWrapped,</span>
  883 |     | <span style='background-color: #eee;'>        ERC20Info storage erc20Info</span>
  884 |     | <span style='background-color: #eee;'>    ) internal returns (int256) {</span>
  885 |     | <span style='background-color: #eee;'>        int256 shares = ERC20Share.unwrap(sharesWrapped);</span>
  886 |     | <span style='background-color: #faa;'>        ERC20Pool storage pool = shares &gt; 0 ? erc20Info.collateral : erc20Info.debt;</span>
  887 |     | <span style='background-color: #eee;'>        return pool.extractPosition(sharesWrapped);</span>
  888 |     | <span style='background-color: #eee;'>    }</span>
  889 |     | <span style='background-color: #eee;'></span>
  890 |     | <span style='background-color: #eee;'>    function _insertPosition(</span>
  891 |     | <span style='background-color: #eee;'>        int256 amount,</span>
  892 |     | <span style='background-color: #eee;'>        DSafeLib.DSafe storage dSafe,</span>
  893 |     | <span style='background-color: #eee;'>        uint16 erc20Idx</span>
  894 |     | <span style='background-color: #eee;'>    ) internal returns (ERC20Share) {</span>
  895 |     | <span style='background-color: #faa;'>        if (amount == 0) {</span>
  896 |     | <span style='background-color: #faa;'>            dSafe.removeERC20IdxFromDAccount(erc20Idx);</span>
  897 |     | <span style='background-color: #eee;'>        } else {</span>
  898 |     | <span style='background-color: #eee;'>            dSafe.accERC20IdxToDAccount(erc20Idx);</span>
  899 |     | <span style='background-color: #eee;'>        }</span>
  900 |     | <span style='background-color: #faa;'>        ERC20Info storage erc20Info = erc20Infos[erc20Idx];</span>
  901 |     | <span style='background-color: #faa;'>        ERC20Pool storage pool = amount &gt; 0 ? erc20Info.collateral : erc20Info.debt;</span>
  902 |     | <span style='background-color: #eee;'>        return pool.insertPosition(amount);</span>
  903 |     | <span style='background-color: #eee;'>    }</span>
  904 |     | <span style='background-color: #eee;'></span>
  905 |     | <span style='background-color: #faa;'>    function _updateInterest(uint16 erc20Idx) internal {</span>
  906 |     | <span style='background-color: #faa;'>        ERC20Info storage erc20Info = erc20Infos[erc20Idx]; // retrieve ERC20Info and store in memory</span>
  907 |     | <span style='background-color: #faa;'>        if (erc20Info.timestamp == block.timestamp) return; // already updated this block</span>
  908 |     | <span style='background-color: #faa;'>        int256 delta = FsMath.safeCastToSigned(block.timestamp - erc20Info.timestamp); // time passed since last update</span>
  909 |     | <span style='background-color: #eee;'>        erc20Info.timestamp = block.timestamp; // update timestamp to current timestamp</span>
  910 |     | <span style='background-color: #faa;'>        int256 debt = -erc20Info.debt.tokens; // get the debt</span>
  911 |     | <span style='background-color: #faa;'>        int256 interestRate = computeInterestRate(erc20Idx);</span>
  912 |     | <span style='background-color: #faa;'>        int256 interest = (debt * (FsMath.exp(interestRate * delta) - FsMath.FIXED_POINT_SCALE)) /</span>
  913 |     | <span style='background-color: #eee;'>            FsMath.FIXED_POINT_SCALE; // Get the interest</span>
  914 |     | <span style='background-color: #faa;'>        int256 treasuryInterest = (interest *</span>
  915 |     | <span style='background-color: #faa;'>            FsMath.safeCastToSigned(config.treasuryInterestFraction)) / 1 ether; // Get the treasury interest</span>
  916 |     | <span style='background-color: #faa;'>        erc20Info.debt.tokens -= interest; // subtract interest from debt (increase)</span>
  917 |     | <span style='background-color: #faa;'>        erc20Info.collateral.tokens += interest - treasuryInterest; // add interest to collateral (increase)</span>
  918 |     | <span style='background-color: #eee;'></span>
  919 |     | <span style='background-color: #faa;'>        _dAccountERC20ChangeBy(config.treasurySafe, erc20Idx, treasuryInterest); // add treasury interest to treasury</span>
  920 |     | <span style='background-color: #eee;'>    }</span>
  921 |     | <span style='background-color: #eee;'></span>
  922 |     | <span style='background-color: #eee;'>    /// @notice Checks if the account&#39;s positions are overcollateralized</span>
  923 |     | <span style='background-color: #eee;'>    /// @dev checks the eventual state of `executeBatch` function execution:</span>
  924 |     | <span style='background-color: #eee;'>    /// * `dSafe` must have collateral &gt;= debt</span>
  925 |     | <span style='background-color: #eee;'>    /// * DOS must have sufficient balance of deposits and loans for each ERC20 token</span>
  926 |     | <span style='background-color: #eee;'>    /// @dev when called by the end of `executeBatch`, isSolvent checks the potential target state</span>
  927 |     | <span style='background-color: #eee;'>    /// of DOS. Calling this function separately would check current state of DOS, that is always</span>
  928 |     | <span style='background-color: #eee;'>    /// solvable, and so the return value would always be `true`, unless the `dSafe` is liquidatable</span>
  929 |     | <span style='background-color: #eee;'>    /// @param dSafe The address of a dSafe who performed the `executeBatch`</span>
  930 |     | <span style='background-color: #eee;'>    /// @return Whether the position is solvent.</span>
  931 |     | <span style='background-color: #faa;'>    function isSolvent(address dSafe) internal view returns (bool) {</span>
  932 |     | <span style='background-color: #faa;'>        uint gasBefore = gasleft();</span>
  933 |     | <span style='background-color: #faa;'>        int256 leverage = config.fractionalReserveLeverage;</span>
  934 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; erc20Infos.length; i++) {</span>
  935 |     | <span style='background-color: #faa;'>            int256 totalDebt = erc20Infos[i].debt.tokens;</span>
  936 |     | <span style='background-color: #faa;'>            int256 reserve = erc20Infos[i].collateral.tokens + totalDebt;</span>
  937 |     | <span style='background-color: #eee;'>            FsUtils.Assert(</span>
  938 |     | <span style='background-color: #faa;'>                IERC20(erc20Infos[i].erc20Contract).balanceOf(address(this)) &gt;= uint256(reserve)</span>
  939 |     | <span style='background-color: #eee;'>            );</span>
  940 |     | <span style='background-color: #faa;'>            require(reserve &gt;= -totalDebt / leverage, &quot;Not enough reserve for debt&quot;);</span>
  941 |     | <span style='background-color: #eee;'>        }</span>
  942 |     | <span style='background-color: #eee;'>        (, int256 collateral, int256 debt) = getRiskAdjustedPositionValues(dSafe);</span>
  943 |     | <span style='background-color: #faa;'>        if (gasBefore - gasleft() &gt; config.maxSolvencyCheckGasCost)</span>
  944 |     | <span style='background-color: #faa;'>            revert SolvencyCheckTooExpensive();</span>
  945 |     | <span style='background-color: #faa;'>        return collateral &gt;= debt;</span>
  946 |     | <span style='background-color: #eee;'>    }</span>
  947 |     | <span style='background-color: #eee;'></span>
  948 |     | <span style='background-color: #faa;'>    function _getNFTId(address erc721, uint256 tokenId) internal view returns (DSafeLib.NFTId) {</span>
  949 |     | <span style='background-color: #faa;'>        if (infoIdx[erc721].kind != ContractKind.ERC721) {</span>
  950 |     | <span style='background-color: #faa;'>            revert NotNFT();</span>
  951 |     | <span style='background-color: #eee;'>        }</span>
  952 |     | <span style='background-color: #faa;'>        uint16 erc721Idx = infoIdx[erc721].idx;</span>
  953 |     | <span style='background-color: #faa;'>        uint256 tokenHash = uint256(keccak256(abi.encodePacked(tokenId))) &gt;&gt; 32;</span>
  954 |     | <span style='background-color: #faa;'>        return DSafeLib.NFTId.wrap(erc721Idx | (tokenHash &lt;&lt; 16) | ((tokenId &gt;&gt; 240) &lt;&lt; 240));</span>
  955 |     | <span style='background-color: #eee;'>    }</span>
  956 |     | <span style='background-color: #eee;'></span>
  957 |     | <span style='background-color: #eee;'>    function _isApprovedOrOwner(</span>
  958 |     | <span style='background-color: #eee;'>        address spender,</span>
  959 |     | <span style='background-color: #eee;'>        address _owner,</span>
  960 |     | <span style='background-color: #eee;'>        DSafeLib.NFTId nftId</span>
  961 |     | <span style='background-color: #eee;'>    ) internal view returns (bool) {</span>
  962 |     | <span style='background-color: #eee;'>        DSafeLib.DSafe storage p = dSafes[msg.sender];</span>
  963 |     | <span style='background-color: #faa;'>        (uint16 infoIndex, uint256 tokenId) = getNFTData(nftId);</span>
  964 |     | <span style='background-color: #faa;'>        address collection = erc721Infos[infoIndex].erc721Contract;</span>
  965 |     | <span style='background-color: #faa;'>        uint16 idx = tokenDataByNFTId[nftId].dSafeIdx;</span>
  966 |     | <span style='background-color: #faa;'>        bool isdepositERC721Owner = idx &lt; p.nfts.length &amp;&amp;</span>
  967 |     | <span style='background-color: #faa;'>            DSafeLib.NFTId.unwrap(p.nfts[idx]) == DSafeLib.NFTId.unwrap(nftId);</span>
  968 |     | <span style='background-color: #faa;'>        return (isdepositERC721Owner ||</span>
  969 |     | <span style='background-color: #faa;'>            getApproved(collection, tokenId) == spender ||</span>
  970 |     | <span style='background-color: #eee;'>            isApprovedForAll(collection, _owner, spender));</span>
  971 |     | <span style='background-color: #eee;'>    }</span>
  972 |     | <span style='background-color: #eee;'></span>
  973 |     | <span style='background-color: #eee;'>    // Config functions are handled by DOSConfig</span>
  974 |     | <span style='background-color: #eee;'>    function _implementation() internal view override returns (address) {</span>
  975 |     | <span style='background-color: #faa;'>        return dosConfigAddress;</span>
  976 |     | <span style='background-color: #eee;'>    }</span>
  977 |     | <span style='background-color: #eee;'>}</span>
  978 |     | <span style='background-color: #eee;'></span>
  979 |     | <span style='background-color: #faa;'>/// @title DOS Config</span>
  980 |     | <span style='background-color: #eee;'>contract DOSConfig is DOSState, ImmutableGovernance, IDOSConfig {</span>
  981 |     | <span style='background-color: #eee;'>    using DSafeLib for DSafeLib.DSafe;</span>
  982 |     | <span style='background-color: #eee;'>    using DSafeLib for ERC20Pool;</span>
  983 |     | <span style='background-color: #eee;'>    using SafeERC20 for IERC20;</span>
  984 |     | <span style='background-color: #eee;'>    using Address for address;</span>
  985 |     | <span style='background-color: #eee;'></span>
  986 |     | <span style='background-color: #eee;'>    constructor(address _owner) ImmutableGovernance(_owner) {}</span>
  987 |     | <span style='background-color: #eee;'></span>
  988 |     | <span style='background-color: #eee;'>    /// @notice upgrades the version of dSafeLogic contract for the `dSafe`</span>
  989 |     | <span style='background-color: #eee;'>    /// @param version The new target version of dSafeLogic contract</span>
  990 |     | <span style='background-color: #eee;'>    function upgradeDSafeImplementation(</span>
  991 |     | <span style='background-color: #eee;'>        string calldata version</span>
  992 |     | <span style='background-color: #eee;'>    ) external override onlyDSafe whenNotPaused {</span>
  993 |     | <span style='background-color: #eee;'>        (</span>
  994 |     | <span style='background-color: #eee;'>            ,</span>
  995 |     | <span style='background-color: #eee;'>            IVersionManager.Status status,</span>
  996 |     | <span style='background-color: #eee;'>            IVersionManager.BugLevel bugLevel,</span>
  997 |     | <span style='background-color: #eee;'>            address implementation,</span>
  998 |     | <span style='background-color: #eee;'></span>
  999 |     | <span style='background-color: #faa;'>        ) = versionManager.getVersionDetails(version);</span>
 1000 |     | <span style='background-color: #faa;'>        require(status != IVersionManager.Status.DEPRECATED, &quot;Version is deprecated&quot;);</span>
 1001 |     | <span style='background-color: #eee;'>        require(bugLevel == IVersionManager.BugLevel.NONE, &quot;Version has bugs&quot;);</span>
 1002 |     | <span style='background-color: #faa;'>        dSafeLogic[msg.sender] = implementation;</span>
 1003 |     | <span style='background-color: #faa;'>        emit IDOSConfig.DSafeImplementationUpgraded(msg.sender, version, implementation);</span>
 1004 |     | <span style='background-color: #eee;'>    }</span>
 1005 |     | <span style='background-color: #eee;'></span>
 1006 |     | <span style='background-color: #eee;'>    /// @notice transfers the ownership of the `dSafe` to the `newOwner`</span>
 1007 |     | <span style='background-color: #eee;'>    /// @param newOwner The new owner of the `dSafe`</span>
 1008 |     | <span style='background-color: #eee;'>    function transferDSafeOwnership(address newOwner) external override onlyDSafe whenNotPaused {</span>
 1009 |     | <span style='background-color: #eee;'>        dSafes[msg.sender].owner = newOwner;</span>
 1010 |     | <span style='background-color: #faa;'>        emit IDOSConfig.DSafeOwnershipTransferred(msg.sender, newOwner);</span>
 1011 |     | <span style='background-color: #eee;'>    }</span>
 1012 |     | <span style='background-color: #eee;'></span>
 1013 |     | <span style='background-color: #eee;'>    /// @notice Pause the contract</span>
 1014 |     | <span style='background-color: #eee;'>    function pause() external override onlyGovernance {</span>
 1015 |     | <span style='background-color: #eee;'>        _pause();</span>
 1016 |     | <span style='background-color: #eee;'>    }</span>
 1017 |     | <span style='background-color: #eee;'></span>
 1018 |     | <span style='background-color: #eee;'>    /// @notice Unpause the contract</span>
 1019 |     | <span style='background-color: #eee;'>    function unpause() external override onlyGovernance {</span>
 1020 |     | <span style='background-color: #eee;'>        _unpause();</span>
 1021 |     | <span style='background-color: #eee;'>    }</span>
 1022 |     | <span style='background-color: #eee;'></span>
 1023 |     | <span style='background-color: #eee;'>    /// @notice add a new ERC20 to be used inside DOS</span>
 1024 |     | <span style='background-color: #eee;'>    /// @dev For governance only.</span>
 1025 |     | <span style='background-color: #eee;'>    /// @param erc20Contract The address of ERC20 to add</span>
 1026 |     | <span style='background-color: #eee;'>    /// @param name The name of the ERC20. E.g. &quot;Wrapped ETH&quot;</span>
 1027 |     | <span style='background-color: #eee;'>    /// @param symbol The symbol of the ERC20. E.g. &quot;WETH&quot;</span>
 1028 |     | <span style='background-color: #eee;'>    /// @param decimals Decimals of the ERC20. E.g. 18 for WETH and 6 for USDC</span>
 1029 |     | <span style='background-color: #eee;'>    /// @param valueOracle The address of the Value Oracle. Probably Uniswap one</span>
 1030 |     | <span style='background-color: #eee;'>    /// @param baseRate The interest rate when utilization is 0</span>
 1031 |     | <span style='background-color: #eee;'>    /// @param slope1 The interest rate slope when utilization is less than the targetUtilization</span>
 1032 |     | <span style='background-color: #eee;'>    /// @param slope2 The interest rate slope when utilization is more than the targetUtilization</span>
 1033 |     | <span style='background-color: #eee;'>    /// @param targetUtilization The target utilization for the asset</span>
 1034 |     | <span style='background-color: #eee;'>    /// @return the index of the added ERC20 in the erc20Infos array</span>
 1035 |     | <span style='background-color: #eee;'>    function addERC20Info(</span>
 1036 |     | <span style='background-color: #eee;'>        address erc20Contract,</span>
 1037 |     | <span style='background-color: #eee;'>        string calldata name,</span>
 1038 |     | <span style='background-color: #eee;'>        string calldata symbol,</span>
 1039 |     | <span style='background-color: #eee;'>        uint8 decimals,</span>
 1040 |     | <span style='background-color: #eee;'>        address valueOracle,</span>
 1041 |     | <span style='background-color: #eee;'>        uint256 baseRate,</span>
 1042 |     | <span style='background-color: #eee;'>        uint256 slope1,</span>
 1043 |     | <span style='background-color: #eee;'>        uint256 slope2,</span>
 1044 |     | <span style='background-color: #eee;'>        uint256 targetUtilization</span>
 1045 |     | <span style='background-color: #eee;'>    ) external override onlyGovernance returns (uint16) {</span>
 1046 |     | <span style='background-color: #faa;'>        uint16 erc20Idx = uint16(erc20Infos.length);</span>
 1047 |     | <span style='background-color: #eee;'>        erc20Infos.push(</span>
 1048 |     | <span style='background-color: #faa;'>            ERC20Info(</span>
 1049 |     | <span style='background-color: #eee;'>                erc20Contract,</span>
 1050 |     | <span style='background-color: #eee;'>                IERC20ValueOracle(valueOracle),</span>
 1051 |     | <span style='background-color: #faa;'>                ERC20Pool(0, 0),</span>
 1052 |     | <span style='background-color: #faa;'>                ERC20Pool(0, 0),</span>
 1053 |     | <span style='background-color: #eee;'>                baseRate,</span>
 1054 |     | <span style='background-color: #eee;'>                slope1,</span>
 1055 |     | <span style='background-color: #eee;'>                slope2,</span>
 1056 |     | <span style='background-color: #eee;'>                targetUtilization,</span>
 1057 |     | <span style='background-color: #faa;'>                block.timestamp</span>
 1058 |     | <span style='background-color: #eee;'>            )</span>
 1059 |     | <span style='background-color: #eee;'>        );</span>
 1060 |     | <span style='background-color: #faa;'>        infoIdx[erc20Contract] = ContractData(erc20Idx, ContractKind.ERC20);</span>
 1061 |     | <span style='background-color: #faa;'>        emit IDOSConfig.ERC20Added(</span>
 1062 |     | <span style='background-color: #eee;'>            erc20Idx,</span>
 1063 |     | <span style='background-color: #eee;'>            erc20Contract,</span>
 1064 |     | <span style='background-color: #eee;'>            name,</span>
 1065 |     | <span style='background-color: #eee;'>            symbol,</span>
 1066 |     | <span style='background-color: #eee;'>            decimals,</span>
 1067 |     | <span style='background-color: #eee;'>            valueOracle,</span>
 1068 |     | <span style='background-color: #eee;'>            baseRate,</span>
 1069 |     | <span style='background-color: #eee;'>            slope1,</span>
 1070 |     | <span style='background-color: #eee;'>            slope2,</span>
 1071 |     | <span style='background-color: #eee;'>            targetUtilization</span>
 1072 |     | <span style='background-color: #eee;'>        );</span>
 1073 |     | <span style='background-color: #eee;'>        return erc20Idx;</span>
 1074 |     | <span style='background-color: #eee;'>    }</span>
 1075 |     | <span style='background-color: #eee;'></span>
 1076 |     | <span style='background-color: #eee;'>    /// @notice Add a new ERC721 to be used inside DOS.</span>
 1077 |     | <span style='background-color: #eee;'>    /// @dev For governance only.</span>
 1078 |     | <span style='background-color: #eee;'>    /// @param erc721Contract The address of the ERC721 to be added</span>
 1079 |     | <span style='background-color: #eee;'>    /// @param valueOracleAddress The address of the Uniswap Oracle to get the price of a token</span>
 1080 |     | <span style='background-color: #eee;'>    function addERC721Info(</span>
 1081 |     | <span style='background-color: #eee;'>        address erc721Contract,</span>
 1082 |     | <span style='background-color: #eee;'>        address valueOracleAddress</span>
 1083 |     | <span style='background-color: #eee;'>    ) external override onlyGovernance {</span>
 1084 |     | <span style='background-color: #faa;'>        if (IERC165(erc721Contract).supportsInterface(type(IERC721).interfaceId) == false) {</span>
 1085 |     | <span style='background-color: #faa;'>            revert NotNFT();</span>
 1086 |     | <span style='background-color: #eee;'>        }</span>
 1087 |     | <span style='background-color: #eee;'>        INFTValueOracle valueOracle = INFTValueOracle(valueOracleAddress);</span>
 1088 |     | <span style='background-color: #faa;'>        uint256 erc721Idx = erc721Infos.length;</span>
 1089 |     | <span style='background-color: #faa;'>        erc721Infos.push(ERC721Info(erc721Contract, valueOracle));</span>
 1090 |     | <span style='background-color: #faa;'>        infoIdx[erc721Contract] = ContractData(uint16(erc721Idx), ContractKind.ERC721);</span>
 1091 |     | <span style='background-color: #faa;'>        emit IDOSConfig.ERC721Added(erc721Idx, erc721Contract, valueOracleAddress);</span>
 1092 |     | <span style='background-color: #eee;'>    }</span>
 1093 |     | <span style='background-color: #eee;'></span>
 1094 |     | <span style='background-color: #eee;'>    /// @notice Updates the config of DOS</span>
 1095 |     | <span style='background-color: #eee;'>    /// @dev for governance only.</span>
 1096 |     | <span style='background-color: #eee;'>    /// @param _config the Config of IDOSConfig. A struct with DOS parameters</span>
 1097 |     | <span style='background-color: #eee;'>    function setConfig(Config calldata _config) external override onlyGovernance {</span>
 1098 |     | <span style='background-color: #faa;'>        config = _config;</span>
 1099 |     | <span style='background-color: #faa;'>        emit IDOSConfig.ConfigSet(_config);</span>
 1100 |     | <span style='background-color: #eee;'>    }</span>
 1101 |     | <span style='background-color: #eee;'></span>
 1102 |     | <span style='background-color: #eee;'>    /// @notice Set the address of Version Manager contract</span>
 1103 |     | <span style='background-color: #eee;'>    /// @dev for governance only.</span>
 1104 |     | <span style='background-color: #eee;'>    /// @param _versionManager The address of the Version Manager contract to be set</span>
 1105 |     | <span style='background-color: #eee;'>    function setVersionManager(address _versionManager) external override onlyGovernance {</span>
 1106 |     | <span style='background-color: #eee;'>        versionManager = IVersionManager(_versionManager);</span>
 1107 |     | <span style='background-color: #faa;'>        emit IDOSConfig.VersionManagerSet(_versionManager);</span>
 1108 |     | <span style='background-color: #eee;'>    }</span>
 1109 |     | <span style='background-color: #eee;'></span>
 1110 |     | <span style='background-color: #eee;'>    /// @notice Updates some of ERC20 config parameters</span>
 1111 |     | <span style='background-color: #eee;'>    /// @dev for governance only.</span>
 1112 |     | <span style='background-color: #eee;'>    /// @param erc20 The address of ERC20 contract for which DOS config parameters should be updated</span>
 1113 |     | <span style='background-color: #eee;'>    /// @param baseRate The interest rate when utilization is 0</span>
 1114 |     | <span style='background-color: #eee;'>    /// @param slope1 The interest rate slope when utilization is less than the targetUtilization</span>
 1115 |     | <span style='background-color: #eee;'>    /// @param slope2 The interest rate slope when utilization is more than the targetUtilization</span>
 1116 |     | <span style='background-color: #eee;'>    /// @param targetUtilization The target utilization for the asset</span>
 1117 |     | <span style='background-color: #eee;'>    function setERC20Data(</span>
 1118 |     | <span style='background-color: #eee;'>        address erc20,</span>
 1119 |     | <span style='background-color: #eee;'>        uint256 baseRate,</span>
 1120 |     | <span style='background-color: #eee;'>        uint256 slope1,</span>
 1121 |     | <span style='background-color: #eee;'>        uint256 slope2,</span>
 1122 |     | <span style='background-color: #eee;'>        uint256 targetUtilization</span>
 1123 |     | <span style='background-color: #eee;'>    ) external override onlyGovernance {</span>
 1124 |     | <span style='background-color: #faa;'>        uint16 erc20Idx = infoIdx[erc20].idx;</span>
 1125 |     | <span style='background-color: #faa;'>        if (infoIdx[erc20].kind != ContractKind.ERC20) {</span>
 1126 |     | <span style='background-color: #faa;'>            revert NotERC20();</span>
 1127 |     | <span style='background-color: #eee;'>        }</span>
 1128 |     | <span style='background-color: #faa;'>        erc20Infos[erc20Idx].baseRate = baseRate;</span>
 1129 |     | <span style='background-color: #faa;'>        erc20Infos[erc20Idx].slope1 = slope1;</span>
 1130 |     | <span style='background-color: #faa;'>        erc20Infos[erc20Idx].slope2 = slope2;</span>
 1131 |     | <span style='background-color: #faa;'>        erc20Infos[erc20Idx].targetUtilization = targetUtilization;</span>
 1132 |     | <span style='background-color: #faa;'>        emit IDOSConfig.ERC20DataSet(erc20, baseRate, slope1, slope2, targetUtilization);</span>
 1133 |     | <span style='background-color: #eee;'>    }</span>
 1134 |     | <span style='background-color: #eee;'></span>
 1135 |     | <span style='background-color: #eee;'>    /// @notice creates a new dSafe with sender as the owner and returns the dSafe address</span>
 1136 |     | <span style='background-color: #eee;'>    /// @return dSafe The address of the created dSafe</span>
 1137 |     | <span style='background-color: #eee;'>    function createDSafe() external override whenNotPaused returns (address dSafe) {</span>
 1138 |     | <span style='background-color: #faa;'>        _createDSafe(msg.sender);</span>
 1139 |     | <span style='background-color: #eee;'>   }</span>
 1140 |     | <span style='background-color: #eee;'></span>
 1141 |     | <span style='background-color: #faa;'>    function _createDSafe(address sender) public returns (address dSafe) {</span>
 1142 |     | <span style='background-color: #faa;'>        address[] memory erc20s = new address[](erc20Infos.length);</span>
 1143 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; erc20Infos.length; i++) {</span>
 1144 |     | <span style='background-color: #faa;'>            erc20s[i] = erc20Infos[i].erc20Contract;</span>
 1145 |     | <span style='background-color: #eee;'>        }</span>
 1146 |     | <span style='background-color: #faa;'>        address[] memory erc721s = new address[](erc721Infos.length);</span>
 1147 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; erc721Infos.length; i++) {</span>
 1148 |     | <span style='background-color: #faa;'>            erc721s[i] = erc721Infos[i].erc721Contract;</span>
 1149 |     | <span style='background-color: #eee;'>        }</span>
 1150 |     | <span style='background-color: #eee;'></span>
 1151 |     | <span style='background-color: #faa;'>        dSafe = address(new DSafeProxy(address(this), erc20s, erc721s));</span>
 1152 |     | <span style='background-color: #faa;'>        dSafes[dSafe].owner = sender;</span>
 1153 |     | <span style='background-color: #eee;'></span>
 1154 |     | <span style='background-color: #eee;'>        // add a version parameter if users should pick a specific version</span>
 1155 |     | <span style='background-color: #faa;'>        (, , , address implementation, ) = versionManager.getRecommendedVersion();</span>
 1156 |     | <span style='background-color: #faa;'>        dSafeLogic[dSafe] = implementation;</span>
 1157 |     | <span style='background-color: #faa;'>        emit IDOSConfig.DSafeCreated(dSafe, sender);</span>
 1158 |     | <span style='background-color: #eee;'>    }</span>
 1159 |     | <span style='background-color: #eee;'></span>
 1160 |     | <span style='background-color: #eee;'>    /// @notice Returns the amount of `erc20` tokens on dAccount of dSafe</span>
 1161 |     | <span style='background-color: #eee;'>    /// @param dSafeAddr The address of the dSafe for which dAccount the amount of `erc20` should</span>
 1162 |     | <span style='background-color: #eee;'>    /// be calculated</span>
 1163 |     | <span style='background-color: #eee;'>    /// @param erc20 The address of ERC20 which balance on dAccount of `dSafe` should be calculated</span>
 1164 |     | <span style='background-color: #eee;'>    /// @return the amount of `erc20` on the dAccount of `dSafe`</span>
 1165 |     | <span style='background-color: #eee;'>    function getDAccountERC20(</span>
 1166 |     | <span style='background-color: #eee;'>        address dSafeAddr,</span>
 1167 |     | <span style='background-color: #eee;'>        IERC20 erc20</span>
 1168 |     | <span style='background-color: #eee;'>    ) external view override returns (int256) {</span>
 1169 |     | <span style='background-color: #faa;'>        DSafeLib.DSafe storage dSafe = dSafes[dSafeAddr];</span>
 1170 |     | <span style='background-color: #eee;'>        (ERC20Info storage erc20Info, uint16 erc20Idx) = getERC20Info(erc20);</span>
 1171 |     | <span style='background-color: #faa;'>        ERC20Share erc20Share = dSafe.erc20Share[erc20Idx];</span>
 1172 |     | <span style='background-color: #eee;'>        return getBalance(erc20Share, erc20Info);</span>
 1173 |     | <span style='background-color: #eee;'>    }</span>
 1174 |     | <span style='background-color: #eee;'></span>
 1175 |     | <span style='background-color: #eee;'>    /// @notice returns the NFTs on dAccount of `dSafe`</span>
 1176 |     | <span style='background-color: #eee;'>    /// @param dSafe The address of dSafe which dAccount NFTs should be returned</span>
 1177 |     | <span style='background-color: #eee;'>    /// @return The array of NFT deposited on the dAccount of `dSafe`</span>
 1178 |     | <span style='background-color: #eee;'>    function getDAccountERC721(address dSafe) external view override returns (NFTData[] memory) {</span>
 1179 |     | <span style='background-color: #faa;'>        NFTData[] memory nftData = new NFTData[](dSafes[dSafe].nfts.length);</span>
 1180 |     | <span style='background-color: #faa;'>        for (uint i = 0; i &lt; nftData.length; i++) {</span>
 1181 |     | <span style='background-color: #faa;'>            (uint16 erc721Idx, uint256 tokenId) = getNFTData(dSafes[dSafe].nfts[i]);</span>
 1182 |     | <span style='background-color: #faa;'>            nftData[i] = NFTData(erc721Infos[erc721Idx].erc721Contract, tokenId);</span>
 1183 |     | <span style='background-color: #eee;'>        }</span>
 1184 |     | <span style='background-color: #eee;'>        return nftData;</span>
 1185 |     | <span style='background-color: #eee;'>    }</span>
 1186 |     | <span style='background-color: #eee;'>}</span>
 1187 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/dos/DSafeProxy.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
   5 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC721/IERC721.sol&quot;;</span>
   6 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/cryptography/EIP712.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/proxy/Proxy.sol&quot;;</span>
   8 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/cryptography/SignatureChecker.sol&quot;;</span>
   9 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC721/IERC721Receiver.sol&quot;;</span>
  10 |     | <span style='background-color: #eee;'>import &quot;@uniswap/v3-periphery/contracts/interfaces/ISwapRouter.sol&quot;;</span>
  11 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/interfaces/IERC1271.sol&quot;;</span>
  12 |     | <span style='background-color: #eee;'>import &quot;../lib/FsUtils.sol&quot;;</span>
  13 |     | <span style='background-color: #eee;'>import &quot;../lib/Call.sol&quot;;</span>
  14 |     | <span style='background-color: #eee;'>import &quot;../lib/ImmutableVersion.sol&quot;;</span>
  15 |     | <span style='background-color: #eee;'>import &quot;../interfaces/IDOS.sol&quot;;</span>
  16 |     | <span style='background-color: #eee;'>import &quot;../interfaces/IVersionManager.sol&quot;;</span>
  17 |     | <span style='background-color: #eee;'>import &quot;../interfaces/ITransferReceiver2.sol&quot;;</span>
  18 |     | <span style='background-color: #eee;'>import &quot;../external/interfaces/IPermit2.sol&quot;;</span>
  19 |     | <span style='background-color: #eee;'>import {ISafe} from &quot;../interfaces/ISafe.sol&quot;;</span>
  20 |     | <span style='background-color: #eee;'>import &quot;./DSafeState.sol&quot;;</span>
  21 |     | <span style='background-color: #eee;'>import &quot;./Liquifier.sol&quot;;</span>
  22 |     | <span style='background-color: #eee;'>import &quot;../interfaces/IERC1363-extended.sol&quot;;</span>
  23 |     | <span style='background-color: #eee;'>import &quot;../lib/NonceMap.sol&quot;;</span>
  24 |     | <span style='background-color: #eee;'></span>
  25 |     | <span style='background-color: #eee;'>/// @title DSafe Proxy</span>
  26 |     | <span style='background-color: #eee;'>/// @notice Proxy contract for DOS Safes</span>
  27 |     | <span style='background-color: #faa;'>// Inspired by TransparentUpdatableProxy</span>
  28 |     | <span style='background-color: #eee;'>contract DSafeProxy is DSafeState, Proxy {</span>
  29 |     | <span style='background-color: #eee;'>    modifier ifDos() {</span>
  30 |     | <span style='background-color: #faa;'>        if (msg.sender == address(dos)) {</span>
  31 |     | <span style='background-color: #eee;'>            _;</span>
  32 |     | <span style='background-color: #eee;'>        } else {</span>
  33 |     | <span style='background-color: #eee;'>            _fallback();</span>
  34 |     | <span style='background-color: #eee;'>        }</span>
  35 |     | <span style='background-color: #eee;'>    }</span>
  36 |     | <span style='background-color: #eee;'></span>
  37 |     | <span style='background-color: #eee;'>    constructor(address _dos, address[] memory erc20s, address[] memory erc721s) DSafeState(_dos) {</span>
  38 |     | <span style='background-color: #eee;'>        // Approve DOS and PERMIT2 to spend all ERC20s</span>
  39 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; erc20s.length; i++) {</span>
  40 |     | <span style='background-color: #eee;'>            // slither-disable-next-line missing-zero-check</span>
  41 |     | <span style='background-color: #faa;'>            IERC20 erc20 = IERC20(FsUtils.nonNull(erc20s[i]));</span>
  42 |     | <span style='background-color: #faa;'>            erc20.approve(_dos, type(uint256).max);</span>
  43 |     | <span style='background-color: #faa;'>            erc20.approve(address(PERMIT2), type(uint256).max);</span>
  44 |     | <span style='background-color: #faa;'>            erc20.approve(address(TRANSFER_AND_CALL2), type(uint256).max);</span>
  45 |     | <span style='background-color: #eee;'>        }</span>
  46 |     | <span style='background-color: #eee;'>        // Approve DOS to spend all ERC721s</span>
  47 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; erc721s.length; i++) {</span>
  48 |     | <span style='background-color: #eee;'>            // slither-disable-next-line missing-zero-check</span>
  49 |     | <span style='background-color: #faa;'>            IERC721 erc721 = IERC721(FsUtils.nonNull(erc721s[i]));</span>
  50 |     | <span style='background-color: #faa;'>            erc721.setApprovalForAll(_dos, true);</span>
  51 |     | <span style='background-color: #eee;'>            // Add future uniswap permit for ERC721 support</span>
  52 |     | <span style='background-color: #eee;'>        }</span>
  53 |     | <span style='background-color: #eee;'>    }</span>
  54 |     | <span style='background-color: #eee;'></span>
  55 |     | <span style='background-color: #eee;'>    // Allow ETH transfers</span>
  56 |     | <span style='background-color: #eee;'>    receive() external payable override {}</span>
  57 |     | <span style='background-color: #eee;'></span>
  58 |     | <span style='background-color: #eee;'>    // Allow DOS to make arbitrary calls in lieu of this dSafe</span>
  59 |     | <span style='background-color: #eee;'>    function executeBatch(Call[] calldata calls) external payable ifDos {</span>
  60 |     | <span style='background-color: #eee;'>        // Function is payable to allow for ETH transfers to the logic</span>
  61 |     | <span style='background-color: #eee;'>        // contract, but dos should never send eth (dos contract should</span>
  62 |     | <span style='background-color: #eee;'>        // never contain eth / other than what&#39;s self-destructed into it)</span>
  63 |     | <span style='background-color: #eee;'>        assert(false);</span>
  64 |     | <span style='background-color: #eee;'>        FsUtils.Assert(msg.value == 0);</span>
  65 |     | <span style='background-color: #eee;'>        CallLib.executeBatch(calls);</span>
  66 |     | <span style='background-color: #eee;'>    }</span>
  67 |     | <span style='background-color: #eee;'></span>
  68 |     | <span style='background-color: #eee;'>    // The implementation of the delegate is controlled by DOS</span>
  69 |     | <span style='background-color: #eee;'>    function _implementation() internal view override returns (address) {</span>
  70 |     | <span style='background-color: #faa;'>        return dos.getImplementation(address(this));</span>
  71 |     | <span style='background-color: #eee;'>    }</span>
  72 |     | <span style='background-color: #eee;'>}</span>
  73 |     | <span style='background-color: #eee;'></span>
  74 |     | <span style='background-color: #eee;'>// Calls to the contract not coming from DOS itself are routed to this logic</span>
  75 |     | <span style='background-color: #faa;'>// contract. This allows for flexible extra addition to your dSafe.</span>
  76 |     | <span style='background-color: #eee;'>contract DSafeLogic is</span>
  77 |     | <span style='background-color: #eee;'>    DSafeState,</span>
  78 |     | <span style='background-color: #eee;'>    ImmutableVersion,</span>
  79 |     | <span style='background-color: #eee;'>    IERC721Receiver,</span>
  80 |     | <span style='background-color: #eee;'>    IERC1271,</span>
  81 |     | <span style='background-color: #eee;'>    ITransferReceiver2,</span>
  82 |     | <span style='background-color: #eee;'>    EIP712,</span>
  83 |     | <span style='background-color: #eee;'>    ISafe,</span>
  84 |     | <span style='background-color: #eee;'>    Liquifier,</span>
  85 |     | <span style='background-color: #eee;'>    IERC1363SpenderExtended</span>
  86 |     | <span style='background-color: #eee;'>{</span>
  87 |     | <span style='background-color: #eee;'>    using NonceMapLib for NonceMap;</span>
  88 |     | <span style='background-color: #eee;'></span>
  89 |     | <span style='background-color: #eee;'>    bytes private constant EXECUTEBATCH_TYPESTRING =</span>
  90 |     | <span style='background-color: #faa;'>        &quot;ExecuteBatch(Call[] calls,uint256 nonce,uint256 deadline)&quot;;</span>
  91 |     | <span style='background-color: #eee;'>    bytes private constant TRANSFER_TYPESTRING = &quot;Transfer(address token,uint256 amount)&quot;;</span>
  92 |     | <span style='background-color: #eee;'>    bytes private constant ONTRANSFERRECEIVED2CALL_TYPESTRING =</span>
  93 |     | <span style='background-color: #eee;'>        &quot;OnTransferReceived2Call(address operator,address from,Transfer[] transfers,Call[] calls,uint256 nonce,uint256 deadline)&quot;;</span>
  94 |     | <span style='background-color: #eee;'></span>
  95 |     | <span style='background-color: #eee;'>    bytes32 private constant EXECUTEBATCH_TYPEHASH =</span>
  96 |     | <span style='background-color: #faa;'>        keccak256(abi.encodePacked(EXECUTEBATCH_TYPESTRING, CallLib.CALL_TYPESTRING));</span>
  97 |     | <span style='background-color: #faa;'>    bytes32 private constant TRANSFER_TYPEHASH = keccak256(TRANSFER_TYPESTRING);</span>
  98 |     | <span style='background-color: #eee;'>    bytes32 private constant ONTRANSFERRECEIVED2CALL_TYPEHASH =</span>
  99 |     | <span style='background-color: #faa;'>        keccak256(</span>
 100 |     | <span style='background-color: #faa;'>            abi.encodePacked(</span>
 101 |     | <span style='background-color: #eee;'>                ONTRANSFERRECEIVED2CALL_TYPESTRING,</span>
 102 |     | <span style='background-color: #eee;'>                CallLib.CALL_TYPESTRING,</span>
 103 |     | <span style='background-color: #eee;'>                TRANSFER_TYPESTRING</span>
 104 |     | <span style='background-color: #eee;'>            )</span>
 105 |     | <span style='background-color: #eee;'>        );</span>
 106 |     | <span style='background-color: #eee;'></span>
 107 |     | <span style='background-color: #eee;'>    string private constant VERSION = &quot;1.0.0&quot;;</span>
 108 |     | <span style='background-color: #eee;'></span>
 109 |     | <span style='background-color: #eee;'>    bool internal forwardNFT;</span>
 110 |     | <span style='background-color: #eee;'>    NonceMap private nonceMap;</span>
 111 |     | <span style='background-color: #eee;'></span>
 112 |     | <span style='background-color: #eee;'>    error InvalidData();</span>
 113 |     | <span style='background-color: #eee;'>    error InvalidSignature();</span>
 114 |     | <span style='background-color: #eee;'>    error NonceAlreadyUsed();</span>
 115 |     | <span style='background-color: #eee;'>    error DeadlineExpired();</span>
 116 |     | <span style='background-color: #eee;'></span>
 117 |     | <span style='background-color: #eee;'>    modifier onlyOwner() {</span>
 118 |     | <span style='background-color: #faa;'>        require(dos.getDSafeOwner(address(this)) == msg.sender, &quot;&quot;);</span>
 119 |     | <span style='background-color: #eee;'>        _;</span>
 120 |     | <span style='background-color: #eee;'>    }</span>
 121 |     | <span style='background-color: #eee;'></span>
 122 |     | <span style='background-color: #eee;'>    // Note EIP712 is implemented with immutable variables and is not using</span>
 123 |     | <span style='background-color: #eee;'>    // storage and thus can be used in a proxy contract constructor.</span>
 124 |     | <span style='background-color: #eee;'>    // Version number should be in sync with VersionManager version.</span>
 125 |     | <span style='background-color: #eee;'>    constructor(</span>
 126 |     | <span style='background-color: #eee;'>        address _dos</span>
 127 |     | <span style='background-color: #eee;'>    ) EIP712(&quot;DOS dSafe&quot;, VERSION) ImmutableVersion(VERSION) DSafeState(_dos) {}</span>
 128 |     | <span style='background-color: #eee;'></span>
 129 |     | <span style='background-color: #eee;'>    /// @notice makes a batch of different calls from the name of dSafe owner. Eventual state of</span>
 130 |     | <span style='background-color: #eee;'>    /// dAccount and DOS must be solvent, i.e. debt on dAccount cannot exceed collateral on</span>
 131 |     | <span style='background-color: #eee;'>    /// dAccount and dSafe and DOS reserve/debt must be sufficient</span>
 132 |     | <span style='background-color: #eee;'>    /// @dev - this goes to dos.executeBatch that would immediately call DSafeProxy.executeBatch</span>
 133 |     | <span style='background-color: #eee;'>    /// from above of this file</span>
 134 |     | <span style='background-color: #eee;'>    /// @param calls {address to, bytes callData, uint256 value}[], where</span>
 135 |     | <span style='background-color: #eee;'>    ///   * to - is the address of the contract whose function should be called</span>
 136 |     | <span style='background-color: #eee;'>    ///   * callData - encoded function name and it&#39;s arguments</span>
 137 |     | <span style='background-color: #eee;'>    ///   * value - the amount of ETH to sent with the call</span>
 138 |     | <span style='background-color: #eee;'>    function executeBatch(Call[] memory calls) external payable onlyOwner {</span>
 139 |     | <span style='background-color: #eee;'>        assert(false);</span>
 140 |     | <span style='background-color: #eee;'>        bool saveForwardNFT = forwardNFT;</span>
 141 |     | <span style='background-color: #eee;'>        forwardNFT = false;</span>
 142 |     | <span style='background-color: #eee;'>        dos.executeBatch(calls);</span>
 143 |     | <span style='background-color: #eee;'>        forwardNFT = saveForwardNFT;</span>
 144 |     | <span style='background-color: #eee;'>    }</span>
 145 |     | <span style='background-color: #eee;'></span>
 146 |     | <span style='background-color: #eee;'>    function executeSignedBatch(</span>
 147 |     | <span style='background-color: #eee;'>        Call[] memory calls,</span>
 148 |     | <span style='background-color: #eee;'>        uint256 nonce,</span>
 149 |     | <span style='background-color: #eee;'>        uint256 deadline,</span>
 150 |     | <span style='background-color: #eee;'>        bytes calldata signature</span>
 151 |     | <span style='background-color: #eee;'>    ) external payable {</span>
 152 |     | <span style='background-color: #faa;'>        if (deadline &lt; block.timestamp) revert DeadlineExpired();</span>
 153 |     | <span style='background-color: #faa;'>        nonceMap.validateAndUseNonce(nonce);</span>
 154 |     | <span style='background-color: #faa;'>        bytes32 digest = _hashTypedDataV4(</span>
 155 |     | <span style='background-color: #eee;'>            keccak256(</span>
 156 |     | <span style='background-color: #faa;'>                abi.encode(EXECUTEBATCH_TYPEHASH, CallLib.hashCallArray(calls), nonce, deadline)</span>
 157 |     | <span style='background-color: #eee;'>            )</span>
 158 |     | <span style='background-color: #eee;'>        );</span>
 159 |     | <span style='background-color: #faa;'>        if (</span>
 160 |     | <span style='background-color: #faa;'>            !SignatureChecker.isValidSignatureNow(</span>
 161 |     | <span style='background-color: #faa;'>                dos.getDSafeOwner(address(this)),</span>
 162 |     | <span style='background-color: #eee;'>                digest,</span>
 163 |     | <span style='background-color: #eee;'>                signature</span>
 164 |     | <span style='background-color: #eee;'>            )</span>
 165 |     | <span style='background-color: #faa;'>        ) revert InvalidSignature();</span>
 166 |     | <span style='background-color: #eee;'></span>
 167 |     | <span style='background-color: #faa;'>        dos.executeBatch(calls);</span>
 168 |     | <span style='background-color: #eee;'>    }</span>
 169 |     | <span style='background-color: #eee;'></span>
 170 |     | <span style='background-color: #eee;'>    function forwardNFTs(bool _forwardNFT) external {</span>
 171 |     | <span style='background-color: #faa;'>        require(msg.sender == address(this), &quot;only this&quot;);</span>
 172 |     | <span style='background-color: #eee;'>        forwardNFT = _forwardNFT;</span>
 173 |     | <span style='background-color: #eee;'>    }</span>
 174 |     | <span style='background-color: #eee;'></span>
 175 |     | <span style='background-color: #eee;'>    /// @notice ERC721 transfer callback</span>
 176 |     | <span style='background-color: #eee;'>    /// @dev it&#39;s a callback, required to be implemented by IERC721Receiver interface for the</span>
 177 |     | <span style='background-color: #eee;'>    /// contract to be able to receive ERC721 NFTs.</span>
 178 |     | <span style='background-color: #eee;'>    /// we are already using it to support &quot;forwardNFT&quot; of dSafe.</span>
 179 |     | <span style='background-color: #eee;'>    /// `return this.onERC721Received.selector;` is mandatory part for the NFT transfer to work -</span>
 180 |     | <span style='background-color: #eee;'>    /// not a part of owr business logic</span>
 181 |     | <span style='background-color: #eee;'>    /// @param - operator The address which called `safeTransferFrom` function</span>
 182 |     | <span style='background-color: #eee;'>    /// @param - from The address which previously owned the token</span>
 183 |     | <span style='background-color: #eee;'>    /// @param tokenId The NFT identifier which is being transferred</span>
 184 |     | <span style='background-color: #eee;'>    /// @param data Additional data with no specified format</span>
 185 |     | <span style='background-color: #eee;'>    /// @return `bytes4(keccak256(&quot;onERC721Received(address,address,uint256,bytes)&quot;))`</span>
 186 |     | <span style='background-color: #eee;'>    function onERC721Received(</span>
 187 |     | <span style='background-color: #eee;'>        address /* operator */,</span>
 188 |     | <span style='background-color: #eee;'>        address /* from */,</span>
 189 |     | <span style='background-color: #eee;'>        uint256 tokenId,</span>
 190 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 191 |     | <span style='background-color: #eee;'>    ) public virtual override returns (bytes4) {</span>
 192 |     | <span style='background-color: #faa;'>        if (forwardNFT) {</span>
 193 |     | <span style='background-color: #faa;'>            IERC721(msg.sender).safeTransferFrom(address(this), address(dos), tokenId, data);</span>
 194 |     | <span style='background-color: #eee;'>        }</span>
 195 |     | <span style='background-color: #eee;'>        return this.onERC721Received.selector;</span>
 196 |     | <span style='background-color: #eee;'>    }</span>
 197 |     | <span style='background-color: #eee;'></span>
 198 |     | <span style='background-color: #eee;'>    function setNonce(uint256 nonce) external onlyOwner {</span>
 199 |     | <span style='background-color: #faa;'>        nonceMap.validateAndUseNonce(nonce);</span>
 200 |     | <span style='background-color: #eee;'>    }</span>
 201 |     | <span style='background-color: #eee;'></span>
 202 |     | <span style='background-color: #eee;'>    /// @inheritdoc ITransferReceiver2</span>
 203 |     | <span style='background-color: #eee;'>    function onTransferReceived2(</span>
 204 |     | <span style='background-color: #eee;'>        address operator,</span>
 205 |     | <span style='background-color: #eee;'>        address from,</span>
 206 |     | <span style='background-color: #eee;'>        ITransferReceiver2.Transfer[] calldata transfers,</span>
 207 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
 208 |     | <span style='background-color: #eee;'>    ) external override onlyTransferAndCall2 returns (bytes4) {</span>
 209 |     | <span style='background-color: #eee;'>        // options:</span>
 210 |     | <span style='background-color: #eee;'>        // 1) just deposit into proxy, nothing to do</span>
 211 |     | <span style='background-color: #eee;'>        // 2) execute a batch of calls (msg.sender is owner)</span>
 212 |     | <span style='background-color: #eee;'>        // 3) directly deposit into dos contract</span>
 213 |     | <span style='background-color: #eee;'>        // 3) execute a signed batch of tx&#39;s</span>
 214 |     | <span style='background-color: #faa;'>        if (data.length == 0) {</span>
 215 |     | <span style='background-color: #eee;'>            /* just deposit in the proxy, nothing to do */</span>
 216 |     | <span style='background-color: #faa;'>        } else if (data[0] == 0x00) {</span>
 217 |     | <span style='background-color: #eee;'>            // execute batch</span>
 218 |     | <span style='background-color: #faa;'>            require(msg.sender == dos.getDSafeOwner(address(this)), &quot;Not owner&quot;);</span>
 219 |     | <span style='background-color: #faa;'>            Call[] memory calls = abi.decode(data[1:], (Call[]));</span>
 220 |     | <span style='background-color: #faa;'>            dos.executeBatch(calls);</span>
 221 |     | <span style='background-color: #faa;'>        } else if (data[0] == 0x01) {</span>
 222 |     | <span style='background-color: #faa;'>            require(data.length == 1, &quot;Invalid data - allowed are [], [0...], [1] and [2]&quot;);</span>
 223 |     | <span style='background-color: #eee;'>            // deposit in the dos dSafe</span>
 224 |     | <span style='background-color: #faa;'>            for (uint256 i = 0; i &lt; transfers.length; i++) {</span>
 225 |     | <span style='background-color: #faa;'>                ITransferReceiver2.Transfer memory transfer = transfers[i];</span>
 226 |     | <span style='background-color: #faa;'>                dos.depositERC20(IERC20(transfer.token), transfer.amount);</span>
 227 |     | <span style='background-color: #eee;'>            }</span>
 228 |     | <span style='background-color: #faa;'>        } else if (data[0] == 0x02) {</span>
 229 |     | <span style='background-color: #eee;'>            // execute signed batch</span>
 230 |     | <span style='background-color: #eee;'></span>
 231 |     | <span style='background-color: #eee;'>            // Verify signature matches</span>
 232 |     | <span style='background-color: #faa;'>            (Call[] memory calls, uint256 nonce, uint256 deadline, bytes memory signature) = abi</span>
 233 |     | <span style='background-color: #eee;'>                .decode(data[1:], (Call[], uint256, uint256, bytes));</span>
 234 |     | <span style='background-color: #eee;'></span>
 235 |     | <span style='background-color: #faa;'>            if (deadline &lt; block.timestamp) revert DeadlineExpired();</span>
 236 |     | <span style='background-color: #faa;'>            nonceMap.validateAndUseNonce(nonce);</span>
 237 |     | <span style='background-color: #eee;'></span>
 238 |     | <span style='background-color: #faa;'>            bytes32[] memory transferDigests = new bytes32[](transfers.length);</span>
 239 |     | <span style='background-color: #faa;'>            for (uint256 i = 0; i &lt; transfers.length; i++) {</span>
 240 |     | <span style='background-color: #faa;'>                transferDigests[i] = keccak256(</span>
 241 |     | <span style='background-color: #faa;'>                    abi.encode(TRANSFER_TYPEHASH, transfers[i].token, transfers[i].amount)</span>
 242 |     | <span style='background-color: #eee;'>                );</span>
 243 |     | <span style='background-color: #eee;'>            }</span>
 244 |     | <span style='background-color: #faa;'>            bytes32 digest = _hashTypedDataV4(</span>
 245 |     | <span style='background-color: #faa;'>                keccak256(</span>
 246 |     | <span style='background-color: #faa;'>                    abi.encode(</span>
 247 |     | <span style='background-color: #eee;'>                        ONTRANSFERRECEIVED2CALL_TYPEHASH,</span>
 248 |     | <span style='background-color: #eee;'>                        operator,</span>
 249 |     | <span style='background-color: #eee;'>                        from,</span>
 250 |     | <span style='background-color: #faa;'>                        keccak256(abi.encodePacked(transferDigests)),</span>
 251 |     | <span style='background-color: #faa;'>                        CallLib.hashCallArray(calls),</span>
 252 |     | <span style='background-color: #eee;'>                        nonce,</span>
 253 |     | <span style='background-color: #eee;'>                        deadline</span>
 254 |     | <span style='background-color: #eee;'>                    )</span>
 255 |     | <span style='background-color: #eee;'>                )</span>
 256 |     | <span style='background-color: #eee;'>            );</span>
 257 |     | <span style='background-color: #faa;'>            if (</span>
 258 |     | <span style='background-color: #faa;'>                !SignatureChecker.isValidSignatureNow(</span>
 259 |     | <span style='background-color: #faa;'>                    dos.getDSafeOwner(address(this)),</span>
 260 |     | <span style='background-color: #eee;'>                    digest,</span>
 261 |     | <span style='background-color: #eee;'>                    signature</span>
 262 |     | <span style='background-color: #eee;'>                )</span>
 263 |     | <span style='background-color: #faa;'>            ) revert InvalidSignature();</span>
 264 |     | <span style='background-color: #eee;'></span>
 265 |     | <span style='background-color: #faa;'>            dos.executeBatch(calls);</span>
 266 |     | <span style='background-color: #eee;'>        } else {</span>
 267 |     | <span style='background-color: #faa;'>            revert(&quot;Invalid data - allowed are &#39;&#39;, &#39;0x00...&#39;, &#39;0x01&#39; and &#39;0x02...&#39;&quot;);</span>
 268 |     | <span style='background-color: #eee;'>        }</span>
 269 |     | <span style='background-color: #faa;'>        return ITransferReceiver2.onTransferReceived2.selector;</span>
 270 |     | <span style='background-color: #eee;'>    }</span>
 271 |     | <span style='background-color: #eee;'></span>
 272 |     | <span style='background-color: #eee;'>    function onApprovalReceived(</span>
 273 |     | <span style='background-color: #eee;'>        address sender,</span>
 274 |     | <span style='background-color: #eee;'>        uint256 amount,</span>
 275 |     | <span style='background-color: #eee;'>        Call memory call</span>
 276 |     | <span style='background-color: #eee;'>    ) external returns (bytes4) {</span>
 277 |     | <span style='background-color: #faa;'>        if (call.callData.length == 0) {</span>
 278 |     | <span style='background-color: #faa;'>            revert(&quot;PL: INVALID_DATA&quot;);</span>
 279 |     | <span style='background-color: #eee;'>        }</span>
 280 |     | <span style='background-color: #faa;'>        emit TokensApproved(sender, amount, call.callData);</span>
 281 |     | <span style='background-color: #eee;'></span>
 282 |     | <span style='background-color: #faa;'>        Call[] memory calls = new Call[](1);</span>
 283 |     | <span style='background-color: #faa;'>        calls[0] = call;</span>
 284 |     | <span style='background-color: #eee;'></span>
 285 |     | <span style='background-color: #faa;'>        dos.executeBatch(calls);</span>
 286 |     | <span style='background-color: #eee;'></span>
 287 |     | <span style='background-color: #eee;'>        return this.onApprovalReceived.selector;</span>
 288 |     | <span style='background-color: #eee;'>    }</span>
 289 |     | <span style='background-color: #eee;'></span>
 290 |     | <span style='background-color: #eee;'>    function owner() external view returns (address) {</span>
 291 |     | <span style='background-color: #faa;'>        return dos.getDSafeOwner(address(this));</span>
 292 |     | <span style='background-color: #eee;'>    }</span>
 293 |     | <span style='background-color: #eee;'></span>
 294 |     | <span style='background-color: #eee;'>    /// @inheritdoc IERC1271</span>
 295 |     | <span style='background-color: #eee;'>    function isValidSignature(</span>
 296 |     | <span style='background-color: #eee;'>        bytes32 hash,</span>
 297 |     | <span style='background-color: #eee;'>        bytes memory signature</span>
 298 |     | <span style='background-color: #eee;'>    ) public view override returns (bytes4 magicValue) {</span>
 299 |     | <span style='background-color: #faa;'>        magicValue = SignatureChecker.isValidSignatureNow(</span>
 300 |     | <span style='background-color: #faa;'>            dos.getDSafeOwner(address(this)),</span>
 301 |     | <span style='background-color: #eee;'>            hash,</span>
 302 |     | <span style='background-color: #eee;'>            signature</span>
 303 |     | <span style='background-color: #eee;'>        )</span>
 304 |     | <span style='background-color: #eee;'>            ? this.isValidSignature.selector</span>
 305 |     | <span style='background-color: #eee;'>            : bytes4(0);</span>
 306 |     | <span style='background-color: #eee;'>    }</span>
 307 |     | <span style='background-color: #eee;'></span>
 308 |     | <span style='background-color: #eee;'>    function valueNonce(uint256 nonce) external view returns (bool) {</span>
 309 |     | <span style='background-color: #faa;'>        return nonceMap.getNonce(nonce);</span>
 310 |     | <span style='background-color: #eee;'>    }</span>
 311 |     | <span style='background-color: #eee;'>}</span>
 312 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/dos/DSafeState.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;../interfaces/IDOS.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'>import &quot;../lib/FsUtils.sol&quot;;</span>
  6 |     | <span style='background-color: #eee;'></span>
  7 |     | <span style='background-color: #eee;'>/// @title the state part of the DSafeLogic. A parent to all contracts that form dSafe</span>
  8 |     | <span style='background-color: #eee;'>/// @dev the contract is abstract because it is not expected to be used separately from dSafe</span>
  9 |     | <span style='background-color: #eee;'>abstract contract DSafeState {</span>
 10 |     | <span style='background-color: #eee;'>    /// @dev DOS instance to be used by all other dSafe contracts</span>
 11 |     | <span style='background-color: #faa;'>    IDOS public immutable dos;</span>
 12 |     | <span style='background-color: #eee;'></span>
 13 |     | <span style='background-color: #eee;'>    /// @param _dos - address of a deployed DOS contract</span>
 14 |     | <span style='background-color: #eee;'>    constructor(address _dos) {</span>
 15 |     | <span style='background-color: #eee;'>        // slither-disable-next-line missing-zero-check</span>
 16 |     | <span style='background-color: #faa;'>        dos = IDOS(FsUtils.nonNull(_dos));</span>
 17 |     | <span style='background-color: #eee;'>    }</span>
 18 |     | <span style='background-color: #eee;'>}</span>
 19 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/dos/Liquifier.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
   5 |     | <span style='background-color: #eee;'>import &quot;@uniswap/v3-periphery/contracts/interfaces/ISwapRouter.sol&quot;;</span>
   6 |     | <span style='background-color: #eee;'>import &quot;../external/interfaces/INonfungiblePositionManager.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'>import &quot;../interfaces/IDOS.sol&quot;;</span>
   8 |     | <span style='background-color: #eee;'>import &quot;./DSafeState.sol&quot;;</span>
   9 |     | <span style='background-color: #eee;'></span>
  10 |     | <span style='background-color: #eee;'>struct SqrtPricePriceRangeX96 {</span>
  11 |     | <span style='background-color: #eee;'>    uint160 minSell;</span>
  12 |     | <span style='background-color: #eee;'>    uint160 maxBuy;</span>
  13 |     | <span style='background-color: #eee;'>}</span>
  14 |     | <span style='background-color: #eee;'></span>
  15 |     | <span style='background-color: #eee;'>/// @title Logic for liquify functionality of dSafe</span>
  16 |     | <span style='background-color: #eee;'>/// @dev It is designed to be an extension for dSafeLogic contract.</span>
  17 |     | <span style='background-color: #eee;'>/// Functionally, it&#39;s a part of the dSafeLogic contract, but has been extracted into a separate</span>
  18 |     | <span style='background-color: #eee;'>/// contract for better code structuring. This is why the contract is declared as abstract</span>
  19 |     | <span style='background-color: #eee;'>///   The only function it exports is `liquify`. The rest are private function that are parts of</span>
  20 |     | <span style='background-color: #eee;'>/// `liquify`</span>
  21 |     | <span style='background-color: #eee;'>abstract contract Liquifier is DSafeState {</span>
  22 |     | <span style='background-color: #eee;'>    modifier selfOrDSafeOwner() {</span>
  23 |     | <span style='background-color: #eee;'>        require(</span>
  24 |     | <span style='background-color: #faa;'>            msg.sender == address(this) || msg.sender == dos.getDSafeOwner(address(this)),</span>
  25 |     | <span style='background-color: #eee;'>            &quot;only self or owner&quot;</span>
  26 |     | <span style='background-color: #eee;'>        );</span>
  27 |     | <span style='background-color: #faa;'>        _;</span>
  28 |     | <span style='background-color: #eee;'>    }</span>
  29 |     | <span style='background-color: #eee;'></span>
  30 |     | <span style='background-color: #eee;'>    /// @notice Advanced version of liquidate function. Potentially unwanted side-affect of</span>
  31 |     | <span style='background-color: #eee;'>    /// liquidation is a debt on the liquidator. So liquify would liquidate and then re-balance</span>
  32 |     | <span style='background-color: #eee;'>    /// obtained assets to have no debt. This is the algorithm:</span>
  33 |     | <span style='background-color: #eee;'>    ///   * liquidate dAccount of target `dSafe`</span>
  34 |     | <span style='background-color: #eee;'>    ///   * terminate all obtained ERC721s (NFTs)</span>
  35 |     | <span style='background-color: #eee;'>    ///   * buy/sell `erc20s` for `numeraire` so the balance of `dSafe` on that ERC20s matches the</span>
  36 |     | <span style='background-color: #eee;'>    ///     debt of `dSafe` on it&#39;s dAccount. E.g.:</span>
  37 |     | <span style='background-color: #eee;'>    ///     - for 1 WETH of debt on dAccount and 3 WETH on the balance of dSafe - sell 2 WETH</span>
  38 |     | <span style='background-color: #eee;'>    ///     - for 3 WETH of debt on dAccount and 1 WETH on the balance of dSafe - buy 2 WETH</span>
  39 |     | <span style='background-color: #eee;'>    ///     - for no debt on dAccount and 1 WETH on the balance of dSafe - sell 2 WETH</span>
  40 |     | <span style='background-color: #eee;'>    ///     - for 1 WETH of debt on dAccount and no WETH on the balance of dSave - buy 1 WETH</span>
  41 |     | <span style='background-color: #eee;'>    ///   * deposit `erc20s` and `numeraire` to cover debts</span>
  42 |     | <span style='background-color: #eee;'>    ///</span>
  43 |     | <span style='background-color: #eee;'>    /// !! IMPORTANT: because this function executes quite a lot of logic on top of DOS.liquidate(),</span>
  44 |     | <span style='background-color: #eee;'>    /// there is a risk that for liquidatable position with a long list of NFTs it will run out</span>
  45 |     | <span style='background-color: #eee;'>    /// of gas. As for now, it&#39;s up to liquidator to estimate if specific position is liquifiable,</span>
  46 |     | <span style='background-color: #eee;'>    /// or DOS.liquidate() need to be used (with further assets re-balancing in other transactions)</span>
  47 |     | <span style='background-color: #eee;'>    /// @dev notes on erc20s: the reason for erc20s been a call parameter, and not been calculated</span>
  48 |     | <span style='background-color: #eee;'>    /// inside of liquify, is reducing gas costs</span>
  49 |     | <span style='background-color: #eee;'>    ///   erc20s should NOT include numeraire. Otherwise, the transaction would be reverted with an</span>
  50 |     | <span style='background-color: #eee;'>    /// error from uniswap router</span>
  51 |     | <span style='background-color: #eee;'>    ///   It&#39;s the responsibility of caller to provide the correct list of erc20s. Assets</span>
  52 |     | <span style='background-color: #eee;'>    /// re-balancing would be performed only by this list of tokens and numeraire.</span>
  53 |     | <span style='background-color: #eee;'>    ///   * if erc20s misses a token that liquidatable have debt on - the debt on this erc20 would</span>
  54 |     | <span style='background-color: #eee;'>    ///     persist on liquidator&#39;s dAccount as-is</span>
  55 |     | <span style='background-color: #eee;'>    ///   * if erc20s misses a token that liquidatable have collateral on - the token would persist</span>
  56 |     | <span style='background-color: #eee;'>    ///     on liquidator&#39;s dAccount. It may result in generating debt in numeraire on liquidator</span>
  57 |     | <span style='background-color: #eee;'>    ///     dAccount by the end of liquify (because the token would not be soled for numeraire,</span>
  58 |     | <span style='background-color: #eee;'>    ///     there may not be enough numeraire to buy tokens to cover debts, and so they will be</span>
  59 |     | <span style='background-color: #eee;'>    ///     bought in debt)</span>
  60 |     | <span style='background-color: #eee;'>    ///   * if erc20s misses a token that would be obtained as the result of NFT termination - same</span>
  61 |     | <span style='background-color: #eee;'>    ///     as previous, except of the token to be persisted on dSafe instead of dAccount of</span>
  62 |     | <span style='background-color: #eee;'>    ///     liquidator</span>
  63 |     | <span style='background-color: #eee;'>    ///   Because no buy/sell would be done for prices from outside of the erc20sAllowedPriceRanges,</span>
  64 |     | <span style='background-color: #eee;'>    /// too narrow range may result in not having enough of some ERC20 to cover the debt. So the</span>
  65 |     | <span style='background-color: #eee;'>    /// eventual state would still include some debt</span>
  66 |     | <span style='background-color: #eee;'>    /// @param dSafe - the address of a dSafe to liquidate</span>
  67 |     | <span style='background-color: #eee;'>    /// @param swapRouter - the address of a Uniswap swap router to be used to buy/sell erc20s</span>
  68 |     | <span style='background-color: #eee;'>    /// @param nftManager - the address of a Uniswap NonFungibleTokenManager to be used to terminate</span>
  69 |     | <span style='background-color: #eee;'>    /// ERC721 (NFTs)</span>
  70 |     | <span style='background-color: #eee;'>    /// @param numeraire - the address of an ERC20 to be used to convert to and from erc20s. The</span>
  71 |     | <span style='background-color: #eee;'>    /// liquidation reward would be in this token</span>
  72 |     | <span style='background-color: #eee;'>    /// @param erc20s - the list of ERC20 that liquidated has debt, collateral or that would be</span>
  73 |     | <span style='background-color: #eee;'>    /// obtained from termination of any ERC721 that he owns. Except of numeraire, that should</span>
  74 |     | <span style='background-color: #eee;'>    /// never be included in erc20s array</span>
  75 |     | <span style='background-color: #eee;'>    /// @param erc20sAllowedPriceRanges - the list of root squares of allowed prices in Q96 for</span>
  76 |     | <span style='background-color: #eee;'>    /// `erc20s` swaps on Uniswap in `numeraire`. This is the protection against sandwich-attack -</span>
  77 |     | <span style='background-color: #eee;'>    /// if the price would be lower/higher for sell/buy</span>
  78 |     | <span style='background-color: #eee;'>    ///   It&#39;s up to liquidator to decide what range is acceptable. +/- 1% of price before liquify</span>
  79 |     | <span style='background-color: #eee;'>    /// call seems to be reasonable</span>
  80 |     | <span style='background-color: #eee;'>    ///   Zero minSell/maxBuy value for a specific ERC20 would disable the corresponding check</span>
  81 |     | <span style='background-color: #eee;'>    /// Uniswap docs - https://docs.uniswap.org/contracts/v3/guides/swaps/single-swaps</span>
  82 |     | <span style='background-color: #eee;'>    /// It doesn&#39;t explained in Uniswap docs, but this is how it actually works:</span>
  83 |     | <span style='background-color: #eee;'>    /// * if the price for each token would be below the specified limit</span>
  84 |     | <span style='background-color: #eee;'>    /// then full amount would be converted and no error would be thrown</span>
  85 |     | <span style='background-color: #eee;'>    /// * if at least some amount of tokens can be bought by the price that is below the limit</span>
  86 |     | <span style='background-color: #eee;'>    /// then only that amount of tokens would be bought and no error would be thrown</span>
  87 |     | <span style='background-color: #eee;'>    /// * if no tokens can be bought by the price below the limit</span>
  88 |     | <span style='background-color: #eee;'>    /// then error would be thrown with message &quot;SPL&quot;</span>
  89 |     | <span style='background-color: #faa;'>    function liquify(</span>
  90 |     | <span style='background-color: #eee;'>        address dSafe,</span>
  91 |     | <span style='background-color: #eee;'>        address swapRouter,</span>
  92 |     | <span style='background-color: #eee;'>        address nftManager,</span>
  93 |     | <span style='background-color: #eee;'>        address numeraire,</span>
  94 |     | <span style='background-color: #eee;'>        IERC20[] calldata erc20s,</span>
  95 |     | <span style='background-color: #eee;'>        SqrtPricePriceRangeX96[] calldata erc20sAllowedPriceRanges</span>
  96 |     | <span style='background-color: #eee;'>    ) external selfOrDSafeOwner {</span>
  97 |     | <span style='background-color: #faa;'>        if (msg.sender != address(this)) {</span>
  98 |     | <span style='background-color: #eee;'>            /* prettier-ignore */ // list of liquify arguments as-is</span>
  99 |     | <span style='background-color: #faa;'>            return callOverBatchExecute(dSafe, swapRouter, nftManager, numeraire, erc20s, erc20sAllowedPriceRanges);</span>
 100 |     | <span style='background-color: #eee;'>        }</span>
 101 |     | <span style='background-color: #eee;'></span>
 102 |     | <span style='background-color: #faa;'>        dos.liquidate(dSafe);</span>
 103 |     | <span style='background-color: #eee;'></span>
 104 |     | <span style='background-color: #eee;'>        (</span>
 105 |     | <span style='background-color: #eee;'>            IERC20[] memory erc20sCollateral,</span>
 106 |     | <span style='background-color: #eee;'>            uint256[] memory erc20sDebtAmounts</span>
 107 |     | <span style='background-color: #eee;'>        ) = analyseDAccountStructure(erc20s, numeraire);</span>
 108 |     | <span style='background-color: #eee;'></span>
 109 |     | <span style='background-color: #faa;'>        dos.withdrawFull(erc20sCollateral);</span>
 110 |     | <span style='background-color: #eee;'>        terminateERC721s(nftManager);</span>
 111 |     | <span style='background-color: #eee;'></span>
 112 |     | <span style='background-color: #eee;'>        (</span>
 113 |     | <span style='background-color: #eee;'>            uint256[] memory erc20sToSellAmounts,</span>
 114 |     | <span style='background-color: #eee;'>            uint256[] memory erc20sToBuyAmounts</span>
 115 |     | <span style='background-color: #eee;'>        ) = calcSellAndBuyERC20Amounts(erc20s, erc20sDebtAmounts);</span>
 116 |     | <span style='background-color: #eee;'>        sellERC20s(swapRouter, erc20s, erc20sToSellAmounts, numeraire, erc20sAllowedPriceRanges);</span>
 117 |     | <span style='background-color: #eee;'>        buyERC20s(swapRouter, erc20s, erc20sToBuyAmounts, numeraire, erc20sAllowedPriceRanges);</span>
 118 |     | <span style='background-color: #eee;'></span>
 119 |     | <span style='background-color: #eee;'>        deposit(erc20s, numeraire);</span>
 120 |     | <span style='background-color: #eee;'>    }</span>
 121 |     | <span style='background-color: #eee;'></span>
 122 |     | <span style='background-color: #eee;'>    function callOverBatchExecute(</span>
 123 |     | <span style='background-color: #eee;'>        address dSafe,</span>
 124 |     | <span style='background-color: #eee;'>        address swapRouter,</span>
 125 |     | <span style='background-color: #eee;'>        address nftManager,</span>
 126 |     | <span style='background-color: #eee;'>        address numeraire,</span>
 127 |     | <span style='background-color: #eee;'>        IERC20[] calldata erc20s,</span>
 128 |     | <span style='background-color: #eee;'>        SqrtPricePriceRangeX96[] calldata erc20sAllowedPriceRanges</span>
 129 |     | <span style='background-color: #eee;'>    ) private {</span>
 130 |     | <span style='background-color: #faa;'>        Call[] memory calls = new Call[](1);</span>
 131 |     | <span style='background-color: #faa;'>        calls[0] = Call({</span>
 132 |     | <span style='background-color: #eee;'>            to: address(this),</span>
 133 |     | <span style='background-color: #faa;'>            callData: abi.encodeWithSelector(</span>
 134 |     | <span style='background-color: #eee;'>                this.liquify.selector,</span>
 135 |     | <span style='background-color: #eee;'>                dSafe,</span>
 136 |     | <span style='background-color: #eee;'>                swapRouter,</span>
 137 |     | <span style='background-color: #eee;'>                nftManager,</span>
 138 |     | <span style='background-color: #eee;'>                numeraire,</span>
 139 |     | <span style='background-color: #eee;'>                erc20s,</span>
 140 |     | <span style='background-color: #eee;'>                erc20sAllowedPriceRanges</span>
 141 |     | <span style='background-color: #eee;'>            ),</span>
 142 |     | <span style='background-color: #eee;'>            value: 0</span>
 143 |     | <span style='background-color: #eee;'>        });</span>
 144 |     | <span style='background-color: #faa;'>        dos.executeBatch(calls);</span>
 145 |     | <span style='background-color: #eee;'>    }</span>
 146 |     | <span style='background-color: #eee;'></span>
 147 |     | <span style='background-color: #eee;'>    /// @param nftManager - passed as-is from liquify function. The address of a Uniswap</span>
 148 |     | <span style='background-color: #eee;'>    ///   NonFungibleTokenManager to be used to terminate ERC721 (NFTs)</span>
 149 |     | <span style='background-color: #eee;'>    function terminateERC721s(address nftManager) private {</span>
 150 |     | <span style='background-color: #eee;'>        INonfungiblePositionManager manager = INonfungiblePositionManager(nftManager);</span>
 151 |     | <span style='background-color: #faa;'>        IDOS.NFTData[] memory nfts = dos.getDAccountERC721(address(this));</span>
 152 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; nfts.length; i++) {</span>
 153 |     | <span style='background-color: #faa;'>            IDOS.NFTData memory nft = nfts[i];</span>
 154 |     | <span style='background-color: #faa;'>            dos.withdrawERC721(nft.erc721, nft.tokenId);</span>
 155 |     | <span style='background-color: #faa;'>            (, , , , , , , uint128 nftLiquidity, , , , ) = manager.positions(nft.tokenId);</span>
 156 |     | <span style='background-color: #faa;'>            manager.decreaseLiquidity(</span>
 157 |     | <span style='background-color: #faa;'>                INonfungiblePositionManager.DecreaseLiquidityParams({</span>
 158 |     | <span style='background-color: #eee;'>                    tokenId: nft.tokenId,</span>
 159 |     | <span style='background-color: #eee;'>                    liquidity: nftLiquidity,</span>
 160 |     | <span style='background-color: #eee;'>                    amount0Min: 0,</span>
 161 |     | <span style='background-color: #eee;'>                    amount1Min: 0,</span>
 162 |     | <span style='background-color: #faa;'>                    deadline: type(uint256).max</span>
 163 |     | <span style='background-color: #eee;'>                })</span>
 164 |     | <span style='background-color: #eee;'>            );</span>
 165 |     | <span style='background-color: #faa;'>            manager.collect(</span>
 166 |     | <span style='background-color: #faa;'>                INonfungiblePositionManager.CollectParams({</span>
 167 |     | <span style='background-color: #eee;'>                    tokenId: nft.tokenId,</span>
 168 |     | <span style='background-color: #eee;'>                    recipient: address(this),</span>
 169 |     | <span style='background-color: #eee;'>                    amount0Max: type(uint128).max,</span>
 170 |     | <span style='background-color: #eee;'>                    amount1Max: type(uint128).max</span>
 171 |     | <span style='background-color: #eee;'>                })</span>
 172 |     | <span style='background-color: #eee;'>            );</span>
 173 |     | <span style='background-color: #eee;'></span>
 174 |     | <span style='background-color: #faa;'>            manager.burn(nft.tokenId);</span>
 175 |     | <span style='background-color: #eee;'>        }</span>
 176 |     | <span style='background-color: #eee;'>    }</span>
 177 |     | <span style='background-color: #eee;'></span>
 178 |     | <span style='background-color: #eee;'>    function analyseDAccountStructure(</span>
 179 |     | <span style='background-color: #eee;'>        IERC20[] calldata erc20s,</span>
 180 |     | <span style='background-color: #eee;'>        address numeraire</span>
 181 |     | <span style='background-color: #eee;'>    ) private view returns (IERC20[] memory erc20sCollateral, uint256[] memory erc20sDebtAmounts) {</span>
 182 |     | <span style='background-color: #faa;'>        uint256 numOfERC20sCollateral = 0;</span>
 183 |     | <span style='background-color: #eee;'>        int256[] memory balances = new int256[](erc20s.length);</span>
 184 |     | <span style='background-color: #eee;'></span>
 185 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; erc20s.length; i++) {</span>
 186 |     | <span style='background-color: #faa;'>            int256 balance = dos.getDAccountERC20(address(this), erc20s[i]);</span>
 187 |     | <span style='background-color: #faa;'>            if (balance &gt; 0) {</span>
 188 |     | <span style='background-color: #faa;'>                numOfERC20sCollateral++;</span>
 189 |     | <span style='background-color: #faa;'>                balances[i] = balance;</span>
 190 |     | <span style='background-color: #faa;'>            } else if (balance &lt; 0) {</span>
 191 |     | <span style='background-color: #faa;'>                balances[i] = balance;</span>
 192 |     | <span style='background-color: #eee;'>            }</span>
 193 |     | <span style='background-color: #eee;'>        }</span>
 194 |     | <span style='background-color: #eee;'></span>
 195 |     | <span style='background-color: #faa;'>        int256 dAccountNumeraireBalance = dos.getDAccountERC20(address(this), IERC20(numeraire));</span>
 196 |     | <span style='background-color: #faa;'>        if (dAccountNumeraireBalance &gt; 0) {</span>
 197 |     | <span style='background-color: #faa;'>            numOfERC20sCollateral++;</span>
 198 |     | <span style='background-color: #eee;'>        }</span>
 199 |     | <span style='background-color: #eee;'></span>
 200 |     | <span style='background-color: #faa;'>        erc20sCollateral = new IERC20[](numOfERC20sCollateral);</span>
 201 |     | <span style='background-color: #faa;'>        erc20sDebtAmounts = new uint256[](erc20s.length);</span>
 202 |     | <span style='background-color: #eee;'></span>
 203 |     | <span style='background-color: #faa;'>        if (dAccountNumeraireBalance &gt; 0) {</span>
 204 |     | <span style='background-color: #faa;'>            erc20sCollateral[0] = IERC20(numeraire);</span>
 205 |     | <span style='background-color: #eee;'>        }</span>
 206 |     | <span style='background-color: #eee;'></span>
 207 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; erc20s.length; i++) {</span>
 208 |     | <span style='background-color: #faa;'>            if (balances[i] &gt; 0) {</span>
 209 |     | <span style='background-color: #faa;'>                erc20sCollateral[--numOfERC20sCollateral] = erc20s[i];</span>
 210 |     | <span style='background-color: #faa;'>            } else if (balances[i] &lt; 0) {</span>
 211 |     | <span style='background-color: #faa;'>                erc20sDebtAmounts[i] = uint256(-balances[i]);</span>
 212 |     | <span style='background-color: #eee;'>            }</span>
 213 |     | <span style='background-color: #eee;'>        }</span>
 214 |     | <span style='background-color: #eee;'>    }</span>
 215 |     | <span style='background-color: #eee;'></span>
 216 |     | <span style='background-color: #eee;'>    function calcSellAndBuyERC20Amounts(</span>
 217 |     | <span style='background-color: #eee;'>        IERC20[] calldata erc20s,</span>
 218 |     | <span style='background-color: #eee;'>        uint256[] memory erc20sDebtAmounts</span>
 219 |     | <span style='background-color: #eee;'>    )</span>
 220 |     | <span style='background-color: #eee;'>        private</span>
 221 |     | <span style='background-color: #eee;'>        view</span>
 222 |     | <span style='background-color: #eee;'>        returns (uint256[] memory erc20ToSellAmounts, uint256[] memory erc20ToBuyAmounts)</span>
 223 |     | <span style='background-color: #eee;'>    {</span>
 224 |     | <span style='background-color: #faa;'>        erc20ToBuyAmounts = new uint256[](erc20s.length);</span>
 225 |     | <span style='background-color: #faa;'>        erc20ToSellAmounts = new uint256[](erc20s.length);</span>
 226 |     | <span style='background-color: #eee;'></span>
 227 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; erc20s.length; i++) {</span>
 228 |     | <span style='background-color: #faa;'>            uint256 balance = erc20s[i].balanceOf(address(this));</span>
 229 |     | <span style='background-color: #faa;'>            if (balance &gt; erc20sDebtAmounts[i]) {</span>
 230 |     | <span style='background-color: #faa;'>                erc20ToSellAmounts[i] = balance - erc20sDebtAmounts[i];</span>
 231 |     | <span style='background-color: #faa;'>            } else if (balance &lt; erc20sDebtAmounts[i]) {</span>
 232 |     | <span style='background-color: #faa;'>                erc20ToBuyAmounts[i] = erc20sDebtAmounts[i] - balance;</span>
 233 |     | <span style='background-color: #eee;'>            }</span>
 234 |     | <span style='background-color: #eee;'>        }</span>
 235 |     | <span style='background-color: #eee;'>    }</span>
 236 |     | <span style='background-color: #eee;'></span>
 237 |     | <span style='background-color: #eee;'>    function sellERC20s(</span>
 238 |     | <span style='background-color: #eee;'>        address swapRouter,</span>
 239 |     | <span style='background-color: #eee;'>        IERC20[] memory erc20sToSell,</span>
 240 |     | <span style='background-color: #eee;'>        uint256[] memory amountsToSell,</span>
 241 |     | <span style='background-color: #eee;'>        address erc20ToSellFor,</span>
 242 |     | <span style='background-color: #eee;'>        SqrtPricePriceRangeX96[] calldata erc20sAllowedPriceRanges</span>
 243 |     | <span style='background-color: #eee;'>    ) private {</span>
 244 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; erc20sToSell.length; i++) {</span>
 245 |     | <span style='background-color: #faa;'>            if (amountsToSell[i] == 0) continue;</span>
 246 |     | <span style='background-color: #eee;'></span>
 247 |     | <span style='background-color: #faa;'>            ISwapRouter.ExactInputSingleParams memory params = ISwapRouter.ExactInputSingleParams({</span>
 248 |     | <span style='background-color: #faa;'>                tokenIn: address(erc20sToSell[i]),</span>
 249 |     | <span style='background-color: #eee;'>                tokenOut: erc20ToSellFor,</span>
 250 |     | <span style='background-color: #faa;'>                fee: 500,</span>
 251 |     | <span style='background-color: #eee;'>                recipient: address(this),</span>
 252 |     | <span style='background-color: #eee;'>                deadline: type(uint256).max, // ignore - total transaction type should be limited at DOS level</span>
 253 |     | <span style='background-color: #faa;'>                amountIn: amountsToSell[i],</span>
 254 |     | <span style='background-color: #eee;'>                amountOutMinimum: 0,</span>
 255 |     | <span style='background-color: #eee;'>                // see comments on `erc20sAllowedPriceRanges` parameter of `liquify`</span>
 256 |     | <span style='background-color: #faa;'>                sqrtPriceLimitX96: erc20sAllowedPriceRanges[i].minSell</span>
 257 |     | <span style='background-color: #eee;'>            });</span>
 258 |     | <span style='background-color: #eee;'></span>
 259 |     | <span style='background-color: #faa;'>            try ISwapRouter(swapRouter).exactInputSingle(params) {} catch Error(</span>
 260 |     | <span style='background-color: #eee;'>                string memory reason</span>
 261 |     | <span style='background-color: #eee;'>            ) {</span>
 262 |     | <span style='background-color: #eee;'>                // &quot;SPL&quot; means that proposed sell price is too low. If so - silently skip conversion.</span>
 263 |     | <span style='background-color: #eee;'>                // For any other error - revert</span>
 264 |     | <span style='background-color: #eee;'>                // Consider emitting or logging</span>
 265 |     | <span style='background-color: #eee;'>                // Consider ignoring some other errors if it&#39;s appropriate</span>
 266 |     | <span style='background-color: #eee;'>                // Consider replacing with `Strings.equal` on OpenZeppelin next release</span>
 267 |     | <span style='background-color: #faa;'>                if (keccak256(abi.encodePacked(reason)) != keccak256(abi.encodePacked(&quot;SPL&quot;))) {</span>
 268 |     | <span style='background-color: #faa;'>                    revert(reason);</span>
 269 |     | <span style='background-color: #eee;'>                }</span>
 270 |     | <span style='background-color: #eee;'>            }</span>
 271 |     | <span style='background-color: #eee;'>        }</span>
 272 |     | <span style='background-color: #eee;'>    }</span>
 273 |     | <span style='background-color: #eee;'></span>
 274 |     | <span style='background-color: #eee;'>    function buyERC20s(</span>
 275 |     | <span style='background-color: #eee;'>        address swapRouter,</span>
 276 |     | <span style='background-color: #eee;'>        IERC20[] memory erc20sToBuy,</span>
 277 |     | <span style='background-color: #eee;'>        uint256[] memory amountsToBuy,</span>
 278 |     | <span style='background-color: #eee;'>        address erc20ToBuyFor,</span>
 279 |     | <span style='background-color: #eee;'>        SqrtPricePriceRangeX96[] calldata erc20sAllowedPriceRanges</span>
 280 |     | <span style='background-color: #eee;'>    ) private {</span>
 281 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; erc20sToBuy.length; i++) {</span>
 282 |     | <span style='background-color: #faa;'>            if (amountsToBuy[i] == 0) continue;</span>
 283 |     | <span style='background-color: #eee;'></span>
 284 |     | <span style='background-color: #faa;'>            ISwapRouter.ExactOutputSingleParams memory params = ISwapRouter</span>
 285 |     | <span style='background-color: #eee;'>                .ExactOutputSingleParams({</span>
 286 |     | <span style='background-color: #eee;'>                    tokenIn: erc20ToBuyFor,</span>
 287 |     | <span style='background-color: #faa;'>                    tokenOut: address(erc20sToBuy[i]),</span>
 288 |     | <span style='background-color: #eee;'>                    fee: 500,</span>
 289 |     | <span style='background-color: #eee;'>                    recipient: address(this),</span>
 290 |     | <span style='background-color: #eee;'>                    deadline: type(uint256).max, // ignore - total transaction type should be limited at DOS level</span>
 291 |     | <span style='background-color: #faa;'>                    amountOut: amountsToBuy[i],</span>
 292 |     | <span style='background-color: #eee;'>                    amountInMaximum: type(uint256).max,</span>
 293 |     | <span style='background-color: #eee;'>                    // see comments on `erc20sAllowedPriceRanges` parameter of `liquify`</span>
 294 |     | <span style='background-color: #faa;'>                    sqrtPriceLimitX96: erc20sAllowedPriceRanges[i].maxBuy</span>
 295 |     | <span style='background-color: #eee;'>                });</span>
 296 |     | <span style='background-color: #eee;'></span>
 297 |     | <span style='background-color: #faa;'>            try ISwapRouter(swapRouter).exactOutputSingle(params) {} catch Error(</span>
 298 |     | <span style='background-color: #eee;'>                string memory reason</span>
 299 |     | <span style='background-color: #eee;'>            ) {</span>
 300 |     | <span style='background-color: #eee;'>                // &quot;SPL&quot; means that proposed buy price is too high. If so - silently skip conversion.</span>
 301 |     | <span style='background-color: #eee;'>                // For any other error - revert</span>
 302 |     | <span style='background-color: #eee;'>                // Consider emitting or logging</span>
 303 |     | <span style='background-color: #eee;'>                // Consider ignoring some other errors if it&#39;s appropriate</span>
 304 |     | <span style='background-color: #eee;'>                // Consider replacing with `Strings.equal` on OpenZeppelin next release</span>
 305 |     | <span style='background-color: #faa;'>                if (keccak256(abi.encodePacked(reason)) != keccak256(abi.encodePacked(&quot;SPL&quot;))) {</span>
 306 |     | <span style='background-color: #faa;'>                    revert(reason);</span>
 307 |     | <span style='background-color: #eee;'>                }</span>
 308 |     | <span style='background-color: #eee;'>            }</span>
 309 |     | <span style='background-color: #eee;'>        }</span>
 310 |     | <span style='background-color: #eee;'>    }</span>
 311 |     | <span style='background-color: #eee;'></span>
 312 |     | <span style='background-color: #eee;'>    function deposit(IERC20[] memory erc20s, address numeraire) private {</span>
 313 |     | <span style='background-color: #faa;'>        dos.depositFull(erc20s);</span>
 314 |     | <span style='background-color: #faa;'>        IERC20[] memory numeraireArray = new IERC20[](1);</span>
 315 |     | <span style='background-color: #faa;'>        numeraireArray[0] = IERC20(numeraire);</span>
 316 |     | <span style='background-color: #faa;'>        dos.depositFull(numeraireArray);</span>
 317 |     | <span style='background-color: #eee;'>    }</span>
 318 |     | <span style='background-color: #eee;'>}</span>
 319 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/dos/TransferAndCall2.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/cryptography/EIP712.sol&quot;;</span>
   5 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/cryptography/ECDSA.sol&quot;;</span>
   6 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/cryptography/SignatureChecker.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span>
   8 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/interfaces/IERC1363Receiver.sol&quot;;</span>
   9 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
  10 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol&quot;;</span>
  11 |     | <span style='background-color: #eee;'>import &quot;../external/interfaces/IWETH9.sol&quot;;</span>
  12 |     | <span style='background-color: #eee;'>import &quot;../interfaces/ITransferReceiver2.sol&quot;;</span>
  13 |     | <span style='background-color: #eee;'>import &quot;../lib/NonceMap.sol&quot;;</span>
  14 |     | <span style='background-color: #eee;'></span>
  15 |     | <span style='background-color: #eee;'>// Bringing ERC1363 to all tokens, it&#39;s to ERC1363 what Permit2 is to ERC2612.</span>
  16 |     | <span style='background-color: #eee;'>// This should be proposed as an EIP and should be deployed cross chain on</span>
  17 |     | <span style='background-color: #faa;'>// fixed address using AnyswapCreate2Deployer.</span>
  18 |     | <span style='background-color: #eee;'>contract TransferAndCall2 is IERC1363Receiver, EIP712 {</span>
  19 |     | <span style='background-color: #eee;'>    using Address for address;</span>
  20 |     | <span style='background-color: #eee;'>    using SafeERC20 for IERC20;</span>
  21 |     | <span style='background-color: #eee;'>    using NonceMapLib for NonceMap;</span>
  22 |     | <span style='background-color: #eee;'></span>
  23 |     | <span style='background-color: #faa;'>    bytes private constant TRANSFER_TYPESTRING = &quot;Transfer(address token,uint256 amount)&quot;;</span>
  24 |     | <span style='background-color: #eee;'>    bytes private constant PERMIT_TYPESTRING =</span>
  25 |     | <span style='background-color: #faa;'>        &quot;Permit(address receiver,Transfer[] transfers,bytes data,uint256 nonce,uint256 deadline)&quot;;</span>
  26 |     | <span style='background-color: #faa;'>    bytes32 private constant TRANSFER_TYPEHASH = keccak256(TRANSFER_TYPESTRING);</span>
  27 |     | <span style='background-color: #eee;'>    bytes32 private constant PERMIT_TYPEHASH =</span>
  28 |     | <span style='background-color: #faa;'>        keccak256(abi.encodePacked(PERMIT_TYPESTRING, TRANSFER_TYPESTRING));</span>
  29 |     | <span style='background-color: #eee;'></span>
  30 |     | <span style='background-color: #eee;'>    mapping(address =&gt; mapping(address =&gt; bool)) public approvalByOwnerByOperator;</span>
  31 |     | <span style='background-color: #eee;'>    mapping(address =&gt; NonceMap) private nonceMap;</span>
  32 |     | <span style='background-color: #eee;'></span>
  33 |     | <span style='background-color: #eee;'>    error onTransferReceivedFailed(</span>
  34 |     | <span style='background-color: #eee;'>        address to,</span>
  35 |     | <span style='background-color: #eee;'>        address operator,</span>
  36 |     | <span style='background-color: #eee;'>        address from,</span>
  37 |     | <span style='background-color: #eee;'>        ITransferReceiver2.Transfer[] transfers,</span>
  38 |     | <span style='background-color: #eee;'>        bytes data</span>
  39 |     | <span style='background-color: #eee;'>    );</span>
  40 |     | <span style='background-color: #eee;'></span>
  41 |     | <span style='background-color: #eee;'>    error TransfersUnsorted();</span>
  42 |     | <span style='background-color: #eee;'></span>
  43 |     | <span style='background-color: #eee;'>    error EthDoesntMatchWethTransfer();</span>
  44 |     | <span style='background-color: #eee;'></span>
  45 |     | <span style='background-color: #eee;'>    error UnauthorizedOperator(address operator, address from);</span>
  46 |     | <span style='background-color: #eee;'></span>
  47 |     | <span style='background-color: #eee;'>    constructor() EIP712(&quot;TransferAndCall2&quot;, &quot;1&quot;) {}</span>
  48 |     | <span style='background-color: #eee;'></span>
  49 |     | <span style='background-color: #eee;'>    /// @dev Set approval for all token transfers from msg.sender to a particular operator</span>
  50 |     | <span style='background-color: #eee;'>    function setApprovalForAll(address operator, bool approved) external {</span>
  51 |     | <span style='background-color: #faa;'>        approvalByOwnerByOperator[msg.sender][operator] = approved;</span>
  52 |     | <span style='background-color: #eee;'>    }</span>
  53 |     | <span style='background-color: #eee;'></span>
  54 |     | <span style='background-color: #eee;'>    /// @dev Called by a token to indicate a transfer into the callee</span>
  55 |     | <span style='background-color: #eee;'>    /// @param receiver The account to sent the tokens</span>
  56 |     | <span style='background-color: #eee;'>    /// @param transfers Transfers that have been made</span>
  57 |     | <span style='background-color: #eee;'>    /// @param data The extra data being passed to the receiving contract</span>
  58 |     | <span style='background-color: #eee;'>    function transferAndCall2(</span>
  59 |     | <span style='background-color: #eee;'>        address receiver,</span>
  60 |     | <span style='background-color: #eee;'>        ITransferReceiver2.Transfer[] calldata transfers,</span>
  61 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
  62 |     | <span style='background-color: #eee;'>    ) external {</span>
  63 |     | <span style='background-color: #faa;'>        return transferFromAndCall2Impl(msg.sender, receiver, address(0), transfers, data);</span>
  64 |     | <span style='background-color: #eee;'>    }</span>
  65 |     | <span style='background-color: #eee;'></span>
  66 |     | <span style='background-color: #eee;'>    /// @dev Called by a token to indicate a transfer into the callee, converting ETH to WETH</span>
  67 |     | <span style='background-color: #eee;'>    /// @param receiver The account to sent the tokens</span>
  68 |     | <span style='background-color: #eee;'>    /// @param weth The WETH9 contract address</span>
  69 |     | <span style='background-color: #eee;'>    /// @param transfers Transfers that have been made</span>
  70 |     | <span style='background-color: #eee;'>    /// @param data The extra data being passed to the receiving contract</span>
  71 |     | <span style='background-color: #eee;'>    function transferAndCall2WithValue(</span>
  72 |     | <span style='background-color: #eee;'>        address receiver,</span>
  73 |     | <span style='background-color: #eee;'>        address weth,</span>
  74 |     | <span style='background-color: #eee;'>        ITransferReceiver2.Transfer[] calldata transfers,</span>
  75 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
  76 |     | <span style='background-color: #eee;'>    ) external payable {</span>
  77 |     | <span style='background-color: #faa;'>        return transferFromAndCall2Impl(msg.sender, receiver, weth, transfers, data);</span>
  78 |     | <span style='background-color: #eee;'>    }</span>
  79 |     | <span style='background-color: #eee;'></span>
  80 |     | <span style='background-color: #eee;'>    /// @dev Called by a token to indicate a transfer into the callee</span>
  81 |     | <span style='background-color: #eee;'>    /// @param from The account that has sent the tokens</span>
  82 |     | <span style='background-color: #eee;'>    /// @param receiver The account to sent the tokens</span>
  83 |     | <span style='background-color: #eee;'>    /// @param transfers Transfers that have been made</span>
  84 |     | <span style='background-color: #eee;'>    /// @param data The extra data being passed to the receiving contract</span>
  85 |     | <span style='background-color: #eee;'>    function transferFromAndCall2(</span>
  86 |     | <span style='background-color: #eee;'>        address from,</span>
  87 |     | <span style='background-color: #eee;'>        address receiver,</span>
  88 |     | <span style='background-color: #eee;'>        ITransferReceiver2.Transfer[] calldata transfers,</span>
  89 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
  90 |     | <span style='background-color: #eee;'>    ) external {</span>
  91 |     | <span style='background-color: #faa;'>        if (!approvalByOwnerByOperator[from][msg.sender]) {</span>
  92 |     | <span style='background-color: #faa;'>            revert UnauthorizedOperator(msg.sender, from);</span>
  93 |     | <span style='background-color: #eee;'>        }</span>
  94 |     | <span style='background-color: #faa;'>        return transferFromAndCall2Impl(from, receiver, address(0), transfers, data);</span>
  95 |     | <span style='background-color: #eee;'>    }</span>
  96 |     | <span style='background-color: #eee;'></span>
  97 |     | <span style='background-color: #eee;'>    function transferAndCall2WithPermit(</span>
  98 |     | <span style='background-color: #eee;'>        address from,</span>
  99 |     | <span style='background-color: #eee;'>        address receiver,</span>
 100 |     | <span style='background-color: #eee;'>        ITransferReceiver2.Transfer[] calldata transfers,</span>
 101 |     | <span style='background-color: #eee;'>        bytes calldata data,</span>
 102 |     | <span style='background-color: #eee;'>        uint256 nonce,</span>
 103 |     | <span style='background-color: #eee;'>        uint256 deadline,</span>
 104 |     | <span style='background-color: #eee;'>        bytes calldata signature</span>
 105 |     | <span style='background-color: #eee;'>    ) external {</span>
 106 |     | <span style='background-color: #eee;'>        nonceMap[from].validateAndUseNonce(nonce);</span>
 107 |     | <span style='background-color: #faa;'>        require(block.timestamp &lt;= deadline, &quot;Expired permit&quot;);</span>
 108 |     | <span style='background-color: #eee;'>        bytes32[] memory transferHashes = new bytes32[](transfers.length);</span>
 109 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; transfers.length; i++) {</span>
 110 |     | <span style='background-color: #faa;'>            transferHashes[i] = keccak256(</span>
 111 |     | <span style='background-color: #faa;'>                abi.encodePacked(TRANSFER_TYPEHASH, transfers[i].token, transfers[i].amount)</span>
 112 |     | <span style='background-color: #eee;'>            );</span>
 113 |     | <span style='background-color: #eee;'>        }</span>
 114 |     | <span style='background-color: #eee;'>        bytes32 digest = _hashTypedDataV4(</span>
 115 |     | <span style='background-color: #faa;'>            keccak256(</span>
 116 |     | <span style='background-color: #faa;'>                abi.encode(</span>
 117 |     | <span style='background-color: #eee;'>                    PERMIT_TYPEHASH,</span>
 118 |     | <span style='background-color: #eee;'>                    receiver,</span>
 119 |     | <span style='background-color: #faa;'>                    keccak256(abi.encodePacked(transferHashes)),</span>
 120 |     | <span style='background-color: #eee;'>                    data,</span>
 121 |     | <span style='background-color: #eee;'>                    nonce,</span>
 122 |     | <span style='background-color: #eee;'>                    deadline</span>
 123 |     | <span style='background-color: #eee;'>                )</span>
 124 |     | <span style='background-color: #eee;'>            )</span>
 125 |     | <span style='background-color: #eee;'>        );</span>
 126 |     | <span style='background-color: #faa;'>        require(SignatureChecker.isValidSignatureNow(from, digest, signature), &quot;Invalid signature&quot;);</span>
 127 |     | <span style='background-color: #faa;'>        return transferFromAndCall2Impl(from, receiver, address(0), transfers, data);</span>
 128 |     | <span style='background-color: #eee;'>    }</span>
 129 |     | <span style='background-color: #eee;'></span>
 130 |     | <span style='background-color: #eee;'>    /// @notice Callback for ERC1363 transferAndCall</span>
 131 |     | <span style='background-color: #eee;'>    /// @param _operator The address which called `transferAndCall` function</span>
 132 |     | <span style='background-color: #eee;'>    /// @param _from The address which previously owned the token</span>
 133 |     | <span style='background-color: #eee;'>    /// @param _amount The amount of tokens being transferred</span>
 134 |     | <span style='background-color: #eee;'>    /// @param _data Additional data containing the receiver address and the extra data</span>
 135 |     | <span style='background-color: #eee;'>    function onTransferReceived(</span>
 136 |     | <span style='background-color: #eee;'>        address _operator,</span>
 137 |     | <span style='background-color: #eee;'>        address _from,</span>
 138 |     | <span style='background-color: #eee;'>        uint256 _amount,</span>
 139 |     | <span style='background-color: #eee;'>        bytes calldata _data</span>
 140 |     | <span style='background-color: #eee;'>    ) external override returns (bytes4) {</span>
 141 |     | <span style='background-color: #faa;'>        (address to, bytes memory decodedData) = abi.decode(_data, (address, bytes));</span>
 142 |     | <span style='background-color: #eee;'>        ITransferReceiver2.Transfer[] memory transfers = new ITransferReceiver2.Transfer[](1);</span>
 143 |     | <span style='background-color: #faa;'>        transfers[0] = ITransferReceiver2.Transfer(msg.sender, _amount);</span>
 144 |     | <span style='background-color: #faa;'>        callOnTransferReceived2(to, _operator, _from, transfers, decodedData);</span>
 145 |     | <span style='background-color: #faa;'>        return IERC1363Receiver.onTransferReceived.selector;</span>
 146 |     | <span style='background-color: #eee;'>    }</span>
 147 |     | <span style='background-color: #eee;'></span>
 148 |     | <span style='background-color: #faa;'>    function transferFromAndCall2Impl(</span>
 149 |     | <span style='background-color: #eee;'>        address from,</span>
 150 |     | <span style='background-color: #eee;'>        address receiver,</span>
 151 |     | <span style='background-color: #eee;'>        address weth,</span>
 152 |     | <span style='background-color: #eee;'>        ITransferReceiver2.Transfer[] calldata transfers,</span>
 153 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 154 |     | <span style='background-color: #eee;'>    ) internal {</span>
 155 |     | <span style='background-color: #faa;'>        uint256 ethAmount = msg.value;</span>
 156 |     | <span style='background-color: #faa;'>        if (ethAmount != 0) {</span>
 157 |     | <span style='background-color: #faa;'>            IWETH9(payable(weth)).deposit{value: msg.value}();</span>
 158 |     | <span style='background-color: #eee;'>            IERC20(weth).safeTransfer(receiver, msg.value);</span>
 159 |     | <span style='background-color: #eee;'>        }</span>
 160 |     | <span style='background-color: #faa;'>        address prev = address(0);</span>
 161 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; transfers.length; i++) {</span>
 162 |     | <span style='background-color: #faa;'>            address tokenAddress = transfers[i].token;</span>
 163 |     | <span style='background-color: #faa;'>            if (prev &gt;= tokenAddress) revert TransfersUnsorted();</span>
 164 |     | <span style='background-color: #faa;'>            prev = tokenAddress;</span>
 165 |     | <span style='background-color: #faa;'>            uint256 amount = transfers[i].amount;</span>
 166 |     | <span style='background-color: #faa;'>            if (tokenAddress == weth) {</span>
 167 |     | <span style='background-color: #eee;'>                // Already send WETH</span>
 168 |     | <span style='background-color: #eee;'>                amount -= ethAmount; // reverts if msg.value &gt; amount</span>
 169 |     | <span style='background-color: #faa;'>                ethAmount = 0;</span>
 170 |     | <span style='background-color: #eee;'>            }</span>
 171 |     | <span style='background-color: #eee;'>            IERC20 token = IERC20(tokenAddress);</span>
 172 |     | <span style='background-color: #faa;'>            if (amount &gt; 0) token.safeTransferFrom(from, receiver, amount);</span>
 173 |     | <span style='background-color: #eee;'>        }</span>
 174 |     | <span style='background-color: #faa;'>        if (ethAmount != 0) revert EthDoesntMatchWethTransfer();</span>
 175 |     | <span style='background-color: #faa;'>        if (receiver.isContract()) {</span>
 176 |     | <span style='background-color: #faa;'>            callOnTransferReceived2(receiver, msg.sender, from, transfers, data);</span>
 177 |     | <span style='background-color: #eee;'>        }</span>
 178 |     | <span style='background-color: #eee;'>    }</span>
 179 |     | <span style='background-color: #eee;'></span>
 180 |     | <span style='background-color: #faa;'>    function callOnTransferReceived2(</span>
 181 |     | <span style='background-color: #eee;'>        address to,</span>
 182 |     | <span style='background-color: #eee;'>        address operator,</span>
 183 |     | <span style='background-color: #eee;'>        address from,</span>
 184 |     | <span style='background-color: #eee;'>        ITransferReceiver2.Transfer[] memory transfers,</span>
 185 |     | <span style='background-color: #eee;'>        bytes memory data</span>
 186 |     | <span style='background-color: #eee;'>    ) internal {</span>
 187 |     | <span style='background-color: #faa;'>        if (</span>
 188 |     | <span style='background-color: #faa;'>            ITransferReceiver2(to).onTransferReceived2(operator, from, transfers, data) !=</span>
 189 |     | <span style='background-color: #eee;'>            ITransferReceiver2.onTransferReceived2.selector</span>
 190 |     | <span style='background-color: #eee;'>        ) {</span>
 191 |     | <span style='background-color: #faa;'>            revert onTransferReceivedFailed(to, operator, from, transfers, data);</span>
 192 |     | <span style='background-color: #eee;'>        }</span>
 193 |     | <span style='background-color: #eee;'>    }</span>
 194 |     | <span style='background-color: #eee;'>}</span>
 195 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/dos/VersionManager.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>// Inspired by the following contract: https://github.com/OpenBazaar/smart-contracts/blob/22d3f190163102f9ceee95ac705001c82ca55624/contracts/registry/ContractManager.sol</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'>import {FsUtils} from &quot;../lib/FsUtils.sol&quot;;</span>
   8 |     | <span style='background-color: #eee;'>import {ImmutableGovernance} from &quot;../lib/ImmutableGovernance.sol&quot;;</span>
   9 |     | <span style='background-color: #eee;'>import {ImmutableVersion} from &quot;../lib/ImmutableVersion.sol&quot;;</span>
  10 |     | <span style='background-color: #eee;'>import &quot;../interfaces/IVersionManager.sol&quot;;</span>
  11 |     | <span style='background-color: #eee;'></span>
  12 |     | <span style='background-color: #faa;'>/// @title DOS Version Manager</span>
  13 |     | <span style='background-color: #eee;'>contract VersionManager is IVersionManager, ImmutableGovernance {</span>
  14 |     | <span style='background-color: #eee;'>    /// @notice Array of all version names</span>
  15 |     | <span style='background-color: #eee;'>    string[] internal _versionString;</span>
  16 |     | <span style='background-color: #eee;'></span>
  17 |     | <span style='background-color: #eee;'>    /// @notice Mapping from version names to version structs</span>
  18 |     | <span style='background-color: #eee;'>    mapping(string =&gt; Version) internal _versions;</span>
  19 |     | <span style='background-color: #eee;'></span>
  20 |     | <span style='background-color: #eee;'>    /// @dev The recommended version</span>
  21 |     | <span style='background-color: #eee;'>    string internal _recommendedVersion;</span>
  22 |     | <span style='background-color: #eee;'></span>
  23 |     | <span style='background-color: #eee;'>    modifier versionExists(string memory versionName) {</span>
  24 |     | <span style='background-color: #faa;'>        if (_versions[versionName].implementation == address(0)) {</span>
  25 |     | <span style='background-color: #faa;'>            revert VersionNotRegistered();</span>
  26 |     | <span style='background-color: #eee;'>        }</span>
  27 |     | <span style='background-color: #eee;'>        _;</span>
  28 |     | <span style='background-color: #eee;'>    }</span>
  29 |     | <span style='background-color: #eee;'></span>
  30 |     | <span style='background-color: #eee;'>    modifier validStatus(Status status) {</span>
  31 |     | <span style='background-color: #faa;'>        require(uint8(status) &lt;= uint8(Status.DEPRECATED), &quot;Invalid status&quot;);</span>
  32 |     | <span style='background-color: #eee;'>        _;</span>
  33 |     | <span style='background-color: #eee;'>    }</span>
  34 |     | <span style='background-color: #eee;'></span>
  35 |     | <span style='background-color: #eee;'>    modifier validBugLevel(BugLevel bugLevel) {</span>
  36 |     | <span style='background-color: #faa;'>        require(uint8(bugLevel) &lt;= uint8(BugLevel.CRITICAL), &quot;Invalid bug level&quot;);</span>
  37 |     | <span style='background-color: #eee;'>        _;</span>
  38 |     | <span style='background-color: #eee;'>    }</span>
  39 |     | <span style='background-color: #eee;'></span>
  40 |     | <span style='background-color: #eee;'>    constructor(address _owner) ImmutableGovernance(_owner) {}</span>
  41 |     | <span style='background-color: #eee;'></span>
  42 |     | <span style='background-color: #eee;'>    /// @notice Registers a new version of the store contract</span>
  43 |     | <span style='background-color: #eee;'>    /// @param status Status of the version to be added</span>
  44 |     | <span style='background-color: #eee;'>    /// @param _implementation The address of the implementation of the version</span>
  45 |     | <span style='background-color: #eee;'>    function addVersion(</span>
  46 |     | <span style='background-color: #eee;'>        Status status,</span>
  47 |     | <span style='background-color: #eee;'>        address _implementation</span>
  48 |     | <span style='background-color: #eee;'>    ) external onlyGovernance validStatus(status) {</span>
  49 |     | <span style='background-color: #eee;'>        address implementation = FsUtils.nonNull(_implementation);</span>
  50 |     | <span style='background-color: #eee;'>        // implementation must be a contract</span>
  51 |     | <span style='background-color: #faa;'>        if (!Address.isContract(implementation)) {</span>
  52 |     | <span style='background-color: #faa;'>            revert InvalidImplementation();</span>
  53 |     | <span style='background-color: #eee;'>        }</span>
  54 |     | <span style='background-color: #eee;'></span>
  55 |     | <span style='background-color: #eee;'>        string memory versionName = &quot;&quot;;</span>
  56 |     | <span style='background-color: #faa;'>        try ImmutableVersion(implementation).immutableVersion() returns (bytes32 immutableVersion) {</span>
  57 |     | <span style='background-color: #faa;'>            versionName = string(FsUtils.decodeFromBytes32(immutableVersion));</span>
  58 |     | <span style='background-color: #eee;'>        } catch {</span>
  59 |     | <span style='background-color: #faa;'>            revert InvalidImplementation();</span>
  60 |     | <span style='background-color: #eee;'>        }</span>
  61 |     | <span style='background-color: #eee;'></span>
  62 |     | <span style='background-color: #eee;'>        // version name must not be the empty string</span>
  63 |     | <span style='background-color: #faa;'>        if (bytes(versionName).length == 0) {</span>
  64 |     | <span style='background-color: #faa;'>            revert InvalidVersionName();</span>
  65 |     | <span style='background-color: #eee;'>        }</span>
  66 |     | <span style='background-color: #eee;'></span>
  67 |     | <span style='background-color: #eee;'>        // the version name should not already be registered</span>
  68 |     | <span style='background-color: #faa;'>        if (_versions[versionName].implementation != address(0)) {</span>
  69 |     | <span style='background-color: #faa;'>            revert VersionAlreadyRegistered();</span>
  70 |     | <span style='background-color: #eee;'>        }</span>
  71 |     | <span style='background-color: #eee;'>        _versionString.push(versionName);</span>
  72 |     | <span style='background-color: #eee;'></span>
  73 |     | <span style='background-color: #faa;'>        _versions[versionName] = Version({</span>
  74 |     | <span style='background-color: #eee;'>            versionName: versionName,</span>
  75 |     | <span style='background-color: #eee;'>            status: status,</span>
  76 |     | <span style='background-color: #eee;'>            bugLevel: BugLevel.NONE,</span>
  77 |     | <span style='background-color: #eee;'>            implementation: implementation,</span>
  78 |     | <span style='background-color: #faa;'>            dateAdded: block.timestamp</span>
  79 |     | <span style='background-color: #eee;'>        });</span>
  80 |     | <span style='background-color: #eee;'></span>
  81 |     | <span style='background-color: #faa;'>        emit VersionAdded(versionName, implementation);</span>
  82 |     | <span style='background-color: #eee;'>    }</span>
  83 |     | <span style='background-color: #eee;'></span>
  84 |     | <span style='background-color: #eee;'>    /// @notice Update a contract version</span>
  85 |     | <span style='background-color: #eee;'>    /// @param versionName Version of the contract</span>
  86 |     | <span style='background-color: #eee;'>    /// @param status Status of the contract</span>
  87 |     | <span style='background-color: #eee;'>    /// @param bugLevel New bug level for the contract</span>
  88 |     | <span style='background-color: #eee;'>    function updateVersion(</span>
  89 |     | <span style='background-color: #eee;'>        string calldata versionName,</span>
  90 |     | <span style='background-color: #eee;'>        Status status,</span>
  91 |     | <span style='background-color: #eee;'>        BugLevel bugLevel</span>
  92 |     | <span style='background-color: #eee;'>    )</span>
  93 |     | <span style='background-color: #eee;'>        external</span>
  94 |     | <span style='background-color: #eee;'>        onlyGovernance</span>
  95 |     | <span style='background-color: #eee;'>        versionExists(versionName)</span>
  96 |     | <span style='background-color: #eee;'>        validStatus(status)</span>
  97 |     | <span style='background-color: #eee;'>        validBugLevel(bugLevel)</span>
  98 |     | <span style='background-color: #eee;'>    {</span>
  99 |     | <span style='background-color: #faa;'>        _versions[versionName].status = status;</span>
 100 |     | <span style='background-color: #faa;'>        _versions[versionName].bugLevel = bugLevel;</span>
 101 |     | <span style='background-color: #eee;'></span>
 102 |     | <span style='background-color: #faa;'>        emit VersionUpdated(versionName, status, bugLevel);</span>
 103 |     | <span style='background-color: #eee;'>    }</span>
 104 |     | <span style='background-color: #eee;'></span>
 105 |     | <span style='background-color: #eee;'>    /// @notice Set the recommended version</span>
 106 |     | <span style='background-color: #eee;'>    /// @param versionName Version of the contract</span>
 107 |     | <span style='background-color: #eee;'>    function markRecommendedVersion(</span>
 108 |     | <span style='background-color: #eee;'>        string calldata versionName</span>
 109 |     | <span style='background-color: #eee;'>    ) external onlyGovernance versionExists(versionName) {</span>
 110 |     | <span style='background-color: #eee;'>        require(</span>
 111 |     | <span style='background-color: #faa;'>            _versions[versionName].status != IVersionManager.Status.DEPRECATED &amp;&amp;</span>
 112 |     | <span style='background-color: #faa;'>                _versions[versionName].bugLevel == IVersionManager.BugLevel.NONE,</span>
 113 |     | <span style='background-color: #eee;'>            &quot;Version not valid&quot;</span>
 114 |     | <span style='background-color: #eee;'>        );</span>
 115 |     | <span style='background-color: #eee;'>        // set the version name as the recommended version</span>
 116 |     | <span style='background-color: #faa;'>        _recommendedVersion = versionName;</span>
 117 |     | <span style='background-color: #eee;'></span>
 118 |     | <span style='background-color: #faa;'>        emit VersionRecommended(versionName);</span>
 119 |     | <span style='background-color: #eee;'>    }</span>
 120 |     | <span style='background-color: #eee;'></span>
 121 |     | <span style='background-color: #eee;'>    /// @notice Remove the recommended version</span>
 122 |     | <span style='background-color: #eee;'>    function removeRecommendedVersion() external onlyGovernance {</span>
 123 |     | <span style='background-color: #eee;'>        // delete the recommended version name</span>
 124 |     | <span style='background-color: #faa;'>        delete _recommendedVersion;</span>
 125 |     | <span style='background-color: #eee;'></span>
 126 |     | <span style='background-color: #faa;'>        emit RecommendedVersionRemoved();</span>
 127 |     | <span style='background-color: #eee;'>    }</span>
 128 |     | <span style='background-color: #eee;'></span>
 129 |     | <span style='background-color: #eee;'>    /// @notice Get recommended version for the contract.</span>
 130 |     | <span style='background-color: #eee;'>    /// @return versionName The name of the recommended version</span>
 131 |     | <span style='background-color: #eee;'>    /// @return status The status of the recommended version</span>
 132 |     | <span style='background-color: #eee;'>    /// @return bugLevel The bug level of the recommended version</span>
 133 |     | <span style='background-color: #eee;'>    /// @return implementation The address of the implementation of the recommended version</span>
 134 |     | <span style='background-color: #eee;'>    /// @return dateAdded The date the recommended version was added</span>
 135 |     | <span style='background-color: #eee;'>    function getRecommendedVersion()</span>
 136 |     | <span style='background-color: #eee;'>        external</span>
 137 |     | <span style='background-color: #eee;'>        view</span>
 138 |     | <span style='background-color: #eee;'>        returns (</span>
 139 |     | <span style='background-color: #eee;'>            string memory versionName,</span>
 140 |     | <span style='background-color: #eee;'>            Status status,</span>
 141 |     | <span style='background-color: #eee;'>            BugLevel bugLevel,</span>
 142 |     | <span style='background-color: #eee;'>            address implementation,</span>
 143 |     | <span style='background-color: #eee;'>            uint256 dateAdded</span>
 144 |     | <span style='background-color: #eee;'>        )</span>
 145 |     | <span style='background-color: #eee;'>    {</span>
 146 |     | <span style='background-color: #faa;'>        require(bytes(_recommendedVersion).length != 0, &quot;Recommended version is not specified&quot;);</span>
 147 |     | <span style='background-color: #eee;'>        versionName = _recommendedVersion;</span>
 148 |     | <span style='background-color: #eee;'></span>
 149 |     | <span style='background-color: #eee;'>        Version storage recommendedVersion = _versions[versionName];</span>
 150 |     | <span style='background-color: #eee;'></span>
 151 |     | <span style='background-color: #faa;'>        status = recommendedVersion.status;</span>
 152 |     | <span style='background-color: #eee;'>        bugLevel = recommendedVersion.bugLevel;</span>
 153 |     | <span style='background-color: #eee;'>        implementation = recommendedVersion.implementation;</span>
 154 |     | <span style='background-color: #faa;'>        dateAdded = recommendedVersion.dateAdded;</span>
 155 |     | <span style='background-color: #eee;'></span>
 156 |     | <span style='background-color: #eee;'>        return (versionName, status, bugLevel, implementation, dateAdded);</span>
 157 |     | <span style='background-color: #eee;'>    }</span>
 158 |     | <span style='background-color: #eee;'></span>
 159 |     | <span style='background-color: #eee;'>    /// @notice Get total count of versions</span>
 160 |     | <span style='background-color: #eee;'>    function getVersionCount() external view returns (uint256 count) {</span>
 161 |     | <span style='background-color: #eee;'>        count = _versionString.length;</span>
 162 |     | <span style='background-color: #eee;'>    }</span>
 163 |     | <span style='background-color: #eee;'></span>
 164 |     | <span style='background-color: #eee;'>    /// @dev Returns the version name at specific index in the versionString[] array</span>
 165 |     | <span style='background-color: #eee;'>    /// @param index The index to be searched for</span>
 166 |     | <span style='background-color: #eee;'>    function getVersionAtIndex(uint256 index) external view returns (string memory versionName) {</span>
 167 |     | <span style='background-color: #faa;'>        versionName = _versionString[index];</span>
 168 |     | <span style='background-color: #eee;'>    }</span>
 169 |     | <span style='background-color: #eee;'></span>
 170 |     | <span style='background-color: #eee;'>    /// @notice Get the implementation address for a version</span>
 171 |     | <span style='background-color: #eee;'>    /// @param index The index of the version</span>
 172 |     | <span style='background-color: #eee;'>    function getVersionAddress(uint256 index) external view returns (address) {</span>
 173 |     | <span style='background-color: #faa;'>        string memory versionName = _versionString[index];</span>
 174 |     | <span style='background-color: #faa;'>        Version memory v = _versions[versionName];</span>
 175 |     | <span style='background-color: #faa;'>        return v.implementation;</span>
 176 |     | <span style='background-color: #eee;'>    }</span>
 177 |     | <span style='background-color: #eee;'></span>
 178 |     | <span style='background-color: #eee;'>    /// @notice Returns the version details for the given version name</span>
 179 |     | <span style='background-color: #eee;'>    /// @param versionName Version string</span>
 180 |     | <span style='background-color: #eee;'>    function getVersionDetails(</span>
 181 |     | <span style='background-color: #eee;'>        string calldata versionName</span>
 182 |     | <span style='background-color: #eee;'>    )</span>
 183 |     | <span style='background-color: #eee;'>        external</span>
 184 |     | <span style='background-color: #eee;'>        view</span>
 185 |     | <span style='background-color: #eee;'>        returns (</span>
 186 |     | <span style='background-color: #eee;'>            string memory versionString,</span>
 187 |     | <span style='background-color: #eee;'>            Status status,</span>
 188 |     | <span style='background-color: #eee;'>            BugLevel bugLevel,</span>
 189 |     | <span style='background-color: #eee;'>            address implementation,</span>
 190 |     | <span style='background-color: #eee;'>            uint256 dateAdded</span>
 191 |     | <span style='background-color: #eee;'>        )</span>
 192 |     | <span style='background-color: #eee;'>    {</span>
 193 |     | <span style='background-color: #faa;'>        Version storage v = _versions[versionName];</span>
 194 |     | <span style='background-color: #eee;'></span>
 195 |     | <span style='background-color: #eee;'>        versionString = v.versionName;</span>
 196 |     | <span style='background-color: #faa;'>        status = v.status;</span>
 197 |     | <span style='background-color: #eee;'>        bugLevel = v.bugLevel;</span>
 198 |     | <span style='background-color: #eee;'>        implementation = v.implementation;</span>
 199 |     | <span style='background-color: #faa;'>        dateAdded = v.dateAdded;</span>
 200 |     | <span style='background-color: #eee;'></span>
 201 |     | <span style='background-color: #eee;'>        return (versionString, status, bugLevel, implementation, dateAdded);</span>
 202 |     | <span style='background-color: #eee;'>    }</span>
 203 |     | <span style='background-color: #eee;'>}</span>
 204 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/duoswapV2/DuoswapV2ERC20.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-3.0-or-later</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.7;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>import &quot;@uniswap/v2-core/contracts/interfaces/IUniswapV2ERC20.sol&quot;;</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>//solhint-disable var-name-mixedcase</span>
   7 |     | <span style='background-color: #eee;'>//solhint-disable reason-string</span>
   8 |     | <span style='background-color: #eee;'>//solhint-disable const-name-snakecase</span>
   9 |     | <span style='background-color: #faa;'></span>
  10 |     | <span style='background-color: #eee;'>contract DuoswapV2ERC20 is IUniswapV2ERC20 {</span>
  11 |     | <span style='background-color: #faa;'>    string public constant override name = &quot;Uniswap V2&quot;;</span>
  12 |     | <span style='background-color: #eee;'>    string public constant override symbol = &quot;UNI-V2&quot;;</span>
  13 |     | <span style='background-color: #faa;'>    uint8 public constant override decimals = 18;</span>
  14 |     | <span style='background-color: #eee;'>    uint256 public override totalSupply;</span>
  15 |     | <span style='background-color: #faa;'>    mapping(address =&gt; uint256) public override balanceOf;</span>
  16 |     | <span style='background-color: #faa;'>    mapping(address =&gt; mapping(address =&gt; uint256)) public override allowance;</span>
  17 |     | <span style='background-color: #eee;'></span>
  18 |     | <span style='background-color: #faa;'>    bytes32 public override DOMAIN_SEPARATOR;</span>
  19 |     | <span style='background-color: #eee;'>    // keccak256(&quot;Permit(address owner,address spender,uint256 value,uint256 nonce,uint256 deadline)&quot;);</span>
  20 |     | <span style='background-color: #eee;'>    bytes32 public constant override PERMIT_TYPEHASH =</span>
  21 |     | <span style='background-color: #faa;'>        0x6e71edae12b1b97f4d1f60370fef10105fa2faae0126114a169c64845d6126c9;</span>
  22 |     | <span style='background-color: #eee;'>    mapping(address =&gt; uint256) public override nonces;</span>
  23 |     | <span style='background-color: #eee;'></span>
  24 |     | <span style='background-color: #eee;'>    constructor() {</span>
  25 |     | <span style='background-color: #faa;'>        DOMAIN_SEPARATOR = keccak256(</span>
  26 |     | <span style='background-color: #faa;'>            abi.encode(</span>
  27 |     | <span style='background-color: #faa;'>                keccak256(</span>
  28 |     | <span style='background-color: #eee;'>                    &quot;EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)&quot;</span>
  29 |     | <span style='background-color: #eee;'>                ),</span>
  30 |     | <span style='background-color: #faa;'>                keccak256(bytes(name)),</span>
  31 |     | <span style='background-color: #faa;'>                keccak256(bytes(&quot;1&quot;)),</span>
  32 |     | <span style='background-color: #faa;'>                block.chainid,</span>
  33 |     | <span style='background-color: #faa;'>                address(this)</span>
  34 |     | <span style='background-color: #eee;'>            )</span>
  35 |     | <span style='background-color: #eee;'>        );</span>
  36 |     | <span style='background-color: #eee;'>    }</span>
  37 |     | <span style='background-color: #eee;'></span>
  38 |     | <span style='background-color: #eee;'>    function approve(address spender, uint256 value) external override returns (bool) {</span>
  39 |     | <span style='background-color: #faa;'>        _approve(msg.sender, spender, value);</span>
  40 |     | <span style='background-color: #eee;'>        return true;</span>
  41 |     | <span style='background-color: #eee;'>    }</span>
  42 |     | <span style='background-color: #eee;'></span>
  43 |     | <span style='background-color: #eee;'>    function transfer(address to, uint256 value) external override returns (bool) {</span>
  44 |     | <span style='background-color: #faa;'>        _transfer(msg.sender, to, value);</span>
  45 |     | <span style='background-color: #eee;'>        return true;</span>
  46 |     | <span style='background-color: #eee;'>    }</span>
  47 |     | <span style='background-color: #eee;'></span>
  48 |     | <span style='background-color: #eee;'>    function transferFrom(</span>
  49 |     | <span style='background-color: #eee;'>        address from,</span>
  50 |     | <span style='background-color: #eee;'>        address to,</span>
  51 |     | <span style='background-color: #eee;'>        uint256 value</span>
  52 |     | <span style='background-color: #eee;'>    ) external override returns (bool) {</span>
  53 |     | <span style='background-color: #faa;'>        if (allowance[from][msg.sender] != type(uint256).max) {</span>
  54 |     | <span style='background-color: #faa;'>            allowance[from][msg.sender] -= value;</span>
  55 |     | <span style='background-color: #eee;'>        }</span>
  56 |     | <span style='background-color: #faa;'>        _transfer(from, to, value);</span>
  57 |     | <span style='background-color: #eee;'>        return true;</span>
  58 |     | <span style='background-color: #eee;'>    }</span>
  59 |     | <span style='background-color: #eee;'></span>
  60 |     | <span style='background-color: #eee;'>    function permit(</span>
  61 |     | <span style='background-color: #eee;'>        address owner,</span>
  62 |     | <span style='background-color: #eee;'>        address spender,</span>
  63 |     | <span style='background-color: #eee;'>        uint256 value,</span>
  64 |     | <span style='background-color: #eee;'>        uint256 deadline,</span>
  65 |     | <span style='background-color: #eee;'>        uint8 v,</span>
  66 |     | <span style='background-color: #eee;'>        bytes32 r,</span>
  67 |     | <span style='background-color: #eee;'>        bytes32 s</span>
  68 |     | <span style='background-color: #eee;'>    ) external override {</span>
  69 |     | <span style='background-color: #eee;'>        //solhint-disable-next-line not-rely-on-time</span>
  70 |     | <span style='background-color: #faa;'>        require(deadline &gt;= block.timestamp, &quot;UniswapV2: EXPIRED&quot;);</span>
  71 |     | <span style='background-color: #faa;'>        bytes32 digest = keccak256(</span>
  72 |     | <span style='background-color: #faa;'>            abi.encodePacked(</span>
  73 |     | <span style='background-color: #eee;'>                &quot;\x19\x01&quot;,</span>
  74 |     | <span style='background-color: #faa;'>                DOMAIN_SEPARATOR,</span>
  75 |     | <span style='background-color: #faa;'>                keccak256(</span>
  76 |     | <span style='background-color: #faa;'>                    abi.encode(PERMIT_TYPEHASH, owner, spender, value, nonces[owner]++, deadline)</span>
  77 |     | <span style='background-color: #eee;'>                )</span>
  78 |     | <span style='background-color: #eee;'>            )</span>
  79 |     | <span style='background-color: #eee;'>        );</span>
  80 |     | <span style='background-color: #faa;'>        address recoveredAddress = ecrecover(digest, v, r, s);</span>
  81 |     | <span style='background-color: #eee;'>        require(</span>
  82 |     | <span style='background-color: #faa;'>            recoveredAddress != address(0) &amp;&amp; recoveredAddress == owner,</span>
  83 |     | <span style='background-color: #eee;'>            &quot;UniswapV2: INVALID_SIGNATURE&quot;</span>
  84 |     | <span style='background-color: #eee;'>        );</span>
  85 |     | <span style='background-color: #faa;'>        _approve(owner, spender, value);</span>
  86 |     | <span style='background-color: #eee;'>    }</span>
  87 |     | <span style='background-color: #eee;'></span>
  88 |     | <span style='background-color: #faa;'>    function _mint(address to, uint256 value) internal {</span>
  89 |     | <span style='background-color: #faa;'>        totalSupply += value;</span>
  90 |     | <span style='background-color: #faa;'>        balanceOf[to] += value;</span>
  91 |     | <span style='background-color: #faa;'>        emit Transfer(address(0), to, value);</span>
  92 |     | <span style='background-color: #eee;'>    }</span>
  93 |     | <span style='background-color: #eee;'></span>
  94 |     | <span style='background-color: #eee;'>    function _burn(address from, uint256 value) internal {</span>
  95 |     | <span style='background-color: #faa;'>        balanceOf[from] -= value;</span>
  96 |     | <span style='background-color: #faa;'>        totalSupply -= value;</span>
  97 |     | <span style='background-color: #faa;'>        emit Transfer(from, address(0), value);</span>
  98 |     | <span style='background-color: #eee;'>    }</span>
  99 |     | <span style='background-color: #eee;'></span>
 100 |     | <span style='background-color: #faa;'>    function _approve(address owner, address spender, uint256 value) internal {</span>
 101 |     | <span style='background-color: #faa;'>        allowance[owner][spender] = value;</span>
 102 |     | <span style='background-color: #faa;'>        emit Approval(owner, spender, value);</span>
 103 |     | <span style='background-color: #eee;'>    }</span>
 104 |     | <span style='background-color: #eee;'></span>
 105 |     | <span style='background-color: #faa;'>    function _transfer(address from, address to, uint256 value) private {</span>
 106 |     | <span style='background-color: #faa;'>        balanceOf[from] -= value;</span>
 107 |     | <span style='background-color: #faa;'>        balanceOf[to] += value;</span>
 108 |     | <span style='background-color: #faa;'>        emit Transfer(from, to, value);</span>
 109 |     | <span style='background-color: #eee;'>    }</span>
 110 |     | <span style='background-color: #eee;'>}</span>
 111 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/duoswapV2/DuoswapV2Factory.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-3.0-or-later</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.7;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;@uniswap/v2-core/contracts/interfaces/IUniswapV2Factory.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'>import {IDuoswapV2Pair, DuoswapV2Pair} from &quot;./DuoswapV2Pair.sol&quot;;</span>
  6 |     | <span style='background-color: #faa;'></span>
  7 |     | <span style='background-color: #eee;'>contract DuoswapV2Factory is IUniswapV2Factory {</span>
  8 |     | <span style='background-color: #faa;'>    bytes32 public constant PAIR_HASH = keccak256(type(DuoswapV2Pair).creationCode);</span>
  9 |     | <span style='background-color: #eee;'></span>
 10 |     | <span style='background-color: #eee;'>    address public dos;</span>
 11 |     | <span style='background-color: #faa;'>    address public override feeTo;</span>
 12 |     | <span style='background-color: #faa;'>    address public override feeToSetter;</span>
 13 |     | <span style='background-color: #eee;'></span>
 14 |     | <span style='background-color: #faa;'>    mapping(address =&gt; mapping(address =&gt; address)) public override getPair;</span>
 15 |     | <span style='background-color: #faa;'>    address[] public override allPairs;</span>
 16 |     | <span style='background-color: #eee;'></span>
 17 |     | <span style='background-color: #eee;'>    constructor(address _dos, address _feeToSetter) {</span>
 18 |     | <span style='background-color: #eee;'>        dos = _dos;</span>
 19 |     | <span style='background-color: #faa;'>        feeToSetter = _feeToSetter;</span>
 20 |     | <span style='background-color: #eee;'>    }</span>
 21 |     | <span style='background-color: #eee;'></span>
 22 |     | <span style='background-color: #eee;'>    function createPair(address tokenA, address tokenB) external override returns (address pair) {</span>
 23 |     | <span style='background-color: #faa;'>        require(tokenA != tokenB, &quot;UniswapV2: IDENTICAL_ADDRESSES&quot;);</span>
 24 |     | <span style='background-color: #faa;'>        (address token0, address token1) = tokenA &lt; tokenB ? (tokenA, tokenB) : (tokenB, tokenA);</span>
 25 |     | <span style='background-color: #faa;'>        require(token0 != address(0), &quot;UniswapV2: ZERO_ADDRESS&quot;);</span>
 26 |     | <span style='background-color: #faa;'>        require(getPair[token0][token1] == address(0), &quot;UniswapV2: PAIR_EXISTS&quot;); // single check is sufficient</span>
 27 |     | <span style='background-color: #eee;'></span>
 28 |     | <span style='background-color: #faa;'>        pair = address(new DuoswapV2Pair{salt: keccak256(abi.encodePacked(token0, token1))}());</span>
 29 |     | <span style='background-color: #faa;'>        IDuoswapV2Pair(pair).initialize(dos, token0, token1);</span>
 30 |     | <span style='background-color: #eee;'>        getPair[token0][token1] = pair;</span>
 31 |     | <span style='background-color: #eee;'>        getPair[token1][token0] = pair; // populate mapping in the reverse direction</span>
 32 |     | <span style='background-color: #eee;'>        allPairs.push(pair);</span>
 33 |     | <span style='background-color: #faa;'>        emit PairCreated(token0, token1, pair, allPairs.length);</span>
 34 |     | <span style='background-color: #eee;'>    }</span>
 35 |     | <span style='background-color: #eee;'></span>
 36 |     | <span style='background-color: #eee;'>    function setFeeTo(address _feeTo) external override {</span>
 37 |     | <span style='background-color: #faa;'>        require(msg.sender == feeToSetter, &quot;UniswapV2: FORBIDDEN&quot;);</span>
 38 |     | <span style='background-color: #faa;'>        feeTo = _feeTo;</span>
 39 |     | <span style='background-color: #eee;'>    }</span>
 40 |     | <span style='background-color: #eee;'></span>
 41 |     | <span style='background-color: #eee;'>    function setFeeToSetter(address _feeToSetter) external override {</span>
 42 |     | <span style='background-color: #faa;'>        require(msg.sender == feeToSetter, &quot;UniswapV2: FORBIDDEN&quot;);</span>
 43 |     | <span style='background-color: #eee;'>        feeToSetter = _feeToSetter;</span>
 44 |     | <span style='background-color: #eee;'>    }</span>
 45 |     | <span style='background-color: #eee;'></span>
 46 |     | <span style='background-color: #eee;'>    function allPairsLength() external view override returns (uint256) {</span>
 47 |     | <span style='background-color: #eee;'>        return allPairs.length;</span>
 48 |     | <span style='background-color: #eee;'>    }</span>
 49 |     | <span style='background-color: #eee;'>}</span>
 50 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/duoswapV2/DuoswapV2Pair.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-3.0-or-later</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.7;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>//solhint-disable ordering</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'>import &quot;@uniswap/v2-core/contracts/interfaces/IUniswapV2Factory.sol&quot;;</span>
   8 |     | <span style='background-color: #eee;'>import &quot;@uniswap/v2-core/contracts/interfaces/IUniswapV2Callee.sol&quot;;</span>
   9 |     | <span style='background-color: #eee;'></span>
  10 |     | <span style='background-color: #eee;'>import &quot;./libraries/Math.sol&quot;;</span>
  11 |     | <span style='background-color: #eee;'>import &quot;./libraries/UQ112x112.sol&quot;;</span>
  12 |     | <span style='background-color: #eee;'></span>
  13 |     | <span style='background-color: #eee;'>import {IDuoswapV2Pair} from &quot;./interfaces/IDuoswapV2Pair.sol&quot;;</span>
  14 |     | <span style='background-color: #eee;'>import {DuoswapV2ERC20} from &quot;./DuoswapV2ERC20.sol&quot;;</span>
  15 |     | <span style='background-color: #eee;'></span>
  16 |     | <span style='background-color: #eee;'>import {IDOS} from &quot;../interfaces/IDOS.sol&quot;;</span>
  17 |     | <span style='background-color: #eee;'>import {Call} from &quot;../lib/Call.sol&quot;;</span>
  18 |     | <span style='background-color: #eee;'>import {ISafe} from &quot;../interfaces/ISafe.sol&quot;;</span>
  19 |     | <span style='background-color: #eee;'></span>
  20 |     | <span style='background-color: #eee;'>//solhint-disable func-name-mixedcase</span>
  21 |     | <span style='background-color: #eee;'>//solhint-disable avoid-low-level-calls</span>
  22 |     | <span style='background-color: #eee;'>//solhint-disable reason-string</span>
  23 |     | <span style='background-color: #eee;'>//solhint-disable not-rely-on-time</span>
  24 |     | <span style='background-color: #faa;'></span>
  25 |     | <span style='background-color: #eee;'>contract DuoswapV2Pair is IDuoswapV2Pair, DuoswapV2ERC20 {</span>
  26 |     | <span style='background-color: #eee;'>    using UQ112x112 for uint224;</span>
  27 |     | <span style='background-color: #eee;'></span>
  28 |     | <span style='background-color: #faa;'>    uint256 public constant override MINIMUM_LIQUIDITY = 10 ** 3;</span>
  29 |     | <span style='background-color: #eee;'></span>
  30 |     | <span style='background-color: #faa;'>    address public override factory;</span>
  31 |     | <span style='background-color: #faa;'>    address public override token0;</span>
  32 |     | <span style='background-color: #faa;'>    address public override token1;</span>
  33 |     | <span style='background-color: #eee;'></span>
  34 |     | <span style='background-color: #faa;'>    address public dos;</span>
  35 |     | <span style='background-color: #faa;'>    address public dSafe;</span>
  36 |     | <span style='background-color: #eee;'></span>
  37 |     | <span style='background-color: #eee;'>    uint112 private reserve0; // uses single storage slot, accessible via getReserves</span>
  38 |     | <span style='background-color: #eee;'>    uint112 private reserve1; // uses single storage slot, accessible via getReserves</span>
  39 |     | <span style='background-color: #eee;'>    uint32 private blockTimestampLast; // uses single storage slot, accessible via getReserves</span>
  40 |     | <span style='background-color: #eee;'></span>
  41 |     | <span style='background-color: #faa;'>    uint256 public override price0CumulativeLast;</span>
  42 |     | <span style='background-color: #faa;'>    uint256 public override price1CumulativeLast;</span>
  43 |     | <span style='background-color: #faa;'>    uint256 public override kLast; // reserve0 * reserve1, as of immediately after the most recent liquidity event</span>
  44 |     | <span style='background-color: #eee;'></span>
  45 |     | <span style='background-color: #faa;'>    uint256 private unlocked = 1;</span>
  46 |     | <span style='background-color: #eee;'>    modifier lock() {</span>
  47 |     | <span style='background-color: #faa;'>        require(unlocked == 1, &quot;UniswapV2: LOCKED&quot;);</span>
  48 |     | <span style='background-color: #eee;'>        unlocked = 0;</span>
  49 |     | <span style='background-color: #eee;'>        _;</span>
  50 |     | <span style='background-color: #eee;'>        unlocked = 1;</span>
  51 |     | <span style='background-color: #eee;'>    }</span>
  52 |     | <span style='background-color: #eee;'></span>
  53 |     | <span style='background-color: #faa;'>    function getReserves()</span>
  54 |     | <span style='background-color: #eee;'>        public</span>
  55 |     | <span style='background-color: #eee;'>        view</span>
  56 |     | <span style='background-color: #eee;'>        override</span>
  57 |     | <span style='background-color: #eee;'>        returns (uint112 _reserve0, uint112 _reserve1, uint32 _blockTimestampLast)</span>
  58 |     | <span style='background-color: #eee;'>    {</span>
  59 |     | <span style='background-color: #faa;'>        _reserve0 = reserve0;</span>
  60 |     | <span style='background-color: #eee;'>        _reserve1 = reserve1;</span>
  61 |     | <span style='background-color: #eee;'>        _blockTimestampLast = blockTimestampLast;</span>
  62 |     | <span style='background-color: #eee;'>    }</span>
  63 |     | <span style='background-color: #eee;'></span>
  64 |     | <span style='background-color: #faa;'>    function _safeTransfer(address token, address to, uint256 amount) private {</span>
  65 |     | <span style='background-color: #faa;'>        Call[] memory call = new Call[](1);</span>
  66 |     | <span style='background-color: #faa;'>        call[0] = (</span>
  67 |     | <span style='background-color: #faa;'>            Call({</span>
  68 |     | <span style='background-color: #faa;'>                to: address(dos),</span>
  69 |     | <span style='background-color: #faa;'>                callData: abi.encodeWithSignature(</span>
  70 |     | <span style='background-color: #eee;'>                    &quot;transferERC20(address,address,uint256)&quot;,</span>
  71 |     | <span style='background-color: #eee;'>                    address(token),</span>
  72 |     | <span style='background-color: #eee;'>                    to,</span>
  73 |     | <span style='background-color: #eee;'>                    amount</span>
  74 |     | <span style='background-color: #eee;'>                ),</span>
  75 |     | <span style='background-color: #eee;'>                value: 0</span>
  76 |     | <span style='background-color: #eee;'>            })</span>
  77 |     | <span style='background-color: #eee;'>        );</span>
  78 |     | <span style='background-color: #eee;'></span>
  79 |     | <span style='background-color: #faa;'>        ISafe(dSafe).executeBatch(call);</span>
  80 |     | <span style='background-color: #eee;'>        // (bool success, bytes memory data) = token.call(</span>
  81 |     | <span style='background-color: #eee;'>        //     abi.encodeWithSelector(IERC20.transferFrom.selector, dSafe,to, value)</span>
  82 |     | <span style='background-color: #eee;'>        // );</span>
  83 |     | <span style='background-color: #eee;'>        // require(</span>
  84 |     | <span style='background-color: #eee;'>        //     success &amp;&amp; (data.length == 0 || abi.decode(data, (bool))),</span>
  85 |     | <span style='background-color: #eee;'>        //     &quot;UniswapV2: TRANSFER_FAILED&quot;</span>
  86 |     | <span style='background-color: #eee;'>        // );</span>
  87 |     | <span style='background-color: #eee;'>    }</span>
  88 |     | <span style='background-color: #eee;'></span>
  89 |     | <span style='background-color: #eee;'>    constructor() {</span>
  90 |     | <span style='background-color: #faa;'>        factory = msg.sender;</span>
  91 |     | <span style='background-color: #eee;'>    }</span>
  92 |     | <span style='background-color: #eee;'></span>
  93 |     | <span style='background-color: #eee;'>    // called once by the factory at time of deployment</span>
  94 |     | <span style='background-color: #eee;'>    function initialize(address _dos, address _token0, address _token1) external override {</span>
  95 |     | <span style='background-color: #faa;'>        require(msg.sender == factory, &quot;UniswapV2: FORBIDDEN&quot;); // sufficient check</span>
  96 |     | <span style='background-color: #faa;'>        dos = _dos;</span>
  97 |     | <span style='background-color: #faa;'>        dSafe = IDOS(dos).createDSafe();</span>
  98 |     | <span style='background-color: #faa;'>        token0 = _token0;</span>
  99 |     | <span style='background-color: #faa;'>        token1 = _token1;</span>
 100 |     | <span style='background-color: #eee;'>    }</span>
 101 |     | <span style='background-color: #eee;'></span>
 102 |     | <span style='background-color: #eee;'>    // update reserves and, on the first call per block, price accumulators</span>
 103 |     | <span style='background-color: #faa;'>    function _update(</span>
 104 |     | <span style='background-color: #eee;'>        uint256 balance0,</span>
 105 |     | <span style='background-color: #eee;'>        uint256 balance1,</span>
 106 |     | <span style='background-color: #eee;'>        uint112 _reserve0,</span>
 107 |     | <span style='background-color: #eee;'>        uint112 _reserve1</span>
 108 |     | <span style='background-color: #eee;'>    ) private {</span>
 109 |     | <span style='background-color: #eee;'>        require(</span>
 110 |     | <span style='background-color: #faa;'>            balance0 &lt;= type(uint112).max &amp;&amp; balance1 &lt;= type(uint112).max,</span>
 111 |     | <span style='background-color: #eee;'>            &quot;UniswapV2: OVERFLOW&quot;</span>
 112 |     | <span style='background-color: #eee;'>        );</span>
 113 |     | <span style='background-color: #faa;'>        uint32 blockTimestamp = uint32(block.timestamp % 2 ** 32);</span>
 114 |     | <span style='background-color: #eee;'>        unchecked {</span>
 115 |     | <span style='background-color: #faa;'>            uint32 timeElapsed = blockTimestamp - blockTimestampLast; // overflow is desired</span>
 116 |     | <span style='background-color: #faa;'>            if (timeElapsed &gt; 0 &amp;&amp; _reserve0 != 0 &amp;&amp; _reserve1 != 0) {</span>
 117 |     | <span style='background-color: #eee;'>                // * never overflows, and + overflow is desired</span>
 118 |     | <span style='background-color: #faa;'>                price0CumulativeLast +=</span>
 119 |     | <span style='background-color: #faa;'>                    uint256(UQ112x112.encode(_reserve1).uqdiv(_reserve0)) *</span>
 120 |     | <span style='background-color: #eee;'>                    timeElapsed;</span>
 121 |     | <span style='background-color: #faa;'>                price1CumulativeLast +=</span>
 122 |     | <span style='background-color: #faa;'>                    uint256(UQ112x112.encode(_reserve0).uqdiv(_reserve1)) *</span>
 123 |     | <span style='background-color: #eee;'>                    timeElapsed;</span>
 124 |     | <span style='background-color: #eee;'>            }</span>
 125 |     | <span style='background-color: #eee;'>        }</span>
 126 |     | <span style='background-color: #eee;'>        reserve0 = uint112(balance0);</span>
 127 |     | <span style='background-color: #eee;'>        reserve1 = uint112(balance1);</span>
 128 |     | <span style='background-color: #eee;'>        blockTimestampLast = blockTimestamp;</span>
 129 |     | <span style='background-color: #faa;'>        emit Sync(reserve0, reserve1);</span>
 130 |     | <span style='background-color: #eee;'>    }</span>
 131 |     | <span style='background-color: #eee;'></span>
 132 |     | <span style='background-color: #eee;'>    // if fee is on, mint liquidity equivalent to 1/6th of the growth in sqrt(k)</span>
 133 |     | <span style='background-color: #faa;'>    function _mintFee(uint112 _reserve0, uint112 _reserve1) private returns (bool feeOn) {</span>
 134 |     | <span style='background-color: #faa;'>        address feeTo = IUniswapV2Factory(factory).feeTo();</span>
 135 |     | <span style='background-color: #faa;'>        feeOn = feeTo != address(0);</span>
 136 |     | <span style='background-color: #faa;'>        uint256 _kLast = kLast; // gas savings</span>
 137 |     | <span style='background-color: #faa;'>        if (feeOn) {</span>
 138 |     | <span style='background-color: #faa;'>            if (_kLast != 0) {</span>
 139 |     | <span style='background-color: #faa;'>                uint256 rootK = Math.sqrt(uint256(_reserve0) * _reserve1);</span>
 140 |     | <span style='background-color: #faa;'>                uint256 rootKLast = Math.sqrt(_kLast);</span>
 141 |     | <span style='background-color: #faa;'>                if (rootK &gt; rootKLast) {</span>
 142 |     | <span style='background-color: #faa;'>                    uint256 numerator = totalSupply * (rootK - rootKLast);</span>
 143 |     | <span style='background-color: #faa;'>                    uint256 denominator = rootK * 5 + rootKLast;</span>
 144 |     | <span style='background-color: #faa;'>                    uint256 liquidity = numerator / denominator;</span>
 145 |     | <span style='background-color: #faa;'>                    if (liquidity &gt; 0) _mint(feeTo, liquidity);</span>
 146 |     | <span style='background-color: #eee;'>                }</span>
 147 |     | <span style='background-color: #eee;'>            }</span>
 148 |     | <span style='background-color: #faa;'>        } else if (_kLast != 0) {</span>
 149 |     | <span style='background-color: #eee;'>            kLast = 0;</span>
 150 |     | <span style='background-color: #eee;'>        }</span>
 151 |     | <span style='background-color: #eee;'>    }</span>
 152 |     | <span style='background-color: #eee;'></span>
 153 |     | <span style='background-color: #eee;'>    // this low-level function should be called from a contract which performs important safety checks</span>
 154 |     | <span style='background-color: #eee;'>    function mint(address to) external override lock returns (uint256 liquidity) {</span>
 155 |     | <span style='background-color: #faa;'>        (uint112 _reserve0, uint112 _reserve1, ) = getReserves(); // gas savings</span>
 156 |     | <span style='background-color: #faa;'>        uint256 balance0 = uint256(IDOS(dos).getDAccountERC20(dSafe, IERC20(token0)));</span>
 157 |     | <span style='background-color: #faa;'>        uint256 balance1 = uint256(IDOS(dos).getDAccountERC20(dSafe, IERC20(token1)));</span>
 158 |     | <span style='background-color: #faa;'>        uint256 amount0 = balance0 - _reserve0;</span>
 159 |     | <span style='background-color: #faa;'>        uint256 amount1 = balance1 - _reserve1;</span>
 160 |     | <span style='background-color: #eee;'></span>
 161 |     | <span style='background-color: #faa;'>        bool feeOn = _mintFee(_reserve0, _reserve1);</span>
 162 |     | <span style='background-color: #eee;'>        uint256 _totalSupply = totalSupply; // gas savings, must be defined here since totalSupply can update in _mintFee</span>
 163 |     | <span style='background-color: #faa;'>        if (_totalSupply == 0) {</span>
 164 |     | <span style='background-color: #faa;'>            liquidity = Math.sqrt(amount0 * amount1) - MINIMUM_LIQUIDITY;</span>
 165 |     | <span style='background-color: #eee;'>            _mint(address(0), MINIMUM_LIQUIDITY); // permanently lock the first MINIMUM_LIQUIDITY tokens</span>
 166 |     | <span style='background-color: #eee;'>        } else {</span>
 167 |     | <span style='background-color: #eee;'>            liquidity = Math.min(</span>
 168 |     | <span style='background-color: #faa;'>                (amount0 * _totalSupply) / _reserve0,</span>
 169 |     | <span style='background-color: #faa;'>                (amount1 * _totalSupply) / _reserve1</span>
 170 |     | <span style='background-color: #eee;'>            );</span>
 171 |     | <span style='background-color: #eee;'>        }</span>
 172 |     | <span style='background-color: #faa;'>        require(liquidity &gt; 0, &quot;UniswapV2: INSUFFICIENT_LIQUIDITY_MINTED&quot;);</span>
 173 |     | <span style='background-color: #faa;'>        _mint(address(this), liquidity); // mint to this address</span>
 174 |     | <span style='background-color: #faa;'>        _approve(address(this), address(dos), liquidity);</span>
 175 |     | <span style='background-color: #faa;'>        IDOS(dos).depositERC20ForSafe(address(this), to, liquidity); // deposit LP tokens into DOS</span>
 176 |     | <span style='background-color: #eee;'></span>
 177 |     | <span style='background-color: #faa;'>        _update(balance0, balance1, _reserve0, _reserve1);</span>
 178 |     | <span style='background-color: #faa;'>        if (feeOn) kLast = uint256(reserve0) * reserve1; // reserve0 and reserve1 are up-to-date</span>
 179 |     | <span style='background-color: #faa;'>        emit Mint(msg.sender, amount0, amount1);</span>
 180 |     | <span style='background-color: #eee;'>    }</span>
 181 |     | <span style='background-color: #eee;'></span>
 182 |     | <span style='background-color: #eee;'>    // this low-level function should be called from a contract which performs important safety checks</span>
 183 |     | <span style='background-color: #eee;'>    function burn(address to) external override lock returns (uint256 amount0, uint256 amount1) {</span>
 184 |     | <span style='background-color: #faa;'>        (uint112 _reserve0, uint112 _reserve1, ) = getReserves(); // gas savings</span>
 185 |     | <span style='background-color: #faa;'>        address _token0 = token0; // gas savings</span>
 186 |     | <span style='background-color: #faa;'>        address _token1 = token1; // gas savings</span>
 187 |     | <span style='background-color: #faa;'>        uint256 balance0 = uint256(IDOS(dos).getDAccountERC20(dSafe, IERC20(_token0)));</span>
 188 |     | <span style='background-color: #faa;'>        uint256 balance1 = uint256(IDOS(dos).getDAccountERC20(dSafe, IERC20(_token1)));</span>
 189 |     | <span style='background-color: #faa;'>        uint256 liquidity = balanceOf[address(this)];</span>
 190 |     | <span style='background-color: #eee;'></span>
 191 |     | <span style='background-color: #faa;'>        bool feeOn = _mintFee(_reserve0, _reserve1);</span>
 192 |     | <span style='background-color: #eee;'>        uint256 _totalSupply = totalSupply; // gas savings, must be defined here since totalSupply can update in _mintFee</span>
 193 |     | <span style='background-color: #faa;'>        amount0 = (liquidity * balance0) / _totalSupply; // using balances ensures pro-rata distribution</span>
 194 |     | <span style='background-color: #faa;'>        amount1 = (liquidity * balance1) / _totalSupply; // using balances ensures pro-rata distribution</span>
 195 |     | <span style='background-color: #faa;'>        require(amount0 &gt; 0 &amp;&amp; amount1 &gt; 0, &quot;UniswapV2: INSUFFICIENT_LIQUIDITY_BURNED&quot;);</span>
 196 |     | <span style='background-color: #eee;'>        _burn(address(this), liquidity);</span>
 197 |     | <span style='background-color: #faa;'>        _safeTransfer(_token0, to, amount0);</span>
 198 |     | <span style='background-color: #faa;'>        _safeTransfer(_token1, to, amount1);</span>
 199 |     | <span style='background-color: #faa;'>        balance0 = uint256(IDOS(dos).getDAccountERC20(dSafe, IERC20(_token0)));</span>
 200 |     | <span style='background-color: #faa;'>        balance1 = uint256(IDOS(dos).getDAccountERC20(dSafe, IERC20(_token1)));</span>
 201 |     | <span style='background-color: #eee;'></span>
 202 |     | <span style='background-color: #faa;'>        _update(balance0, balance1, _reserve0, _reserve1);</span>
 203 |     | <span style='background-color: #faa;'>        if (feeOn) kLast = uint256(reserve0) * reserve1; // reserve0 and reserve1 are up-to-date</span>
 204 |     | <span style='background-color: #faa;'>        emit Burn(msg.sender, amount0, amount1, to);</span>
 205 |     | <span style='background-color: #eee;'>    }</span>
 206 |     | <span style='background-color: #eee;'></span>
 207 |     | <span style='background-color: #eee;'>    // this low-level function should be called from a contract which performs important safety checks</span>
 208 |     | <span style='background-color: #eee;'>    function swap(</span>
 209 |     | <span style='background-color: #eee;'>        uint256 amount0Out,</span>
 210 |     | <span style='background-color: #eee;'>        uint256 amount1Out,</span>
 211 |     | <span style='background-color: #eee;'>        address to,</span>
 212 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
 213 |     | <span style='background-color: #eee;'>    ) external override lock {</span>
 214 |     | <span style='background-color: #faa;'>        require(amount0Out &gt; 0 || amount1Out &gt; 0, &quot;UniswapV2: INSUFFICIENT_OUTPUT_AMOUNT&quot;);</span>
 215 |     | <span style='background-color: #faa;'>        (uint112 _reserve0, uint112 _reserve1, ) = getReserves(); // gas savings</span>
 216 |     | <span style='background-color: #eee;'>        require(</span>
 217 |     | <span style='background-color: #faa;'>            amount0Out &lt; _reserve0 &amp;&amp; amount1Out &lt; _reserve1,</span>
 218 |     | <span style='background-color: #eee;'>            &quot;UniswapV2: INSUFFICIENT_LIQUIDITY&quot;</span>
 219 |     | <span style='background-color: #eee;'>        );</span>
 220 |     | <span style='background-color: #eee;'></span>
 221 |     | <span style='background-color: #eee;'>        uint256 balance0;</span>
 222 |     | <span style='background-color: #eee;'>        uint256 balance1;</span>
 223 |     | <span style='background-color: #eee;'>        {</span>
 224 |     | <span style='background-color: #eee;'>            // scope for _token{0,1}, avoids stack too deep errors</span>
 225 |     | <span style='background-color: #faa;'>            address _token0 = token0;</span>
 226 |     | <span style='background-color: #faa;'>            address _token1 = token1;</span>
 227 |     | <span style='background-color: #faa;'>            require(to != _token0 &amp;&amp; to != _token1, &quot;UniswapV2: INVALID_TO&quot;);</span>
 228 |     | <span style='background-color: #faa;'>            if (amount0Out &gt; 0) _safeTransfer(_token0, to, amount0Out); // optimistically transfer tokens</span>
 229 |     | <span style='background-color: #faa;'>            if (amount1Out &gt; 0) _safeTransfer(_token1, to, amount1Out); // optimistically transfer tokens</span>
 230 |     | <span style='background-color: #faa;'>            if (data.length &gt; 0)</span>
 231 |     | <span style='background-color: #faa;'>                IUniswapV2Callee(to).uniswapV2Call(msg.sender, amount0Out, amount1Out, data);</span>
 232 |     | <span style='background-color: #eee;'></span>
 233 |     | <span style='background-color: #faa;'>            balance0 = uint256(IDOS(dos).getDAccountERC20(dSafe, IERC20(_token0)));</span>
 234 |     | <span style='background-color: #faa;'>            balance1 = uint256(IDOS(dos).getDAccountERC20(dSafe, IERC20(_token1)));</span>
 235 |     | <span style='background-color: #eee;'>        }</span>
 236 |     | <span style='background-color: #faa;'>        uint256 amount0In = balance0 &gt; _reserve0 - amount0Out</span>
 237 |     | <span style='background-color: #faa;'>            ? balance0 - (_reserve0 - amount0Out)</span>
 238 |     | <span style='background-color: #eee;'>            : 0;</span>
 239 |     | <span style='background-color: #faa;'>        uint256 amount1In = balance1 &gt; _reserve1 - amount1Out</span>
 240 |     | <span style='background-color: #faa;'>            ? balance1 - (_reserve1 - amount1Out)</span>
 241 |     | <span style='background-color: #eee;'>            : 0;</span>
 242 |     | <span style='background-color: #faa;'>        require(amount0In &gt; 0 || amount1In &gt; 0, &quot;UniswapV2: INSUFFICIENT_INPUT_AMOUNT&quot;);</span>
 243 |     | <span style='background-color: #eee;'>        {</span>
 244 |     | <span style='background-color: #eee;'>            // scope for reserve{0,1}Adjusted, avoids stack too deep errors</span>
 245 |     | <span style='background-color: #faa;'>            uint256 balance0Adjusted = balance0 * 1000 - amount0In * 3;</span>
 246 |     | <span style='background-color: #faa;'>            uint256 balance1Adjusted = balance1 * 1000 - amount1In * 3;</span>
 247 |     | <span style='background-color: #eee;'>            require(</span>
 248 |     | <span style='background-color: #faa;'>                balance0Adjusted * balance1Adjusted &gt;= uint256(_reserve0) * _reserve1 * 1e6,</span>
 249 |     | <span style='background-color: #eee;'>                &quot;UniswapV2: K&quot;</span>
 250 |     | <span style='background-color: #eee;'>            );</span>
 251 |     | <span style='background-color: #eee;'>        }</span>
 252 |     | <span style='background-color: #eee;'></span>
 253 |     | <span style='background-color: #faa;'>        _update(balance0, balance1, _reserve0, _reserve1);</span>
 254 |     | <span style='background-color: #faa;'>        emit Swap(msg.sender, amount0In, amount1In, amount0Out, amount1Out, to);</span>
 255 |     | <span style='background-color: #eee;'>    }</span>
 256 |     | <span style='background-color: #eee;'></span>
 257 |     | <span style='background-color: #eee;'>    // force balances to match reserves</span>
 258 |     | <span style='background-color: #eee;'>    function skim(address to) external override lock {</span>
 259 |     | <span style='background-color: #faa;'>        address _token0 = token0; // gas savings</span>
 260 |     | <span style='background-color: #faa;'>        address _token1 = token1; // gas savings</span>
 261 |     | <span style='background-color: #eee;'>        _safeTransfer(</span>
 262 |     | <span style='background-color: #eee;'>            _token0,</span>
 263 |     | <span style='background-color: #eee;'>            to,</span>
 264 |     | <span style='background-color: #faa;'>            uint256(IDOS(dos).getDAccountERC20(dSafe, IERC20(token0))) - reserve0</span>
 265 |     | <span style='background-color: #eee;'>        );</span>
 266 |     | <span style='background-color: #faa;'>        _safeTransfer(_token1, to, uint256(IDOS(dos).getDAccountERC20(dSafe, IERC20(token1))));</span>
 267 |     | <span style='background-color: #eee;'>    }</span>
 268 |     | <span style='background-color: #eee;'></span>
 269 |     | <span style='background-color: #eee;'>    // force reserves to match balances</span>
 270 |     | <span style='background-color: #eee;'>    function sync() external override lock {</span>
 271 |     | <span style='background-color: #eee;'>        _update(</span>
 272 |     | <span style='background-color: #faa;'>            uint256(IDOS(dos).getDAccountERC20(dSafe, IERC20(token0))),</span>
 273 |     | <span style='background-color: #faa;'>            uint256(IDOS(dos).getDAccountERC20(dSafe, IERC20(token1))),</span>
 274 |     | <span style='background-color: #faa;'>            reserve0,</span>
 275 |     | <span style='background-color: #faa;'>            reserve1</span>
 276 |     | <span style='background-color: #eee;'>        );</span>
 277 |     | <span style='background-color: #eee;'>    }</span>
 278 |     | <span style='background-color: #eee;'>}</span>
 279 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/duoswapV2/DuoswapV2Router.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-3.0-or-later</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.7;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>//solhint-disable not-rely-on-time</span>
   5 |     | <span style='background-color: #eee;'>//solhint-disable var-name-mixedcase</span>
   6 |     | <span style='background-color: #eee;'>//solhint-disable func-name-mixedcase</span>
   7 |     | <span style='background-color: #eee;'>//solhint-disable func-param-name-mixedcase</span>
   8 |     | <span style='background-color: #eee;'>//solhint-disable reason-string</span>
   9 |     | <span style='background-color: #eee;'>//solhint-disable ordering</span>
  10 |     | <span style='background-color: #eee;'></span>
  11 |     | <span style='background-color: #eee;'>import &quot;@uniswap/lib/contracts/libraries/TransferHelper.sol&quot;;</span>
  12 |     | <span style='background-color: #eee;'>import &quot;@uniswap/v2-core/contracts/interfaces/IUniswapV2Factory.sol&quot;;</span>
  13 |     | <span style='background-color: #eee;'></span>
  14 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
  15 |     | <span style='background-color: #eee;'></span>
  16 |     | <span style='background-color: #eee;'>import &quot;./interfaces/IDuoswapV2Router.sol&quot;;</span>
  17 |     | <span style='background-color: #eee;'>import &quot;./libraries/DuoswapV2Library.sol&quot;;</span>
  18 |     | <span style='background-color: #eee;'>import &quot;../external/interfaces/IWETH9.sol&quot;;</span>
  19 |     | <span style='background-color: #eee;'></span>
  20 |     | <span style='background-color: #eee;'>import {IDuoswapV2Pair} from &quot;./interfaces/IDuoswapV2Pair.sol&quot;;</span>
  21 |     | <span style='background-color: #eee;'>import {IDOS} from &quot;../interfaces/IDOS.sol&quot;;</span>
  22 |     | <span style='background-color: #faa;'></span>
  23 |     | <span style='background-color: #eee;'>contract DuoswapV2Router is IDuoswapV2Router {</span>
  24 |     | <span style='background-color: #faa;'>    address public immutable override factory;</span>
  25 |     | <span style='background-color: #faa;'>    address public immutable override WETH;</span>
  26 |     | <span style='background-color: #faa;'>    address public immutable dos;</span>
  27 |     | <span style='background-color: #eee;'></span>
  28 |     | <span style='background-color: #eee;'>    modifier ensure(uint256 deadline) {</span>
  29 |     | <span style='background-color: #faa;'>        require(deadline &gt;= block.timestamp, &quot;UniswapV2Router: EXPIRED&quot;);</span>
  30 |     | <span style='background-color: #eee;'>        _;</span>
  31 |     | <span style='background-color: #eee;'>    }</span>
  32 |     | <span style='background-color: #eee;'></span>
  33 |     | <span style='background-color: #eee;'>    constructor(address _factory, address _WETH, address _dos) {</span>
  34 |     | <span style='background-color: #faa;'>        factory = _factory;</span>
  35 |     | <span style='background-color: #faa;'>        WETH = _WETH;</span>
  36 |     | <span style='background-color: #faa;'>        dos = _dos;</span>
  37 |     | <span style='background-color: #eee;'>    }</span>
  38 |     | <span style='background-color: #eee;'></span>
  39 |     | <span style='background-color: #eee;'>    receive() external payable {</span>
  40 |     | <span style='background-color: #faa;'>        assert(msg.sender == WETH); // only accept ETH via fallback from the WETH contract</span>
  41 |     | <span style='background-color: #eee;'>    }</span>
  42 |     | <span style='background-color: #eee;'></span>
  43 |     | <span style='background-color: #eee;'>    // **** ADD LIQUIDITY ****</span>
  44 |     | <span style='background-color: #eee;'>    function _addLiquidity(</span>
  45 |     | <span style='background-color: #eee;'>        address tokenA,</span>
  46 |     | <span style='background-color: #eee;'>        address tokenB,</span>
  47 |     | <span style='background-color: #eee;'>        uint256 amountADesired,</span>
  48 |     | <span style='background-color: #eee;'>        uint256 amountBDesired,</span>
  49 |     | <span style='background-color: #eee;'>        uint256 amountAMin,</span>
  50 |     | <span style='background-color: #eee;'>        uint256 amountBMin</span>
  51 |     | <span style='background-color: #eee;'>    ) internal virtual returns (uint256 amountA, uint256 amountB) {</span>
  52 |     | <span style='background-color: #eee;'>        // create the pair if it doesn&#39;t exist yet</span>
  53 |     | <span style='background-color: #faa;'>        if (IUniswapV2Factory(factory).getPair(tokenA, tokenB) == address(0)) {</span>
  54 |     | <span style='background-color: #faa;'>            IUniswapV2Factory(factory).createPair(tokenA, tokenB);</span>
  55 |     | <span style='background-color: #eee;'>        }</span>
  56 |     | <span style='background-color: #faa;'>        (uint256 reserveA, uint256 reserveB) = DuoswapV2Library.getReserves(</span>
  57 |     | <span style='background-color: #eee;'>            factory,</span>
  58 |     | <span style='background-color: #eee;'>            tokenA,</span>
  59 |     | <span style='background-color: #eee;'>            tokenB</span>
  60 |     | <span style='background-color: #eee;'>        );</span>
  61 |     | <span style='background-color: #faa;'>        if (reserveA == 0 &amp;&amp; reserveB == 0) {</span>
  62 |     | <span style='background-color: #faa;'>            (amountA, amountB) = (amountADesired, amountBDesired);</span>
  63 |     | <span style='background-color: #eee;'>        } else {</span>
  64 |     | <span style='background-color: #faa;'>            uint256 amountBOptimal = DuoswapV2Library.quote(amountADesired, reserveA, reserveB);</span>
  65 |     | <span style='background-color: #faa;'>            if (amountBOptimal &lt;= amountBDesired) {</span>
  66 |     | <span style='background-color: #faa;'>                require(amountBOptimal &gt;= amountBMin, &quot;UniswapV2Router: INSUFFICIENT_B_AMOUNT&quot;);</span>
  67 |     | <span style='background-color: #faa;'>                (amountA, amountB) = (amountADesired, amountBOptimal);</span>
  68 |     | <span style='background-color: #eee;'>            } else {</span>
  69 |     | <span style='background-color: #faa;'>                uint256 amountAOptimal = DuoswapV2Library.quote(amountBDesired, reserveB, reserveA);</span>
  70 |     | <span style='background-color: #faa;'>                assert(amountAOptimal &lt;= amountADesired);</span>
  71 |     | <span style='background-color: #faa;'>                require(amountAOptimal &gt;= amountAMin, &quot;UniswapV2Router: INSUFFICIENT_A_AMOUNT&quot;);</span>
  72 |     | <span style='background-color: #eee;'>                (amountA, amountB) = (amountAOptimal, amountBDesired);</span>
  73 |     | <span style='background-color: #eee;'>            }</span>
  74 |     | <span style='background-color: #eee;'>        }</span>
  75 |     | <span style='background-color: #eee;'>    }</span>
  76 |     | <span style='background-color: #eee;'></span>
  77 |     | <span style='background-color: #eee;'>    function addLiquidity(</span>
  78 |     | <span style='background-color: #eee;'>        address tokenA,</span>
  79 |     | <span style='background-color: #eee;'>        address tokenB,</span>
  80 |     | <span style='background-color: #eee;'>        uint256 amountADesired,</span>
  81 |     | <span style='background-color: #eee;'>        uint256 amountBDesired,</span>
  82 |     | <span style='background-color: #eee;'>        uint256 amountAMin,</span>
  83 |     | <span style='background-color: #eee;'>        uint256 amountBMin,</span>
  84 |     | <span style='background-color: #eee;'>        address to,</span>
  85 |     | <span style='background-color: #eee;'>        uint256 deadline</span>
  86 |     | <span style='background-color: #eee;'>    )</span>
  87 |     | <span style='background-color: #eee;'>        external</span>
  88 |     | <span style='background-color: #eee;'>        virtual</span>
  89 |     | <span style='background-color: #eee;'>        override</span>
  90 |     | <span style='background-color: #eee;'>        ensure(deadline)</span>
  91 |     | <span style='background-color: #eee;'>        returns (uint256 amountA, uint256 amountB, uint256 liquidity)</span>
  92 |     | <span style='background-color: #eee;'>    {</span>
  93 |     | <span style='background-color: #eee;'>        // require(msg.sender == address(dos));</span>
  94 |     | <span style='background-color: #eee;'>        (amountA, amountB) = _addLiquidity(</span>
  95 |     | <span style='background-color: #eee;'>            tokenA,</span>
  96 |     | <span style='background-color: #eee;'>            tokenB,</span>
  97 |     | <span style='background-color: #eee;'>            amountADesired,</span>
  98 |     | <span style='background-color: #eee;'>            amountBDesired,</span>
  99 |     | <span style='background-color: #eee;'>            amountAMin,</span>
 100 |     | <span style='background-color: #eee;'>            amountBMin</span>
 101 |     | <span style='background-color: #eee;'>        );</span>
 102 |     | <span style='background-color: #faa;'>        address pair = DuoswapV2Library.pairFor(factory, tokenA, tokenB);</span>
 103 |     | <span style='background-color: #faa;'>        address pairSafe = IDuoswapV2Pair(pair).dSafe();</span>
 104 |     | <span style='background-color: #eee;'></span>
 105 |     | <span style='background-color: #faa;'>        IDOS(dos).transferFromERC20(tokenA, msg.sender, pairSafe, amountA);</span>
 106 |     | <span style='background-color: #faa;'>        IDOS(dos).transferFromERC20(tokenB, msg.sender, pairSafe, amountB);</span>
 107 |     | <span style='background-color: #faa;'>        liquidity = IDuoswapV2Pair(pair).mint(to);</span>
 108 |     | <span style='background-color: #eee;'>    }</span>
 109 |     | <span style='background-color: #eee;'></span>
 110 |     | <span style='background-color: #eee;'>    // **** REMOVE LIQUIDITY ****</span>
 111 |     | <span style='background-color: #eee;'>    function removeLiquidity(</span>
 112 |     | <span style='background-color: #eee;'>        address tokenA,</span>
 113 |     | <span style='background-color: #eee;'>        address tokenB,</span>
 114 |     | <span style='background-color: #eee;'>        uint256 liquidity,</span>
 115 |     | <span style='background-color: #eee;'>        uint256 amountAMin,</span>
 116 |     | <span style='background-color: #eee;'>        uint256 amountBMin,</span>
 117 |     | <span style='background-color: #eee;'>        address to,</span>
 118 |     | <span style='background-color: #eee;'>        uint256 deadline</span>
 119 |     | <span style='background-color: #eee;'>    ) public virtual override ensure(deadline) returns (uint256 amountA, uint256 amountB) {</span>
 120 |     | <span style='background-color: #faa;'>        address pair = DuoswapV2Library.pairFor(factory, tokenA, tokenB);</span>
 121 |     | <span style='background-color: #faa;'>        IDuoswapV2Pair(pair).transferFrom(msg.sender, pair, liquidity); // send liquidity to pair</span>
 122 |     | <span style='background-color: #faa;'>        (uint256 amount0, uint256 amount1) = IDuoswapV2Pair(pair).burn(to);</span>
 123 |     | <span style='background-color: #faa;'>        (address token0, ) = DuoswapV2Library.sortTokens(tokenA, tokenB);</span>
 124 |     | <span style='background-color: #faa;'>        (amountA, amountB) = tokenA == token0 ? (amount0, amount1) : (amount1, amount0);</span>
 125 |     | <span style='background-color: #faa;'>        require(amountA &gt;= amountAMin, &quot;UniswapV2Router: INSUFFICIENT_A_AMOUNT&quot;);</span>
 126 |     | <span style='background-color: #faa;'>        require(amountB &gt;= amountBMin, &quot;UniswapV2Router: INSUFFICIENT_B_AMOUNT&quot;);</span>
 127 |     | <span style='background-color: #eee;'>    }</span>
 128 |     | <span style='background-color: #eee;'></span>
 129 |     | <span style='background-color: #eee;'>    function removeLiquidityWithPermit(</span>
 130 |     | <span style='background-color: #eee;'>        address tokenA,</span>
 131 |     | <span style='background-color: #eee;'>        address tokenB,</span>
 132 |     | <span style='background-color: #eee;'>        uint256 liquidity,</span>
 133 |     | <span style='background-color: #eee;'>        uint256 amountAMin,</span>
 134 |     | <span style='background-color: #eee;'>        uint256 amountBMin,</span>
 135 |     | <span style='background-color: #eee;'>        address to,</span>
 136 |     | <span style='background-color: #eee;'>        uint256 deadline,</span>
 137 |     | <span style='background-color: #eee;'>        bool approveMax,</span>
 138 |     | <span style='background-color: #eee;'>        uint8 v,</span>
 139 |     | <span style='background-color: #eee;'>        bytes32 r,</span>
 140 |     | <span style='background-color: #eee;'>        bytes32 s</span>
 141 |     | <span style='background-color: #eee;'>    ) external virtual override returns (uint256 amountA, uint256 amountB) {</span>
 142 |     | <span style='background-color: #faa;'>        address pair = DuoswapV2Library.pairFor(factory, tokenA, tokenB);</span>
 143 |     | <span style='background-color: #faa;'>        uint256 value = approveMax ? type(uint256).max : liquidity;</span>
 144 |     | <span style='background-color: #faa;'>        IDuoswapV2Pair(pair).permit(msg.sender, address(this), value, deadline, v, r, s);</span>
 145 |     | <span style='background-color: #eee;'>        (amountA, amountB) = removeLiquidity(</span>
 146 |     | <span style='background-color: #eee;'>            tokenA,</span>
 147 |     | <span style='background-color: #eee;'>            tokenB,</span>
 148 |     | <span style='background-color: #eee;'>            liquidity,</span>
 149 |     | <span style='background-color: #eee;'>            amountAMin,</span>
 150 |     | <span style='background-color: #eee;'>            amountBMin,</span>
 151 |     | <span style='background-color: #eee;'>            to,</span>
 152 |     | <span style='background-color: #eee;'>            deadline</span>
 153 |     | <span style='background-color: #eee;'>        );</span>
 154 |     | <span style='background-color: #eee;'>    }</span>
 155 |     | <span style='background-color: #eee;'></span>
 156 |     | <span style='background-color: #eee;'>    // **** SWAP ****</span>
 157 |     | <span style='background-color: #eee;'>    // requires the initial amount to have already been sent to the first pair</span>
 158 |     | <span style='background-color: #faa;'>    function _swap(uint256[] memory amounts, address[] memory path, address _to) internal virtual {</span>
 159 |     | <span style='background-color: #faa;'>        for (uint256 i; i &lt; path.length - 1; i++) {</span>
 160 |     | <span style='background-color: #faa;'>            (address input, address output) = (path[i], path[i + 1]);</span>
 161 |     | <span style='background-color: #faa;'>            (address token0, ) = DuoswapV2Library.sortTokens(input, output);</span>
 162 |     | <span style='background-color: #faa;'>            uint256 amountOut = amounts[i + 1];</span>
 163 |     | <span style='background-color: #faa;'>            (uint256 amount0Out, uint256 amount1Out) = input == token0</span>
 164 |     | <span style='background-color: #eee;'>                ? (uint256(0), amountOut)</span>
 165 |     | <span style='background-color: #eee;'>                : (amountOut, uint256(0));</span>
 166 |     | <span style='background-color: #faa;'>            address to = i &lt; path.length - 2</span>
 167 |     | <span style='background-color: #faa;'>                ? DuoswapV2Library.pairFor(factory, output, path[i + 2])</span>
 168 |     | <span style='background-color: #eee;'>                : _to;</span>
 169 |     | <span style='background-color: #faa;'>            IDuoswapV2Pair(DuoswapV2Library.pairFor(factory, input, output)).swap(</span>
 170 |     | <span style='background-color: #eee;'>                amount0Out,</span>
 171 |     | <span style='background-color: #eee;'>                amount1Out,</span>
 172 |     | <span style='background-color: #eee;'>                to,</span>
 173 |     | <span style='background-color: #eee;'>                new bytes(0)</span>
 174 |     | <span style='background-color: #eee;'>            );</span>
 175 |     | <span style='background-color: #eee;'>        }</span>
 176 |     | <span style='background-color: #eee;'>    }</span>
 177 |     | <span style='background-color: #eee;'></span>
 178 |     | <span style='background-color: #eee;'>    function swapExactTokensForTokens(</span>
 179 |     | <span style='background-color: #eee;'>        uint256 amountIn,</span>
 180 |     | <span style='background-color: #eee;'>        uint256 amountOutMin,</span>
 181 |     | <span style='background-color: #eee;'>        address[] calldata path,</span>
 182 |     | <span style='background-color: #eee;'>        address to,</span>
 183 |     | <span style='background-color: #eee;'>        uint256 deadline</span>
 184 |     | <span style='background-color: #eee;'>    ) external virtual override ensure(deadline) returns (uint256[] memory amounts) {</span>
 185 |     | <span style='background-color: #faa;'>        amounts = DuoswapV2Library.getAmountsOut(factory, amountIn, path);</span>
 186 |     | <span style='background-color: #faa;'>        require(</span>
 187 |     | <span style='background-color: #faa;'>            amounts[amounts.length - 1] &gt;= amountOutMin,</span>
 188 |     | <span style='background-color: #eee;'>            &quot;UniswapV2Router: INSUFFICIENT_OUTPUT_AMOUNT&quot;</span>
 189 |     | <span style='background-color: #eee;'>        );</span>
 190 |     | <span style='background-color: #eee;'>        IDOS(dos).transferFromERC20(</span>
 191 |     | <span style='background-color: #faa;'>            path[0],</span>
 192 |     | <span style='background-color: #eee;'>            to, // changed to userSafe</span>
 193 |     | <span style='background-color: #eee;'>            IDuoswapV2Pair(DuoswapV2Library.pairFor(factory, path[0], path[1])).dSafe(), // changed to pairSafe</span>
 194 |     | <span style='background-color: #eee;'>            amounts[0]</span>
 195 |     | <span style='background-color: #eee;'>        );</span>
 196 |     | <span style='background-color: #eee;'>        _swap(amounts, path, to);</span>
 197 |     | <span style='background-color: #eee;'>    }</span>
 198 |     | <span style='background-color: #eee;'></span>
 199 |     | <span style='background-color: #eee;'>    function swapTokensForExactTokens(</span>
 200 |     | <span style='background-color: #eee;'>        uint256 amountOut,</span>
 201 |     | <span style='background-color: #eee;'>        uint256 amountInMax,</span>
 202 |     | <span style='background-color: #eee;'>        address[] calldata path,</span>
 203 |     | <span style='background-color: #eee;'>        address to,</span>
 204 |     | <span style='background-color: #eee;'>        uint256 deadline</span>
 205 |     | <span style='background-color: #eee;'>    ) external virtual override ensure(deadline) returns (uint256[] memory amounts) {</span>
 206 |     | <span style='background-color: #faa;'>        amounts = DuoswapV2Library.getAmountsIn(factory, amountOut, path);</span>
 207 |     | <span style='background-color: #faa;'>        require(amounts[0] &lt;= amountInMax, &quot;UniswapV2Router: EXCESSIVE_INPUT_AMOUNT&quot;);</span>
 208 |     | <span style='background-color: #faa;'>        IDOS(dos).transferFromERC20(</span>
 209 |     | <span style='background-color: #faa;'>            path[0],</span>
 210 |     | <span style='background-color: #eee;'>            to, // changed to userSafe</span>
 211 |     | <span style='background-color: #faa;'>            IDuoswapV2Pair(DuoswapV2Library.pairFor(factory, path[0], path[1])).dSafe(), // changed to pairSafe</span>
 212 |     | <span style='background-color: #faa;'>            amounts[0]</span>
 213 |     | <span style='background-color: #eee;'>        );</span>
 214 |     | <span style='background-color: #faa;'>        _swap(amounts, path, to);</span>
 215 |     | <span style='background-color: #eee;'>    }</span>
 216 |     | <span style='background-color: #eee;'></span>
 217 |     | <span style='background-color: #eee;'>    // **** SWAP (supporting fee-on-transfer tokens) ****</span>
 218 |     | <span style='background-color: #eee;'>    // requires the initial amount to have already been sent to the first pair</span>
 219 |     | <span style='background-color: #eee;'>    function _swapSupportingFeeOnTransferTokens(</span>
 220 |     | <span style='background-color: #eee;'>        address[] memory path,</span>
 221 |     | <span style='background-color: #eee;'>        address _to</span>
 222 |     | <span style='background-color: #eee;'>    ) internal virtual {</span>
 223 |     | <span style='background-color: #faa;'>        for (uint256 i; i &lt; path.length - 1; i++) {</span>
 224 |     | <span style='background-color: #faa;'>            (address input, address output) = (path[i], path[i + 1]);</span>
 225 |     | <span style='background-color: #faa;'>            (address token0, ) = DuoswapV2Library.sortTokens(input, output);</span>
 226 |     | <span style='background-color: #faa;'>            IDuoswapV2Pair pair = IDuoswapV2Pair(DuoswapV2Library.pairFor(factory, input, output));</span>
 227 |     | <span style='background-color: #eee;'>            uint256 amountInput;</span>
 228 |     | <span style='background-color: #eee;'>            uint256 amountOutput;</span>
 229 |     | <span style='background-color: #eee;'>            {</span>
 230 |     | <span style='background-color: #eee;'>                // scope to avoid stack too deep errors</span>
 231 |     | <span style='background-color: #faa;'>                (uint256 reserve0, uint256 reserve1, ) = pair.getReserves();</span>
 232 |     | <span style='background-color: #faa;'>                (uint256 reserveInput, uint256 reserveOutput) = input == token0</span>
 233 |     | <span style='background-color: #eee;'>                    ? (reserve0, reserve1)</span>
 234 |     | <span style='background-color: #eee;'>                    : (reserve1, reserve0);</span>
 235 |     | <span style='background-color: #faa;'>                amountInput = IERC20(input).balanceOf(address(pair)) - reserveInput;</span>
 236 |     | <span style='background-color: #faa;'>                amountOutput = DuoswapV2Library.getAmountOut(</span>
 237 |     | <span style='background-color: #eee;'>                    amountInput,</span>
 238 |     | <span style='background-color: #eee;'>                    reserveInput,</span>
 239 |     | <span style='background-color: #eee;'>                    reserveOutput</span>
 240 |     | <span style='background-color: #eee;'>                );</span>
 241 |     | <span style='background-color: #eee;'>            }</span>
 242 |     | <span style='background-color: #faa;'>            (uint256 amount0Out, uint256 amount1Out) = input == token0</span>
 243 |     | <span style='background-color: #eee;'>                ? (uint256(0), amountOutput)</span>
 244 |     | <span style='background-color: #eee;'>                : (amountOutput, uint256(0));</span>
 245 |     | <span style='background-color: #faa;'>            address to = i &lt; path.length - 2</span>
 246 |     | <span style='background-color: #faa;'>                ? DuoswapV2Library.pairFor(factory, output, path[i + 2])</span>
 247 |     | <span style='background-color: #eee;'>                : _to;</span>
 248 |     | <span style='background-color: #faa;'>            pair.swap(amount0Out, amount1Out, to, new bytes(0));</span>
 249 |     | <span style='background-color: #eee;'>        }</span>
 250 |     | <span style='background-color: #eee;'>    }</span>
 251 |     | <span style='background-color: #eee;'></span>
 252 |     | <span style='background-color: #eee;'>    function swapExactTokensForTokensSupportingFeeOnTransferTokens(</span>
 253 |     | <span style='background-color: #eee;'>        uint256 amountIn,</span>
 254 |     | <span style='background-color: #eee;'>        uint256 amountOutMin,</span>
 255 |     | <span style='background-color: #eee;'>        address[] calldata path,</span>
 256 |     | <span style='background-color: #eee;'>        address to,</span>
 257 |     | <span style='background-color: #eee;'>        uint256 deadline</span>
 258 |     | <span style='background-color: #eee;'>    ) external virtual override ensure(deadline) {</span>
 259 |     | <span style='background-color: #eee;'>        TransferHelper.safeTransferFrom(</span>
 260 |     | <span style='background-color: #faa;'>            path[0],</span>
 261 |     | <span style='background-color: #faa;'>            msg.sender,</span>
 262 |     | <span style='background-color: #faa;'>            DuoswapV2Library.pairFor(factory, path[0], path[1]),</span>
 263 |     | <span style='background-color: #eee;'>            amountIn</span>
 264 |     | <span style='background-color: #eee;'>        );</span>
 265 |     | <span style='background-color: #faa;'>        uint256 balanceBefore = IERC20(path[path.length - 1]).balanceOf(to);</span>
 266 |     | <span style='background-color: #eee;'>        _swapSupportingFeeOnTransferTokens(path, to);</span>
 267 |     | <span style='background-color: #faa;'>        require(</span>
 268 |     | <span style='background-color: #faa;'>            IERC20(path[path.length - 1]).balanceOf(to) - balanceBefore &gt;= amountOutMin,</span>
 269 |     | <span style='background-color: #eee;'>            &quot;UniswapV2Router: INSUFFICIENT_OUTPUT_AMOUNT&quot;</span>
 270 |     | <span style='background-color: #eee;'>        );</span>
 271 |     | <span style='background-color: #eee;'>    }</span>
 272 |     | <span style='background-color: #eee;'></span>
 273 |     | <span style='background-color: #eee;'>    // **** LIBRARY FUNCTIONS ****</span>
 274 |     | <span style='background-color: #eee;'>    function quote(</span>
 275 |     | <span style='background-color: #eee;'>        uint256 amountA,</span>
 276 |     | <span style='background-color: #eee;'>        uint256 reserveA,</span>
 277 |     | <span style='background-color: #eee;'>        uint256 reserveB</span>
 278 |     | <span style='background-color: #eee;'>    ) public pure virtual override returns (uint256 amountB) {</span>
 279 |     | <span style='background-color: #faa;'>        return DuoswapV2Library.quote(amountA, reserveA, reserveB);</span>
 280 |     | <span style='background-color: #eee;'>    }</span>
 281 |     | <span style='background-color: #eee;'></span>
 282 |     | <span style='background-color: #eee;'>    function getAmountOut(</span>
 283 |     | <span style='background-color: #eee;'>        uint256 amountIn,</span>
 284 |     | <span style='background-color: #eee;'>        uint256 reserveIn,</span>
 285 |     | <span style='background-color: #eee;'>        uint256 reserveOut</span>
 286 |     | <span style='background-color: #eee;'>    ) public pure virtual override returns (uint256 amountOut) {</span>
 287 |     | <span style='background-color: #faa;'>        return DuoswapV2Library.getAmountOut(amountIn, reserveIn, reserveOut);</span>
 288 |     | <span style='background-color: #eee;'>    }</span>
 289 |     | <span style='background-color: #eee;'></span>
 290 |     | <span style='background-color: #eee;'>    function getAmountIn(</span>
 291 |     | <span style='background-color: #eee;'>        uint256 amountOut,</span>
 292 |     | <span style='background-color: #eee;'>        uint256 reserveIn,</span>
 293 |     | <span style='background-color: #eee;'>        uint256 reserveOut</span>
 294 |     | <span style='background-color: #eee;'>    ) public pure virtual override returns (uint256 amountIn) {</span>
 295 |     | <span style='background-color: #faa;'>        return DuoswapV2Library.getAmountIn(amountOut, reserveIn, reserveOut);</span>
 296 |     | <span style='background-color: #eee;'>    }</span>
 297 |     | <span style='background-color: #eee;'></span>
 298 |     | <span style='background-color: #eee;'>    function getAmountsOut(</span>
 299 |     | <span style='background-color: #eee;'>        uint256 amountIn,</span>
 300 |     | <span style='background-color: #eee;'>        address[] memory path</span>
 301 |     | <span style='background-color: #eee;'>    ) public view virtual override returns (uint256[] memory amounts) {</span>
 302 |     | <span style='background-color: #faa;'>        return DuoswapV2Library.getAmountsOut(factory, amountIn, path);</span>
 303 |     | <span style='background-color: #eee;'>    }</span>
 304 |     | <span style='background-color: #eee;'></span>
 305 |     | <span style='background-color: #eee;'>    function getAmountsIn(</span>
 306 |     | <span style='background-color: #eee;'>        uint256 amountOut,</span>
 307 |     | <span style='background-color: #eee;'>        address[] memory path</span>
 308 |     | <span style='background-color: #eee;'>    ) public view virtual override returns (uint256[] memory amounts) {</span>
 309 |     | <span style='background-color: #faa;'>        return DuoswapV2Library.getAmountsIn(factory, amountOut, path);</span>
 310 |     | <span style='background-color: #eee;'>    }</span>
 311 |     | <span style='background-color: #eee;'>}</span>
 312 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/duoswapV2/interfaces/IDuoswapV2Pair.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-3.0-or-later</span>
  2 |     | <span style='background-color: #eee;'></span>
  3 |     | <span style='background-color: #eee;'>//solhint-disable-next-line compiler-version</span>
  4 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.5.0;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>//solhint-disable func-name-mixedcase</span>
  7 |     | <span style='background-color: #eee;'></span>
  8 |     | <span style='background-color: #eee;'>import &quot;@uniswap/v2-core/contracts/interfaces/IUniswapV2ERC20.sol&quot;;</span>
  9 |     | <span style='background-color: #eee;'></span>
 10 |     | <span style='background-color: #eee;'>interface IDuoswapV2Pair is IUniswapV2ERC20 {</span>
 11 |     | <span style='background-color: #eee;'>    event Mint(address indexed sender, uint256 amount0, uint256 amount1);</span>
 12 |     | <span style='background-color: #eee;'>    event Burn(address indexed sender, uint256 amount0, uint256 amount1, address indexed to);</span>
 13 |     | <span style='background-color: #eee;'>    event Swap(</span>
 14 |     | <span style='background-color: #eee;'>        address indexed sender,</span>
 15 |     | <span style='background-color: #eee;'>        uint256 amount0In,</span>
 16 |     | <span style='background-color: #eee;'>        uint256 amount1In,</span>
 17 |     | <span style='background-color: #eee;'>        uint256 amount0Out,</span>
 18 |     | <span style='background-color: #eee;'>        uint256 amount1Out,</span>
 19 |     | <span style='background-color: #eee;'>        address indexed to</span>
 20 |     | <span style='background-color: #eee;'>    );</span>
 21 |     | <span style='background-color: #eee;'>    event Sync(uint112 reserve0, uint112 reserve1);</span>
 22 |     | <span style='background-color: #eee;'></span>
 23 |     | <span style='background-color: #eee;'>    function MINIMUM_LIQUIDITY() external pure returns (uint256);</span>
 24 |     | <span style='background-color: #eee;'></span>
 25 |     | <span style='background-color: #eee;'>    function factory() external view returns (address);</span>
 26 |     | <span style='background-color: #eee;'></span>
 27 |     | <span style='background-color: #eee;'>    function token0() external view returns (address);</span>
 28 |     | <span style='background-color: #eee;'></span>
 29 |     | <span style='background-color: #eee;'>    function token1() external view returns (address);</span>
 30 |     | <span style='background-color: #eee;'></span>
 31 |     | <span style='background-color: #eee;'>    function dSafe() external view returns (address);</span>
 32 |     | <span style='background-color: #eee;'></span>
 33 |     | <span style='background-color: #eee;'>    function getReserves()</span>
 34 |     | <span style='background-color: #eee;'>        external</span>
 35 |     | <span style='background-color: #eee;'>        view</span>
 36 |     | <span style='background-color: #eee;'>        returns (uint112 reserve0, uint112 reserve1, uint32 blockTimestampLast);</span>
 37 |     | <span style='background-color: #eee;'></span>
 38 |     | <span style='background-color: #eee;'>    function price0CumulativeLast() external view returns (uint256);</span>
 39 |     | <span style='background-color: #eee;'></span>
 40 |     | <span style='background-color: #eee;'>    function price1CumulativeLast() external view returns (uint256);</span>
 41 |     | <span style='background-color: #eee;'></span>
 42 |     | <span style='background-color: #eee;'>    function kLast() external view returns (uint256);</span>
 43 |     | <span style='background-color: #eee;'></span>
 44 |     | <span style='background-color: #eee;'>    function mint(address to) external returns (uint256 liquidity);</span>
 45 |     | <span style='background-color: #eee;'></span>
 46 |     | <span style='background-color: #eee;'>    function burn(address to) external returns (uint256 amount0, uint256 amount1);</span>
 47 |     | <span style='background-color: #eee;'></span>
 48 |     | <span style='background-color: #eee;'>    function swap(uint256 amount0Out, uint256 amount1Out, address to, bytes calldata data) external;</span>
 49 |     | <span style='background-color: #eee;'></span>
 50 |     | <span style='background-color: #eee;'>    function skim(address to) external;</span>
 51 |     | <span style='background-color: #eee;'></span>
 52 |     | <span style='background-color: #eee;'>    function sync() external;</span>
 53 |     | <span style='background-color: #eee;'></span>
 54 |     | <span style='background-color: #eee;'>    function initialize(address, address, address) external;</span>
 55 |     | <span style='background-color: #eee;'>}</span>
 56 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/duoswapV2/interfaces/IDuoswapV2Router.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-3.0-or-later</span>
  2 |     | <span style='background-color: #eee;'></span>
  3 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.7;</span>
  4 |     | <span style='background-color: #eee;'></span>
  5 |     | <span style='background-color: #eee;'>import &quot;./IDuoswapV2Router01.sol&quot;;</span>
  6 |     | <span style='background-color: #eee;'></span>
  7 |     | <span style='background-color: #eee;'>interface IDuoswapV2Router is IDuoswapV2Router01 {</span>
  8 |     | <span style='background-color: #eee;'>    event TokensApproved(address sender, uint256 amount, bytes data);</span>
  9 |     | <span style='background-color: #eee;'>    event TokensReceived(address spender, address sender, uint256 amount, bytes data);</span>
 10 |     | <span style='background-color: #eee;'></span>
 11 |     | <span style='background-color: #eee;'>    function swapExactTokensForTokensSupportingFeeOnTransferTokens(</span>
 12 |     | <span style='background-color: #eee;'>        uint256 amountIn,</span>
 13 |     | <span style='background-color: #eee;'>        uint256 amountOutMin,</span>
 14 |     | <span style='background-color: #eee;'>        address[] calldata path,</span>
 15 |     | <span style='background-color: #eee;'>        address to,</span>
 16 |     | <span style='background-color: #eee;'>        uint256 deadline</span>
 17 |     | <span style='background-color: #eee;'>    ) external;</span>
 18 |     | <span style='background-color: #eee;'>}</span>
 19 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/duoswapV2/interfaces/IDuoswapV2Router01.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-3.0-or-later</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.7;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>//solhint-disable func-name-mixedcase</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>interface IDuoswapV2Router01 {</span>
  7 |     | <span style='background-color: #eee;'>    function factory() external view returns (address);</span>
  8 |     | <span style='background-color: #eee;'></span>
  9 |     | <span style='background-color: #eee;'>    function WETH() external view returns (address);</span>
 10 |     | <span style='background-color: #eee;'></span>
 11 |     | <span style='background-color: #eee;'>    function addLiquidity(</span>
 12 |     | <span style='background-color: #eee;'>        address tokenA,</span>
 13 |     | <span style='background-color: #eee;'>        address tokenB,</span>
 14 |     | <span style='background-color: #eee;'>        uint256 amountADesired,</span>
 15 |     | <span style='background-color: #eee;'>        uint256 amountBDesired,</span>
 16 |     | <span style='background-color: #eee;'>        uint256 amountAMin,</span>
 17 |     | <span style='background-color: #eee;'>        uint256 amountBMin,</span>
 18 |     | <span style='background-color: #eee;'>        address to,</span>
 19 |     | <span style='background-color: #eee;'>        uint256 deadline</span>
 20 |     | <span style='background-color: #eee;'>    ) external returns (uint256 amountA, uint256 amountB, uint256 liquidity);</span>
 21 |     | <span style='background-color: #eee;'></span>
 22 |     | <span style='background-color: #eee;'>    function removeLiquidity(</span>
 23 |     | <span style='background-color: #eee;'>        address tokenA,</span>
 24 |     | <span style='background-color: #eee;'>        address tokenB,</span>
 25 |     | <span style='background-color: #eee;'>        uint256 liquidity,</span>
 26 |     | <span style='background-color: #eee;'>        uint256 amountAMin,</span>
 27 |     | <span style='background-color: #eee;'>        uint256 amountBMin,</span>
 28 |     | <span style='background-color: #eee;'>        address to,</span>
 29 |     | <span style='background-color: #eee;'>        uint256 deadline</span>
 30 |     | <span style='background-color: #eee;'>    ) external returns (uint256 amountA, uint256 amountB);</span>
 31 |     | <span style='background-color: #eee;'></span>
 32 |     | <span style='background-color: #eee;'>    function removeLiquidityWithPermit(</span>
 33 |     | <span style='background-color: #eee;'>        address tokenA,</span>
 34 |     | <span style='background-color: #eee;'>        address tokenB,</span>
 35 |     | <span style='background-color: #eee;'>        uint256 liquidity,</span>
 36 |     | <span style='background-color: #eee;'>        uint256 amountAMin,</span>
 37 |     | <span style='background-color: #eee;'>        uint256 amountBMin,</span>
 38 |     | <span style='background-color: #eee;'>        address to,</span>
 39 |     | <span style='background-color: #eee;'>        uint256 deadline,</span>
 40 |     | <span style='background-color: #eee;'>        bool approveMax,</span>
 41 |     | <span style='background-color: #eee;'>        uint8 v,</span>
 42 |     | <span style='background-color: #eee;'>        bytes32 r,</span>
 43 |     | <span style='background-color: #eee;'>        bytes32 s</span>
 44 |     | <span style='background-color: #eee;'>    ) external returns (uint256 amountA, uint256 amountB);</span>
 45 |     | <span style='background-color: #eee;'></span>
 46 |     | <span style='background-color: #eee;'>    function swapExactTokensForTokens(</span>
 47 |     | <span style='background-color: #eee;'>        uint256 amountIn,</span>
 48 |     | <span style='background-color: #eee;'>        uint256 amountOutMin,</span>
 49 |     | <span style='background-color: #eee;'>        address[] calldata path,</span>
 50 |     | <span style='background-color: #eee;'>        address to,</span>
 51 |     | <span style='background-color: #eee;'>        uint256 deadline</span>
 52 |     | <span style='background-color: #eee;'>    ) external returns (uint256[] memory amounts);</span>
 53 |     | <span style='background-color: #eee;'></span>
 54 |     | <span style='background-color: #eee;'>    function swapTokensForExactTokens(</span>
 55 |     | <span style='background-color: #eee;'>        uint256 amountOut,</span>
 56 |     | <span style='background-color: #eee;'>        uint256 amountInMax,</span>
 57 |     | <span style='background-color: #eee;'>        address[] calldata path,</span>
 58 |     | <span style='background-color: #eee;'>        address to,</span>
 59 |     | <span style='background-color: #eee;'>        uint256 deadline</span>
 60 |     | <span style='background-color: #eee;'>    ) external returns (uint256[] memory amounts);</span>
 61 |     | <span style='background-color: #eee;'></span>
 62 |     | <span style='background-color: #eee;'>    function quote(</span>
 63 |     | <span style='background-color: #eee;'>        uint256 amountA,</span>
 64 |     | <span style='background-color: #eee;'>        uint256 reserveA,</span>
 65 |     | <span style='background-color: #eee;'>        uint256 reserveB</span>
 66 |     | <span style='background-color: #eee;'>    ) external pure returns (uint256 amountB);</span>
 67 |     | <span style='background-color: #eee;'></span>
 68 |     | <span style='background-color: #eee;'>    function getAmountOut(</span>
 69 |     | <span style='background-color: #eee;'>        uint256 amountIn,</span>
 70 |     | <span style='background-color: #eee;'>        uint256 reserveIn,</span>
 71 |     | <span style='background-color: #eee;'>        uint256 reserveOut</span>
 72 |     | <span style='background-color: #eee;'>    ) external pure returns (uint256 amountOut);</span>
 73 |     | <span style='background-color: #eee;'></span>
 74 |     | <span style='background-color: #eee;'>    function getAmountIn(</span>
 75 |     | <span style='background-color: #eee;'>        uint256 amountOut,</span>
 76 |     | <span style='background-color: #eee;'>        uint256 reserveIn,</span>
 77 |     | <span style='background-color: #eee;'>        uint256 reserveOut</span>
 78 |     | <span style='background-color: #eee;'>    ) external pure returns (uint256 amountIn);</span>
 79 |     | <span style='background-color: #eee;'></span>
 80 |     | <span style='background-color: #eee;'>    function getAmountsOut(</span>
 81 |     | <span style='background-color: #eee;'>        uint256 amountIn,</span>
 82 |     | <span style='background-color: #eee;'>        address[] calldata path</span>
 83 |     | <span style='background-color: #eee;'>    ) external view returns (uint256[] memory amounts);</span>
 84 |     | <span style='background-color: #eee;'></span>
 85 |     | <span style='background-color: #eee;'>    function getAmountsIn(</span>
 86 |     | <span style='background-color: #eee;'>        uint256 amountOut,</span>
 87 |     | <span style='background-color: #eee;'>        address[] calldata path</span>
 88 |     | <span style='background-color: #eee;'>    ) external view returns (uint256[] memory amounts);</span>
 89 |     | <span style='background-color: #eee;'>}</span>
 90 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/duoswapV2/libraries/DuoswapV2Library.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-3.0-or-later</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.4;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>//solhint-disable reason-string</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>import {IDuoswapV2Pair} from &quot;../interfaces/IDuoswapV2Pair.sol&quot;;</span>
   7 |     | <span style='background-color: #faa;'></span>
   8 |     | <span style='background-color: #eee;'>library DuoswapV2Library {</span>
   9 |     | <span style='background-color: #eee;'>    // returns sorted token addresses, used to handle return values from pairs sorted in this order</span>
  10 |     | <span style='background-color: #faa;'>    function sortTokens(</span>
  11 |     | <span style='background-color: #eee;'>        address tokenA,</span>
  12 |     | <span style='background-color: #eee;'>        address tokenB</span>
  13 |     | <span style='background-color: #eee;'>    ) internal pure returns (address token0, address token1) {</span>
  14 |     | <span style='background-color: #faa;'>        require(tokenA != tokenB, &quot;UniswapV2Library: IDENTICAL_ADDRESSES&quot;);</span>
  15 |     | <span style='background-color: #faa;'>        (token0, token1) = tokenA &lt; tokenB ? (tokenA, tokenB) : (tokenB, tokenA);</span>
  16 |     | <span style='background-color: #faa;'>        require(token0 != address(0), &quot;UniswapV2Library: ZERO_ADDRESS&quot;);</span>
  17 |     | <span style='background-color: #eee;'>    }</span>
  18 |     | <span style='background-color: #eee;'></span>
  19 |     | <span style='background-color: #eee;'>    // calculates the CREATE2 address for a pair without making any external calls</span>
  20 |     | <span style='background-color: #faa;'>    function pairFor(</span>
  21 |     | <span style='background-color: #eee;'>        address factory,</span>
  22 |     | <span style='background-color: #eee;'>        address tokenA,</span>
  23 |     | <span style='background-color: #eee;'>        address tokenB</span>
  24 |     | <span style='background-color: #eee;'>    ) internal pure returns (address pair) {</span>
  25 |     | <span style='background-color: #faa;'>        (address token0, address token1) = sortTokens(tokenA, tokenB);</span>
  26 |     | <span style='background-color: #eee;'>        pair = address(</span>
  27 |     | <span style='background-color: #eee;'>            uint160(</span>
  28 |     | <span style='background-color: #eee;'>                uint256(</span>
  29 |     | <span style='background-color: #faa;'>                    keccak256(</span>
  30 |     | <span style='background-color: #faa;'>                        abi.encodePacked(</span>
  31 |     | <span style='background-color: #eee;'>                            bytes1(0xff),</span>
  32 |     | <span style='background-color: #eee;'>                            factory,</span>
  33 |     | <span style='background-color: #faa;'>                            keccak256(abi.encodePacked(token0, token1)),</span>
  34 |     | <span style='background-color: #eee;'>                            hex&quot;6606d7ddc46633fe75181c4673be2eb17f1a8360674e23ec54231cec1e5077c6&quot; // NOTE: need to replace with actual init code hash every time the pair code is updated</span>
  35 |     | <span style='background-color: #eee;'>                        )</span>
  36 |     | <span style='background-color: #eee;'>                    )</span>
  37 |     | <span style='background-color: #eee;'>                )</span>
  38 |     | <span style='background-color: #eee;'>            )</span>
  39 |     | <span style='background-color: #eee;'>        );</span>
  40 |     | <span style='background-color: #eee;'>    }</span>
  41 |     | <span style='background-color: #eee;'></span>
  42 |     | <span style='background-color: #eee;'>    // fetches and sorts the reserves for a pair</span>
  43 |     | <span style='background-color: #faa;'>    function getReserves(</span>
  44 |     | <span style='background-color: #eee;'>        address factory,</span>
  45 |     | <span style='background-color: #eee;'>        address tokenA,</span>
  46 |     | <span style='background-color: #eee;'>        address tokenB</span>
  47 |     | <span style='background-color: #eee;'>    ) internal view returns (uint256 reserveA, uint256 reserveB) {</span>
  48 |     | <span style='background-color: #faa;'>        (address token0, ) = sortTokens(tokenA, tokenB);</span>
  49 |     | <span style='background-color: #faa;'>        (uint256 reserve0, uint256 reserve1, ) = IDuoswapV2Pair(pairFor(factory, tokenA, tokenB))</span>
  50 |     | <span style='background-color: #eee;'>            .getReserves();</span>
  51 |     | <span style='background-color: #faa;'>        (reserveA, reserveB) = tokenA == token0 ? (reserve0, reserve1) : (reserve1, reserve0);</span>
  52 |     | <span style='background-color: #eee;'>    }</span>
  53 |     | <span style='background-color: #eee;'></span>
  54 |     | <span style='background-color: #eee;'>    // given some amount of an asset and pair reserves, returns an equivalent amount of the other asset</span>
  55 |     | <span style='background-color: #faa;'>    function quote(</span>
  56 |     | <span style='background-color: #eee;'>        uint256 amountA,</span>
  57 |     | <span style='background-color: #eee;'>        uint256 reserveA,</span>
  58 |     | <span style='background-color: #eee;'>        uint256 reserveB</span>
  59 |     | <span style='background-color: #eee;'>    ) internal pure returns (uint256 amountB) {</span>
  60 |     | <span style='background-color: #faa;'>        require(amountA &gt; 0, &quot;UniswapV2Library: INSUFFICIENT_AMOUNT&quot;);</span>
  61 |     | <span style='background-color: #faa;'>        require(reserveA &gt; 0 &amp;&amp; reserveB &gt; 0, &quot;UniswapV2Library: INSUFFICIENT_LIQUIDITY&quot;);</span>
  62 |     | <span style='background-color: #faa;'>        amountB = (amountA * reserveB) / reserveA;</span>
  63 |     | <span style='background-color: #eee;'>    }</span>
  64 |     | <span style='background-color: #eee;'></span>
  65 |     | <span style='background-color: #eee;'>    // given an input amount of an asset and pair reserves, returns the maximum output amount of the other asset</span>
  66 |     | <span style='background-color: #faa;'>    function getAmountOut(</span>
  67 |     | <span style='background-color: #eee;'>        uint256 amountIn,</span>
  68 |     | <span style='background-color: #eee;'>        uint256 reserveIn,</span>
  69 |     | <span style='background-color: #eee;'>        uint256 reserveOut</span>
  70 |     | <span style='background-color: #eee;'>    ) internal pure returns (uint256 amountOut) {</span>
  71 |     | <span style='background-color: #faa;'>        require(amountIn &gt; 0, &quot;UniswapV2Library: INSUFFICIENT_INPUT_AMOUNT&quot;);</span>
  72 |     | <span style='background-color: #faa;'>        require(reserveIn &gt; 0 &amp;&amp; reserveOut &gt; 0, &quot;UniswapV2Library: INSUFFICIENT_LIQUIDITY&quot;);</span>
  73 |     | <span style='background-color: #faa;'>        uint256 amountInWithFee = amountIn * 997;</span>
  74 |     | <span style='background-color: #faa;'>        uint256 numerator = amountInWithFee * reserveOut;</span>
  75 |     | <span style='background-color: #faa;'>        uint256 denominator = reserveIn * 1000 + amountInWithFee;</span>
  76 |     | <span style='background-color: #faa;'>        amountOut = numerator / denominator;</span>
  77 |     | <span style='background-color: #eee;'>    }</span>
  78 |     | <span style='background-color: #eee;'></span>
  79 |     | <span style='background-color: #eee;'>    // given an output amount of an asset and pair reserves, returns a required input amount of the other asset</span>
  80 |     | <span style='background-color: #faa;'>    function getAmountIn(</span>
  81 |     | <span style='background-color: #eee;'>        uint256 amountOut,</span>
  82 |     | <span style='background-color: #eee;'>        uint256 reserveIn,</span>
  83 |     | <span style='background-color: #eee;'>        uint256 reserveOut</span>
  84 |     | <span style='background-color: #eee;'>    ) internal pure returns (uint256 amountIn) {</span>
  85 |     | <span style='background-color: #faa;'>        require(amountOut &gt; 0, &quot;UniswapV2Library: INSUFFICIENT_OUTPUT_AMOUNT&quot;);</span>
  86 |     | <span style='background-color: #faa;'>        require(reserveIn &gt; 0 &amp;&amp; reserveOut &gt; 0, &quot;UniswapV2Library: INSUFFICIENT_LIQUIDITY&quot;);</span>
  87 |     | <span style='background-color: #faa;'>        uint256 numerator = reserveIn * amountOut * 1000;</span>
  88 |     | <span style='background-color: #faa;'>        uint256 denominator = (reserveOut - amountOut) * 997;</span>
  89 |     | <span style='background-color: #faa;'>        amountIn = numerator / denominator + 1;</span>
  90 |     | <span style='background-color: #eee;'>    }</span>
  91 |     | <span style='background-color: #eee;'></span>
  92 |     | <span style='background-color: #eee;'>    // performs chained getAmountOut calculations on any number of pairs</span>
  93 |     | <span style='background-color: #faa;'>    function getAmountsOut(</span>
  94 |     | <span style='background-color: #eee;'>        address factory,</span>
  95 |     | <span style='background-color: #eee;'>        uint256 amountIn,</span>
  96 |     | <span style='background-color: #eee;'>        address[] memory path</span>
  97 |     | <span style='background-color: #eee;'>    ) internal view returns (uint256[] memory amounts) {</span>
  98 |     | <span style='background-color: #faa;'>        require(path.length &gt;= 2, &quot;UniswapV2Library: INVALID_PATH&quot;);</span>
  99 |     | <span style='background-color: #faa;'>        amounts = new uint256[](path.length);</span>
 100 |     | <span style='background-color: #eee;'>        amounts[0] = amountIn;</span>
 101 |     | <span style='background-color: #eee;'></span>
 102 |     | <span style='background-color: #faa;'>        for (uint256 i; i &lt; path.length - 1; i++) {</span>
 103 |     | <span style='background-color: #faa;'>            (uint256 reserveIn, uint256 reserveOut) = getReserves(factory, path[i], path[i + 1]);</span>
 104 |     | <span style='background-color: #faa;'>            amounts[i + 1] = getAmountOut(amounts[i], reserveIn, reserveOut);</span>
 105 |     | <span style='background-color: #eee;'>        }</span>
 106 |     | <span style='background-color: #eee;'>    }</span>
 107 |     | <span style='background-color: #eee;'></span>
 108 |     | <span style='background-color: #eee;'>    // performs chained getAmountIn calculations on any number of pairs</span>
 109 |     | <span style='background-color: #faa;'>    function getAmountsIn(</span>
 110 |     | <span style='background-color: #eee;'>        address factory,</span>
 111 |     | <span style='background-color: #eee;'>        uint256 amountOut,</span>
 112 |     | <span style='background-color: #eee;'>        address[] memory path</span>
 113 |     | <span style='background-color: #eee;'>    ) internal view returns (uint256[] memory amounts) {</span>
 114 |     | <span style='background-color: #faa;'>        require(path.length &gt;= 2, &quot;UniswapV2Library: INVALID_PATH&quot;);</span>
 115 |     | <span style='background-color: #faa;'>        amounts = new uint256[](path.length);</span>
 116 |     | <span style='background-color: #faa;'>        amounts[amounts.length - 1] = amountOut;</span>
 117 |     | <span style='background-color: #faa;'>        for (uint256 i = path.length - 1; i &gt; 0; i--) {</span>
 118 |     | <span style='background-color: #faa;'>            (uint256 reserveIn, uint256 reserveOut) = getReserves(factory, path[i - 1], path[i]);</span>
 119 |     | <span style='background-color: #faa;'>            amounts[i - 1] = getAmountIn(amounts[i], reserveIn, reserveOut);</span>
 120 |     | <span style='background-color: #eee;'>        }</span>
 121 |     | <span style='background-color: #eee;'>    }</span>
 122 |     | <span style='background-color: #eee;'>}</span>
 123 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/duoswapV2/libraries/Math.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.5.16;</span>
  2 |     | <span style='background-color: #eee;'></span>
  3 |     | <span style='background-color: #eee;'>// a library for performing various math operations</span>
  4 |     | <span style='background-color: #faa;'></span>
  5 |     | <span style='background-color: #eee;'>library Math {</span>
  6 |     | <span style='background-color: #eee;'>    function min(uint x, uint y) internal pure returns (uint z) {</span>
  7 |     | <span style='background-color: #faa;'>        z = x &lt; y ? x : y;</span>
  8 |     | <span style='background-color: #eee;'>    }</span>
  9 |     | <span style='background-color: #eee;'></span>
 10 |     | <span style='background-color: #eee;'>    // babylonian method (https://en.wikipedia.org/wiki/Methods_of_computing_square_roots#Babylonian_method)</span>
 11 |     | <span style='background-color: #faa;'>    function sqrt(uint y) internal pure returns (uint z) {</span>
 12 |     | <span style='background-color: #faa;'>        if (y &gt; 3) {</span>
 13 |     | <span style='background-color: #faa;'>            z = y;</span>
 14 |     | <span style='background-color: #faa;'>            uint x = y / 2 + 1;</span>
 15 |     | <span style='background-color: #faa;'>            while (x &lt; z) {</span>
 16 |     | <span style='background-color: #faa;'>                z = x;</span>
 17 |     | <span style='background-color: #faa;'>                x = (y / x + x) / 2;</span>
 18 |     | <span style='background-color: #eee;'>            }</span>
 19 |     | <span style='background-color: #faa;'>        } else if (y != 0) {</span>
 20 |     | <span style='background-color: #faa;'>            z = 1;</span>
 21 |     | <span style='background-color: #eee;'>        }</span>
 22 |     | <span style='background-color: #eee;'>    }</span>
 23 |     | <span style='background-color: #eee;'>}</span>
 24 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/duoswapV2/libraries/UQ112x112.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.5.16;</span>
  2 |     | <span style='background-color: #eee;'></span>
  3 |     | <span style='background-color: #eee;'>// a library for handling binary fixed point numbers (https://en.wikipedia.org/wiki/Q_(number_format))</span>
  4 |     | <span style='background-color: #eee;'></span>
  5 |     | <span style='background-color: #eee;'>// range: [0, 2**112 - 1]</span>
  6 |     | <span style='background-color: #eee;'>// resolution: 1 / 2**112</span>
  7 |     | <span style='background-color: #faa;'></span>
  8 |     | <span style='background-color: #eee;'>library UQ112x112 {</span>
  9 |     | <span style='background-color: #faa;'>    uint224 constant Q112 = 2 ** 112;</span>
 10 |     | <span style='background-color: #eee;'></span>
 11 |     | <span style='background-color: #eee;'>    // encode a uint112 as a UQ112x112</span>
 12 |     | <span style='background-color: #faa;'>    function encode(uint112 y) internal pure returns (uint224 z) {</span>
 13 |     | <span style='background-color: #eee;'>        z = uint224(y) * Q112; // never overflows</span>
 14 |     | <span style='background-color: #eee;'>    }</span>
 15 |     | <span style='background-color: #eee;'></span>
 16 |     | <span style='background-color: #eee;'>    // divide a UQ112x112 by a uint112, returning a UQ112x112</span>
 17 |     | <span style='background-color: #faa;'>    function uqdiv(uint224 x, uint112 y) internal pure returns (uint224 z) {</span>
 18 |     | <span style='background-color: #eee;'>        z = x / uint224(y);</span>
 19 |     | <span style='background-color: #eee;'>    }</span>
 20 |     | <span style='background-color: #eee;'>}</span>
 21 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/external/interfaces/IAnyswapCreate2Deployer.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>interface IAnyswapCreate2Deployer {</span>
  5 |     | <span style='background-color: #eee;'>    event Deployed(address addr, uint256 salt);</span>
  6 |     | <span style='background-color: #eee;'></span>
  7 |     | <span style='background-color: #eee;'>    function deploy(bytes memory code, uint256 salt) external;</span>
  8 |     | <span style='background-color: #eee;'>}</span>
  9 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/external/interfaces/INonfungiblePositionManager.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// All this file is taken from @uniswap/v3-periphery/contracts/interfaces/INonfungiblePositionManager.sol</span>
   2 |     | <span style='background-color: #eee;'>// Commented out the code that is not compatible with owr OpenZeppelin version.</span>
   3 |     | <span style='background-color: #eee;'>// So the rest may be used to create an interface for a deployed instance of this contract</span>
   4 |     | <span style='background-color: #eee;'></span>
   5 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: GPL-2.0-or-later</span>
   6 |     | <span style='background-color: #eee;'>pragma solidity &gt;=0.7.5;</span>
   7 |     | <span style='background-color: #eee;'>pragma abicoder v2;</span>
   8 |     | <span style='background-color: #eee;'></span>
   9 |     | <span style='background-color: #eee;'>//import &#39;@openzeppelin/contracts/token/ERC721/IERC721Metadata.sol&#39;;</span>
  10 |     | <span style='background-color: #eee;'>//import &#39;@openzeppelin/contracts/token/ERC721/IERC721Enumerable.sol&#39;;</span>
  11 |     | <span style='background-color: #eee;'></span>
  12 |     | <span style='background-color: #eee;'>//import &#39;./IPoolInitializer.sol&#39;;</span>
  13 |     | <span style='background-color: #eee;'>//import &#39;./IERC721Permit.sol&#39;;</span>
  14 |     | <span style='background-color: #eee;'>//import &#39;./IPeripheryPayments.sol&#39;;</span>
  15 |     | <span style='background-color: #eee;'>//import &#39;./IPeripheryImmutableState.sol&#39;;</span>
  16 |     | <span style='background-color: #eee;'>//import &#39;../libraries/PoolAddress.sol&#39;;</span>
  17 |     | <span style='background-color: #eee;'></span>
  18 |     | <span style='background-color: #eee;'>/// @title Non-fungible token for positions</span>
  19 |     | <span style='background-color: #eee;'>/// @notice Wraps Uniswap V3 positions in a non-fungible token interface which allows for them to be transferred</span>
  20 |     | <span style='background-color: #eee;'>/// and authorized.</span>
  21 |     | <span style='background-color: #eee;'>//is</span>
  22 |     | <span style='background-color: #eee;'>//IPoolInitializer,</span>
  23 |     | <span style='background-color: #eee;'>//IPeripheryPayments,</span>
  24 |     | <span style='background-color: #eee;'>//IPeripheryImmutableState,</span>
  25 |     | <span style='background-color: #eee;'>//IERC721Metadata,</span>
  26 |     | <span style='background-color: #eee;'>//IERC721Enumerable,</span>
  27 |     | <span style='background-color: #eee;'>//IERC721Permit</span>
  28 |     | <span style='background-color: #eee;'>interface INonfungiblePositionManager {</span>
  29 |     | <span style='background-color: #eee;'>    /// @notice Emitted when liquidity is increased for a position NFT</span>
  30 |     | <span style='background-color: #eee;'>    /// @dev Also emitted when a token is minted</span>
  31 |     | <span style='background-color: #eee;'>    /// @param tokenId The ID of the token for which liquidity was increased</span>
  32 |     | <span style='background-color: #eee;'>    /// @param liquidity The amount by which liquidity for the NFT position was increased</span>
  33 |     | <span style='background-color: #eee;'>    /// @param amount0 The amount of token0 that was paid for the increase in liquidity</span>
  34 |     | <span style='background-color: #eee;'>    /// @param amount1 The amount of token1 that was paid for the increase in liquidity</span>
  35 |     | <span style='background-color: #eee;'>    event IncreaseLiquidity(</span>
  36 |     | <span style='background-color: #eee;'>        uint256 indexed tokenId,</span>
  37 |     | <span style='background-color: #eee;'>        uint128 liquidity,</span>
  38 |     | <span style='background-color: #eee;'>        uint256 amount0,</span>
  39 |     | <span style='background-color: #eee;'>        uint256 amount1</span>
  40 |     | <span style='background-color: #eee;'>    );</span>
  41 |     | <span style='background-color: #eee;'>    /// @notice Emitted when liquidity is decreased for a position NFT</span>
  42 |     | <span style='background-color: #eee;'>    /// @param tokenId The ID of the token for which liquidity was decreased</span>
  43 |     | <span style='background-color: #eee;'>    /// @param liquidity The amount by which liquidity for the NFT position was decreased</span>
  44 |     | <span style='background-color: #eee;'>    /// @param amount0 The amount of token0 that was accounted for the decrease in liquidity</span>
  45 |     | <span style='background-color: #eee;'>    /// @param amount1 The amount of token1 that was accounted for the decrease in liquidity</span>
  46 |     | <span style='background-color: #eee;'>    event DecreaseLiquidity(</span>
  47 |     | <span style='background-color: #eee;'>        uint256 indexed tokenId,</span>
  48 |     | <span style='background-color: #eee;'>        uint128 liquidity,</span>
  49 |     | <span style='background-color: #eee;'>        uint256 amount0,</span>
  50 |     | <span style='background-color: #eee;'>        uint256 amount1</span>
  51 |     | <span style='background-color: #eee;'>    );</span>
  52 |     | <span style='background-color: #eee;'>    /// @notice Emitted when tokens are collected for a position NFT</span>
  53 |     | <span style='background-color: #eee;'>    /// @dev The amounts reported may not be exactly equivalent to the amounts transferred, due to rounding behavior</span>
  54 |     | <span style='background-color: #eee;'>    /// @param tokenId The ID of the token for which underlying tokens were collected</span>
  55 |     | <span style='background-color: #eee;'>    /// @param recipient The address of the account that received the collected tokens</span>
  56 |     | <span style='background-color: #eee;'>    /// @param amount0 The amount of token0 owed to the position that was collected</span>
  57 |     | <span style='background-color: #eee;'>    /// @param amount1 The amount of token1 owed to the position that was collected</span>
  58 |     | <span style='background-color: #eee;'>    event Collect(uint256 indexed tokenId, address recipient, uint256 amount0, uint256 amount1);</span>
  59 |     | <span style='background-color: #eee;'></span>
  60 |     | <span style='background-color: #eee;'>    /// @notice Returns the position information associated with a given token ID.</span>
  61 |     | <span style='background-color: #eee;'>    /// @dev Throws if the token ID is not valid.</span>
  62 |     | <span style='background-color: #eee;'>    /// @param tokenId The ID of the token that represents the position</span>
  63 |     | <span style='background-color: #eee;'>    /// @return nonce The nonce for permits</span>
  64 |     | <span style='background-color: #eee;'>    /// @return operator The address that is approved for spending</span>
  65 |     | <span style='background-color: #eee;'>    /// @return token0 The address of the token0 for a specific pool</span>
  66 |     | <span style='background-color: #eee;'>    /// @return token1 The address of the token1 for a specific pool</span>
  67 |     | <span style='background-color: #eee;'>    /// @return fee The fee associated with the pool</span>
  68 |     | <span style='background-color: #eee;'>    /// @return tickLower The lower end of the tick range for the position</span>
  69 |     | <span style='background-color: #eee;'>    /// @return tickUpper The higher end of the tick range for the position</span>
  70 |     | <span style='background-color: #eee;'>    /// @return liquidity The liquidity of the position</span>
  71 |     | <span style='background-color: #eee;'>    /// @return feeGrowthInside0LastX128 The fee growth of token0 as of the last action on the individual position</span>
  72 |     | <span style='background-color: #eee;'>    /// @return feeGrowthInside1LastX128 The fee growth of token1 as of the last action on the individual position</span>
  73 |     | <span style='background-color: #eee;'>    /// @return tokensOwed0 The uncollected amount of token0 owed to the position as of the last computation</span>
  74 |     | <span style='background-color: #eee;'>    /// @return tokensOwed1 The uncollected amount of token1 owed to the position as of the last computation</span>
  75 |     | <span style='background-color: #eee;'>    function positions(</span>
  76 |     | <span style='background-color: #eee;'>        uint256 tokenId</span>
  77 |     | <span style='background-color: #eee;'>    )</span>
  78 |     | <span style='background-color: #eee;'>        external</span>
  79 |     | <span style='background-color: #eee;'>        view</span>
  80 |     | <span style='background-color: #eee;'>        returns (</span>
  81 |     | <span style='background-color: #eee;'>            uint96 nonce,</span>
  82 |     | <span style='background-color: #eee;'>            address operator,</span>
  83 |     | <span style='background-color: #eee;'>            address token0,</span>
  84 |     | <span style='background-color: #eee;'>            address token1,</span>
  85 |     | <span style='background-color: #eee;'>            uint24 fee,</span>
  86 |     | <span style='background-color: #eee;'>            int24 tickLower,</span>
  87 |     | <span style='background-color: #eee;'>            int24 tickUpper,</span>
  88 |     | <span style='background-color: #eee;'>            uint128 liquidity,</span>
  89 |     | <span style='background-color: #eee;'>            uint256 feeGrowthInside0LastX128,</span>
  90 |     | <span style='background-color: #eee;'>            uint256 feeGrowthInside1LastX128,</span>
  91 |     | <span style='background-color: #eee;'>            uint128 tokensOwed0,</span>
  92 |     | <span style='background-color: #eee;'>            uint128 tokensOwed1</span>
  93 |     | <span style='background-color: #eee;'>        );</span>
  94 |     | <span style='background-color: #eee;'></span>
  95 |     | <span style='background-color: #eee;'>    struct MintParams {</span>
  96 |     | <span style='background-color: #eee;'>        address token0;</span>
  97 |     | <span style='background-color: #eee;'>        address token1;</span>
  98 |     | <span style='background-color: #eee;'>        uint24 fee;</span>
  99 |     | <span style='background-color: #eee;'>        int24 tickLower;</span>
 100 |     | <span style='background-color: #eee;'>        int24 tickUpper;</span>
 101 |     | <span style='background-color: #eee;'>        uint256 amount0Desired;</span>
 102 |     | <span style='background-color: #eee;'>        uint256 amount1Desired;</span>
 103 |     | <span style='background-color: #eee;'>        uint256 amount0Min;</span>
 104 |     | <span style='background-color: #eee;'>        uint256 amount1Min;</span>
 105 |     | <span style='background-color: #eee;'>        address recipient;</span>
 106 |     | <span style='background-color: #eee;'>        uint256 deadline;</span>
 107 |     | <span style='background-color: #eee;'>    }</span>
 108 |     | <span style='background-color: #eee;'></span>
 109 |     | <span style='background-color: #eee;'>    /// @notice Creates a new position wrapped in a NFT</span>
 110 |     | <span style='background-color: #eee;'>    /// @dev Call this when the pool does exist and is initialized. Note that if the pool is created but not initialized</span>
 111 |     | <span style='background-color: #eee;'>    /// a method does not exist, i.e. the pool is assumed to be initialized.</span>
 112 |     | <span style='background-color: #eee;'>    /// @param params The params necessary to mint a position, encoded as `MintParams` in calldata</span>
 113 |     | <span style='background-color: #eee;'>    /// @return tokenId The ID of the token that represents the minted position</span>
 114 |     | <span style='background-color: #eee;'>    /// @return liquidity The amount of liquidity for this position</span>
 115 |     | <span style='background-color: #eee;'>    /// @return amount0 The amount of token0</span>
 116 |     | <span style='background-color: #eee;'>    /// @return amount1 The amount of token1</span>
 117 |     | <span style='background-color: #eee;'>    function mint(</span>
 118 |     | <span style='background-color: #eee;'>        MintParams calldata params</span>
 119 |     | <span style='background-color: #eee;'>    )</span>
 120 |     | <span style='background-color: #eee;'>        external</span>
 121 |     | <span style='background-color: #eee;'>        payable</span>
 122 |     | <span style='background-color: #eee;'>        returns (uint256 tokenId, uint128 liquidity, uint256 amount0, uint256 amount1);</span>
 123 |     | <span style='background-color: #eee;'></span>
 124 |     | <span style='background-color: #eee;'>    struct IncreaseLiquidityParams {</span>
 125 |     | <span style='background-color: #eee;'>        uint256 tokenId;</span>
 126 |     | <span style='background-color: #eee;'>        uint256 amount0Desired;</span>
 127 |     | <span style='background-color: #eee;'>        uint256 amount1Desired;</span>
 128 |     | <span style='background-color: #eee;'>        uint256 amount0Min;</span>
 129 |     | <span style='background-color: #eee;'>        uint256 amount1Min;</span>
 130 |     | <span style='background-color: #eee;'>        uint256 deadline;</span>
 131 |     | <span style='background-color: #eee;'>    }</span>
 132 |     | <span style='background-color: #eee;'></span>
 133 |     | <span style='background-color: #eee;'>    /// @notice Increases the amount of liquidity in a position, with tokens paid by the `msg.sender`</span>
 134 |     | <span style='background-color: #eee;'>    /// @param params tokenId The ID of the token for which liquidity is being increased,</span>
 135 |     | <span style='background-color: #eee;'>    /// amount0Desired The desired amount of token0 to be spent,</span>
 136 |     | <span style='background-color: #eee;'>    /// amount1Desired The desired amount of token1 to be spent,</span>
 137 |     | <span style='background-color: #eee;'>    /// amount0Min The minimum amount of token0 to spend, which serves as a slippage check,</span>
 138 |     | <span style='background-color: #eee;'>    /// amount1Min The minimum amount of token1 to spend, which serves as a slippage check,</span>
 139 |     | <span style='background-color: #eee;'>    /// deadline The time by which the transaction must be included to effect the change</span>
 140 |     | <span style='background-color: #eee;'>    /// @return liquidity The new liquidity amount as a result of the increase</span>
 141 |     | <span style='background-color: #eee;'>    /// @return amount0 The amount of token0 to acheive resulting liquidity</span>
 142 |     | <span style='background-color: #eee;'>    /// @return amount1 The amount of token1 to acheive resulting liquidity</span>
 143 |     | <span style='background-color: #eee;'>    function increaseLiquidity(</span>
 144 |     | <span style='background-color: #eee;'>        IncreaseLiquidityParams calldata params</span>
 145 |     | <span style='background-color: #eee;'>    ) external payable returns (uint128 liquidity, uint256 amount0, uint256 amount1);</span>
 146 |     | <span style='background-color: #eee;'></span>
 147 |     | <span style='background-color: #eee;'>    struct DecreaseLiquidityParams {</span>
 148 |     | <span style='background-color: #eee;'>        uint256 tokenId;</span>
 149 |     | <span style='background-color: #eee;'>        uint128 liquidity;</span>
 150 |     | <span style='background-color: #eee;'>        uint256 amount0Min;</span>
 151 |     | <span style='background-color: #eee;'>        uint256 amount1Min;</span>
 152 |     | <span style='background-color: #eee;'>        uint256 deadline;</span>
 153 |     | <span style='background-color: #eee;'>    }</span>
 154 |     | <span style='background-color: #eee;'></span>
 155 |     | <span style='background-color: #eee;'>    /// @notice Decreases the amount of liquidity in a position and accounts it to the position</span>
 156 |     | <span style='background-color: #eee;'>    /// @param params tokenId The ID of the token for which liquidity is being decreased,</span>
 157 |     | <span style='background-color: #eee;'>    /// amount The amount by which liquidity will be decreased,</span>
 158 |     | <span style='background-color: #eee;'>    /// amount0Min The minimum amount of token0 that should be accounted for the burned liquidity,</span>
 159 |     | <span style='background-color: #eee;'>    /// amount1Min The minimum amount of token1 that should be accounted for the burned liquidity,</span>
 160 |     | <span style='background-color: #eee;'>    /// deadline The time by which the transaction must be included to effect the change</span>
 161 |     | <span style='background-color: #eee;'>    /// @return amount0 The amount of token0 accounted to the position&#39;s tokens owed</span>
 162 |     | <span style='background-color: #eee;'>    /// @return amount1 The amount of token1 accounted to the position&#39;s tokens owed</span>
 163 |     | <span style='background-color: #eee;'>    function decreaseLiquidity(</span>
 164 |     | <span style='background-color: #eee;'>        DecreaseLiquidityParams calldata params</span>
 165 |     | <span style='background-color: #eee;'>    ) external payable returns (uint256 amount0, uint256 amount1);</span>
 166 |     | <span style='background-color: #eee;'></span>
 167 |     | <span style='background-color: #eee;'>    struct CollectParams {</span>
 168 |     | <span style='background-color: #eee;'>        uint256 tokenId;</span>
 169 |     | <span style='background-color: #eee;'>        address recipient;</span>
 170 |     | <span style='background-color: #eee;'>        uint128 amount0Max;</span>
 171 |     | <span style='background-color: #eee;'>        uint128 amount1Max;</span>
 172 |     | <span style='background-color: #eee;'>    }</span>
 173 |     | <span style='background-color: #eee;'></span>
 174 |     | <span style='background-color: #eee;'>    /// @notice Collects up to a maximum amount of fees owed to a specific position to the recipient</span>
 175 |     | <span style='background-color: #eee;'>    /// @param params tokenId The ID of the NFT for which tokens are being collected,</span>
 176 |     | <span style='background-color: #eee;'>    /// recipient The account that should receive the tokens,</span>
 177 |     | <span style='background-color: #eee;'>    /// amount0Max The maximum amount of token0 to collect,</span>
 178 |     | <span style='background-color: #eee;'>    /// amount1Max The maximum amount of token1 to collect</span>
 179 |     | <span style='background-color: #eee;'>    /// @return amount0 The amount of fees collected in token0</span>
 180 |     | <span style='background-color: #eee;'>    /// @return amount1 The amount of fees collected in token1</span>
 181 |     | <span style='background-color: #eee;'>    function collect(</span>
 182 |     | <span style='background-color: #eee;'>        CollectParams calldata params</span>
 183 |     | <span style='background-color: #eee;'>    ) external payable returns (uint256 amount0, uint256 amount1);</span>
 184 |     | <span style='background-color: #eee;'></span>
 185 |     | <span style='background-color: #eee;'>    /// @notice Burns a token ID, which deletes it from the NFT contract. The token must have 0 liquidity and all tokens</span>
 186 |     | <span style='background-color: #eee;'>    /// must be collected first.</span>
 187 |     | <span style='background-color: #eee;'>    /// @param tokenId The ID of the token that is being burned</span>
 188 |     | <span style='background-color: #eee;'>    function burn(uint256 tokenId) external payable;</span>
 189 |     | <span style='background-color: #eee;'>}</span>
 190 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/external/interfaces/IPermit2.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>// Minimal Permit2 interface, derived from</span>
  7 |     | <span style='background-color: #eee;'>// https://github.com/Uniswap/permit2/blob/main/src/interfaces/ISignatureTransfer.sol</span>
  8 |     | <span style='background-color: #eee;'>interface IPermit2 {</span>
  9 |     | <span style='background-color: #eee;'>    // Token and amount in a permit message.</span>
 10 |     | <span style='background-color: #eee;'>    struct TokenPermissions {</span>
 11 |     | <span style='background-color: #eee;'>        // Token to transfer.</span>
 12 |     | <span style='background-color: #eee;'>        IERC20 token;</span>
 13 |     | <span style='background-color: #eee;'>        // Amount to transfer.</span>
 14 |     | <span style='background-color: #eee;'>        uint256 amount;</span>
 15 |     | <span style='background-color: #eee;'>    }</span>
 16 |     | <span style='background-color: #eee;'></span>
 17 |     | <span style='background-color: #eee;'>    // The permit2 message.</span>
 18 |     | <span style='background-color: #eee;'>    struct PermitTransferFrom {</span>
 19 |     | <span style='background-color: #eee;'>        // Permitted token and amount.</span>
 20 |     | <span style='background-color: #eee;'>        TokenPermissions permitted;</span>
 21 |     | <span style='background-color: #eee;'>        // Unique identifier for this permit.</span>
 22 |     | <span style='background-color: #eee;'>        uint256 nonce;</span>
 23 |     | <span style='background-color: #eee;'>        // Expiration for this permit.</span>
 24 |     | <span style='background-color: #eee;'>        uint256 deadline;</span>
 25 |     | <span style='background-color: #eee;'>    }</span>
 26 |     | <span style='background-color: #eee;'></span>
 27 |     | <span style='background-color: #eee;'>    // Transfer details for permitTransferFrom().</span>
 28 |     | <span style='background-color: #eee;'>    struct SignatureTransferDetails {</span>
 29 |     | <span style='background-color: #eee;'>        // Recipient of tokens.</span>
 30 |     | <span style='background-color: #eee;'>        address to;</span>
 31 |     | <span style='background-color: #eee;'>        // Amount to transfer.</span>
 32 |     | <span style='background-color: #eee;'>        uint256 requestedAmount;</span>
 33 |     | <span style='background-color: #eee;'>    }</span>
 34 |     | <span style='background-color: #eee;'></span>
 35 |     | <span style='background-color: #eee;'>    // Consume a permit2 message and transfer tokens.</span>
 36 |     | <span style='background-color: #eee;'>    function permitTransferFrom(</span>
 37 |     | <span style='background-color: #eee;'>        PermitTransferFrom calldata permit,</span>
 38 |     | <span style='background-color: #eee;'>        SignatureTransferDetails calldata transferDetails,</span>
 39 |     | <span style='background-color: #eee;'>        address owner,</span>
 40 |     | <span style='background-color: #eee;'>        bytes calldata signature</span>
 41 |     | <span style='background-color: #eee;'>    ) external;</span>
 42 |     | <span style='background-color: #eee;'>}</span>
 43 |     | <span style='background-color: #eee;'></span>
 44 |     | <span style='background-color: #eee;'>// https://docs.uniswap.org/contracts/permit2/overview</span>
 45 |     | <span style='background-color: #eee;'>// https://etherscan.io/address/0x000000000022D473030F116dDEE9F6B43aC78BA3#code</span>
 46 |     | <span style='background-color: #faa;'>IPermit2 constant PERMIT2 = IPermit2(0x000000000022D473030F116dDEE9F6B43aC78BA3);</span>
 47 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/external/interfaces/IWETH9.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol&quot;;</span>
  6 |     | <span style='background-color: #eee;'></span>
  7 |     | <span style='background-color: #eee;'>interface IERC20WithMetadata is IERC20, IERC20Metadata {}</span>
  8 |     | <span style='background-color: #eee;'></span>
  9 |     | <span style='background-color: #eee;'>interface IWETH9 is IERC20WithMetadata {</span>
 10 |     | <span style='background-color: #eee;'>    receive() external payable;</span>
 11 |     | <span style='background-color: #eee;'></span>
 12 |     | <span style='background-color: #eee;'>    function deposit() external payable;</span>
 13 |     | <span style='background-color: #eee;'></span>
 14 |     | <span style='background-color: #eee;'>    function withdraw(uint256 wad) external;</span>
 15 |     | <span style='background-color: #eee;'>}</span>
 16 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/governance/GovernanceProxy.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span>
   5 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC1155/utils/ERC1155Receiver.sol&quot;;</span>
   6 |     | <span style='background-color: #eee;'>import &quot;../lib/FsUtils.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'>import &quot;../lib/ImmutableGovernance.sol&quot;;</span>
   8 |     | <span style='background-color: #eee;'>import &quot;../lib/AccessControl.sol&quot;;</span>
   9 |     | <span style='background-color: #eee;'>import &quot;../tokens/HashNFT.sol&quot;;</span>
  10 |     | <span style='background-color: #eee;'>import &quot;../lib/Call.sol&quot;;</span>
  11 |     | <span style='background-color: #eee;'></span>
  12 |     | <span style='background-color: #eee;'>// This is a proxy contract representing governance. This allows a fixed</span>
  13 |     | <span style='background-color: #eee;'>// ethereum address to be the indefinite owner of the system. This works</span>
  14 |     | <span style='background-color: #eee;'>// nicely with ImmutableGovernance allowing owner to be stored in contract</span>
  15 |     | <span style='background-color: #eee;'>// code instead of storage. Note that a governance account only has to</span>
  16 |     | <span style='background-color: #eee;'>// interact with the &quot;execute&quot; method. Proposing new governance or accepting</span>
  17 |     | <span style='background-color: #eee;'>// governance is done through calls to &quot;execute&quot;, simplifying voting</span>
  18 |     | <span style='background-color: #faa;'>// contracts that govern this proxy.</span>
  19 |     | <span style='background-color: #eee;'>contract GovernanceProxy {</span>
  20 |     | <span style='background-color: #eee;'>    using Address for address;</span>
  21 |     | <span style='background-color: #eee;'></span>
  22 |     | <span style='background-color: #eee;'>    // This address controls the proxy and is allowed to execute</span>
  23 |     | <span style='background-color: #eee;'>    // contract calls from this contracts account.</span>
  24 |     | <span style='background-color: #eee;'>    address public governance;</span>
  25 |     | <span style='background-color: #eee;'>    // To avoid losing governance by accidentally transferring governance</span>
  26 |     | <span style='background-color: #eee;'>    // to a wrong address we use a propose mechanism, where the proposed</span>
  27 |     | <span style='background-color: #eee;'>    // governance can also execute and by this action finalize the</span>
  28 |     | <span style='background-color: #eee;'>    // the transfer of governance. This prevents accidentally transferring</span>
  29 |     | <span style='background-color: #eee;'>    // control to an invalid address.</span>
  30 |     | <span style='background-color: #faa;'>    address public proposedGovernance;</span>
  31 |     | <span style='background-color: #eee;'></span>
  32 |     | <span style='background-color: #eee;'>    event NewGovernanceProposed(address newGovernance);</span>
  33 |     | <span style='background-color: #eee;'>    event GovernanceChanged(address oldGovernance, address newGovernance);</span>
  34 |     | <span style='background-color: #eee;'>    event BatchExecuted(CallWithoutValue[] calls);</span>
  35 |     | <span style='background-color: #eee;'></span>
  36 |     | <span style='background-color: #eee;'>    error OnlyGovernance();</span>
  37 |     | <span style='background-color: #eee;'></span>
  38 |     | <span style='background-color: #eee;'>    constructor(address _governance) {</span>
  39 |     | <span style='background-color: #eee;'>        governance = FsUtils.nonNull(_governance);</span>
  40 |     | <span style='background-color: #eee;'>    }</span>
  41 |     | <span style='background-color: #eee;'></span>
  42 |     | <span style='background-color: #eee;'>    /// @notice Execute a batch of contract calls.</span>
  43 |     | <span style='background-color: #eee;'>    /// @param calls an array of calls.</span>
  44 |     | <span style='background-color: #eee;'>    function executeBatch(CallWithoutValue[] calldata calls) external {</span>
  45 |     | <span style='background-color: #faa;'>        if (msg.sender != governance) {</span>
  46 |     | <span style='background-color: #eee;'>            // If the caller is not governance we only accept if the previous</span>
  47 |     | <span style='background-color: #eee;'>            // governance has proposed it as the new governance account.</span>
  48 |     | <span style='background-color: #faa;'>            if (msg.sender != proposedGovernance) revert OnlyGovernance();</span>
  49 |     | <span style='background-color: #faa;'>            emit GovernanceChanged(governance, msg.sender);</span>
  50 |     | <span style='background-color: #eee;'>            governance = msg.sender;</span>
  51 |     | <span style='background-color: #eee;'>            proposedGovernance = address(0);</span>
  52 |     | <span style='background-color: #eee;'>        }</span>
  53 |     | <span style='background-color: #eee;'>        // Instead of monitoring each configuration change we opt for a</span>
  54 |     | <span style='background-color: #eee;'>        // simpler approach where we just emit an event for each batch of</span>
  55 |     | <span style='background-color: #eee;'>        // privileged calls.</span>
  56 |     | <span style='background-color: #faa;'>        emit BatchExecuted(calls);</span>
  57 |     | <span style='background-color: #eee;'>        CallLib.executeBatchWithoutValue(calls);</span>
  58 |     | <span style='background-color: #eee;'>    }</span>
  59 |     | <span style='background-color: #eee;'></span>
  60 |     | <span style='background-color: #eee;'>    /// @notice Propose a new account as governance account. Note that this can</span>
  61 |     | <span style='background-color: #eee;'>    /// only be called through the execute method above and hence only</span>
  62 |     | <span style='background-color: #eee;'>    /// by the current governance.</span>
  63 |     | <span style='background-color: #eee;'>    /// @param newGovernance address of the new governance account (or zero to revoke proposal)</span>
  64 |     | <span style='background-color: #eee;'>    function proposeGovernance(address newGovernance) external {</span>
  65 |     | <span style='background-color: #faa;'>        if (msg.sender != address(this)) revert OnlyGovernance();</span>
  66 |     | <span style='background-color: #faa;'>        emit NewGovernanceProposed(newGovernance);</span>
  67 |     | <span style='background-color: #faa;'>        proposedGovernance = newGovernance;</span>
  68 |     | <span style='background-color: #eee;'>    }</span>
  69 |     | <span style='background-color: #eee;'>}</span>
  70 |     | <span style='background-color: #faa;'></span>
  71 |     | <span style='background-color: #eee;'>contract Governance is AccessControl, ERC1155Receiver {</span>
  72 |     | <span style='background-color: #eee;'>    address public voting;</span>
  73 |     | <span style='background-color: #faa;'>    uint256 public maxSupportedGasCost = 8e6;</span>
  74 |     | <span style='background-color: #faa;'>    mapping(address =&gt; mapping(bytes4 =&gt; uint256)) public bitmaskByAddressBySelector;</span>
  75 |     | <span style='background-color: #eee;'></span>
  76 |     | <span style='background-color: #eee;'>    event ExecutionFailed(uint256 indexed messageId, string reason);</span>
  77 |     | <span style='background-color: #eee;'>    event ExecutionSucceeded(uint256 indexed messageId);</span>
  78 |     | <span style='background-color: #eee;'></span>
  79 |     | <span style='background-color: #eee;'>    error AccessDenied(address account, uint8 accessLevel);</span>
  80 |     | <span style='background-color: #eee;'>    error InvalidCall(address to, bytes callData);</span>
  81 |     | <span style='background-color: #eee;'>    error CallDenied(address to, bytes callData, uint8 accessLevel);</span>
  82 |     | <span style='background-color: #eee;'>    error PrivilagedMethod(address to, bytes4 selector);</span>
  83 |     | <span style='background-color: #eee;'>    error OnlyHashNFT();</span>
  84 |     | <span style='background-color: #eee;'>    error InsufficientGas();</span>
  85 |     | <span style='background-color: #eee;'></span>
  86 |     | <span style='background-color: #eee;'>    constructor(</span>
  87 |     | <span style='background-color: #eee;'>        address _governanceProxy,</span>
  88 |     | <span style='background-color: #eee;'>        address _hashNFT,</span>
  89 |     | <span style='background-color: #eee;'>        address _voting</span>
  90 |     | <span style='background-color: #eee;'>    ) AccessControl(_governanceProxy, _hashNFT) {</span>
  91 |     | <span style='background-color: #faa;'>        voting = FsUtils.nonNull(_voting);</span>
  92 |     | <span style='background-color: #eee;'>    }</span>
  93 |     | <span style='background-color: #eee;'></span>
  94 |     | <span style='background-color: #eee;'>    function executeBatch(CallWithoutValue[] memory calls) external {</span>
  95 |     | <span style='background-color: #faa;'>        uint256 tokenId = hashNFT.toTokenId(voting, CallLib.hashCallWithoutValueArray(calls));</span>
  96 |     | <span style='background-color: #faa;'>        hashNFT.burn(address(this), tokenId, 1); // reverts if tokenId isn&#39;t owned.</span>
  97 |     | <span style='background-color: #eee;'></span>
  98 |     | <span style='background-color: #eee;'>        // For governance calls we do not want them to revert and be in limbo. Thus if the batch</span>
  99 |     | <span style='background-color: #eee;'>        // reverts we should still burn the NFT. The only caveat is that we want to prevent</span>
 100 |     | <span style='background-color: #eee;'>        // sabotage votes by executing with insufficient gas and provoking a spurious revert.</span>
 101 |     | <span style='background-color: #faa;'>        bool failed = false;</span>
 102 |     | <span style='background-color: #eee;'>        string memory reason = &quot;&quot;;</span>
 103 |     | <span style='background-color: #faa;'>        try governanceProxy().executeBatch(calls) {} catch Error(string memory _reason) {</span>
 104 |     | <span style='background-color: #eee;'>            failed = true;</span>
 105 |     | <span style='background-color: #eee;'>            reason = _reason;</span>
 106 |     | <span style='background-color: #eee;'>        } catch {</span>
 107 |     | <span style='background-color: #faa;'>            failed = true;</span>
 108 |     | <span style='background-color: #eee;'>        }</span>
 109 |     | <span style='background-color: #faa;'>        if (failed) {</span>
 110 |     | <span style='background-color: #eee;'>            // 1/64th of the gas is left in case the execution fails because of OOG. We need to</span>
 111 |     | <span style='background-color: #eee;'>            // require that this exceeds maxSupportedGasCost / 64 to ensure that in case it</span>
 112 |     | <span style='background-color: #eee;'>            // reverted because of OOG the execution was given ample gas.</span>
 113 |     | <span style='background-color: #faa;'>            if (gasleft() &lt; maxSupportedGasCost / 64) revert InsufficientGas();</span>
 114 |     | <span style='background-color: #faa;'>            emit ExecutionFailed(tokenId, reason);</span>
 115 |     | <span style='background-color: #eee;'>        } else {</span>
 116 |     | <span style='background-color: #faa;'>            emit ExecutionSucceeded(tokenId);</span>
 117 |     | <span style='background-color: #eee;'>        }</span>
 118 |     | <span style='background-color: #eee;'>    }</span>
 119 |     | <span style='background-color: #eee;'></span>
 120 |     | <span style='background-color: #eee;'>    function executeBatchWithClearance(</span>
 121 |     | <span style='background-color: #eee;'>        CallWithoutValue[] memory calls,</span>
 122 |     | <span style='background-color: #eee;'>        uint8 accessLevel</span>
 123 |     | <span style='background-color: #eee;'>    ) external {</span>
 124 |     | <span style='background-color: #faa;'>        if (!hasAccess(msg.sender, accessLevel)) revert AccessDenied(msg.sender, accessLevel);</span>
 125 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; calls.length; i++) {</span>
 126 |     | <span style='background-color: #faa;'>            if (calls[i].callData.length &lt; 4) revert InvalidCall(calls[i].to, calls[i].callData);</span>
 127 |     | <span style='background-color: #faa;'>            bytes4 selector = bytes4(calls[i].callData);</span>
 128 |     | <span style='background-color: #faa;'>            if ((bitmaskByAddressBySelector[calls[i].to][selector] &amp; (1 &lt;&lt; accessLevel)) == 0) {</span>
 129 |     | <span style='background-color: #faa;'>                revert CallDenied(calls[i].to, calls[i].callData, accessLevel);</span>
 130 |     | <span style='background-color: #eee;'>            }</span>
 131 |     | <span style='background-color: #eee;'>        }</span>
 132 |     | <span style='background-color: #faa;'>        governanceProxy().executeBatch(calls);</span>
 133 |     | <span style='background-color: #eee;'>    }</span>
 134 |     | <span style='background-color: #eee;'></span>
 135 |     | <span style='background-color: #eee;'>    function transferVoting(address newVoting) external onlyGovernance {</span>
 136 |     | <span style='background-color: #eee;'>        voting = FsUtils.nonNull(newVoting);</span>
 137 |     | <span style='background-color: #eee;'>    }</span>
 138 |     | <span style='background-color: #eee;'></span>
 139 |     | <span style='background-color: #eee;'>    function setAccessLevel(</span>
 140 |     | <span style='background-color: #eee;'>        address addr,</span>
 141 |     | <span style='background-color: #eee;'>        bytes4 selector,</span>
 142 |     | <span style='background-color: #eee;'>        uint8 accessLevel,</span>
 143 |     | <span style='background-color: #eee;'>        bool allowed</span>
 144 |     | <span style='background-color: #eee;'>    ) external onlyGovernance {</span>
 145 |     | <span style='background-color: #eee;'>        // We cannot allow setting access level for this contract, since that would enable a designated</span>
 146 |     | <span style='background-color: #eee;'>        // caller to escalate their access level to include all privilaged functions in the system.</span>
 147 |     | <span style='background-color: #eee;'>        // By disallowing access levels for this contract we ensure that only the voting system can</span>
 148 |     | <span style='background-color: #eee;'>        // set access levels for other contracts. The same holds for proposeGovernance on the governance</span>
 149 |     | <span style='background-color: #eee;'>        // proxy.</span>
 150 |     | <span style='background-color: #faa;'>        if (</span>
 151 |     | <span style='background-color: #faa;'>            (addr == address(this) &amp;&amp; selector != this.revokeAccess.selector) ||</span>
 152 |     | <span style='background-color: #faa;'>            addr == immutableGovernance</span>
 153 |     | <span style='background-color: #eee;'>        ) {</span>
 154 |     | <span style='background-color: #faa;'>            revert PrivilagedMethod(addr, selector);</span>
 155 |     | <span style='background-color: #eee;'>        }</span>
 156 |     | <span style='background-color: #faa;'>        if (allowed) {</span>
 157 |     | <span style='background-color: #faa;'>            bitmaskByAddressBySelector[addr][selector] |= 1 &lt;&lt; accessLevel;</span>
 158 |     | <span style='background-color: #eee;'>        } else {</span>
 159 |     | <span style='background-color: #faa;'>            bitmaskByAddressBySelector[addr][selector] &amp;= ~(1 &lt;&lt; accessLevel);</span>
 160 |     | <span style='background-color: #eee;'>        }</span>
 161 |     | <span style='background-color: #eee;'>    }</span>
 162 |     | <span style='background-color: #eee;'></span>
 163 |     | <span style='background-color: #eee;'>    function setMaxSupportedGasCost(uint256 _maxSupportedGasCost) external onlyGovernance {</span>
 164 |     | <span style='background-color: #faa;'>        require(_maxSupportedGasCost &gt; 0, &quot;Governance: invalid gas cost&quot;);</span>
 165 |     | <span style='background-color: #eee;'>        maxSupportedGasCost = _maxSupportedGasCost;</span>
 166 |     | <span style='background-color: #eee;'>    }</span>
 167 |     | <span style='background-color: #eee;'></span>
 168 |     | <span style='background-color: #eee;'>    function onERC1155Received(</span>
 169 |     | <span style='background-color: #eee;'>        address /* operator */,</span>
 170 |     | <span style='background-color: #eee;'>        address /* from */,</span>
 171 |     | <span style='background-color: #eee;'>        uint256 /* id */,</span>
 172 |     | <span style='background-color: #eee;'>        uint256 /* value */,</span>
 173 |     | <span style='background-color: #eee;'>        bytes calldata /* data */</span>
 174 |     | <span style='background-color: #eee;'>    ) external view returns (bytes4) {</span>
 175 |     | <span style='background-color: #faa;'>        if (msg.sender != address(hashNFT)) revert OnlyHashNFT();</span>
 176 |     | <span style='background-color: #eee;'>        return this.onERC1155Received.selector;</span>
 177 |     | <span style='background-color: #eee;'>    }</span>
 178 |     | <span style='background-color: #eee;'></span>
 179 |     | <span style='background-color: #eee;'>    function onERC1155BatchReceived(</span>
 180 |     | <span style='background-color: #eee;'>        address /* operator */,</span>
 181 |     | <span style='background-color: #eee;'>        address /* from */,</span>
 182 |     | <span style='background-color: #eee;'>        uint256[] calldata /* ids */,</span>
 183 |     | <span style='background-color: #eee;'>        uint256[] calldata /* values */,</span>
 184 |     | <span style='background-color: #eee;'>        bytes calldata /* data */</span>
 185 |     | <span style='background-color: #eee;'>    ) external view returns (bytes4) {</span>
 186 |     | <span style='background-color: #faa;'>        if (msg.sender != address(hashNFT)) revert OnlyHashNFT();</span>
 187 |     | <span style='background-color: #eee;'>        return this.onERC1155BatchReceived.selector;</span>
 188 |     | <span style='background-color: #eee;'>    }</span>
 189 |     | <span style='background-color: #eee;'></span>
 190 |     | <span style='background-color: #eee;'>    function governanceProxy() internal view returns (GovernanceProxy) {</span>
 191 |     | <span style='background-color: #faa;'>        return GovernanceProxy(immutableGovernance);</span>
 192 |     | <span style='background-color: #eee;'>    }</span>
 193 |     | <span style='background-color: #eee;'>}</span>
 194 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/governance/OffchainEntityProxy.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/access/Ownable.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/cryptography/EIP712.sol&quot;;</span>
  6 |     | <span style='background-color: #eee;'>import &quot;../lib/Call.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'>import &quot;../lib/FsUtils.sol&quot;;</span>
  8 |     | <span style='background-color: #eee;'></span>
  9 |     | <span style='background-color: #eee;'>// Signers (EOAs) are the only things that cross EVM chains as they have the same address on all chains.</span>
 10 |     | <span style='background-color: #eee;'>// To represent an entity cross chains therefore requires a dedicated signer. However this is cumbersome</span>
 11 |     | <span style='background-color: #eee;'>// to manage securely when the offchain entity is distributed (if the signer is hardware who possesses it, or</span>
 12 |     | <span style='background-color: #eee;'>// the security risk of sharing the privare key). Instead, ideally we want a multisig smart contract</span>
 13 |     | <span style='background-color: #eee;'>// representing the entity but with a fixed address on all chains. We propose a simple proxy contract</span>
 14 |     | <span style='background-color: #eee;'>// that can be deployed to a fixed address on all chains, and can be owned by a multisig wallet. This</span>
 15 |     | <span style='background-color: #eee;'>// reduces the use of the key to infrequent initial setup for a new chain.</span>
 16 |     | <span style='background-color: #eee;'></span>
 17 |     | <span style='background-color: #eee;'>// Note: we could deploy this contract with a dedicated deployer key. However this means we must guarantee</span>
 18 |     | <span style='background-color: #eee;'>// that deployment of this contract is always the first action on the chain for this key. Instead we</span>
 19 |     | <span style='background-color: #faa;'>// opt for a pattern that only needs the dedicated key to sign offchain.</span>
 20 |     | <span style='background-color: #eee;'>contract OffchainEntityProxy is Ownable, EIP712 {</span>
 21 |     | <span style='background-color: #eee;'>    bytes32 constant TAKEOWNERSHIP_TYPEHASH =</span>
 22 |     | <span style='background-color: #faa;'>        keccak256(&quot;TakeOwnership(address newOwner,uint256 nonce)&quot;);</span>
 23 |     | <span style='background-color: #eee;'></span>
 24 |     | <span style='background-color: #eee;'>    bytes32 private immutable entityName;</span>
 25 |     | <span style='background-color: #eee;'></span>
 26 |     | <span style='background-color: #faa;'>    uint256 public nonce;</span>
 27 |     | <span style='background-color: #eee;'></span>
 28 |     | <span style='background-color: #eee;'>    // Due to offchain signer address being part of the deployment bytecode, the address at which</span>
 29 |     | <span style='background-color: #eee;'>    // this contract is deployed identifies the offchain signer.</span>
 30 |     | <span style='background-color: #eee;'>    constructor(</span>
 31 |     | <span style='background-color: #eee;'>        address offchainSigner,</span>
 32 |     | <span style='background-color: #eee;'>        string memory _entityName</span>
 33 |     | <span style='background-color: #eee;'>    ) EIP712(&quot;OffchainEntityProxy&quot;, &quot;1&quot;) {</span>
 34 |     | <span style='background-color: #faa;'>        _transferOwnership(offchainSigner);</span>
 35 |     | <span style='background-color: #faa;'>        entityName = FsUtils.encodeToBytes32(bytes(_entityName));</span>
 36 |     | <span style='background-color: #eee;'>    }</span>
 37 |     | <span style='background-color: #eee;'></span>
 38 |     | <span style='background-color: #eee;'>    // By using signature based ownership transfer, we can ensure that the signer can be</span>
 39 |     | <span style='background-color: #eee;'>    // purely offchain.</span>
 40 |     | <span style='background-color: #eee;'>    function takeOwnership(bytes calldata signature) external {</span>
 41 |     | <span style='background-color: #eee;'>        bytes32 digest = _hashTypedDataV4(</span>
 42 |     | <span style='background-color: #faa;'>            keccak256(abi.encode(TAKEOWNERSHIP_TYPEHASH, msg.sender, nonce++))</span>
 43 |     | <span style='background-color: #eee;'>        );</span>
 44 |     | <span style='background-color: #eee;'></span>
 45 |     | <span style='background-color: #eee;'>        address signer = ECDSA.recover(digest, signature);</span>
 46 |     | <span style='background-color: #faa;'>        require(signer == owner(), &quot;Invalid signature&quot;);</span>
 47 |     | <span style='background-color: #eee;'></span>
 48 |     | <span style='background-color: #faa;'>        _transferOwnership(msg.sender);</span>
 49 |     | <span style='background-color: #eee;'>    }</span>
 50 |     | <span style='background-color: #eee;'></span>
 51 |     | <span style='background-color: #eee;'>    // Allow the owner to execute arbitrary calls on behalf of the entity through this proxy</span>
 52 |     | <span style='background-color: #eee;'>    // contract.</span>
 53 |     | <span style='background-color: #eee;'>    function executeBatch(Call[] memory calls) external payable onlyOwner {</span>
 54 |     | <span style='background-color: #eee;'>        CallLib.executeBatch(calls);</span>
 55 |     | <span style='background-color: #eee;'>    }</span>
 56 |     | <span style='background-color: #eee;'></span>
 57 |     | <span style='background-color: #eee;'>    function name() external view returns (string memory) {</span>
 58 |     | <span style='background-color: #faa;'>        return string(FsUtils.decodeFromBytes32(entityName));</span>
 59 |     | <span style='background-color: #eee;'>    }</span>
 60 |     | <span style='background-color: #eee;'>}</span>
 61 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/governance/TimeLockedCall.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/access/Ownable2Step.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'>import &quot;./GovernanceProxy.sol&quot;;</span>
  6 |     | <span style='background-color: #eee;'>import &quot;../lib/ImmutableGovernance.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'>import &quot;../tokens/HashNFT.sol&quot;;</span>
  8 |     | <span style='background-color: #eee;'>import &quot;../lib/AccessControl.sol&quot;;</span>
  9 |     | <span style='background-color: #faa;'></span>
 10 |     | <span style='background-color: #eee;'>contract TimeLockedCall is ImmutableGovernance, Ownable2Step {</span>
 11 |     | <span style='background-color: #faa;'>    uint256 constant MIN_TIMELOCK = 1 days;</span>
 12 |     | <span style='background-color: #faa;'>    uint256 constant MAX_TIMELOCK = 3 days;</span>
 13 |     | <span style='background-color: #eee;'></span>
 14 |     | <span style='background-color: #faa;'>    HashNFT public immutable hashNFT;</span>
 15 |     | <span style='background-color: #faa;'>    uint8 public immutable accessLevel;</span>
 16 |     | <span style='background-color: #eee;'></span>
 17 |     | <span style='background-color: #faa;'>    uint256 public lockTime;</span>
 18 |     | <span style='background-color: #eee;'></span>
 19 |     | <span style='background-color: #eee;'>    event BatchProposed(CallWithoutValue[] calls, uint256 executionTime);</span>
 20 |     | <span style='background-color: #eee;'></span>
 21 |     | <span style='background-color: #eee;'>    constructor(</span>
 22 |     | <span style='background-color: #eee;'>        address governance,</span>
 23 |     | <span style='background-color: #eee;'>        address hashNFT_,</span>
 24 |     | <span style='background-color: #eee;'>        uint8 _accessLevel,</span>
 25 |     | <span style='background-color: #eee;'>        uint256 _lockTime</span>
 26 |     | <span style='background-color: #eee;'>    ) ImmutableGovernance(governance) {</span>
 27 |     | <span style='background-color: #eee;'>        require(</span>
 28 |     | <span style='background-color: #faa;'>            _accessLevel == uint8(AccessControl.AccessLevel.FINANCIAL_RISK),</span>
 29 |     | <span style='background-color: #eee;'>            &quot;TimeLockedCall: invalid access level&quot;</span>
 30 |     | <span style='background-color: #eee;'>        );</span>
 31 |     | <span style='background-color: #faa;'>        accessLevel = _accessLevel;</span>
 32 |     | <span style='background-color: #faa;'>        hashNFT = HashNFT(FsUtils.nonNull(hashNFT_));</span>
 33 |     | <span style='background-color: #eee;'>        _setLockTime(_lockTime);</span>
 34 |     | <span style='background-color: #eee;'>    }</span>
 35 |     | <span style='background-color: #eee;'></span>
 36 |     | <span style='background-color: #eee;'>    function proposeBatch(CallWithoutValue[] calldata calls) external onlyOwner {</span>
 37 |     | <span style='background-color: #faa;'>        uint256 executionTime = block.timestamp + lockTime;</span>
 38 |     | <span style='background-color: #faa;'>        emit BatchProposed(calls, block.timestamp + lockTime);</span>
 39 |     | <span style='background-color: #faa;'>        hashNFT.mint(address(this), calcDigest(calls, executionTime), &quot;&quot;);</span>
 40 |     | <span style='background-color: #eee;'>    }</span>
 41 |     | <span style='background-color: #eee;'></span>
 42 |     | <span style='background-color: #eee;'>    function executeBatch(CallWithoutValue[] calldata calls, uint256 executionTime) external {</span>
 43 |     | <span style='background-color: #faa;'>        require(executionTime &lt;= block.timestamp, &quot;TimeLockedCall: not ready&quot;);</span>
 44 |     | <span style='background-color: #faa;'>        uint256 tokenId = hashNFT.toTokenId(address(this), calcDigest(calls, executionTime));</span>
 45 |     | <span style='background-color: #faa;'>        hashNFT.burn(address(this), tokenId, 1);</span>
 46 |     | <span style='background-color: #faa;'>        Governance(GovernanceProxy(immutableGovernance).governance()).executeBatchWithClearance(</span>
 47 |     | <span style='background-color: #eee;'>            calls,</span>
 48 |     | <span style='background-color: #faa;'>            accessLevel</span>
 49 |     | <span style='background-color: #eee;'>        );</span>
 50 |     | <span style='background-color: #eee;'>    }</span>
 51 |     | <span style='background-color: #eee;'></span>
 52 |     | <span style='background-color: #eee;'>    function setLockTime(uint256 _lockTime) external onlyGovernance {</span>
 53 |     | <span style='background-color: #eee;'>        _setLockTime(_lockTime);</span>
 54 |     | <span style='background-color: #eee;'>    }</span>
 55 |     | <span style='background-color: #eee;'></span>
 56 |     | <span style='background-color: #eee;'>    function _setLockTime(uint256 _lockTime) internal {</span>
 57 |     | <span style='background-color: #faa;'>        require(_lockTime &gt;= MIN_TIMELOCK, &quot;TimeLockedCall: too short&quot;);</span>
 58 |     | <span style='background-color: #faa;'>        require(_lockTime &lt;= MAX_TIMELOCK, &quot;TimeLockedCall: too long&quot;);</span>
 59 |     | <span style='background-color: #faa;'>        lockTime = _lockTime;</span>
 60 |     | <span style='background-color: #eee;'>    }</span>
 61 |     | <span style='background-color: #eee;'></span>
 62 |     | <span style='background-color: #faa;'>    function calcDigest(</span>
 63 |     | <span style='background-color: #eee;'>        CallWithoutValue[] calldata calls,</span>
 64 |     | <span style='background-color: #eee;'>        uint256 executionTime</span>
 65 |     | <span style='background-color: #eee;'>    ) internal pure returns (bytes32) {</span>
 66 |     | <span style='background-color: #faa;'>        return keccak256(abi.encode(executionTime, calls));</span>
 67 |     | <span style='background-color: #eee;'>    }</span>
 68 |     | <span style='background-color: #eee;'>}</span>
 69 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/governance/Voting.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span>
   5 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/cryptography/EIP712.sol&quot;;</span>
   6 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/cryptography/ECDSA.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/cryptography/SignatureChecker.sol&quot;;</span>
   8 |     | <span style='background-color: #eee;'>import &quot;../tokens/HashNFT.sol&quot;;</span>
   9 |     | <span style='background-color: #eee;'>import &quot;../lib/Proofs.sol&quot;;</span>
  10 |     | <span style='background-color: #eee;'>import &quot;../lib/Call.sol&quot;;</span>
  11 |     | <span style='background-color: #eee;'>import &quot;../lib/FsUtils.sol&quot;;</span>
  12 |     | <span style='background-color: #eee;'>import &quot;../lib/NonceMap.sol&quot;;</span>
  13 |     | <span style='background-color: #faa;'></span>
  14 |     | <span style='background-color: #eee;'>contract Voting is EIP712 {</span>
  15 |     | <span style='background-color: #eee;'>    using NonceMapLib for NonceMap;</span>
  16 |     | <span style='background-color: #eee;'>    using Address for address;</span>
  17 |     | <span style='background-color: #eee;'></span>
  18 |     | <span style='background-color: #eee;'>    struct Proposal {</span>
  19 |     | <span style='background-color: #eee;'>        bytes32 digest;</span>
  20 |     | <span style='background-color: #eee;'>        uint256 deadline;</span>
  21 |     | <span style='background-color: #eee;'>        bytes32 storageHash;</span>
  22 |     | <span style='background-color: #eee;'>        uint256 totalSupply;</span>
  23 |     | <span style='background-color: #eee;'>        uint256 yesVotes;</span>
  24 |     | <span style='background-color: #eee;'>        uint256 noVotes;</span>
  25 |     | <span style='background-color: #eee;'>    }</span>
  26 |     | <span style='background-color: #eee;'></span>
  27 |     | <span style='background-color: #eee;'>    struct Vote {</span>
  28 |     | <span style='background-color: #eee;'>        address voter;</span>
  29 |     | <span style='background-color: #eee;'>        bool support;</span>
  30 |     | <span style='background-color: #eee;'>        bytes signature;</span>
  31 |     | <span style='background-color: #eee;'>        bytes proof;</span>
  32 |     | <span style='background-color: #eee;'>    }</span>
  33 |     | <span style='background-color: #eee;'></span>
  34 |     | <span style='background-color: #eee;'>    bytes private constant VOTE_TYPESTRING = &quot;Vote(uint256 proposalId,bool support)&quot;;</span>
  35 |     | <span style='background-color: #faa;'>    bytes32 private constant VOTE_TYPEHASH = keccak256(VOTE_TYPESTRING);</span>
  36 |     | <span style='background-color: #eee;'></span>
  37 |     | <span style='background-color: #faa;'>    uint256 public constant FRACTION = 10; // 10% must vote for quorum</span>
  38 |     | <span style='background-color: #faa;'>    uint256 public constant MIN_VOTING_POWER = 100 ether;</span>
  39 |     | <span style='background-color: #eee;'></span>
  40 |     | <span style='background-color: #faa;'>    HashNFT public immutable hashNFT;</span>
  41 |     | <span style='background-color: #faa;'>    address public immutable governanceToken;</span>
  42 |     | <span style='background-color: #faa;'>    address public immutable governance;</span>
  43 |     | <span style='background-color: #faa;'>    uint256 public immutable mappingSlot;</span>
  44 |     | <span style='background-color: #faa;'>    uint256 public immutable totalSupplySlot;</span>
  45 |     | <span style='background-color: #eee;'></span>
  46 |     | <span style='background-color: #faa;'>    Proposal[] public proposals;</span>
  47 |     | <span style='background-color: #eee;'>    mapping(address =&gt; NonceMap) private votesByAddress;</span>
  48 |     | <span style='background-color: #faa;'>    mapping(address =&gt; address) public delegates;</span>
  49 |     | <span style='background-color: #eee;'></span>
  50 |     | <span style='background-color: #eee;'>    event ProposalCreated(</span>
  51 |     | <span style='background-color: #eee;'>        uint256 proposalId,</span>
  52 |     | <span style='background-color: #eee;'>        string title,</span>
  53 |     | <span style='background-color: #eee;'>        string description,</span>
  54 |     | <span style='background-color: #eee;'>        CallWithoutValue[] calls,</span>
  55 |     | <span style='background-color: #eee;'>        uint256 deadline,</span>
  56 |     | <span style='background-color: #eee;'>        bytes32 digest,</span>
  57 |     | <span style='background-color: #eee;'>        uint256 blockNumber</span>
  58 |     | <span style='background-color: #eee;'>    );</span>
  59 |     | <span style='background-color: #eee;'></span>
  60 |     | <span style='background-color: #eee;'>    event VoteCasted(address voter, uint256 proposalId, bool support, uint256 votes);</span>
  61 |     | <span style='background-color: #eee;'></span>
  62 |     | <span style='background-color: #eee;'>    modifier requireValidProposal(uint256 proposalId) {</span>
  63 |     | <span style='background-color: #faa;'>        require(</span>
  64 |     | <span style='background-color: #faa;'>            proposalId &lt; proposals.length &amp;&amp; proposals[proposalId].deadline &gt; 0,</span>
  65 |     | <span style='background-color: #eee;'>            &quot;proposal not found&quot;</span>
  66 |     | <span style='background-color: #eee;'>        );</span>
  67 |     | <span style='background-color: #faa;'>        require(proposals[proposalId].deadline &gt;= block.timestamp, &quot;voting ended&quot;);</span>
  68 |     | <span style='background-color: #eee;'>        _;</span>
  69 |     | <span style='background-color: #eee;'>    }</span>
  70 |     | <span style='background-color: #eee;'></span>
  71 |     | <span style='background-color: #eee;'>    constructor(</span>
  72 |     | <span style='background-color: #eee;'>        address hashNFT_,</span>
  73 |     | <span style='background-color: #eee;'>        address governanceToken_,</span>
  74 |     | <span style='background-color: #eee;'>        uint256 mappingSlot_,</span>
  75 |     | <span style='background-color: #eee;'>        uint256 totalSupplySlot_,</span>
  76 |     | <span style='background-color: #eee;'>        address governance_</span>
  77 |     | <span style='background-color: #eee;'>    ) EIP712(&quot;Voting&quot;, &quot;1&quot;) {</span>
  78 |     | <span style='background-color: #faa;'>        hashNFT = HashNFT(FsUtils.nonNull(hashNFT_));</span>
  79 |     | <span style='background-color: #faa;'>        governanceToken = FsUtils.nonNull(governanceToken_);</span>
  80 |     | <span style='background-color: #faa;'>        mappingSlot = mappingSlot_;</span>
  81 |     | <span style='background-color: #faa;'>        totalSupplySlot = totalSupplySlot_;</span>
  82 |     | <span style='background-color: #faa;'>        governance = FsUtils.nonNull(governance_);</span>
  83 |     | <span style='background-color: #eee;'>    }</span>
  84 |     | <span style='background-color: #eee;'></span>
  85 |     | <span style='background-color: #faa;'>    function proposeVote(</span>
  86 |     | <span style='background-color: #eee;'>        string calldata title,</span>
  87 |     | <span style='background-color: #eee;'>        string calldata description,</span>
  88 |     | <span style='background-color: #eee;'>        CallWithoutValue[] calldata calls,</span>
  89 |     | <span style='background-color: #eee;'>        uint256 blockNumber,</span>
  90 |     | <span style='background-color: #eee;'>        bytes calldata blockHeader,</span>
  91 |     | <span style='background-color: #eee;'>        bytes calldata stateProof,</span>
  92 |     | <span style='background-color: #eee;'>        bytes calldata totalSupplyProof,</span>
  93 |     | <span style='background-color: #eee;'>        address voter,</span>
  94 |     | <span style='background-color: #eee;'>        bytes calldata proof</span>
  95 |     | <span style='background-color: #eee;'>    ) external {</span>
  96 |     | <span style='background-color: #faa;'>        require(msg.sender == voter || delegates[voter] == msg.sender, &quot;not authorized&quot;);</span>
  97 |     | <span style='background-color: #faa;'>        require(calls.length &gt; 0, &quot;Empty proposal&quot;);</span>
  98 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; calls.length; i++) {</span>
  99 |     | <span style='background-color: #faa;'>            require(calls[i].to.isContract(), &quot;target not a contract&quot;);</span>
 100 |     | <span style='background-color: #faa;'>            require(calls[i].callData.length &gt;= 4, &quot;Invalid callData&quot;);</span>
 101 |     | <span style='background-color: #eee;'>        }</span>
 102 |     | <span style='background-color: #eee;'>        bytes32 storageHash;</span>
 103 |     | <span style='background-color: #eee;'>        {</span>
 104 |     | <span style='background-color: #eee;'>            bytes32 blockHash = getBlockHash(blockNumber);</span>
 105 |     | <span style='background-color: #faa;'>            require(block.number &lt;= blockNumber + 256, &quot;block too old&quot;);</span>
 106 |     | <span style='background-color: #faa;'>            require(keccak256(blockHeader) == blockHash, &quot;invalid block header&quot;);</span>
 107 |     | <span style='background-color: #eee;'>            // RLP of block header 1 list tag + 2 length bytes + 33 bytes of parent hash + 33 bytes of ommers + 21 bytes of coinbase + 1 byte tag</span>
 108 |     | <span style='background-color: #faa;'>            bytes32 stateHash = bytes32(blockHeader[91:]);</span>
 109 |     | <span style='background-color: #eee;'></span>
 110 |     | <span style='background-color: #faa;'>            (, , storageHash, ) = TrieLib.proofAccount(governanceToken, stateHash, stateProof);</span>
 111 |     | <span style='background-color: #eee;'>        }</span>
 112 |     | <span style='background-color: #eee;'></span>
 113 |     | <span style='background-color: #eee;'>        // proof storageHash is correct for blockhash(blockNumber) governanceTokenAddress</span>
 114 |     | <span style='background-color: #faa;'>        Proposal storage proposal = proposals.push();</span>
 115 |     | <span style='background-color: #faa;'>        proposal.digest = CallLib.hashCallWithoutValueArray(calls);</span>
 116 |     | <span style='background-color: #faa;'>        proposal.deadline = block.timestamp + 2 days;</span>
 117 |     | <span style='background-color: #faa;'>        proposal.storageHash = storageHash;</span>
 118 |     | <span style='background-color: #faa;'>        proposal.totalSupply = TrieLib.proofStorageAt(</span>
 119 |     | <span style='background-color: #faa;'>            bytes32(totalSupplySlot),</span>
 120 |     | <span style='background-color: #eee;'>            storageHash,</span>
 121 |     | <span style='background-color: #eee;'>            totalSupplyProof</span>
 122 |     | <span style='background-color: #eee;'>        );</span>
 123 |     | <span style='background-color: #eee;'></span>
 124 |     | <span style='background-color: #faa;'>        emit ProposalCreated(</span>
 125 |     | <span style='background-color: #faa;'>            proposals.length - 1,</span>
 126 |     | <span style='background-color: #eee;'>            title,</span>
 127 |     | <span style='background-color: #eee;'>            description,</span>
 128 |     | <span style='background-color: #eee;'>            calls,</span>
 129 |     | <span style='background-color: #eee;'>            proposal.deadline,</span>
 130 |     | <span style='background-color: #eee;'>            proposal.digest,</span>
 131 |     | <span style='background-color: #eee;'>            blockNumber</span>
 132 |     | <span style='background-color: #eee;'>        );</span>
 133 |     | <span style='background-color: #eee;'></span>
 134 |     | <span style='background-color: #faa;'>        uint256 amount = _vote(voter, proposals.length - 1, true, proof);</span>
 135 |     | <span style='background-color: #faa;'>        require(amount &gt;= MIN_VOTING_POWER, &quot;insufficient voting power&quot;);</span>
 136 |     | <span style='background-color: #eee;'>    }</span>
 137 |     | <span style='background-color: #eee;'></span>
 138 |     | <span style='background-color: #eee;'>    function vote(</span>
 139 |     | <span style='background-color: #eee;'>        address voter,</span>
 140 |     | <span style='background-color: #eee;'>        uint256 proposalId,</span>
 141 |     | <span style='background-color: #eee;'>        bool support,</span>
 142 |     | <span style='background-color: #eee;'>        bytes calldata proof</span>
 143 |     | <span style='background-color: #eee;'>    ) external requireValidProposal(proposalId) {</span>
 144 |     | <span style='background-color: #faa;'>        if (voter == address(0)) {</span>
 145 |     | <span style='background-color: #faa;'>            voter = msg.sender;</span>
 146 |     | <span style='background-color: #eee;'>        } else {</span>
 147 |     | <span style='background-color: #faa;'>            require(voter == msg.sender || msg.sender == delegates[voter], &quot;invalid voter&quot;);</span>
 148 |     | <span style='background-color: #eee;'>        }</span>
 149 |     | <span style='background-color: #faa;'>        _vote(voter, proposalId, support, proof);</span>
 150 |     | <span style='background-color: #eee;'>    }</span>
 151 |     | <span style='background-color: #eee;'></span>
 152 |     | <span style='background-color: #eee;'>    // Allow multiple offchain votes to be verified in a single transaction</span>
 153 |     | <span style='background-color: #eee;'>    function voteBatch(</span>
 154 |     | <span style='background-color: #eee;'>        uint256 proposalId,</span>
 155 |     | <span style='background-color: #eee;'>        Vote[] calldata votes</span>
 156 |     | <span style='background-color: #eee;'>    ) external requireValidProposal(proposalId) {</span>
 157 |     | <span style='background-color: #faa;'>        bytes32 yesVoteDigest = _hashTypedDataV4(</span>
 158 |     | <span style='background-color: #faa;'>            keccak256(abi.encode(VOTE_TYPEHASH, proposalId, true))</span>
 159 |     | <span style='background-color: #eee;'>        );</span>
 160 |     | <span style='background-color: #faa;'>        bytes32 noVoteDigest = _hashTypedDataV4(</span>
 161 |     | <span style='background-color: #faa;'>            keccak256(abi.encode(VOTE_TYPEHASH, proposalId, false))</span>
 162 |     | <span style='background-color: #eee;'>        );</span>
 163 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; votes.length; i++) {</span>
 164 |     | <span style='background-color: #faa;'>            address addr = votes[i].voter;</span>
 165 |     | <span style='background-color: #faa;'>            if (delegates[addr] != address(0)) {</span>
 166 |     | <span style='background-color: #faa;'>                addr = delegates[addr];</span>
 167 |     | <span style='background-color: #eee;'>            }</span>
 168 |     | <span style='background-color: #faa;'>            require(</span>
 169 |     | <span style='background-color: #faa;'>                SignatureChecker.isValidSignatureNow(</span>
 170 |     | <span style='background-color: #eee;'>                    addr,</span>
 171 |     | <span style='background-color: #faa;'>                    votes[i].support ? yesVoteDigest : noVoteDigest,</span>
 172 |     | <span style='background-color: #faa;'>                    votes[i].signature</span>
 173 |     | <span style='background-color: #eee;'>                ),</span>
 174 |     | <span style='background-color: #eee;'>                &quot;invalid signature&quot;</span>
 175 |     | <span style='background-color: #eee;'>            );</span>
 176 |     | <span style='background-color: #faa;'>            _vote(votes[i].voter, proposalId, votes[i].support, votes[i].proof);</span>
 177 |     | <span style='background-color: #eee;'>        }</span>
 178 |     | <span style='background-color: #eee;'>    }</span>
 179 |     | <span style='background-color: #eee;'></span>
 180 |     | <span style='background-color: #faa;'>    function resolve(uint256 proposalId) external {</span>
 181 |     | <span style='background-color: #faa;'>        Proposal storage proposal = proposals[proposalId];</span>
 182 |     | <span style='background-color: #faa;'>        require(proposal.deadline &gt; 0, &quot;proposal not found&quot;);</span>
 183 |     | <span style='background-color: #faa;'>        require(proposal.deadline &lt; block.timestamp, &quot;voting not ended&quot;);</span>
 184 |     | <span style='background-color: #faa;'>        if (proposal.yesVotes &lt;= proposal.noVotes) {</span>
 185 |     | <span style='background-color: #faa;'>            delete proposals[proposalId];</span>
 186 |     | <span style='background-color: #eee;'>            return;</span>
 187 |     | <span style='background-color: #eee;'>        }</span>
 188 |     | <span style='background-color: #faa;'>        if (proposal.yesVotes + proposal.noVotes &lt; proposal.totalSupply / FRACTION) {</span>
 189 |     | <span style='background-color: #faa;'>            delete proposals[proposalId];</span>
 190 |     | <span style='background-color: #eee;'>            return;</span>
 191 |     | <span style='background-color: #eee;'>        }</span>
 192 |     | <span style='background-color: #eee;'>        bytes32 digest = proposal.digest;</span>
 193 |     | <span style='background-color: #faa;'>        delete proposals[proposalId];</span>
 194 |     | <span style='background-color: #eee;'>        // Vote passed;</span>
 195 |     | <span style='background-color: #faa;'>        hashNFT.mint(governance, digest, &quot;&quot;);</span>
 196 |     | <span style='background-color: #eee;'>    }</span>
 197 |     | <span style='background-color: #eee;'></span>
 198 |     | <span style='background-color: #eee;'>    function setDelegate(address delegate) external {</span>
 199 |     | <span style='background-color: #faa;'>        delegates[msg.sender] = delegate;</span>
 200 |     | <span style='background-color: #eee;'>    }</span>
 201 |     | <span style='background-color: #eee;'></span>
 202 |     | <span style='background-color: #eee;'>    function hasVoted(address voter, uint256 proposalId) external view returns (bool) {</span>
 203 |     | <span style='background-color: #faa;'>        return votesByAddress[voter].getNonce(proposalId);</span>
 204 |     | <span style='background-color: #eee;'>    }</span>
 205 |     | <span style='background-color: #eee;'></span>
 206 |     | <span style='background-color: #faa;'>    function _vote(</span>
 207 |     | <span style='background-color: #eee;'>        address addr,</span>
 208 |     | <span style='background-color: #eee;'>        uint256 proposalId,</span>
 209 |     | <span style='background-color: #eee;'>        bool support,</span>
 210 |     | <span style='background-color: #eee;'>        bytes calldata proof</span>
 211 |     | <span style='background-color: #eee;'>    ) internal returns (uint256 amount) {</span>
 212 |     | <span style='background-color: #faa;'>        votesByAddress[addr].validateAndUseNonce(proposalId);</span>
 213 |     | <span style='background-color: #eee;'>        // Solidity mapping convention</span>
 214 |     | <span style='background-color: #faa;'>        bytes32 addressMappingSlot = keccak256(abi.encode(addr, mappingSlot));</span>
 215 |     | <span style='background-color: #faa;'>        amount = TrieLib.proofStorageAt(</span>
 216 |     | <span style='background-color: #eee;'>            addressMappingSlot,</span>
 217 |     | <span style='background-color: #faa;'>            proposals[proposalId].storageHash,</span>
 218 |     | <span style='background-color: #eee;'>            proof</span>
 219 |     | <span style='background-color: #eee;'>        );</span>
 220 |     | <span style='background-color: #faa;'>        require(amount &gt; 0, &quot;no balance&quot;);</span>
 221 |     | <span style='background-color: #faa;'>        if (support) {</span>
 222 |     | <span style='background-color: #faa;'>            proposals[proposalId].yesVotes += amount;</span>
 223 |     | <span style='background-color: #eee;'>        } else {</span>
 224 |     | <span style='background-color: #faa;'>            proposals[proposalId].noVotes += amount;</span>
 225 |     | <span style='background-color: #eee;'>        }</span>
 226 |     | <span style='background-color: #faa;'>        emit VoteCasted(addr, proposalId, support, amount);</span>
 227 |     | <span style='background-color: #eee;'>    }</span>
 228 |     | <span style='background-color: #eee;'></span>
 229 |     | <span style='background-color: #eee;'>    /// @dev Override this function for testing to return handcrafted blockhashes</span>
 230 |     | <span style='background-color: #eee;'>    function getBlockHash(uint256 blockNumber) internal view virtual returns (bytes32 blockHash) {</span>
 231 |     | <span style='background-color: #faa;'>        return blockhash(blockNumber);</span>
 232 |     | <span style='background-color: #eee;'>    }</span>
 233 |     | <span style='background-color: #eee;'>}</span>
 234 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/interfaces/IDOS.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.7;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
   5 |     | <span style='background-color: #eee;'>import {Call} from &quot;../lib/Call.sol&quot;;</span>
   6 |     | <span style='background-color: #eee;'>import {IERC20ValueOracle} from &quot;./IERC20ValueOracle.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'></span>
   8 |     | <span style='background-color: #eee;'>type ERC20Share is int256;</span>
   9 |     | <span style='background-color: #eee;'></span>
  10 |     | <span style='background-color: #eee;'>interface IDOSERC20 is IERC20 {</span>
  11 |     | <span style='background-color: #eee;'>    function mint(address account, uint256 amount) external;</span>
  12 |     | <span style='background-color: #eee;'></span>
  13 |     | <span style='background-color: #eee;'>    function burn(address account, uint256 amount) external;</span>
  14 |     | <span style='background-color: #eee;'>}</span>
  15 |     | <span style='background-color: #eee;'></span>
  16 |     | <span style='background-color: #eee;'>interface IDOSConfig {</span>
  17 |     | <span style='background-color: #eee;'>    struct Config {</span>
  18 |     | <span style='background-color: #eee;'>        address treasurySafe; // The address of the treasury safe</span>
  19 |     | <span style='background-color: #eee;'>        uint256 treasuryInterestFraction; // Fraction of interest to send to treasury</span>
  20 |     | <span style='background-color: #eee;'>        uint256 maxSolvencyCheckGasCost;</span>
  21 |     | <span style='background-color: #eee;'>        int256 liqFraction; // Fraction for the user</span>
  22 |     | <span style='background-color: #eee;'>        int256 fractionalReserveLeverage; // Ratio of debt to reserves</span>
  23 |     | <span style='background-color: #eee;'>    }</span>
  24 |     | <span style='background-color: #eee;'></span>
  25 |     | <span style='background-color: #eee;'>    struct NFTData {</span>
  26 |     | <span style='background-color: #eee;'>        address erc721;</span>
  27 |     | <span style='background-color: #eee;'>        uint256 tokenId;</span>
  28 |     | <span style='background-color: #eee;'>    }</span>
  29 |     | <span style='background-color: #eee;'></span>
  30 |     | <span style='background-color: #eee;'>    /// @notice Emitted when the implementation of a dSafe is upgraded</span>
  31 |     | <span style='background-color: #eee;'>    /// @param dSafe The address of the dSafe</span>
  32 |     | <span style='background-color: #eee;'>    /// @param version The new implementation version</span>
  33 |     | <span style='background-color: #eee;'>    event DSafeImplementationUpgraded(</span>
  34 |     | <span style='background-color: #eee;'>        address indexed dSafe,</span>
  35 |     | <span style='background-color: #eee;'>        string indexed version,</span>
  36 |     | <span style='background-color: #eee;'>        address implementation</span>
  37 |     | <span style='background-color: #eee;'>    );</span>
  38 |     | <span style='background-color: #eee;'></span>
  39 |     | <span style='background-color: #eee;'>    event DSafeOwnershipTransferred(address indexed dSafe, address indexed newOwner);</span>
  40 |     | <span style='background-color: #eee;'></span>
  41 |     | <span style='background-color: #eee;'>    /// @notice Emitted when a new ERC20 is added to the protocol</span>
  42 |     | <span style='background-color: #eee;'>    /// @param erc20Idx The index of the ERC20 in the protocol</span>
  43 |     | <span style='background-color: #eee;'>    /// @param erc20 The address of the ERC20 contract</span>
  44 |     | <span style='background-color: #eee;'>    /// @param name The name of the ERC20</span>
  45 |     | <span style='background-color: #eee;'>    /// @param symbol The symbol of the ERC20</span>
  46 |     | <span style='background-color: #eee;'>    /// @param decimals The decimals of the ERC20</span>
  47 |     | <span style='background-color: #eee;'>    /// @param valueOracle The address of the value oracle for the ERC20</span>
  48 |     | <span style='background-color: #eee;'>    /// @param baseRate The interest rate at 0% utilization</span>
  49 |     | <span style='background-color: #eee;'>    /// @param slope1 The interest rate slope at 0% to target utilization</span>
  50 |     | <span style='background-color: #eee;'>    /// @param slope2 The interest rate slope at target utilization to 100% utilization</span>
  51 |     | <span style='background-color: #eee;'>    /// @param targetUtilization The target utilization for the ERC20</span>
  52 |     | <span style='background-color: #eee;'>    event ERC20Added(</span>
  53 |     | <span style='background-color: #eee;'>        uint16 erc20Idx,</span>
  54 |     | <span style='background-color: #eee;'>        address erc20,</span>
  55 |     | <span style='background-color: #eee;'>        string name,</span>
  56 |     | <span style='background-color: #eee;'>        string symbol,</span>
  57 |     | <span style='background-color: #eee;'>        uint8 decimals,</span>
  58 |     | <span style='background-color: #eee;'>        address valueOracle,</span>
  59 |     | <span style='background-color: #eee;'>        uint256 baseRate,</span>
  60 |     | <span style='background-color: #eee;'>        uint256 slope1,</span>
  61 |     | <span style='background-color: #eee;'>        uint256 slope2,</span>
  62 |     | <span style='background-color: #eee;'>        uint256 targetUtilization</span>
  63 |     | <span style='background-color: #eee;'>    );</span>
  64 |     | <span style='background-color: #eee;'></span>
  65 |     | <span style='background-color: #eee;'>    /// @notice Emitted when a new ERC721 is added to the protocol</span>
  66 |     | <span style='background-color: #eee;'>    /// @param erc721Idx The index of the ERC721 in the protocol</span>
  67 |     | <span style='background-color: #eee;'>    /// @param erc721Contract The address of the ERC721 contract</span>
  68 |     | <span style='background-color: #eee;'>    /// @param valueOracleAddress The address of the value oracle for the ERC721</span>
  69 |     | <span style='background-color: #eee;'>    event ERC721Added(</span>
  70 |     | <span style='background-color: #eee;'>        uint256 indexed erc721Idx,</span>
  71 |     | <span style='background-color: #eee;'>        address indexed erc721Contract,</span>
  72 |     | <span style='background-color: #eee;'>        address valueOracleAddress</span>
  73 |     | <span style='background-color: #eee;'>    );</span>
  74 |     | <span style='background-color: #eee;'></span>
  75 |     | <span style='background-color: #eee;'>    /// @notice Emitted when the config is set</span>
  76 |     | <span style='background-color: #eee;'>    /// @param config The new config</span>
  77 |     | <span style='background-color: #eee;'>    event ConfigSet(Config indexed config);</span>
  78 |     | <span style='background-color: #eee;'></span>
  79 |     | <span style='background-color: #eee;'>    /// @notice Emitted when the version manager address is set</span>
  80 |     | <span style='background-color: #eee;'>    /// @param versionManager The version manager address</span>
  81 |     | <span style='background-color: #eee;'>    event VersionManagerSet(address indexed versionManager);</span>
  82 |     | <span style='background-color: #eee;'></span>
  83 |     | <span style='background-color: #eee;'>    /// @notice Emitted when ERC20 Data is set</span>
  84 |     | <span style='background-color: #eee;'>    /// @param erc20 The address of the erc20 token</span>
  85 |     | <span style='background-color: #eee;'>    /// @param baseRate The new base interest rate</span>
  86 |     | <span style='background-color: #eee;'>    /// @param slope1 The new slope1</span>
  87 |     | <span style='background-color: #eee;'>    /// @param slope2 The new slope2</span>
  88 |     | <span style='background-color: #eee;'>    /// @param targetUtilization The new target utilization</span>
  89 |     | <span style='background-color: #eee;'>    event ERC20DataSet(</span>
  90 |     | <span style='background-color: #eee;'>        address indexed erc20,</span>
  91 |     | <span style='background-color: #eee;'>        uint256 baseRate,</span>
  92 |     | <span style='background-color: #eee;'>        uint256 slope1,</span>
  93 |     | <span style='background-color: #eee;'>        uint256 slope2,</span>
  94 |     | <span style='background-color: #eee;'>        uint256 targetUtilization</span>
  95 |     | <span style='background-color: #eee;'>    );</span>
  96 |     | <span style='background-color: #eee;'></span>
  97 |     | <span style='background-color: #eee;'>    /// @notice Emitted when a dSafe is created</span>
  98 |     | <span style='background-color: #eee;'>    /// @param dSafe The address of the dSafe</span>
  99 |     | <span style='background-color: #eee;'>    /// @param owner The address of the owner</span>
 100 |     | <span style='background-color: #eee;'>    event DSafeCreated(address dSafe, address owner);</span>
 101 |     | <span style='background-color: #eee;'></span>
 102 |     | <span style='background-color: #eee;'>    function upgradeDSafeImplementation(string calldata version) external;</span>
 103 |     | <span style='background-color: #eee;'></span>
 104 |     | <span style='background-color: #eee;'>    function transferDSafeOwnership(address newOwner) external;</span>
 105 |     | <span style='background-color: #eee;'></span>
 106 |     | <span style='background-color: #eee;'>    function addERC20Info(</span>
 107 |     | <span style='background-color: #eee;'>        address erc20Contract,</span>
 108 |     | <span style='background-color: #eee;'>        string calldata name,</span>
 109 |     | <span style='background-color: #eee;'>        string calldata symbol,</span>
 110 |     | <span style='background-color: #eee;'>        uint8 decimals,</span>
 111 |     | <span style='background-color: #eee;'>        address valueOracle,</span>
 112 |     | <span style='background-color: #eee;'>        uint256 baseRate,</span>
 113 |     | <span style='background-color: #eee;'>        uint256 slope1,</span>
 114 |     | <span style='background-color: #eee;'>        uint256 slope2,</span>
 115 |     | <span style='background-color: #eee;'>        uint256 targetUtilization</span>
 116 |     | <span style='background-color: #eee;'>    ) external returns (uint16);</span>
 117 |     | <span style='background-color: #eee;'></span>
 118 |     | <span style='background-color: #eee;'>    function addERC721Info(address nftContract, address valueOracleAddress) external;</span>
 119 |     | <span style='background-color: #eee;'></span>
 120 |     | <span style='background-color: #eee;'>    function setERC20Data(</span>
 121 |     | <span style='background-color: #eee;'>        address erc20,</span>
 122 |     | <span style='background-color: #eee;'>        uint256 baseRate,</span>
 123 |     | <span style='background-color: #eee;'>        uint256 slope1,</span>
 124 |     | <span style='background-color: #eee;'>        uint256 slope2,</span>
 125 |     | <span style='background-color: #eee;'>        uint256 targetUtilization</span>
 126 |     | <span style='background-color: #eee;'>    ) external;</span>
 127 |     | <span style='background-color: #eee;'></span>
 128 |     | <span style='background-color: #eee;'>    function setConfig(Config calldata _config) external;</span>
 129 |     | <span style='background-color: #eee;'></span>
 130 |     | <span style='background-color: #eee;'>    function setVersionManager(address _versionManager) external;</span>
 131 |     | <span style='background-color: #eee;'></span>
 132 |     | <span style='background-color: #eee;'>    function createDSafe() external returns (address dSafe);</span>
 133 |     | <span style='background-color: #eee;'></span>
 134 |     | <span style='background-color: #eee;'>    function pause() external;</span>
 135 |     | <span style='background-color: #eee;'></span>
 136 |     | <span style='background-color: #eee;'>    function unpause() external;</span>
 137 |     | <span style='background-color: #eee;'></span>
 138 |     | <span style='background-color: #eee;'>    function getDAccountERC20(address dSafe, IERC20 erc20) external view returns (int256);</span>
 139 |     | <span style='background-color: #eee;'></span>
 140 |     | <span style='background-color: #eee;'>    function getDAccountERC721(address dSafe) external view returns (NFTData[] memory);</span>
 141 |     | <span style='background-color: #eee;'>}</span>
 142 |     | <span style='background-color: #eee;'></span>
 143 |     | <span style='background-color: #eee;'>interface IDOSCore {</span>
 144 |     | <span style='background-color: #eee;'>    struct Approval {</span>
 145 |     | <span style='background-color: #eee;'>        address ercContract; // ERC20/ERC721 contract</span>
 146 |     | <span style='background-color: #eee;'>        uint256 amountOrTokenId; // amount or tokenId</span>
 147 |     | <span style='background-color: #eee;'>    }</span>
 148 |     | <span style='background-color: #eee;'></span>
 149 |     | <span style='background-color: #eee;'>    /// @notice Emitted when ERC20 tokens are transferred between credit accounts</span>
 150 |     | <span style='background-color: #eee;'>    /// @param erc20 The address of the ERC20 token</span>
 151 |     | <span style='background-color: #eee;'>    /// @param from The address of the sender</span>
 152 |     | <span style='background-color: #eee;'>    /// @param to The address of the receiver</span>
 153 |     | <span style='background-color: #eee;'>    /// @param value The amount of tokens transferred</span>
 154 |     | <span style='background-color: #eee;'>    event ERC20Transfer(</span>
 155 |     | <span style='background-color: #eee;'>        address indexed erc20,</span>
 156 |     | <span style='background-color: #eee;'>        address indexed from,</span>
 157 |     | <span style='background-color: #eee;'>        address indexed to,</span>
 158 |     | <span style='background-color: #eee;'>        int256 value</span>
 159 |     | <span style='background-color: #eee;'>    );</span>
 160 |     | <span style='background-color: #eee;'></span>
 161 |     | <span style='background-color: #eee;'>    /// @notice Emitted when erc20 tokens are deposited or withdrawn from a credit account</span>
 162 |     | <span style='background-color: #eee;'>    /// @param erc20 The address of the ERC20 token</span>
 163 |     | <span style='background-color: #eee;'>    /// @param to The address of the dSafe</span>
 164 |     | <span style='background-color: #eee;'>    /// @param amount The amount of tokens deposited or withdrawn</span>
 165 |     | <span style='background-color: #eee;'>    event ERC20BalanceChanged(address indexed erc20, address indexed to, int256 indexed amount);</span>
 166 |     | <span style='background-color: #eee;'></span>
 167 |     | <span style='background-color: #eee;'>    /// @notice Emitted when a ERC721 is transferred between credit accounts</span>
 168 |     | <span style='background-color: #eee;'>    /// @param nftId The nftId of the ERC721 token</span>
 169 |     | <span style='background-color: #eee;'>    /// @param from The address of the sender</span>
 170 |     | <span style='background-color: #eee;'>    /// @param to The address of the receiver</span>
 171 |     | <span style='background-color: #eee;'>    event ERC721Transferred(uint256 indexed nftId, address indexed from, address indexed to);</span>
 172 |     | <span style='background-color: #eee;'></span>
 173 |     | <span style='background-color: #eee;'>    /// @notice Emitted when an ERC721 token is deposited to a credit account</span>
 174 |     | <span style='background-color: #eee;'>    /// @param erc721 The address of the ERC721 token</span>
 175 |     | <span style='background-color: #eee;'>    /// @param to The address of the dSafe</span>
 176 |     | <span style='background-color: #eee;'>    /// @param tokenId The id of the token deposited</span>
 177 |     | <span style='background-color: #eee;'>    event ERC721Deposited(address indexed erc721, address indexed to, uint256 indexed tokenId);</span>
 178 |     | <span style='background-color: #eee;'></span>
 179 |     | <span style='background-color: #eee;'>    /// @notice Emitted when an ERC721 token is withdrawn from a credit account</span>
 180 |     | <span style='background-color: #eee;'>    /// @param erc721 The address of the ERC721 token</span>
 181 |     | <span style='background-color: #eee;'>    /// @param from The address of the dSafe</span>
 182 |     | <span style='background-color: #eee;'>    /// @param tokenId The id of the token withdrawn</span>
 183 |     | <span style='background-color: #eee;'>    event ERC721Withdrawn(address indexed erc721, address indexed from, uint256 indexed tokenId);</span>
 184 |     | <span style='background-color: #eee;'></span>
 185 |     | <span style='background-color: #eee;'>    /// @dev Emitted when `owner` approves `spender` to spend `value` tokens on their behalf.</span>
 186 |     | <span style='background-color: #eee;'>    /// @param erc20 The ERC20 token to approve</span>
 187 |     | <span style='background-color: #eee;'>    /// @param owner The address of the token owner</span>
 188 |     | <span style='background-color: #eee;'>    /// @param spender The address of the spender</span>
 189 |     | <span style='background-color: #eee;'>    /// @param value The amount of tokens to approve</span>
 190 |     | <span style='background-color: #eee;'>    event ERC20Approval(</span>
 191 |     | <span style='background-color: #eee;'>        address indexed erc20,</span>
 192 |     | <span style='background-color: #eee;'>        address indexed owner,</span>
 193 |     | <span style='background-color: #eee;'>        address indexed spender,</span>
 194 |     | <span style='background-color: #eee;'>        uint256 value</span>
 195 |     | <span style='background-color: #eee;'>    );</span>
 196 |     | <span style='background-color: #eee;'></span>
 197 |     | <span style='background-color: #eee;'>    /// @dev Emitted when `owner` enables `approved` to manage the `tokenId` token on collection `collection`.</span>
 198 |     | <span style='background-color: #eee;'>    /// @param collection The address of the ERC721 collection</span>
 199 |     | <span style='background-color: #eee;'>    /// @param owner The address of the token owner</span>
 200 |     | <span style='background-color: #eee;'>    /// @param approved The address of the approved operator</span>
 201 |     | <span style='background-color: #eee;'>    /// @param tokenId The ID of the approved token</span>
 202 |     | <span style='background-color: #eee;'>    event ERC721Approval(</span>
 203 |     | <span style='background-color: #eee;'>        address indexed collection,</span>
 204 |     | <span style='background-color: #eee;'>        address indexed owner,</span>
 205 |     | <span style='background-color: #eee;'>        address indexed approved,</span>
 206 |     | <span style='background-color: #eee;'>        uint256 tokenId</span>
 207 |     | <span style='background-color: #eee;'>    );</span>
 208 |     | <span style='background-color: #eee;'></span>
 209 |     | <span style='background-color: #eee;'>    /// @dev Emitted when `owner` enables or disables (`approved`) `operator` to manage all of its erc20s.</span>
 210 |     | <span style='background-color: #eee;'>    /// @param collection The address of the collection</span>
 211 |     | <span style='background-color: #eee;'>    /// @param owner The address of the owner</span>
 212 |     | <span style='background-color: #eee;'>    /// @param operator The address of the operator</span>
 213 |     | <span style='background-color: #eee;'>    /// @param approved True if the operator is approved, false to revoke approval</span>
 214 |     | <span style='background-color: #eee;'>    event ApprovalForAll(</span>
 215 |     | <span style='background-color: #eee;'>        address indexed collection,</span>
 216 |     | <span style='background-color: #eee;'>        address indexed owner,</span>
 217 |     | <span style='background-color: #eee;'>        address indexed operator,</span>
 218 |     | <span style='background-color: #eee;'>        bool approved</span>
 219 |     | <span style='background-color: #eee;'>    );</span>
 220 |     | <span style='background-color: #eee;'></span>
 221 |     | <span style='background-color: #eee;'>    /// @notice Emitted when a dSafe is liquidated</span>
 222 |     | <span style='background-color: #eee;'>    /// @param dSafe The address of the liquidated dSafe</span>
 223 |     | <span style='background-color: #eee;'>    /// @param liquidator The address of the liquidator</span>
 224 |     | <span style='background-color: #eee;'>    event SafeLiquidated(address indexed dSafe, address indexed liquidator);</span>
 225 |     | <span style='background-color: #eee;'></span>
 226 |     | <span style='background-color: #eee;'>    /// @notice Error thrown if a dSafe accumulates too many assets</span>
 227 |     | <span style='background-color: #eee;'>    error SolvencyCheckTooExpensive();</span>
 228 |     | <span style='background-color: #eee;'></span>
 229 |     | <span style='background-color: #eee;'>    function liquidate(address dSafe) external;</span>
 230 |     | <span style='background-color: #eee;'></span>
 231 |     | <span style='background-color: #eee;'>    function depositERC20(IERC20 erc20, uint256 amount) external;</span>
 232 |     | <span style='background-color: #eee;'></span>
 233 |     | <span style='background-color: #eee;'>    function withdrawERC20(IERC20 erc20, uint256 amount) external;</span>
 234 |     | <span style='background-color: #eee;'></span>
 235 |     | <span style='background-color: #eee;'>    function depositERC20ForSafe(address erc20, address to, uint256 amount) external;</span>
 236 |     | <span style='background-color: #eee;'></span>
 237 |     | <span style='background-color: #eee;'>    function depositFull(IERC20[] calldata erc20s) external;</span>
 238 |     | <span style='background-color: #eee;'></span>
 239 |     | <span style='background-color: #eee;'>    function withdrawFull(IERC20[] calldata erc20s) external;</span>
 240 |     | <span style='background-color: #eee;'></span>
 241 |     | <span style='background-color: #eee;'>    function executeBatch(Call[] memory calls) external;</span>
 242 |     | <span style='background-color: #eee;'></span>
 243 |     | <span style='background-color: #eee;'>    function transferERC20(IERC20 erc20, address to, uint256 amount) external;</span>
 244 |     | <span style='background-color: #eee;'></span>
 245 |     | <span style='background-color: #eee;'>    function depositERC721(address nftContract, uint256 tokenId) external;</span>
 246 |     | <span style='background-color: #eee;'></span>
 247 |     | <span style='background-color: #eee;'>    function withdrawERC721(address erc721, uint256 tokenId) external;</span>
 248 |     | <span style='background-color: #eee;'></span>
 249 |     | <span style='background-color: #eee;'>    function transferERC721(address erc721, uint256 tokenId, address to) external;</span>
 250 |     | <span style='background-color: #eee;'></span>
 251 |     | <span style='background-color: #eee;'>    /// @notice Transfer ERC20 tokens from dSafe to another dSafe</span>
 252 |     | <span style='background-color: #eee;'>    /// @dev Note: Allowance must be set with approveERC20</span>
 253 |     | <span style='background-color: #eee;'>    /// @param erc20 The index of the ERC20 token in erc20Infos array</span>
 254 |     | <span style='background-color: #eee;'>    /// @param from The address of the dSafe to transfer from</span>
 255 |     | <span style='background-color: #eee;'>    /// @param to The address of the dSafe to transfer to</span>
 256 |     | <span style='background-color: #eee;'>    /// @param amount The amount of tokens to transfer</span>
 257 |     | <span style='background-color: #eee;'>    function transferFromERC20(</span>
 258 |     | <span style='background-color: #eee;'>        address erc20,</span>
 259 |     | <span style='background-color: #eee;'>        address from,</span>
 260 |     | <span style='background-color: #eee;'>        address to,</span>
 261 |     | <span style='background-color: #eee;'>        uint256 amount</span>
 262 |     | <span style='background-color: #eee;'>    ) external returns (bool);</span>
 263 |     | <span style='background-color: #eee;'></span>
 264 |     | <span style='background-color: #eee;'>    /// @notice Transfer ERC721 tokens from dSafe to another dSafe</span>
 265 |     | <span style='background-color: #eee;'>    /// @param collection The address of the ERC721 token</span>
 266 |     | <span style='background-color: #eee;'>    /// @param from The address of the dSafe to transfer from</span>
 267 |     | <span style='background-color: #eee;'>    /// @param to The address of the dSafe to transfer to</span>
 268 |     | <span style='background-color: #eee;'>    /// @param tokenId The id of the token to transfer</span>
 269 |     | <span style='background-color: #eee;'>    function transferFromERC721(</span>
 270 |     | <span style='background-color: #eee;'>        address collection,</span>
 271 |     | <span style='background-color: #eee;'>        address from,</span>
 272 |     | <span style='background-color: #eee;'>        address to,</span>
 273 |     | <span style='background-color: #eee;'>        uint256 tokenId</span>
 274 |     | <span style='background-color: #eee;'>    ) external;</span>
 275 |     | <span style='background-color: #eee;'></span>
 276 |     | <span style='background-color: #eee;'>    function approveAndCall(</span>
 277 |     | <span style='background-color: #eee;'>        Approval[] calldata approvals,</span>
 278 |     | <span style='background-color: #eee;'>        address spender,</span>
 279 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
 280 |     | <span style='background-color: #eee;'>    ) external;</span>
 281 |     | <span style='background-color: #eee;'></span>
 282 |     | <span style='background-color: #eee;'>    /// @notice Returns the approved address for a token, or zero if no address set</span>
 283 |     | <span style='background-color: #eee;'>    /// @param collection The address of the ERC721 token</span>
 284 |     | <span style='background-color: #eee;'>    /// @param tokenId The id of the token to query</span>
 285 |     | <span style='background-color: #eee;'>    function getApproved(address collection, uint256 tokenId) external view returns (address);</span>
 286 |     | <span style='background-color: #eee;'></span>
 287 |     | <span style='background-color: #eee;'>    function getRiskAdjustedPositionValues(</span>
 288 |     | <span style='background-color: #eee;'>        address dSafeAddress</span>
 289 |     | <span style='background-color: #eee;'>    ) external view returns (int256 totalValue, int256 collateral, int256 debt);</span>
 290 |     | <span style='background-color: #eee;'></span>
 291 |     | <span style='background-color: #eee;'>    /// @notice Returns if the `operator` is allowed to manage all of the erc20s of `owner` on the `collection` contract</span>
 292 |     | <span style='background-color: #eee;'>    /// @param collection The address of the collection contract</span>
 293 |     | <span style='background-color: #eee;'>    /// @param _owner The address of the owner</span>
 294 |     | <span style='background-color: #eee;'>    /// @param spender The address of the spender</span>
 295 |     | <span style='background-color: #eee;'>    function isApprovedForAll(</span>
 296 |     | <span style='background-color: #eee;'>        address collection,</span>
 297 |     | <span style='background-color: #eee;'>        address _owner,</span>
 298 |     | <span style='background-color: #eee;'>        address spender</span>
 299 |     | <span style='background-color: #eee;'>    ) external view returns (bool);</span>
 300 |     | <span style='background-color: #eee;'></span>
 301 |     | <span style='background-color: #eee;'>    /**</span>
 302 |     | <span style='background-color: #eee;'>     * @dev Returns the remaining number of tokens that `spender` will be</span>
 303 |     | <span style='background-color: #eee;'>     * allowed to spend on behalf of `owner` through {transferFrom}. This is</span>
 304 |     | <span style='background-color: #eee;'>     * zero by default.</span>
 305 |     | <span style='background-color: #eee;'>     *</span>
 306 |     | <span style='background-color: #eee;'>     * This value changes when {approve} or {transferFrom} are called.</span>
 307 |     | <span style='background-color: #eee;'>     */</span>
 308 |     | <span style='background-color: #eee;'>    function allowance(</span>
 309 |     | <span style='background-color: #eee;'>        address erc20,</span>
 310 |     | <span style='background-color: #eee;'>        address _owner,</span>
 311 |     | <span style='background-color: #eee;'>        address spender</span>
 312 |     | <span style='background-color: #eee;'>    ) external view returns (uint256);</span>
 313 |     | <span style='background-color: #eee;'></span>
 314 |     | <span style='background-color: #eee;'>    function computeInterestRate(uint16 erc20Idx) external view returns (int96);</span>
 315 |     | <span style='background-color: #eee;'></span>
 316 |     | <span style='background-color: #eee;'>    function getImplementation(address dSafe) external view returns (address);</span>
 317 |     | <span style='background-color: #eee;'></span>
 318 |     | <span style='background-color: #eee;'>    function getDSafeOwner(address dSafe) external view returns (address);</span>
 319 |     | <span style='background-color: #eee;'>}</span>
 320 |     | <span style='background-color: #eee;'></span>
 321 |     | <span style='background-color: #eee;'>interface IDOS is IDOSCore, IDOSConfig {}</span>
 322 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/interfaces/IERC1363-extended.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>//SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.7;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import {Call} from &quot;../lib/Call.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>interface IERC1363SpenderExtended {</span>
  7 |     | <span style='background-color: #eee;'>    function onApprovalReceived(</span>
  8 |     | <span style='background-color: #eee;'>        address owner,</span>
  9 |     | <span style='background-color: #eee;'>        uint256 value,</span>
 10 |     | <span style='background-color: #eee;'>        Call calldata call</span>
 11 |     | <span style='background-color: #eee;'>    ) external returns (bytes4);</span>
 12 |     | <span style='background-color: #eee;'>}</span>
 13 |     | <span style='background-color: #eee;'></span>
 14 |     | <span style='background-color: #eee;'>interface IERC1363ReceiverExtended {</span>
 15 |     | <span style='background-color: #eee;'>    function onTransferReceived(</span>
 16 |     | <span style='background-color: #eee;'>        address operator,</span>
 17 |     | <span style='background-color: #eee;'>        address token,</span>
 18 |     | <span style='background-color: #eee;'>        uint256 value,</span>
 19 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
 20 |     | <span style='background-color: #eee;'>    ) external returns (bytes4);</span>
 21 |     | <span style='background-color: #eee;'>}</span>
 22 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/interfaces/IERC20ValueOracle.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>interface IERC20ValueOracle {</span>
  5 |     | <span style='background-color: #eee;'>    function calcValue(</span>
  6 |     | <span style='background-color: #eee;'>        int256 balance</span>
  7 |     | <span style='background-color: #eee;'>    ) external view returns (int256 value, int256 riskAdjustedValue);</span>
  8 |     | <span style='background-color: #eee;'>}</span>
  9 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/interfaces/INFTValueOracle.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>/// @title NFT Value Oracle Interface</span>
  5 |     | <span style='background-color: #eee;'>interface INFTValueOracle {</span>
  6 |     | <span style='background-color: #eee;'>    function calcValue(</span>
  7 |     | <span style='background-color: #eee;'>        uint256 tokenId</span>
  8 |     | <span style='background-color: #eee;'>    ) external view returns (int256 value, int256 riskAdjustedValue);</span>
  9 |     | <span style='background-color: #eee;'>}</span>
 10 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/interfaces/ISafe.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: UNLICENSED</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.13;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import {Call} from &quot;../lib/Call.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>interface ISafe {</span>
  7 |     | <span style='background-color: #eee;'>    event TokensApproved(address sender, uint256 amount, bytes data);</span>
  8 |     | <span style='background-color: #eee;'>    event TokensReceived(address spender, address sender, uint256 amount, bytes data);</span>
  9 |     | <span style='background-color: #eee;'></span>
 10 |     | <span style='background-color: #eee;'>    function executeBatch(Call[] memory calls) external payable;</span>
 11 |     | <span style='background-color: #eee;'>}</span>
 12 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/interfaces/ITransferReceiver2.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
  6 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'></span>
  8 |     | <span style='background-color: #eee;'>// This address is in flux as long as the bytecode of this contract is not fixed. For now</span>
  9 |     | <span style='background-color: #eee;'>// we deploy it on local block chain on fixed address, when we go deploy this needs to change</span>
 10 |     | <span style='background-color: #eee;'>// to the permanent address.</span>
 11 |     | <span style='background-color: #faa;'>address constant TRANSFER_AND_CALL2 = address(0x4e765952997a33893AfB4457A6A7f381909f3629);</span>
 12 |     | <span style='background-color: #eee;'></span>
 13 |     | <span style='background-color: #eee;'>// Contracts that implement can receive multiple ERC20 transfers in a single transaction,</span>
 14 |     | <span style='background-color: #eee;'>// with backwards compatibility for legacy ERC20&#39;s not implementing ERC677.</span>
 15 |     | <span style='background-color: #eee;'>abstract contract ITransferReceiver2 {</span>
 16 |     | <span style='background-color: #eee;'>    error InvalidSender(address sender);</span>
 17 |     | <span style='background-color: #eee;'></span>
 18 |     | <span style='background-color: #eee;'>    struct Transfer {</span>
 19 |     | <span style='background-color: #eee;'>        address token;</span>
 20 |     | <span style='background-color: #eee;'>        uint256 amount;</span>
 21 |     | <span style='background-color: #eee;'>    }</span>
 22 |     | <span style='background-color: #eee;'></span>
 23 |     | <span style='background-color: #eee;'>    /// @dev Called by a token to indicate a transfer into the callee</span>
 24 |     | <span style='background-color: #eee;'>    /// @param operator The account that initiated the transfer</span>
 25 |     | <span style='background-color: #eee;'>    /// @param from The account that has sent the token</span>
 26 |     | <span style='background-color: #eee;'>    /// @param transfers Transfers that have been made</span>
 27 |     | <span style='background-color: #eee;'>    /// @param data The extra data being passed to the receiving contract</span>
 28 |     | <span style='background-color: #eee;'>    function onTransferReceived2(</span>
 29 |     | <span style='background-color: #eee;'>        address operator,</span>
 30 |     | <span style='background-color: #eee;'>        address from,</span>
 31 |     | <span style='background-color: #eee;'>        Transfer[] calldata transfers,</span>
 32 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
 33 |     | <span style='background-color: #eee;'>    ) external virtual returns (bytes4);</span>
 34 |     | <span style='background-color: #eee;'></span>
 35 |     | <span style='background-color: #eee;'>    modifier onlyTransferAndCall2() {</span>
 36 |     | <span style='background-color: #faa;'>        if (msg.sender != TRANSFER_AND_CALL2) revert InvalidSender(msg.sender);</span>
 37 |     | <span style='background-color: #eee;'>        _;</span>
 38 |     | <span style='background-color: #eee;'>    }</span>
 39 |     | <span style='background-color: #eee;'>}</span>
 40 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/interfaces/IVersionManager.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>/// @notice version is not registered</span>
  5 |     | <span style='background-color: #eee;'>error VersionNotRegistered();</span>
  6 |     | <span style='background-color: #eee;'>/// @notice version name cannot be the empty string</span>
  7 |     | <span style='background-color: #eee;'>error InvalidVersionName();</span>
  8 |     | <span style='background-color: #eee;'>/// @notice implementation must be a contract</span>
  9 |     | <span style='background-color: #eee;'>error InvalidImplementation();</span>
 10 |     | <span style='background-color: #eee;'>/// @notice version is already registered</span>
 11 |     | <span style='background-color: #eee;'>error VersionAlreadyRegistered();</span>
 12 |     | <span style='background-color: #eee;'></span>
 13 |     | <span style='background-color: #eee;'>interface IVersionManager {</span>
 14 |     | <span style='background-color: #eee;'>    /// @dev Signifies the status of a version</span>
 15 |     | <span style='background-color: #eee;'>    enum Status {</span>
 16 |     | <span style='background-color: #eee;'>        BETA,</span>
 17 |     | <span style='background-color: #eee;'>        RC,</span>
 18 |     | <span style='background-color: #eee;'>        PRODUCTION,</span>
 19 |     | <span style='background-color: #eee;'>        DEPRECATED</span>
 20 |     | <span style='background-color: #eee;'>    }</span>
 21 |     | <span style='background-color: #eee;'></span>
 22 |     | <span style='background-color: #eee;'>    /// @dev Indicated the highest level of bug found in the version</span>
 23 |     | <span style='background-color: #eee;'>    enum BugLevel {</span>
 24 |     | <span style='background-color: #eee;'>        NONE,</span>
 25 |     | <span style='background-color: #eee;'>        LOW,</span>
 26 |     | <span style='background-color: #eee;'>        MEDIUM,</span>
 27 |     | <span style='background-color: #eee;'>        HIGH,</span>
 28 |     | <span style='background-color: #eee;'>        CRITICAL</span>
 29 |     | <span style='background-color: #eee;'>    }</span>
 30 |     | <span style='background-color: #eee;'></span>
 31 |     | <span style='background-color: #eee;'>    /// @dev A struct to encode version details</span>
 32 |     | <span style='background-color: #eee;'>    struct Version {</span>
 33 |     | <span style='background-color: #eee;'>        // the version number string ex. &quot;v1.0&quot;</span>
 34 |     | <span style='background-color: #eee;'>        string versionName;</span>
 35 |     | <span style='background-color: #eee;'>        Status status;</span>
 36 |     | <span style='background-color: #eee;'>        BugLevel bugLevel;</span>
 37 |     | <span style='background-color: #eee;'>        // the address of the instantiation of the version</span>
 38 |     | <span style='background-color: #eee;'>        address implementation;</span>
 39 |     | <span style='background-color: #eee;'>        // the date when this version was registered with the contract</span>
 40 |     | <span style='background-color: #eee;'>        uint256 dateAdded;</span>
 41 |     | <span style='background-color: #eee;'>    }</span>
 42 |     | <span style='background-color: #eee;'></span>
 43 |     | <span style='background-color: #eee;'>    event VersionAdded(string versionName, address indexed implementation);</span>
 44 |     | <span style='background-color: #eee;'></span>
 45 |     | <span style='background-color: #eee;'>    event VersionUpdated(string versionName, Status status, BugLevel bugLevel);</span>
 46 |     | <span style='background-color: #eee;'></span>
 47 |     | <span style='background-color: #eee;'>    event VersionRecommended(string versionName);</span>
 48 |     | <span style='background-color: #eee;'></span>
 49 |     | <span style='background-color: #eee;'>    event RecommendedVersionRemoved();</span>
 50 |     | <span style='background-color: #eee;'></span>
 51 |     | <span style='background-color: #eee;'>    function addVersion(Status status, address implementation) external;</span>
 52 |     | <span style='background-color: #eee;'></span>
 53 |     | <span style='background-color: #eee;'>    function updateVersion(string calldata versionName, Status status, BugLevel bugLevel) external;</span>
 54 |     | <span style='background-color: #eee;'></span>
 55 |     | <span style='background-color: #eee;'>    function markRecommendedVersion(string calldata versionName) external;</span>
 56 |     | <span style='background-color: #eee;'></span>
 57 |     | <span style='background-color: #eee;'>    function removeRecommendedVersion() external;</span>
 58 |     | <span style='background-color: #eee;'></span>
 59 |     | <span style='background-color: #eee;'>    function getRecommendedVersion()</span>
 60 |     | <span style='background-color: #eee;'>        external</span>
 61 |     | <span style='background-color: #eee;'>        view</span>
 62 |     | <span style='background-color: #eee;'>        returns (</span>
 63 |     | <span style='background-color: #eee;'>            string memory versionName,</span>
 64 |     | <span style='background-color: #eee;'>            Status status,</span>
 65 |     | <span style='background-color: #eee;'>            BugLevel bugLevel,</span>
 66 |     | <span style='background-color: #eee;'>            address implementation,</span>
 67 |     | <span style='background-color: #eee;'>            uint256 dateAdded</span>
 68 |     | <span style='background-color: #eee;'>        );</span>
 69 |     | <span style='background-color: #eee;'></span>
 70 |     | <span style='background-color: #eee;'>    function getVersionCount() external view returns (uint256 count);</span>
 71 |     | <span style='background-color: #eee;'></span>
 72 |     | <span style='background-color: #eee;'>    function getVersionAtIndex(uint256 index) external view returns (string memory versionName);</span>
 73 |     | <span style='background-color: #eee;'></span>
 74 |     | <span style='background-color: #eee;'>    function getVersionAddress(uint256 index) external view returns (address);</span>
 75 |     | <span style='background-color: #eee;'></span>
 76 |     | <span style='background-color: #eee;'>    function getVersionDetails(</span>
 77 |     | <span style='background-color: #eee;'>        string calldata versionName</span>
 78 |     | <span style='background-color: #eee;'>    )</span>
 79 |     | <span style='background-color: #eee;'>        external</span>
 80 |     | <span style='background-color: #eee;'>        view</span>
 81 |     | <span style='background-color: #eee;'>        returns (</span>
 82 |     | <span style='background-color: #eee;'>            string memory versionString,</span>
 83 |     | <span style='background-color: #eee;'>            Status status,</span>
 84 |     | <span style='background-color: #eee;'>            BugLevel bugLevel,</span>
 85 |     | <span style='background-color: #eee;'>            address implementation,</span>
 86 |     | <span style='background-color: #eee;'>            uint256 dateAdded</span>
 87 |     | <span style='background-color: #eee;'>        );</span>
 88 |     | <span style='background-color: #eee;'>}</span>
 89 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/lib/AccessControl.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;../tokens/HashNFT.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'>import &quot;../lib/FsUtils.sol&quot;;</span>
  6 |     | <span style='background-color: #eee;'>import &quot;./ImmutableGovernance.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'></span>
  8 |     | <span style='background-color: #eee;'>/// @title AccessControl</span>
  9 |     | <span style='background-color: #eee;'>/// @notice Access control based on HashNFT ownership.</span>
 10 |     | <span style='background-color: #eee;'>/// @dev The owner can grant access rights to an address by minting a HashNFT token</span>
 11 |     | <span style='background-color: #faa;'>/// to the address with the given access level.</span>
 12 |     | <span style='background-color: #eee;'>contract AccessControl is ImmutableGovernance {</span>
 13 |     | <span style='background-color: #eee;'>    enum AccessLevel {</span>
 14 |     | <span style='background-color: #eee;'>        SECURITY, // Can operate immediately on pausing exchange</span>
 15 |     | <span style='background-color: #eee;'>        FINANCIAL_RISK // Can set fees, risk factors and interest rates</span>
 16 |     | <span style='background-color: #eee;'>    }</span>
 17 |     | <span style='background-color: #eee;'></span>
 18 |     | <span style='background-color: #eee;'>    HashNFT internal immutable hashNFT;</span>
 19 |     | <span style='background-color: #eee;'></span>
 20 |     | <span style='background-color: #eee;'>    constructor(address owner, address hashNFT_) ImmutableGovernance(owner) {</span>
 21 |     | <span style='background-color: #faa;'>        hashNFT = HashNFT(FsUtils.nonNull(hashNFT_));</span>
 22 |     | <span style='background-color: #eee;'>        require(</span>
 23 |     | <span style='background-color: #faa;'>            hashNFT.supportsInterface(type(IERC1155).interfaceId),</span>
 24 |     | <span style='background-color: #eee;'>            &quot;AccessControl: not HashNFT&quot;</span>
 25 |     | <span style='background-color: #eee;'>        );</span>
 26 |     | <span style='background-color: #eee;'>    }</span>
 27 |     | <span style='background-color: #eee;'></span>
 28 |     | <span style='background-color: #eee;'>    function mintAccess(</span>
 29 |     | <span style='background-color: #eee;'>        address to,</span>
 30 |     | <span style='background-color: #eee;'>        uint256 accessLevel,</span>
 31 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
 32 |     | <span style='background-color: #eee;'>    ) external onlyGovernance {</span>
 33 |     | <span style='background-color: #faa;'>        hashNFT.mint(to, bytes32(accessLevel), data);</span>
 34 |     | <span style='background-color: #eee;'>    }</span>
 35 |     | <span style='background-color: #eee;'></span>
 36 |     | <span style='background-color: #eee;'>    function revokeAccess(address from, uint256 accessLevel) external onlyGovernance {</span>
 37 |     | <span style='background-color: #faa;'>        hashNFT.revoke(from, bytes32(accessLevel));</span>
 38 |     | <span style='background-color: #eee;'>    }</span>
 39 |     | <span style='background-color: #eee;'></span>
 40 |     | <span style='background-color: #faa;'>    function hasAccess(address account, uint256 accessLevel) public view returns (bool) {</span>
 41 |     | <span style='background-color: #eee;'>        return</span>
 42 |     | <span style='background-color: #faa;'>            hashNFT.balanceOf(account, hashNFT.toTokenId(address(this), bytes32(accessLevel))) &gt; 0;</span>
 43 |     | <span style='background-color: #eee;'>    }</span>
 44 |     | <span style='background-color: #eee;'>}</span>
 45 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/lib/Call.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>/**</span>
   7 |     | <span style='background-color: #eee;'> * @title A serialized contract method call.</span>
   8 |     | <span style='background-color: #eee;'> *</span>
   9 |     | <span style='background-color: #eee;'> * @notice A call to a contract with no native value transferred as part of the call.</span>
  10 |     | <span style='background-color: #eee;'> *</span>
  11 |     | <span style='background-color: #eee;'> * We often need to pass calls around, so this is a common representation to use.</span>
  12 |     | <span style='background-color: #eee;'> */</span>
  13 |     | <span style='background-color: #eee;'>struct CallWithoutValue {</span>
  14 |     | <span style='background-color: #eee;'>    address to;</span>
  15 |     | <span style='background-color: #eee;'>    bytes callData;</span>
  16 |     | <span style='background-color: #eee;'>}</span>
  17 |     | <span style='background-color: #eee;'></span>
  18 |     | <span style='background-color: #eee;'>/**</span>
  19 |     | <span style='background-color: #eee;'> * @title A serialized contract method call, with value.</span>
  20 |     | <span style='background-color: #eee;'> *</span>
  21 |     | <span style='background-color: #eee;'> * @notice A call to a contract that may also have native value transferred as part of the call.</span>
  22 |     | <span style='background-color: #eee;'> *</span>
  23 |     | <span style='background-color: #eee;'> * We often need to pass calls around, so this is a common representation to use.</span>
  24 |     | <span style='background-color: #eee;'> */</span>
  25 |     | <span style='background-color: #eee;'>struct Call {</span>
  26 |     | <span style='background-color: #eee;'>    address to;</span>
  27 |     | <span style='background-color: #eee;'>    bytes callData;</span>
  28 |     | <span style='background-color: #eee;'>    uint256 value;</span>
  29 |     | <span style='background-color: #eee;'>}</span>
  30 |     | <span style='background-color: #faa;'></span>
  31 |     | <span style='background-color: #eee;'>library CallLib {</span>
  32 |     | <span style='background-color: #eee;'>    using Address for address;</span>
  33 |     | <span style='background-color: #eee;'></span>
  34 |     | <span style='background-color: #faa;'>    bytes internal constant CALL_TYPESTRING = &quot;Call(address to,bytes callData,uint256 value)&quot;;</span>
  35 |     | <span style='background-color: #faa;'>    bytes32 constant CALL_TYPEHASH = keccak256(CALL_TYPESTRING);</span>
  36 |     | <span style='background-color: #eee;'>    bytes internal constant CALLWITHOUTVALUE_TYPESTRING =</span>
  37 |     | <span style='background-color: #eee;'>        &quot;CallWithoutValue(address to,bytes callData)&quot;;</span>
  38 |     | <span style='background-color: #faa;'>    bytes32 constant CALLWITHOUTVALUE_TYPEHASH = keccak256(CALLWITHOUTVALUE_TYPESTRING);</span>
  39 |     | <span style='background-color: #eee;'></span>
  40 |     | <span style='background-color: #eee;'>    /**</span>
  41 |     | <span style='background-color: #eee;'>     * @notice Execute a call.</span>
  42 |     | <span style='background-color: #eee;'>     *</span>
  43 |     | <span style='background-color: #eee;'>     * @param call The call to execute.</span>
  44 |     | <span style='background-color: #eee;'>     */</span>
  45 |     | <span style='background-color: #eee;'>    function executeWithoutValue(CallWithoutValue memory call) internal {</span>
  46 |     | <span style='background-color: #faa;'>        call.to.functionCall(call.callData);</span>
  47 |     | <span style='background-color: #eee;'>    }</span>
  48 |     | <span style='background-color: #eee;'></span>
  49 |     | <span style='background-color: #eee;'>    /**</span>
  50 |     | <span style='background-color: #eee;'>     * @notice Execute a call with value.</span>
  51 |     | <span style='background-color: #eee;'>     *</span>
  52 |     | <span style='background-color: #eee;'>     * @param call The call to execute.</span>
  53 |     | <span style='background-color: #eee;'>     */</span>
  54 |     | <span style='background-color: #eee;'>    function execute(Call memory call) internal {</span>
  55 |     | <span style='background-color: #faa;'>        call.to.functionCallWithValue(call.callData, call.value);</span>
  56 |     | <span style='background-color: #eee;'>    }</span>
  57 |     | <span style='background-color: #eee;'></span>
  58 |     | <span style='background-color: #eee;'>    /**</span>
  59 |     | <span style='background-color: #eee;'>     * @notice Execute a batch of calls.</span>
  60 |     | <span style='background-color: #eee;'>     *</span>
  61 |     | <span style='background-color: #eee;'>     * @param calls The calls to execute.</span>
  62 |     | <span style='background-color: #eee;'>     */</span>
  63 |     | <span style='background-color: #eee;'>    function executeBatch(Call[] memory calls) internal {</span>
  64 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; calls.length; i++) {</span>
  65 |     | <span style='background-color: #faa;'>            execute(calls[i]);</span>
  66 |     | <span style='background-color: #eee;'>        }</span>
  67 |     | <span style='background-color: #eee;'>    }</span>
  68 |     | <span style='background-color: #eee;'></span>
  69 |     | <span style='background-color: #eee;'>    /**</span>
  70 |     | <span style='background-color: #eee;'>     * @notice Execute a batch of calls with value.</span>
  71 |     | <span style='background-color: #eee;'>     *</span>
  72 |     | <span style='background-color: #eee;'>     * @param calls The calls to execute.</span>
  73 |     | <span style='background-color: #eee;'>     */</span>
  74 |     | <span style='background-color: #eee;'>    function executeBatchWithoutValue(CallWithoutValue[] memory calls) internal {</span>
  75 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; calls.length; i++) {</span>
  76 |     | <span style='background-color: #faa;'>            executeWithoutValue(calls[i]);</span>
  77 |     | <span style='background-color: #eee;'>        }</span>
  78 |     | <span style='background-color: #eee;'>    }</span>
  79 |     | <span style='background-color: #eee;'></span>
  80 |     | <span style='background-color: #eee;'>    function hashCall(Call memory call) internal pure returns (bytes32) {</span>
  81 |     | <span style='background-color: #faa;'>        return keccak256(abi.encode(CALL_TYPEHASH, call.to, keccak256(call.callData), call.value));</span>
  82 |     | <span style='background-color: #eee;'>    }</span>
  83 |     | <span style='background-color: #eee;'></span>
  84 |     | <span style='background-color: #faa;'>    function hashCallArray(Call[] memory calls) internal pure returns (bytes32) {</span>
  85 |     | <span style='background-color: #faa;'>        bytes32[] memory hashes = new bytes32[](calls.length);</span>
  86 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; calls.length; i++) {</span>
  87 |     | <span style='background-color: #faa;'>            hashes[i] = hashCall(calls[i]);</span>
  88 |     | <span style='background-color: #eee;'>        }</span>
  89 |     | <span style='background-color: #faa;'>        return keccak256(abi.encodePacked(hashes));</span>
  90 |     | <span style='background-color: #eee;'>    }</span>
  91 |     | <span style='background-color: #eee;'></span>
  92 |     | <span style='background-color: #eee;'>    function hashCallWithoutValue(CallWithoutValue memory call) internal pure returns (bytes32) {</span>
  93 |     | <span style='background-color: #faa;'>        return keccak256(abi.encode(CALLWITHOUTVALUE_TYPEHASH, call.to, keccak256(call.callData)));</span>
  94 |     | <span style='background-color: #eee;'>    }</span>
  95 |     | <span style='background-color: #eee;'></span>
  96 |     | <span style='background-color: #faa;'>    function hashCallWithoutValueArray(</span>
  97 |     | <span style='background-color: #eee;'>        CallWithoutValue[] memory calls</span>
  98 |     | <span style='background-color: #eee;'>    ) internal pure returns (bytes32) {</span>
  99 |     | <span style='background-color: #eee;'>        bytes32[] memory hashes = new bytes32[](calls.length);</span>
 100 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; calls.length; i++) {</span>
 101 |     | <span style='background-color: #faa;'>            hashes[i] = hashCallWithoutValue(calls[i]);</span>
 102 |     | <span style='background-color: #eee;'>        }</span>
 103 |     | <span style='background-color: #faa;'>        return keccak256(abi.encodePacked(hashes));</span>
 104 |     | <span style='background-color: #eee;'>    }</span>
 105 |     | <span style='background-color: #eee;'>}</span>
 106 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/lib/FsMath.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>import &quot;./FsUtils.sol&quot;;</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>/**</span>
   7 |     | <span style='background-color: #eee;'> * @title Utility methods basic math operations.</span>
   8 |     | <span style='background-color: #eee;'> *</span>
   9 |     | <span style='background-color: #eee;'> * NOTE In order for the fuzzing tests to be isolated, all functions in this library need to be</span>
  10 |     | <span style='background-color: #eee;'> * `internal`.  Otherwise a contract that uses this library has a dependency on the library.</span>
  11 |     | <span style='background-color: #eee;'> *</span>
  12 |     | <span style='background-color: #eee;'> * Our current Echidna setup requires contracts to be deployable in isolation, so make sure to keep</span>
  13 |     | <span style='background-color: #eee;'> * the functions `internal`, until we update our Echidna tests to support more complex setups.</span>
  14 |     | <span style='background-color: #faa;'> */</span>
  15 |     | <span style='background-color: #eee;'>library FsMath {</span>
  16 |     | <span style='background-color: #eee;'>    /**</span>
  17 |     | <span style='background-color: #eee;'>     * @notice Size of `FIXED_POINT_SCALE` in bits.</span>
  18 |     | <span style='background-color: #eee;'>     */</span>
  19 |     | <span style='background-color: #faa;'>    int256 constant FIXED_POINT_SCALE_BITS = 64;</span>
  20 |     | <span style='background-color: #eee;'></span>
  21 |     | <span style='background-color: #eee;'>    /**</span>
  22 |     | <span style='background-color: #eee;'>     * @notice Scaling factor used by our fixed-point integer representation.</span>
  23 |     | <span style='background-color: #eee;'>     *</span>
  24 |     | <span style='background-color: #eee;'>     * We chose `FIXED_POINT_SCALE` to be a power of 2 to make certain optimizations in the</span>
  25 |     | <span style='background-color: #eee;'>     * calculation of `e^x` more efficient.  See `exp()` implementation for details.</span>
  26 |     | <span style='background-color: #eee;'>     *</span>
  27 |     | <span style='background-color: #eee;'>     * See https://en.wikipedia.org/wiki/Fixed-point_arithmetic</span>
  28 |     | <span style='background-color: #eee;'>     */</span>
  29 |     | <span style='background-color: #faa;'>    int256 constant FIXED_POINT_SCALE = int256(1) &lt;&lt; uint256(FIXED_POINT_SCALE_BITS);</span>
  30 |     | <span style='background-color: #eee;'></span>
  31 |     | <span style='background-color: #faa;'>    uint256 constant UINT256_MAX = ~uint256(0);</span>
  32 |     | <span style='background-color: #eee;'></span>
  33 |     | <span style='background-color: #faa;'>    function abs(int256 value) internal pure returns (uint256) {</span>
  34 |     | <span style='background-color: #faa;'>        if (value &gt;= 0) {</span>
  35 |     | <span style='background-color: #eee;'>            // slither-disable-next-line safe-cast</span>
  36 |     | <span style='background-color: #eee;'>            return uint256(value);</span>
  37 |     | <span style='background-color: #eee;'>        }</span>
  38 |     | <span style='background-color: #eee;'>        // slither-disable-next-line safe-cast</span>
  39 |     | <span style='background-color: #faa;'>        return uint256(-value);</span>
  40 |     | <span style='background-color: #eee;'>    }</span>
  41 |     | <span style='background-color: #eee;'></span>
  42 |     | <span style='background-color: #eee;'>    function sabs(int256 value) internal pure returns (int256) {</span>
  43 |     | <span style='background-color: #eee;'>        if (value &gt;= 0) {</span>
  44 |     | <span style='background-color: #eee;'>            return value;</span>
  45 |     | <span style='background-color: #eee;'>        }</span>
  46 |     | <span style='background-color: #eee;'>        return -value;</span>
  47 |     | <span style='background-color: #eee;'>    }</span>
  48 |     | <span style='background-color: #eee;'></span>
  49 |     | <span style='background-color: #faa;'>    function sign(int256 value) internal pure returns (int256) {</span>
  50 |     | <span style='background-color: #faa;'>        if (value &lt; 0) {</span>
  51 |     | <span style='background-color: #faa;'>            return -1;</span>
  52 |     | <span style='background-color: #faa;'>        } else if (value &gt; 0) {</span>
  53 |     | <span style='background-color: #faa;'>            return 1;</span>
  54 |     | <span style='background-color: #eee;'>        } else {</span>
  55 |     | <span style='background-color: #faa;'>            return 0;</span>
  56 |     | <span style='background-color: #eee;'>        }</span>
  57 |     | <span style='background-color: #eee;'>    }</span>
  58 |     | <span style='background-color: #eee;'></span>
  59 |     | <span style='background-color: #eee;'>    function min(int256 a, int256 b) internal pure returns (int256) {</span>
  60 |     | <span style='background-color: #faa;'>        return a &lt; b ? a : b;</span>
  61 |     | <span style='background-color: #eee;'>    }</span>
  62 |     | <span style='background-color: #eee;'></span>
  63 |     | <span style='background-color: #eee;'>    function max(int256 a, int256 b) internal pure returns (int256) {</span>
  64 |     | <span style='background-color: #faa;'>        return a &gt; b ? a : b;</span>
  65 |     | <span style='background-color: #eee;'>    }</span>
  66 |     | <span style='background-color: #eee;'></span>
  67 |     | <span style='background-color: #eee;'>    // Clip val into interval [lower, upper]</span>
  68 |     | <span style='background-color: #eee;'>    function clip(int256 val, int256 lower, int256 upper) internal pure returns (int256) {</span>
  69 |     | <span style='background-color: #eee;'>        return min(max(val, lower), upper);</span>
  70 |     | <span style='background-color: #eee;'>    }</span>
  71 |     | <span style='background-color: #eee;'></span>
  72 |     | <span style='background-color: #faa;'>    function safeCastToSigned(uint256 x) internal pure returns (int256) {</span>
  73 |     | <span style='background-color: #eee;'>        // slither-disable-next-line safe-cast</span>
  74 |     | <span style='background-color: #eee;'>        int256 ret = int256(x);</span>
  75 |     | <span style='background-color: #faa;'>        require(ret &gt;= 0, &quot;Cast overflow&quot;);</span>
  76 |     | <span style='background-color: #eee;'>        return ret;</span>
  77 |     | <span style='background-color: #eee;'>    }</span>
  78 |     | <span style='background-color: #eee;'></span>
  79 |     | <span style='background-color: #faa;'>    function safeCastToUnsigned(int256 x) internal pure returns (uint256) {</span>
  80 |     | <span style='background-color: #faa;'>        require(x &gt;= 0, &quot;Cast underflow&quot;);</span>
  81 |     | <span style='background-color: #eee;'>        // slither-disable-next-line safe-cast</span>
  82 |     | <span style='background-color: #eee;'>        return uint256(x);</span>
  83 |     | <span style='background-color: #eee;'>    }</span>
  84 |     | <span style='background-color: #eee;'></span>
  85 |     | <span style='background-color: #eee;'>    /**</span>
  86 |     | <span style='background-color: #eee;'>     * @notice Calculate `e^x`.</span>
  87 |     | <span style='background-color: #eee;'>     *</span>
  88 |     | <span style='background-color: #eee;'>     * @param x Is a fixed point decimals with the scale of `FIXED_POINT_SCALE`.</span>
  89 |     | <span style='background-color: #eee;'>     * @return A fixed point decimals with the scale of `FIXED_POINT_SCALE`.</span>
  90 |     | <span style='background-color: #eee;'>     */</span>
  91 |     | <span style='background-color: #faa;'>    function exp(int256 x) internal pure returns (int256) {</span>
  92 |     | <span style='background-color: #eee;'>        /*</span>
  93 |     | <span style='background-color: #eee;'>         * Making fixed point representation explicit we want to compute</span>
  94 |     | <span style='background-color: #eee;'>         *</span>
  95 |     | <span style='background-color: #eee;'>         * result = e^(x / FIXED_POINT_SCALE) * FIXED_POINT_SCALE</span>
  96 |     | <span style='background-color: #eee;'>         *</span>
  97 |     | <span style='background-color: #eee;'>         * To efficiently and accurately calculate the above expression we decompose this into 3</span>
  98 |     | <span style='background-color: #eee;'>         * parts where each part has an efficient and accurate method of calculation.</span>
  99 |     | <span style='background-color: #eee;'>         *</span>
 100 |     | <span style='background-color: #eee;'>         * First, we transform the exponentiation into base 2 so we can use shifts:</span>
 101 |     | <span style='background-color: #eee;'>         *</span>
 102 |     | <span style='background-color: #eee;'>         *   e^(x / FIXED_POINT_SCALE) * FIXED_POINT_SCALE</span>
 103 |     | <span style='background-color: #eee;'>         * = 2^(x / FIXED_POINT_SCALE / ln(2)) * FIXED_POINT_SCALE</span>
 104 |     | <span style='background-color: #eee;'>         * = 2^(x / ln2FixedPoint) * FIXED_POINT_SCALE</span>
 105 |     | <span style='background-color: #eee;'>         * = 2^integerQuot * 2^(rem / ln2FixedPoint) * FIXED_POINT_SCALE</span>
 106 |     | <span style='background-color: #eee;'>         */</span>
 107 |     | <span style='background-color: #eee;'></span>
 108 |     | <span style='background-color: #eee;'>        FsUtils.Assert(FIXED_POINT_SCALE_BITS == 64);</span>
 109 |     | <span style='background-color: #eee;'>        /*</span>
 110 |     | <span style='background-color: #eee;'>         * ln(2) * 2^FIXED_POINT_SCALE_BITS = ln(2) * 2^64</span>
 111 |     | <span style='background-color: #eee;'>         */</span>
 112 |     | <span style='background-color: #faa;'>        int256 ln2FixedPoint = 12786308645202655659;</span>
 113 |     | <span style='background-color: #eee;'></span>
 114 |     | <span style='background-color: #eee;'>        int256 shiftLeft = x / ln2FixedPoint;</span>
 115 |     | <span style='background-color: #eee;'>        int256 remainder = x % ln2FixedPoint;</span>
 116 |     | <span style='background-color: #faa;'>        if (shiftLeft &lt;= -FIXED_POINT_SCALE_BITS) return 0;</span>
 117 |     | <span style='background-color: #faa;'>        require(shiftLeft &lt; (256 - FIXED_POINT_SCALE_BITS), &quot;Exponentiation overflows&quot;);</span>
 118 |     | <span style='background-color: #eee;'></span>
 119 |     | <span style='background-color: #eee;'>        /*</span>
 120 |     | <span style='background-color: #eee;'>         * At this point we have decomposed exp as a simple bitshift and a fractional power of 2. We</span>
 121 |     | <span style='background-color: #eee;'>         * could express this as an integer power like</span>
 122 |     | <span style='background-color: #eee;'>         *</span>
 123 |     | <span style='background-color: #eee;'>         *      (2^(1/ln2FixedPoint))^remainder</span>
 124 |     | <span style='background-color: #eee;'>         *</span>
 125 |     | <span style='background-color: #eee;'>         * but `remainder` is very big, in the order of `10^19` resulting in ~60 (2log) iteration in</span>
 126 |     | <span style='background-color: #eee;'>         * repeated squaring but more problematic also a lot of precision loss. It turns out that</span>
 127 |     | <span style='background-color: #eee;'>         * `ln2FixedPoint` as an integer has a smallish factor.</span>
 128 |     | <span style='background-color: #eee;'>         */</span>
 129 |     | <span style='background-color: #eee;'>        int256 smallFactor = 4373;</span>
 130 |     | <span style='background-color: #eee;'>        int256 bigFactor = ln2FixedPoint / smallFactor;</span>
 131 |     | <span style='background-color: #eee;'></span>
 132 |     | <span style='background-color: #eee;'>        /*</span>
 133 |     | <span style='background-color: #eee;'>         * Split</span>
 134 |     | <span style='background-color: #eee;'>         *</span>
 135 |     | <span style='background-color: #eee;'>         *      2^(remainder/ln2FixedPoint)</span>
 136 |     | <span style='background-color: #eee;'>         *</span>
 137 |     | <span style='background-color: #eee;'>         * as</span>
 138 |     | <span style='background-color: #eee;'>         *</span>
 139 |     | <span style='background-color: #eee;'>         *      (2^(1/smallFactor)) ^ (remainder/bigFactor)</span>
 140 |     | <span style='background-color: #eee;'>         */</span>
 141 |     | <span style='background-color: #eee;'>        int256 integerPower = remainder / bigFactor;</span>
 142 |     | <span style='background-color: #eee;'>        int256 smallRemainder = remainder % bigFactor;</span>
 143 |     | <span style='background-color: #eee;'></span>
 144 |     | <span style='background-color: #eee;'>        /*</span>
 145 |     | <span style='background-color: #eee;'>         * So we can further decompose as follows:</span>
 146 |     | <span style='background-color: #eee;'>         *</span>
 147 |     | <span style='background-color: #eee;'>         * (2^(1/smallFactor))^(integerPower) * exp(smallRemainder/fixedPoint)</span>
 148 |     | <span style='background-color: #eee;'>         *</span>
 149 |     | <span style='background-color: #eee;'>         * where in the last factor base 2 is replaced with an ordinary e-power using ln2.</span>
 150 |     | <span style='background-color: #eee;'>         *</span>
 151 |     | <span style='background-color: #eee;'>         * At this point `0 &lt;= integerPower &lt; smallFactor` and `0 &lt;= smallRemainder &lt; bigFactor`.</span>
 152 |     | <span style='background-color: #eee;'>         * The first range implies that repeated exponentiation of the first factor won&#39;t loop too</span>
 153 |     | <span style='background-color: #eee;'>         * much and has rather good precision.  The second range implies that</span>
 154 |     | <span style='background-color: #eee;'>         * `smallRemainder/FIXED_POINT_SCALE &lt; 1/4373` so that the Taylor expansion rapidly</span>
 155 |     | <span style='background-color: #eee;'>         * converges.</span>
 156 |     | <span style='background-color: #eee;'>         */</span>
 157 |     | <span style='background-color: #faa;'>        int256 taylorApprox = FIXED_POINT_SCALE +</span>
 158 |     | <span style='background-color: #eee;'>            smallRemainder +</span>
 159 |     | <span style='background-color: #faa;'>            (smallRemainder * smallRemainder) /</span>
 160 |     | <span style='background-color: #eee;'>            (2 * FIXED_POINT_SCALE) +</span>
 161 |     | <span style='background-color: #faa;'>            (smallRemainder * smallRemainder * smallRemainder) /</span>
 162 |     | <span style='background-color: #eee;'>            (6 * FIXED_POINT_SCALE * FIXED_POINT_SCALE);</span>
 163 |     | <span style='background-color: #eee;'></span>
 164 |     | <span style='background-color: #faa;'>        int256 twoPowRecipSmallFactor = 18449668226934502855; // 2^(1/smallFactor) in fixed point</span>
 165 |     | <span style='background-color: #faa;'>        int256 prod;</span>
 166 |     | <span style='background-color: #faa;'>        if (integerPower &gt;= 0) {</span>
 167 |     | <span style='background-color: #eee;'>            /*</span>
 168 |     | <span style='background-color: #eee;'>             * This implies shiftLeft &gt;= 0 we don&#39;t want to lose precision by first dividing and</span>
 169 |     | <span style='background-color: #eee;'>             * subsequent shifting left.</span>
 170 |     | <span style='background-color: #eee;'>             */</span>
 171 |     | <span style='background-color: #faa;'>            prod = pow(twoPowRecipSmallFactor, integerPower) * taylorApprox;</span>
 172 |     | <span style='background-color: #faa;'>            shiftLeft -= FIXED_POINT_SCALE_BITS;</span>
 173 |     | <span style='background-color: #eee;'>        } else {</span>
 174 |     | <span style='background-color: #eee;'>            /*</span>
 175 |     | <span style='background-color: #eee;'>             * This implies shiftLeft &lt;= 0 so we&#39;re losing precision anyway.</span>
 176 |     | <span style='background-color: #eee;'>             */</span>
 177 |     | <span style='background-color: #faa;'>            prod = (FIXED_POINT_SCALE * taylorApprox) / pow(twoPowRecipSmallFactor, -integerPower);</span>
 178 |     | <span style='background-color: #eee;'>        }</span>
 179 |     | <span style='background-color: #eee;'></span>
 180 |     | <span style='background-color: #faa;'>        return shiftLeft &gt;= 0 ? (prod &lt;&lt; uint256(shiftLeft)) : (prod &gt;&gt; uint256(-shiftLeft));</span>
 181 |     | <span style='background-color: #eee;'>    }</span>
 182 |     | <span style='background-color: #eee;'></span>
 183 |     | <span style='background-color: #eee;'>    /**</span>
 184 |     | <span style='background-color: #eee;'>     * @notice Calculates `x^n`</span>
 185 |     | <span style='background-color: #eee;'>     *</span>
 186 |     | <span style='background-color: #eee;'>     * Note we cannot use solidity `**` as we have to normalize fixed point after every</span>
 187 |     | <span style='background-color: #eee;'>     * multiplication.</span>
 188 |     | <span style='background-color: #eee;'>     *</span>
 189 |     | <span style='background-color: #eee;'>     * @param x  a `FIXED_POINT_SCALE` fixed point decimal, with a scale of `FIXED_POINT_SCALE`.</span>
 190 |     | <span style='background-color: #eee;'>     * @param n  an integer.</span>
 191 |     | <span style='background-color: #eee;'>     */</span>
 192 |     | <span style='background-color: #faa;'>    function pow(int256 x, int256 n) internal pure returns (int256) {</span>
 193 |     | <span style='background-color: #faa;'>        if (n &gt;= 0) {</span>
 194 |     | <span style='background-color: #faa;'>            return powInternal(x, n);</span>
 195 |     | <span style='background-color: #eee;'>        } else {</span>
 196 |     | <span style='background-color: #faa;'>            return powInternal((FIXED_POINT_SCALE * FIXED_POINT_SCALE) / x, -n);</span>
 197 |     | <span style='background-color: #eee;'>        }</span>
 198 |     | <span style='background-color: #eee;'>    }</span>
 199 |     | <span style='background-color: #eee;'></span>
 200 |     | <span style='background-color: #eee;'>    /**</span>
 201 |     | <span style='background-color: #eee;'>     * @notice Calculates square root of `x`, in fixed point decimal with a scale of</span>
 202 |     | <span style='background-color: #eee;'>     * `FIXED_POINT_SCALE`.</span>
 203 |     | <span style='background-color: #eee;'>     *</span>
 204 |     | <span style='background-color: #eee;'>     * @param x  a `FIXED_POINT_SCALE` fixed point decimal, with a scale of `FIXED_POINT_SCALE`.</span>
 205 |     | <span style='background-color: #eee;'>     */</span>
 206 |     | <span style='background-color: #eee;'>    function sqrt(int256 x) internal pure returns (int256) {</span>
 207 |     | <span style='background-color: #faa;'>        require(x &gt;= 0, &quot;Square root of negative number&quot;);</span>
 208 |     | <span style='background-color: #faa;'>        int256 prevRes = 0;</span>
 209 |     | <span style='background-color: #faa;'>        int256 res = x / 2;</span>
 210 |     | <span style='background-color: #faa;'>        while (res != prevRes) {</span>
 211 |     | <span style='background-color: #faa;'>            prevRes = res;</span>
 212 |     | <span style='background-color: #faa;'>            res = (res + (x &lt;&lt; uint256(FIXED_POINT_SCALE_BITS)) / res) / 2;</span>
 213 |     | <span style='background-color: #eee;'>        }</span>
 214 |     | <span style='background-color: #eee;'>        return res;</span>
 215 |     | <span style='background-color: #eee;'>    }</span>
 216 |     | <span style='background-color: #eee;'></span>
 217 |     | <span style='background-color: #eee;'>    // See https://en.wikipedia.org/wiki/Hamming_weight#Efficient_implementation</span>
 218 |     | <span style='background-color: #faa;'>    function bitCount(uint256 x) internal pure returns (uint256) {</span>
 219 |     | <span style='background-color: #eee;'>        // In this routine we purposefully interpret x as a number in Z mod (2^256) in the</span>
 220 |     | <span style='background-color: #eee;'>        // multiplication.</span>
 221 |     | <span style='background-color: #eee;'>        unchecked {</span>
 222 |     | <span style='background-color: #faa;'>            if (x == UINT256_MAX) return 256;</span>
 223 |     | <span style='background-color: #eee;'></span>
 224 |     | <span style='background-color: #eee;'>            // Count 1&#39;s in 128 2-bit groups</span>
 225 |     | <span style='background-color: #eee;'>            uint256 mask = UINT256_MAX / 3; // 0x5555...</span>
 226 |     | <span style='background-color: #eee;'>            // Special case (x &amp; mask) + ((x &gt;&gt; 1) &amp; mask) equals formula below with less</span>
 227 |     | <span style='background-color: #eee;'>            // instructions.</span>
 228 |     | <span style='background-color: #faa;'>            x = x - ((x &gt;&gt; 1) &amp; mask);</span>
 229 |     | <span style='background-color: #eee;'></span>
 230 |     | <span style='background-color: #eee;'>            // Count 1&#39;s in 64 4-bit groups</span>
 231 |     | <span style='background-color: #eee;'>            mask = UINT256_MAX / 5; // 0x3333....</span>
 232 |     | <span style='background-color: #faa;'>            x = (x &amp; mask) + ((x &gt;&gt; 2) &amp; mask);</span>
 233 |     | <span style='background-color: #eee;'></span>
 234 |     | <span style='background-color: #eee;'>            // Count 1&#39;s in 32 8-bit groups. Note At this point there is no danger of overflowing</span>
 235 |     | <span style='background-color: #eee;'>            // between count of groups so we can have</span>
 236 |     | <span style='background-color: #eee;'>            // (x &amp; mask) + ((x &gt;&gt; n) &amp; mask) = (x + (x &gt;&gt; n)) &amp; mask</span>
 237 |     | <span style='background-color: #eee;'>            // which saves an instruction</span>
 238 |     | <span style='background-color: #eee;'>            mask = UINT256_MAX / 17; // 0x0F0F...</span>
 239 |     | <span style='background-color: #faa;'>            x = (x + (x &gt;&gt; 4)) &amp; mask;</span>
 240 |     | <span style='background-color: #eee;'></span>
 241 |     | <span style='background-color: #eee;'>            // At this point we have the count of each of the 32 bytes. In 8 bits we can store</span>
 242 |     | <span style='background-color: #eee;'>            // 0 to 255, so only UINT_MAX would overflow when represented in a single byte, which</span>
 243 |     | <span style='background-color: #eee;'>            // is case we have excluded. So we can calculate the</span>
 244 |     | <span style='background-color: #eee;'>            mask = UINT256_MAX / 255;</span>
 245 |     | <span style='background-color: #faa;'>            x = (x * mask) &gt;&gt; (256 - 8);</span>
 246 |     | <span style='background-color: #eee;'>        }</span>
 247 |     | <span style='background-color: #eee;'>        return x;</span>
 248 |     | <span style='background-color: #eee;'>    }</span>
 249 |     | <span style='background-color: #eee;'></span>
 250 |     | <span style='background-color: #eee;'>    /**</span>
 251 |     | <span style='background-color: #eee;'>     * @notice A helper used by `pow`, that expects that `n` is positive.</span>
 252 |     | <span style='background-color: #eee;'>     */</span>
 253 |     | <span style='background-color: #faa;'>    function powInternal(int256 x, int256 n) private pure returns (int256) {</span>
 254 |     | <span style='background-color: #eee;'>        int256 res = FIXED_POINT_SCALE;</span>
 255 |     | <span style='background-color: #faa;'>        while (n &gt; 0) {</span>
 256 |     | <span style='background-color: #faa;'>            if ((n &amp; 1) == 1) {</span>
 257 |     | <span style='background-color: #faa;'>                res = (res * x) / FIXED_POINT_SCALE;</span>
 258 |     | <span style='background-color: #eee;'>            }</span>
 259 |     | <span style='background-color: #faa;'>            x = (x * x) / FIXED_POINT_SCALE;</span>
 260 |     | <span style='background-color: #faa;'>            n /= 2;</span>
 261 |     | <span style='background-color: #eee;'>        }</span>
 262 |     | <span style='background-color: #faa;'>        return res;</span>
 263 |     | <span style='background-color: #eee;'>    }</span>
 264 |     | <span style='background-color: #eee;'>}</span>
 265 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/lib/FsUtils.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>// BEGIN STRIP</span>
  5 |     | <span style='background-color: #eee;'>// Used in `FsUtils.log` which is a debugging tool.</span>
  6 |     | <span style='background-color: #eee;'>import &quot;hardhat/console.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'></span>
  8 |     | <span style='background-color: #eee;'>// END STRIP</span>
  9 |     | <span style='background-color: #faa;'></span>
 10 |     | <span style='background-color: #eee;'>library FsUtils {</span>
 11 |     | <span style='background-color: #eee;'>    // BEGIN STRIP</span>
 12 |     | <span style='background-color: #eee;'>    // This method is only mean to be used in local testing.  See `preprocess` property in</span>
 13 |     | <span style='background-color: #eee;'>    // `packages/contracts/hardhat.config.ts`.</span>
 14 |     | <span style='background-color: #eee;'>    // Slither sees this function is not used, but it is convenient to have it around for debugging</span>
 15 |     | <span style='background-color: #eee;'>    // purposes.</span>
 16 |     | <span style='background-color: #eee;'>    // slither-disable-next-line dead-code</span>
 17 |     | <span style='background-color: #eee;'>    function log(string memory s) internal view {</span>
 18 |     | <span style='background-color: #eee;'>        console.log(s);</span>
 19 |     | <span style='background-color: #eee;'>    }</span>
 20 |     | <span style='background-color: #eee;'></span>
 21 |     | <span style='background-color: #eee;'>    // This method is only mean to be used in local testing.  See `preprocess` property in</span>
 22 |     | <span style='background-color: #eee;'>    // `packages/contracts/hardhat.config.ts`.</span>
 23 |     | <span style='background-color: #eee;'>    // Slither sees this function is not used, but it is convenient to have it around for debugging</span>
 24 |     | <span style='background-color: #eee;'>    // purposes.</span>
 25 |     | <span style='background-color: #eee;'>    // slither-disable-next-line dead-code</span>
 26 |     | <span style='background-color: #eee;'>    function log(string memory s, int256 x) internal view {</span>
 27 |     | <span style='background-color: #eee;'>        console.log(s);</span>
 28 |     | <span style='background-color: #eee;'>        console.logInt(x);</span>
 29 |     | <span style='background-color: #eee;'>    }</span>
 30 |     | <span style='background-color: #eee;'></span>
 31 |     | <span style='background-color: #eee;'>    function log(string memory s, address x) internal view {</span>
 32 |     | <span style='background-color: #eee;'>        console.log(s, x);</span>
 33 |     | <span style='background-color: #eee;'>    }</span>
 34 |     | <span style='background-color: #eee;'></span>
 35 |     | <span style='background-color: #eee;'>    // END STRIP</span>
 36 |     | <span style='background-color: #eee;'></span>
 37 |     | <span style='background-color: #eee;'>    function encodeToBytes32(bytes memory b) internal pure returns (bytes32) {</span>
 38 |     | <span style='background-color: #faa;'>        require(b.length &lt; 32, &quot;Byte array to long&quot;);</span>
 39 |     | <span style='background-color: #faa;'>        bytes32 out = bytes32(b);</span>
 40 |     | <span style='background-color: #faa;'>        out = (out &amp; (~(bytes32(type(uint256).max) &gt;&gt; (8 * b.length)))) | bytes32(b.length);</span>
 41 |     | <span style='background-color: #eee;'>        return out;</span>
 42 |     | <span style='background-color: #eee;'>    }</span>
 43 |     | <span style='background-color: #eee;'></span>
 44 |     | <span style='background-color: #eee;'>    function decodeFromBytes32(bytes32 b) internal pure returns (bytes memory) {</span>
 45 |     | <span style='background-color: #faa;'>        uint256 len = uint256(b) &amp; 0xff;</span>
 46 |     | <span style='background-color: #eee;'>        bytes memory out = new bytes(len);</span>
 47 |     | <span style='background-color: #faa;'>        for (uint256 i = 0; i &lt; len; i++) {</span>
 48 |     | <span style='background-color: #faa;'>            out[i] = b[i];</span>
 49 |     | <span style='background-color: #eee;'>        }</span>
 50 |     | <span style='background-color: #eee;'>        return out;</span>
 51 |     | <span style='background-color: #eee;'>    }</span>
 52 |     | <span style='background-color: #eee;'></span>
 53 |     | <span style='background-color: #faa;'>    function nonNull(address _address) internal pure returns (address) {</span>
 54 |     | <span style='background-color: #faa;'>        require(_address != address(0), &quot;Zero address&quot;);</span>
 55 |     | <span style='background-color: #eee;'>        return _address;</span>
 56 |     | <span style='background-color: #eee;'>    }</span>
 57 |     | <span style='background-color: #eee;'></span>
 58 |     | <span style='background-color: #faa;'>    function revertBytes(bytes memory b) internal pure {</span>
 59 |     | <span style='background-color: #faa;'>        assembly (&quot;memory-safe&quot;) {</span>
 60 |     | <span style='background-color: #eee;'>            revert(add(b, 0x20), mload(b))</span>
 61 |     | <span style='background-color: #eee;'>        }</span>
 62 |     | <span style='background-color: #eee;'>    }</span>
 63 |     | <span style='background-color: #eee;'></span>
 64 |     | <span style='background-color: #eee;'>    // assert a condition. Assert should be used to assert an invariant that should be true</span>
 65 |     | <span style='background-color: #eee;'>    // logically.</span>
 66 |     | <span style='background-color: #eee;'>    // This is useful for readability and debugability. A failing assert is always a bug.</span>
 67 |     | <span style='background-color: #eee;'>    //</span>
 68 |     | <span style='background-color: #eee;'>    // In production builds (non-hardhat, and non-localhost deployments) this method is a noop.</span>
 69 |     | <span style='background-color: #eee;'>    //</span>
 70 |     | <span style='background-color: #eee;'>    // Use &quot;require&quot; to enforce requirements on data coming from outside of a contract. Ie.,</span>
 71 |     | <span style='background-color: #eee;'>    //</span>
 72 |     | <span style='background-color: #eee;'>    // ```solidity</span>
 73 |     | <span style='background-color: #eee;'>    // function nonNegativeX(int x) external { require(x &gt;= 0, &quot;non-negative&quot;); }</span>
 74 |     | <span style='background-color: #eee;'>    // ```</span>
 75 |     | <span style='background-color: #eee;'>    //</span>
 76 |     | <span style='background-color: #eee;'>    // But</span>
 77 |     | <span style='background-color: #eee;'>    // ```solidity</span>
 78 |     | <span style='background-color: #eee;'>    // function nonNegativeX(int x) private { assert(x &gt;= 0); }</span>
 79 |     | <span style='background-color: #eee;'>    // ```</span>
 80 |     | <span style='background-color: #eee;'>    //</span>
 81 |     | <span style='background-color: #eee;'>    // If a private function has a pre-condition that it should only be called with non-negative</span>
 82 |     | <span style='background-color: #eee;'>    // values it&#39;s a bug in the contract if it&#39;s called with a negative value.</span>
 83 |     | <span style='background-color: #eee;'>    // solhint-disable-next-line func-name-mixedcase</span>
 84 |     | <span style='background-color: #eee;'>    function Assert(bool cond) internal pure {</span>
 85 |     | <span style='background-color: #eee;'>        // BEGIN STRIP</span>
 86 |     | <span style='background-color: #faa;'>        assert(cond);</span>
 87 |     | <span style='background-color: #eee;'>        // END STRIP</span>
 88 |     | <span style='background-color: #eee;'>    }</span>
 89 |     | <span style='background-color: #eee;'>}</span>
 90 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/lib/GitCommitHash.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>// Contracts deriving from this contract will have a public pure function</span>
  5 |     | <span style='background-color: #faa;'>// that returns a gitCommitHash at the moment it was compiled.</span>
  6 |     | <span style='background-color: #eee;'>contract GitCommitHash {</span>
  7 |     | <span style='background-color: #eee;'>    // A purely random string that&#39;s being replaced in a prod build by</span>
  8 |     | <span style='background-color: #eee;'>    // the git hash at build time.</span>
  9 |     | <span style='background-color: #faa;'>    uint256 public immutable gitCommitHash =</span>
 10 |     | <span style='background-color: #faa;'>        0xDEADBEEFCAFEBABEBEACBABEBA5EBA11B0A710ADB00BBABEDEFACA7EDEADFA11;</span>
 11 |     | <span style='background-color: #eee;'>}</span>
 12 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/lib/ImmutableGovernance.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;./FsUtils.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>/// @title ImmutableGovernance</span>
  7 |     | <span style='background-color: #faa;'>/// @dev This contract is meant to be inherited by other contracts, to make them ownable.</span>
  8 |     | <span style='background-color: #eee;'>contract ImmutableGovernance {</span>
  9 |     | <span style='background-color: #faa;'>    address public immutable immutableGovernance;</span>
 10 |     | <span style='background-color: #eee;'></span>
 11 |     | <span style='background-color: #eee;'>    modifier onlyGovernance() {</span>
 12 |     | <span style='background-color: #faa;'>        require(msg.sender == immutableGovernance, &quot;Only owner&quot;);</span>
 13 |     | <span style='background-color: #eee;'>        _;</span>
 14 |     | <span style='background-color: #eee;'>    }</span>
 15 |     | <span style='background-color: #eee;'></span>
 16 |     | <span style='background-color: #eee;'>    constructor(address governance) {</span>
 17 |     | <span style='background-color: #eee;'>        // slither-disable-next-line missing-zero-check</span>
 18 |     | <span style='background-color: #faa;'>        immutableGovernance = FsUtils.nonNull(governance);</span>
 19 |     | <span style='background-color: #eee;'>    }</span>
 20 |     | <span style='background-color: #eee;'>}</span>
 21 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/lib/ImmutableVersion.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;./FsUtils.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'>import &quot;./GitCommitHash.sol&quot;;</span>
  6 |     | <span style='background-color: #eee;'></span>
  7 |     | <span style='background-color: #eee;'>/// @title ImmutableVersion</span>
  8 |     | <span style='background-color: #eee;'>/// @dev This contract is meant to be inherited by other contracts, to version them.</span>
  9 |     | <span style='background-color: #faa;'>/// @notice Inherits from GitCommitHash to tie the version to the commit hash in the git repo.</span>
 10 |     | <span style='background-color: #eee;'>contract ImmutableVersion is GitCommitHash {</span>
 11 |     | <span style='background-color: #faa;'>    bytes32 public immutable immutableVersion;</span>
 12 |     | <span style='background-color: #eee;'></span>
 13 |     | <span style='background-color: #eee;'>    constructor(string memory _version) {</span>
 14 |     | <span style='background-color: #faa;'>        require(bytes(_version).length &gt; 0, &quot;Version is empty&quot;);</span>
 15 |     | <span style='background-color: #faa;'>        immutableVersion = FsUtils.encodeToBytes32(bytes(_version));</span>
 16 |     | <span style='background-color: #eee;'>    }</span>
 17 |     | <span style='background-color: #eee;'>}</span>
 18 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/lib/NonceMap.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/structs/BitMaps.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>struct NonceMap {</span>
  7 |     | <span style='background-color: #eee;'>    BitMaps.BitMap bitMap;</span>
  8 |     | <span style='background-color: #eee;'>}</span>
  9 |     | <span style='background-color: #faa;'></span>
 10 |     | <span style='background-color: #eee;'>library NonceMapLib {</span>
 11 |     | <span style='background-color: #eee;'>    using BitMaps for BitMaps.BitMap;</span>
 12 |     | <span style='background-color: #eee;'></span>
 13 |     | <span style='background-color: #faa;'>    function validateAndUseNonce(NonceMap storage self, uint256 nonce) internal {</span>
 14 |     | <span style='background-color: #faa;'>        require(!self.bitMap.get(nonce), &quot;Nonce already used&quot;);</span>
 15 |     | <span style='background-color: #eee;'>        self.bitMap.set(nonce);</span>
 16 |     | <span style='background-color: #eee;'>    }</span>
 17 |     | <span style='background-color: #eee;'></span>
 18 |     | <span style='background-color: #eee;'>    function getNonce(NonceMap storage self, uint256 nonce) internal view returns (bool) {</span>
 19 |     | <span style='background-color: #faa;'>        return self.bitMap.get(nonce);</span>
 20 |     | <span style='background-color: #eee;'>    }</span>
 21 |     | <span style='background-color: #eee;'>}</span>
 22 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/lib/Proofs.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>import &quot;./FsUtils.sol&quot;;</span>
   5 |     | <span style='background-color: #eee;'></span>
   6 |     | <span style='background-color: #eee;'>type BytesView is uint256;</span>
   7 |     | <span style='background-color: #eee;'></span>
   8 |     | <span style='background-color: #eee;'>type RLPItem is uint256;</span>
   9 |     | <span style='background-color: #eee;'></span>
  10 |     | <span style='background-color: #eee;'>type RLPIterator is uint256;</span>
  11 |     | <span style='background-color: #faa;'></span>
  12 |     | <span style='background-color: #eee;'>library BytesViewLib {</span>
  13 |     | <span style='background-color: #faa;'>    uint256 private constant WORD_SIZE = 32;</span>
  14 |     | <span style='background-color: #eee;'></span>
  15 |     | <span style='background-color: #eee;'>    error OutOfBounds();</span>
  16 |     | <span style='background-color: #eee;'>    error InvalidScalarEncoding();</span>
  17 |     | <span style='background-color: #eee;'></span>
  18 |     | <span style='background-color: #eee;'>    function mload(uint256 ptr) internal pure returns (bytes32 res) {</span>
  19 |     | <span style='background-color: #faa;'>        assembly {</span>
  20 |     | <span style='background-color: #eee;'>            res := mload(ptr)</span>
  21 |     | <span style='background-color: #eee;'>        }</span>
  22 |     | <span style='background-color: #eee;'>    }</span>
  23 |     | <span style='background-color: #eee;'></span>
  24 |     | <span style='background-color: #eee;'>    function mstore(uint256 ptr, bytes32 value) internal pure {</span>
  25 |     | <span style='background-color: #faa;'>        assembly {</span>
  26 |     | <span style='background-color: #eee;'>            mstore(ptr, value)</span>
  27 |     | <span style='background-color: #eee;'>        }</span>
  28 |     | <span style='background-color: #eee;'>    }</span>
  29 |     | <span style='background-color: #eee;'></span>
  30 |     | <span style='background-color: #eee;'>    function memPtr(bytes memory b) internal pure returns (uint256 res) {</span>
  31 |     | <span style='background-color: #faa;'>        assembly {</span>
  32 |     | <span style='background-color: #eee;'>            res := add(b, 0x20)</span>
  33 |     | <span style='background-color: #eee;'>        }</span>
  34 |     | <span style='background-color: #eee;'>    }</span>
  35 |     | <span style='background-color: #eee;'></span>
  36 |     | <span style='background-color: #faa;'>    function mCopy(uint256 src, uint256 dest, uint256 len) internal pure {</span>
  37 |     | <span style='background-color: #eee;'>        unchecked {</span>
  38 |     | <span style='background-color: #eee;'>            // copy as many word sizes as possible</span>
  39 |     | <span style='background-color: #faa;'>            for (; len &gt;= WORD_SIZE; len -= WORD_SIZE) {</span>
  40 |     | <span style='background-color: #eee;'>                mstore(dest, mload(src));</span>
  41 |     | <span style='background-color: #eee;'></span>
  42 |     | <span style='background-color: #eee;'>                src += WORD_SIZE;</span>
  43 |     | <span style='background-color: #eee;'>                dest += WORD_SIZE;</span>
  44 |     | <span style='background-color: #eee;'>            }</span>
  45 |     | <span style='background-color: #faa;'>            if (len == 0) return;</span>
  46 |     | <span style='background-color: #eee;'>            // left over bytes. Mask is used to remove unwanted bytes from the word</span>
  47 |     | <span style='background-color: #faa;'>            FsUtils.Assert(len &gt; 0 &amp;&amp; len &lt; WORD_SIZE);</span>
  48 |     | <span style='background-color: #eee;'>            bytes32 mask = bytes32((1 &lt;&lt; ((WORD_SIZE - len) &lt;&lt; 3)) - 1);</span>
  49 |     | <span style='background-color: #faa;'>            bytes32 srcpart = mload(src) &amp; ~mask; // zero out src</span>
  50 |     | <span style='background-color: #faa;'>            bytes32 destpart = mload(dest) &amp; mask; // retrieve the bytes</span>
  51 |     | <span style='background-color: #faa;'>            mstore(dest, destpart | srcpart);</span>
  52 |     | <span style='background-color: #eee;'>        }</span>
  53 |     | <span style='background-color: #eee;'>    }</span>
  54 |     | <span style='background-color: #eee;'></span>
  55 |     | <span style='background-color: #eee;'>    function empty() internal pure returns (BytesView) {</span>
  56 |     | <span style='background-color: #eee;'>        return BytesView.wrap(0);</span>
  57 |     | <span style='background-color: #eee;'>    }</span>
  58 |     | <span style='background-color: #eee;'></span>
  59 |     | <span style='background-color: #eee;'>    function wrap(uint256 ptr, uint256 len) internal pure returns (BytesView) {</span>
  60 |     | <span style='background-color: #faa;'>        return BytesView.wrap((ptr &lt;&lt; 128) | len);</span>
  61 |     | <span style='background-color: #eee;'>    }</span>
  62 |     | <span style='background-color: #eee;'></span>
  63 |     | <span style='background-color: #eee;'>    function length(BytesView b) internal pure returns (uint256) {</span>
  64 |     | <span style='background-color: #faa;'>        return BytesView.unwrap(b) &amp; type(uint128).max;</span>
  65 |     | <span style='background-color: #eee;'>    }</span>
  66 |     | <span style='background-color: #eee;'></span>
  67 |     | <span style='background-color: #eee;'>    function memPtr(BytesView b) private pure returns (uint256) {</span>
  68 |     | <span style='background-color: #faa;'>        return BytesView.unwrap(b) &gt;&gt; 128;</span>
  69 |     | <span style='background-color: #eee;'>    }</span>
  70 |     | <span style='background-color: #eee;'></span>
  71 |     | <span style='background-color: #eee;'>    function fromBytes(bytes memory b) internal pure returns (BytesView) {</span>
  72 |     | <span style='background-color: #eee;'>        return BytesViewLib.wrap(memPtr(b), b.length);</span>
  73 |     | <span style='background-color: #eee;'>    }</span>
  74 |     | <span style='background-color: #eee;'></span>
  75 |     | <span style='background-color: #faa;'>    function toBytes(BytesView b) internal pure returns (bytes memory res) {</span>
  76 |     | <span style='background-color: #eee;'>        uint len = length(b);</span>
  77 |     | <span style='background-color: #eee;'>        res = new bytes(len);</span>
  78 |     | <span style='background-color: #faa;'>        mCopy(memPtr(b), BytesViewLib.memPtr(res), len);</span>
  79 |     | <span style='background-color: #eee;'>    }</span>
  80 |     | <span style='background-color: #eee;'></span>
  81 |     | <span style='background-color: #eee;'>    function unsafeLoadUInt8(BytesView b, uint256 offset) internal pure returns (uint256) {</span>
  82 |     | <span style='background-color: #eee;'>        unchecked {</span>
  83 |     | <span style='background-color: #faa;'>            return uint256(mload(memPtr(b) + offset)) &gt;&gt; 248;</span>
  84 |     | <span style='background-color: #eee;'>        }</span>
  85 |     | <span style='background-color: #eee;'>    }</span>
  86 |     | <span style='background-color: #eee;'></span>
  87 |     | <span style='background-color: #eee;'>    function loadUInt8(BytesView b, uint256 offset) internal pure returns (uint256) {</span>
  88 |     | <span style='background-color: #eee;'>        if (offset &gt;= length(b)) revert OutOfBounds();</span>
  89 |     | <span style='background-color: #eee;'>        return unsafeLoadUInt8(b, offset);</span>
  90 |     | <span style='background-color: #eee;'>    }</span>
  91 |     | <span style='background-color: #eee;'></span>
  92 |     | <span style='background-color: #faa;'>    function unsafeLoadBytes32(BytesView b, uint256 offset) internal pure returns (bytes32) {</span>
  93 |     | <span style='background-color: #eee;'>        unchecked {</span>
  94 |     | <span style='background-color: #eee;'>            return mload(memPtr(b) + offset);</span>
  95 |     | <span style='background-color: #eee;'>        }</span>
  96 |     | <span style='background-color: #eee;'>    }</span>
  97 |     | <span style='background-color: #eee;'></span>
  98 |     | <span style='background-color: #eee;'>    function loadBytes32(BytesView b, uint256 offset) internal pure returns (bytes32) {</span>
  99 |     | <span style='background-color: #eee;'>        if (offset + 32 &gt; length(b)) revert OutOfBounds();</span>
 100 |     | <span style='background-color: #eee;'>        return unsafeLoadBytes32(b, offset);</span>
 101 |     | <span style='background-color: #eee;'>    }</span>
 102 |     | <span style='background-color: #eee;'></span>
 103 |     | <span style='background-color: #eee;'>    // Decode scalar value (non-negative integer) as described in yellow paper</span>
 104 |     | <span style='background-color: #faa;'>    function decodeScalar(BytesView b) internal pure returns (uint256) {</span>
 105 |     | <span style='background-color: #eee;'>        uint len = length(b);</span>
 106 |     | <span style='background-color: #faa;'>        if (len == 0) return 0;</span>
 107 |     | <span style='background-color: #eee;'>        bytes32 data = unsafeLoadBytes32(b, 0);</span>
 108 |     | <span style='background-color: #faa;'>        if (data[0] == 0) revert InvalidScalarEncoding();</span>
 109 |     | <span style='background-color: #eee;'>        return uint256(data &gt;&gt; ((WORD_SIZE - len) &lt;&lt; 3)); // reverts if len &gt; 32</span>
 110 |     | <span style='background-color: #eee;'>    }</span>
 111 |     | <span style='background-color: #eee;'></span>
 112 |     | <span style='background-color: #faa;'>    function unsafeSlice(</span>
 113 |     | <span style='background-color: #eee;'>        BytesView b,</span>
 114 |     | <span style='background-color: #eee;'>        uint256 offset,</span>
 115 |     | <span style='background-color: #eee;'>        uint256 len</span>
 116 |     | <span style='background-color: #eee;'>    ) internal pure returns (BytesView) {</span>
 117 |     | <span style='background-color: #eee;'>        unchecked {</span>
 118 |     | <span style='background-color: #faa;'>            FsUtils.Assert(offset + len &lt;= length(b));</span>
 119 |     | <span style='background-color: #eee;'>            return BytesViewLib.wrap(memPtr(b) + offset, len);</span>
 120 |     | <span style='background-color: #eee;'>        }</span>
 121 |     | <span style='background-color: #eee;'>    }</span>
 122 |     | <span style='background-color: #eee;'></span>
 123 |     | <span style='background-color: #eee;'>    function slice(BytesView b, uint256 offset, uint256 len) internal pure returns (BytesView) {</span>
 124 |     | <span style='background-color: #faa;'>        if (offset + len &gt; length(b)) revert OutOfBounds();</span>
 125 |     | <span style='background-color: #faa;'>        return unsafeSlice(b, offset, len);</span>
 126 |     | <span style='background-color: #eee;'>    }</span>
 127 |     | <span style='background-color: #eee;'></span>
 128 |     | <span style='background-color: #faa;'>    function unsafeSkip(BytesView b, uint256 offset) internal pure returns (BytesView) {</span>
 129 |     | <span style='background-color: #eee;'>        unchecked {</span>
 130 |     | <span style='background-color: #faa;'>            FsUtils.Assert(offset &lt;= length(b));</span>
 131 |     | <span style='background-color: #eee;'>            return BytesViewLib.wrap(memPtr(b) + offset, length(b) - offset);</span>
 132 |     | <span style='background-color: #eee;'>        }</span>
 133 |     | <span style='background-color: #eee;'>    }</span>
 134 |     | <span style='background-color: #eee;'></span>
 135 |     | <span style='background-color: #eee;'>    function skip(BytesView b, uint256 offset) internal pure returns (BytesView) {</span>
 136 |     | <span style='background-color: #eee;'>        if (offset &gt; length(b)) revert OutOfBounds();</span>
 137 |     | <span style='background-color: #eee;'>        return unsafeSkip(b, offset);</span>
 138 |     | <span style='background-color: #eee;'>    }</span>
 139 |     | <span style='background-color: #eee;'></span>
 140 |     | <span style='background-color: #eee;'>    function keccak(BytesView b) internal pure returns (bytes32 res) {</span>
 141 |     | <span style='background-color: #eee;'>        uint256 ptr = memPtr(b);</span>
 142 |     | <span style='background-color: #eee;'>        uint256 len = length(b);</span>
 143 |     | <span style='background-color: #faa;'>        assembly {</span>
 144 |     | <span style='background-color: #eee;'>            res := keccak256(ptr, len)</span>
 145 |     | <span style='background-color: #eee;'>        }</span>
 146 |     | <span style='background-color: #eee;'>    }</span>
 147 |     | <span style='background-color: #eee;'>}</span>
 148 |     | <span style='background-color: #faa;'></span>
 149 |     | <span style='background-color: #eee;'>library RLP {</span>
 150 |     | <span style='background-color: #eee;'>    using BytesViewLib for BytesView;</span>
 151 |     | <span style='background-color: #eee;'>    using RLP for RLPItem;</span>
 152 |     | <span style='background-color: #eee;'>    using RLP for RLPIterator;</span>
 153 |     | <span style='background-color: #eee;'></span>
 154 |     | <span style='background-color: #eee;'>    error InvalidRLPItem();</span>
 155 |     | <span style='background-color: #eee;'>    error ItemIsNotList();</span>
 156 |     | <span style='background-color: #eee;'>    error ItemIsNotBytes();</span>
 157 |     | <span style='background-color: #eee;'></span>
 158 |     | <span style='background-color: #faa;'>    function isList(RLPItem item) internal pure returns (bool) {</span>
 159 |     | <span style='background-color: #faa;'>        FsUtils.Assert(buffer(item).length() &gt; 0);</span>
 160 |     | <span style='background-color: #faa;'>        return buffer(item).unsafeLoadUInt8(0) &gt;= 0xc0;</span>
 161 |     | <span style='background-color: #eee;'>    }</span>
 162 |     | <span style='background-color: #eee;'></span>
 163 |     | <span style='background-color: #eee;'>    function isBytes(RLPItem item) internal pure returns (bool) {</span>
 164 |     | <span style='background-color: #faa;'>        return !isList(item);</span>
 165 |     | <span style='background-color: #eee;'>    }</span>
 166 |     | <span style='background-color: #eee;'></span>
 167 |     | <span style='background-color: #faa;'>    function requireRLPItem(BytesView b) internal pure returns (RLPItem) {</span>
 168 |     | <span style='background-color: #faa;'>        uint256 len = rlpLen(b);</span>
 169 |     | <span style='background-color: #faa;'>        if (len != b.length()) revert InvalidRLPItem();</span>
 170 |     | <span style='background-color: #eee;'>        return asRLPItem(b);</span>
 171 |     | <span style='background-color: #eee;'>    }</span>
 172 |     | <span style='background-color: #eee;'></span>
 173 |     | <span style='background-color: #faa;'>    function requireBytesView(RLPItem item) internal pure returns (BytesView) {</span>
 174 |     | <span style='background-color: #faa;'>        if (!isBytes(item)) revert ItemIsNotBytes();</span>
 175 |     | <span style='background-color: #faa;'>        return toBytesView(item);</span>
 176 |     | <span style='background-color: #eee;'>    }</span>
 177 |     | <span style='background-color: #eee;'></span>
 178 |     | <span style='background-color: #faa;'>    function toBytesView(RLPItem item) internal pure returns (BytesView) {</span>
 179 |     | <span style='background-color: #eee;'>        unchecked {</span>
 180 |     | <span style='background-color: #eee;'>            FsUtils.Assert(isBytes(item));</span>
 181 |     | <span style='background-color: #eee;'>            uint256 tag = buffer(item).unsafeLoadUInt8(0);</span>
 182 |     | <span style='background-color: #faa;'>            if (tag &lt; 0x80) {</span>
 183 |     | <span style='background-color: #faa;'>                return buffer(item).unsafeSlice(0, 1);</span>
 184 |     | <span style='background-color: #faa;'>            } else if (tag &lt; 0xb8) {</span>
 185 |     | <span style='background-color: #faa;'>                return buffer(item).unsafeSlice(1, tag - 0x80);</span>
 186 |     | <span style='background-color: #eee;'>            } else {</span>
 187 |     | <span style='background-color: #faa;'>                uint256 lenLen = tag - 0xb7;</span>
 188 |     | <span style='background-color: #faa;'>                uint256 len = uint256(buffer(item).unsafeLoadBytes32(1)) &gt;&gt; (8 * (32 - lenLen));</span>
 189 |     | <span style='background-color: #faa;'>                return buffer(item).unsafeSlice(1 + lenLen, len);</span>
 190 |     | <span style='background-color: #eee;'>            }</span>
 191 |     | <span style='background-color: #eee;'>        }</span>
 192 |     | <span style='background-color: #eee;'>    }</span>
 193 |     | <span style='background-color: #eee;'></span>
 194 |     | <span style='background-color: #faa;'>    function requireRLPItemIterator(RLPItem item) internal pure returns (RLPIterator) {</span>
 195 |     | <span style='background-color: #faa;'>        if (!isList(item)) revert ItemIsNotList();</span>
 196 |     | <span style='background-color: #faa;'>        return toRLPItemIterator(item);</span>
 197 |     | <span style='background-color: #eee;'>    }</span>
 198 |     | <span style='background-color: #eee;'></span>
 199 |     | <span style='background-color: #faa;'>    function toRLPItemIterator(RLPItem item) internal pure returns (RLPIterator) {</span>
 200 |     | <span style='background-color: #eee;'>        unchecked {</span>
 201 |     | <span style='background-color: #faa;'>            FsUtils.Assert(isList(item));</span>
 202 |     | <span style='background-color: #faa;'>            uint256 len = 0;</span>
 203 |     | <span style='background-color: #eee;'>            uint256 lenLen = 0;</span>
 204 |     | <span style='background-color: #eee;'>            uint256 initial = buffer(item).unsafeLoadUInt8(0);</span>
 205 |     | <span style='background-color: #faa;'>            if (initial &lt; 0xf8) {</span>
 206 |     | <span style='background-color: #eee;'>                len = initial - 0xc0;</span>
 207 |     | <span style='background-color: #eee;'>            } else {</span>
 208 |     | <span style='background-color: #faa;'>                lenLen = initial - 0xf7;</span>
 209 |     | <span style='background-color: #faa;'>                len = uint256(buffer(item).unsafeLoadBytes32(1)) &gt;&gt; (8 * (32 - lenLen));</span>
 210 |     | <span style='background-color: #eee;'>            }</span>
 211 |     | <span style='background-color: #faa;'>            FsUtils.Assert(len + lenLen + 1 == buffer(item).length()); // , &quot;RLP: Invalid length it&quot;);</span>
 212 |     | <span style='background-color: #faa;'>            BytesView b = buffer(item).unsafeSlice(1 + lenLen, len);</span>
 213 |     | <span style='background-color: #eee;'>            return RLPIterator.wrap(BytesView.unwrap(b));</span>
 214 |     | <span style='background-color: #eee;'>        }</span>
 215 |     | <span style='background-color: #eee;'>    }</span>
 216 |     | <span style='background-color: #eee;'></span>
 217 |     | <span style='background-color: #faa;'>    function unsafeNext(RLPIterator it) internal pure returns (RLPItem item, RLPIterator nextIt) {</span>
 218 |     | <span style='background-color: #faa;'>        FsUtils.Assert(buffer(it).length() &gt; 0); // &quot;RLP: Iterator out of bounds&quot;);</span>
 219 |     | <span style='background-color: #faa;'>        uint256 len = rlpLen(buffer(it));</span>
 220 |     | <span style='background-color: #faa;'>        item = asRLPItem(buffer(it).unsafeSlice(0, len));</span>
 221 |     | <span style='background-color: #faa;'>        nextIt = asRLPIterator(buffer(it).unsafeSkip(len));</span>
 222 |     | <span style='background-color: #eee;'>    }</span>
 223 |     | <span style='background-color: #eee;'></span>
 224 |     | <span style='background-color: #faa;'>    function next(RLPIterator it) internal pure returns (RLPItem item, RLPIterator nextIt) {</span>
 225 |     | <span style='background-color: #faa;'>        FsUtils.Assert(buffer(it).length() &gt; 0); // &quot;RLP: Iterator out of bounds&quot;);</span>
 226 |     | <span style='background-color: #faa;'>        uint256 len = rlpLen(buffer(it));</span>
 227 |     | <span style='background-color: #eee;'>        item = asRLPItem(buffer(it).slice(0, len));</span>
 228 |     | <span style='background-color: #faa;'>        nextIt = asRLPIterator(buffer(it).unsafeSkip(len));</span>
 229 |     | <span style='background-color: #eee;'>    }</span>
 230 |     | <span style='background-color: #eee;'></span>
 231 |     | <span style='background-color: #faa;'>    function unsafeSkipNext(RLPIterator it) internal pure returns (RLPIterator nextIt) {</span>
 232 |     | <span style='background-color: #faa;'>        FsUtils.Assert(buffer(it).length() &gt; 0); // &quot;RLP: Iterator out of bounds&quot;);</span>
 233 |     | <span style='background-color: #faa;'>        uint256 len = rlpLen(buffer(it));</span>
 234 |     | <span style='background-color: #faa;'>        nextIt = asRLPIterator(buffer(it).unsafeSkip(len));</span>
 235 |     | <span style='background-color: #eee;'>    }</span>
 236 |     | <span style='background-color: #eee;'></span>
 237 |     | <span style='background-color: #eee;'>    function hasNext(RLPIterator it) internal pure returns (bool) {</span>
 238 |     | <span style='background-color: #faa;'>        return buffer(it).length() &gt; 0;</span>
 239 |     | <span style='background-color: #eee;'>    }</span>
 240 |     | <span style='background-color: #eee;'></span>
 241 |     | <span style='background-color: #eee;'>    function length(RLPItem item) internal pure returns (uint256) {</span>
 242 |     | <span style='background-color: #eee;'>        return buffer(item).length();</span>
 243 |     | <span style='background-color: #eee;'>    }</span>
 244 |     | <span style='background-color: #eee;'></span>
 245 |     | <span style='background-color: #eee;'>    function keccak(RLPItem item) internal pure returns (bytes32 res) {</span>
 246 |     | <span style='background-color: #eee;'>        return buffer(item).keccak();</span>
 247 |     | <span style='background-color: #eee;'>    }</span>
 248 |     | <span style='background-color: #eee;'></span>
 249 |     | <span style='background-color: #eee;'>    function buffer(RLPItem item) private pure returns (BytesView) {</span>
 250 |     | <span style='background-color: #eee;'>        return BytesView.wrap(RLPItem.unwrap(item));</span>
 251 |     | <span style='background-color: #eee;'>    }</span>
 252 |     | <span style='background-color: #eee;'></span>
 253 |     | <span style='background-color: #eee;'>    function buffer(RLPIterator it) private pure returns (BytesView) {</span>
 254 |     | <span style='background-color: #eee;'>        return BytesView.wrap(RLPIterator.unwrap(it));</span>
 255 |     | <span style='background-color: #eee;'>    }</span>
 256 |     | <span style='background-color: #eee;'></span>
 257 |     | <span style='background-color: #faa;'>    function rlpLen(BytesView b) private pure returns (uint256) {</span>
 258 |     | <span style='background-color: #eee;'>        unchecked {</span>
 259 |     | <span style='background-color: #faa;'>            FsUtils.Assert(b.length() &gt; 0); // &quot;RLP: Empty buffer&quot;);</span>
 260 |     | <span style='background-color: #eee;'>            uint256 len = 0;</span>
 261 |     | <span style='background-color: #eee;'>            uint256 lenLen = 0;</span>
 262 |     | <span style='background-color: #eee;'>            uint256 initial = b.unsafeLoadUInt8(0);</span>
 263 |     | <span style='background-color: #faa;'>            if (initial &lt; 0x80) {</span>
 264 |     | <span style='background-color: #faa;'>                return 1;</span>
 265 |     | <span style='background-color: #eee;'>                // nothing</span>
 266 |     | <span style='background-color: #faa;'>            } else if (initial &lt; 0xb8) {</span>
 267 |     | <span style='background-color: #faa;'>                return 1 + initial - 0x80;</span>
 268 |     | <span style='background-color: #faa;'>            } else if (initial &lt; 0xc0) {</span>
 269 |     | <span style='background-color: #eee;'>                lenLen = initial - 0xb7;</span>
 270 |     | <span style='background-color: #eee;'>                // Continue below</span>
 271 |     | <span style='background-color: #faa;'>            } else if (initial &lt; 0xf8) {</span>
 272 |     | <span style='background-color: #faa;'>                return 1 + initial - 0xc0;</span>
 273 |     | <span style='background-color: #eee;'>            } else {</span>
 274 |     | <span style='background-color: #eee;'>                lenLen = initial - 0xf7;</span>
 275 |     | <span style='background-color: #eee;'>                // Continue below</span>
 276 |     | <span style='background-color: #eee;'>            }</span>
 277 |     | <span style='background-color: #faa;'>            len = uint256(b.unsafeLoadBytes32(1)) &gt;&gt; (8 * (32 - lenLen));</span>
 278 |     | <span style='background-color: #eee;'>            return len + lenLen + 1;</span>
 279 |     | <span style='background-color: #eee;'>        }</span>
 280 |     | <span style='background-color: #eee;'>    }</span>
 281 |     | <span style='background-color: #eee;'></span>
 282 |     | <span style='background-color: #eee;'>    function asRLPItem(BytesView b) private pure returns (RLPItem) {</span>
 283 |     | <span style='background-color: #eee;'>        return RLPItem.wrap(BytesView.unwrap(b));</span>
 284 |     | <span style='background-color: #eee;'>    }</span>
 285 |     | <span style='background-color: #eee;'></span>
 286 |     | <span style='background-color: #eee;'>    function asRLPIterator(BytesView b) private pure returns (RLPIterator) {</span>
 287 |     | <span style='background-color: #eee;'>        return RLPIterator.wrap(BytesView.unwrap(b));</span>
 288 |     | <span style='background-color: #eee;'>    }</span>
 289 |     | <span style='background-color: #eee;'>}</span>
 290 |     | <span style='background-color: #faa;'></span>
 291 |     | <span style='background-color: #eee;'>library TrieLib {</span>
 292 |     | <span style='background-color: #eee;'>    using BytesViewLib for BytesView;</span>
 293 |     | <span style='background-color: #eee;'>    using RLP for RLPItem;</span>
 294 |     | <span style='background-color: #eee;'>    using RLP for RLPIterator;</span>
 295 |     | <span style='background-color: #eee;'></span>
 296 |     | <span style='background-color: #eee;'>    // RLP(&quot;&quot;) = &quot;0x80&quot;</span>
 297 |     | <span style='background-color: #eee;'>    bytes32 private constant EMPTY_TRIE_HASH =</span>
 298 |     | <span style='background-color: #faa;'>        0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421;</span>
 299 |     | <span style='background-color: #eee;'></span>
 300 |     | <span style='background-color: #eee;'>    error KeyTooLong();</span>
 301 |     | <span style='background-color: #eee;'>    error ProofTooLong();</span>
 302 |     | <span style='background-color: #eee;'>    error IncompleteProof();</span>
 303 |     | <span style='background-color: #eee;'>    error InvalidProof();</span>
 304 |     | <span style='background-color: #eee;'></span>
 305 |     | <span style='background-color: #eee;'>    /// @dev Verify a proof of a key in a Merkle Patricia Trie, revert if the proof is invalid.</span>
 306 |     | <span style='background-color: #eee;'>    /// @param key The key to verify.</span>
 307 |     | <span style='background-color: #eee;'>    /// @param root The root hash of the trie. This is assumed to be from a trusted source (e.g. a block header)</span>
 308 |     | <span style='background-color: #eee;'>    ///        and therefore represents a structurally valid tree.</span>
 309 |     | <span style='background-color: #eee;'>    /// @param proof The proof of the key. Untrusted data.</span>
 310 |     | <span style='background-color: #eee;'>    /// @return The value of the key if the key exists or empty if key doesn&#39;t exist.</span>
 311 |     | <span style='background-color: #eee;'>    /// @notice The stored value is encoded as RLP and thus never empty, so empty means the key doesn&#39;t exist.</span>
 312 |     | <span style='background-color: #eee;'>    ///         This is reasonably optimized for gas, it&#39;s around 25k gas per proof depending on the depth.</span>
 313 |     | <span style='background-color: #faa;'>    function verify(</span>
 314 |     | <span style='background-color: #eee;'>        bytes32 key,</span>
 315 |     | <span style='background-color: #eee;'>        uint256 keyLength,</span>
 316 |     | <span style='background-color: #eee;'>        bytes32 root,</span>
 317 |     | <span style='background-color: #eee;'>        bytes memory proof</span>
 318 |     | <span style='background-color: #eee;'>    ) internal pure returns (BytesView) {</span>
 319 |     | <span style='background-color: #eee;'>        unchecked {</span>
 320 |     | <span style='background-color: #faa;'>            if (keyLength &gt; 32) revert KeyTooLong();</span>
 321 |     | <span style='background-color: #faa;'>            uint256 nibblesLeft = keyLength * 2;</span>
 322 |     | <span style='background-color: #faa;'>            RLPItem rlpListItem = RLP.requireRLPItem(BytesViewLib.fromBytes(proof));</span>
 323 |     | <span style='background-color: #faa;'>            RLPIterator listIt = rlpListItem.requireRLPItemIterator();</span>
 324 |     | <span style='background-color: #eee;'>            RLPItem child0;</span>
 325 |     | <span style='background-color: #eee;'>            RLPItem child1;</span>
 326 |     | <span style='background-color: #faa;'>            BytesView res = BytesViewLib.empty();</span>
 327 |     | <span style='background-color: #faa;'>            while (listIt.hasNext()) {</span>
 328 |     | <span style='background-color: #faa;'>                if (root == EMPTY_TRIE_HASH) revert ProofTooLong();</span>
 329 |     | <span style='background-color: #eee;'>                RLPItem rlpItem;</span>
 330 |     | <span style='background-color: #faa;'>                (rlpItem, listIt) = listIt.next();</span>
 331 |     | <span style='background-color: #faa;'>                if (rlpItem.keccak() != root) revert InvalidProof();</span>
 332 |     | <span style='background-color: #eee;'>                // Because it passed this cryptographic check, we know that the rlpItem is a well-formed</span>
 333 |     | <span style='background-color: #eee;'>                // RLP encoded MPT node.</span>
 334 |     | <span style='background-color: #eee;'></span>
 335 |     | <span style='background-color: #faa;'>                RLPIterator childIt = rlpItem.toRLPItemIterator();</span>
 336 |     | <span style='background-color: #eee;'>                FsUtils.Assert(childIt.hasNext());</span>
 337 |     | <span style='background-color: #faa;'>                (child0, childIt) = childIt.unsafeNext();</span>
 338 |     | <span style='background-color: #eee;'>                FsUtils.Assert(childIt.hasNext());</span>
 339 |     | <span style='background-color: #faa;'>                (child1, childIt) = childIt.unsafeNext();</span>
 340 |     | <span style='background-color: #eee;'></span>
 341 |     | <span style='background-color: #faa;'>                RLPItem nextRoot;</span>
 342 |     | <span style='background-color: #eee;'>                root = EMPTY_TRIE_HASH; // sentinel indicating end of proof</span>
 343 |     | <span style='background-color: #faa;'>                if (childIt.hasNext()) {</span>
 344 |     | <span style='background-color: #eee;'>                    // Branch node</span>
 345 |     | <span style='background-color: #faa;'>                    uint nibble = nibblesLeft == 0 ? 16 : uint256(key) &gt;&gt; 252;</span>
 346 |     | <span style='background-color: #eee;'></span>
 347 |     | <span style='background-color: #faa;'>                    if (nibble &lt; 2) {</span>
 348 |     | <span style='background-color: #faa;'>                        nextRoot = nibble == 0 ? child0 : child1;</span>
 349 |     | <span style='background-color: #eee;'>                    } else {</span>
 350 |     | <span style='background-color: #faa;'>                        for (uint i = 2; i &lt; nibble; i++) {</span>
 351 |     | <span style='background-color: #eee;'>                            FsUtils.Assert(childIt.hasNext());</span>
 352 |     | <span style='background-color: #faa;'>                            childIt = childIt.unsafeSkipNext();</span>
 353 |     | <span style='background-color: #eee;'>                        }</span>
 354 |     | <span style='background-color: #eee;'>                        FsUtils.Assert(childIt.hasNext());</span>
 355 |     | <span style='background-color: #faa;'>                        (nextRoot, childIt) = childIt.unsafeNext();</span>
 356 |     | <span style='background-color: #eee;'>                    }</span>
 357 |     | <span style='background-color: #eee;'></span>
 358 |     | <span style='background-color: #faa;'>                    if (nibblesLeft == 0) {</span>
 359 |     | <span style='background-color: #faa;'>                        res = nextRoot.toBytesView();</span>
 360 |     | <span style='background-color: #faa;'>                        continue;</span>
 361 |     | <span style='background-color: #eee;'>                    }</span>
 362 |     | <span style='background-color: #eee;'>                    key &lt;&lt;= 4;</span>
 363 |     | <span style='background-color: #eee;'>                    nibblesLeft -= 1;</span>
 364 |     | <span style='background-color: #eee;'>                } else {</span>
 365 |     | <span style='background-color: #eee;'>                    // Extension or leaf nodes</span>
 366 |     | <span style='background-color: #faa;'>                    BytesView partialKey = child0.toBytesView();</span>
 367 |     | <span style='background-color: #faa;'>                    FsUtils.Assert(partialKey.length() &gt; 0 &amp;&amp; partialKey.length() &lt;= 33);</span>
 368 |     | <span style='background-color: #eee;'>                    uint256 tag = partialKey.unsafeLoadUInt8(0);</span>
 369 |     | <span style='background-color: #eee;'>                    bytes32 partialKeyBytes = partialKey.unsafeLoadBytes32(1);</span>
 370 |     | <span style='background-color: #eee;'>                    uint partialKeyLength = 2 * partialKey.length() - 2;</span>
 371 |     | <span style='background-color: #eee;'>                    // Two most significant bits must be zero for a valid hex-prefix string</span>
 372 |     | <span style='background-color: #faa;'>                    FsUtils.Assert(tag &lt; 64);</span>
 373 |     | <span style='background-color: #faa;'>                    if ((tag &amp; 16) != 0) {</span>
 374 |     | <span style='background-color: #eee;'>                        // Odd number of nibbles, low order nibble of tag is first nibble of key</span>
 375 |     | <span style='background-color: #faa;'>                        partialKeyBytes = (partialKeyBytes &gt;&gt; 4) | bytes32(tag &lt;&lt; 252);</span>
 376 |     | <span style='background-color: #eee;'>                        partialKeyLength += 1;</span>
 377 |     | <span style='background-color: #eee;'>                    } else {</span>
 378 |     | <span style='background-color: #eee;'>                        // Even number of nibbles, low order nibble of tag is zero</span>
 379 |     | <span style='background-color: #faa;'>                        FsUtils.Assert(tag &amp; 0xF == 0);</span>
 380 |     | <span style='background-color: #eee;'>                    }</span>
 381 |     | <span style='background-color: #eee;'>                    // For a valid MPT, the partial key must be at least one nibble and will</span>
 382 |     | <span style='background-color: #eee;'>                    // never be more then 32 bytes.</span>
 383 |     | <span style='background-color: #faa;'>                    FsUtils.Assert(partialKeyLength &gt; 0 &amp;&amp; partialKeyLength &lt;= 64);</span>
 384 |     | <span style='background-color: #eee;'>                    // The partialKey must be a prefix of key</span>
 385 |     | <span style='background-color: #faa;'>                    if (</span>
 386 |     | <span style='background-color: #faa;'>                        partialKeyLength &gt; nibblesLeft ||</span>
 387 |     | <span style='background-color: #faa;'>                        (partialKeyBytes ^ key) &gt;&gt; (256 - 4 * partialKeyLength) != 0</span>
 388 |     | <span style='background-color: #eee;'>                    ) {</span>
 389 |     | <span style='background-color: #eee;'>                        // The partial key is not a prefix of the key, so the key doesn&#39;t exist</span>
 390 |     | <span style='background-color: #faa;'>                        continue;</span>
 391 |     | <span style='background-color: #eee;'>                    }</span>
 392 |     | <span style='background-color: #eee;'>                    nibblesLeft -= partialKeyLength;</span>
 393 |     | <span style='background-color: #eee;'>                    key &lt;&lt;= 4 * partialKeyLength;</span>
 394 |     | <span style='background-color: #eee;'></span>
 395 |     | <span style='background-color: #faa;'>                    if ((tag &amp; 32) != 0) {</span>
 396 |     | <span style='background-color: #eee;'>                        // Leaf node</span>
 397 |     | <span style='background-color: #faa;'>                        if (nibblesLeft == 0) {</span>
 398 |     | <span style='background-color: #faa;'>                            res = child1.toBytesView();</span>
 399 |     | <span style='background-color: #eee;'>                        }</span>
 400 |     | <span style='background-color: #faa;'>                        continue;</span>
 401 |     | <span style='background-color: #eee;'>                    }</span>
 402 |     | <span style='background-color: #faa;'>                    nextRoot = child1;</span>
 403 |     | <span style='background-color: #eee;'>                }</span>
 404 |     | <span style='background-color: #eee;'>                // Proof continue with child node</span>
 405 |     | <span style='background-color: #faa;'>                if (nextRoot.isBytes()) {</span>
 406 |     | <span style='background-color: #faa;'>                    BytesView childBytes = nextRoot.toBytesView();</span>
 407 |     | <span style='background-color: #faa;'>                    if (childBytes.length() == 0) {</span>
 408 |     | <span style='background-color: #faa;'>                        continue;</span>
 409 |     | <span style='background-color: #eee;'>                    }</span>
 410 |     | <span style='background-color: #faa;'>                    FsUtils.Assert(childBytes.length() == 32); // Invalid child hash</span>
 411 |     | <span style='background-color: #eee;'>                    root = childBytes.unsafeLoadBytes32(0);</span>
 412 |     | <span style='background-color: #eee;'>                } else {</span>
 413 |     | <span style='background-color: #faa;'>                    FsUtils.Assert(nextRoot.isList());</span>
 414 |     | <span style='background-color: #eee;'>                    // The next node is embedded directly in this node</span>
 415 |     | <span style='background-color: #eee;'>                    // as it&#39;s RLP length is less than 32 bytes.</span>
 416 |     | <span style='background-color: #faa;'>                    FsUtils.Assert(nextRoot.length() &lt; 32); // &quot;IP: child node too long&quot;;</span>
 417 |     | <span style='background-color: #eee;'>                    root = nextRoot.keccak();</span>
 418 |     | <span style='background-color: #eee;'>                }</span>
 419 |     | <span style='background-color: #eee;'>            }</span>
 420 |     | <span style='background-color: #faa;'>            if (root != EMPTY_TRIE_HASH) revert IncompleteProof();</span>
 421 |     | <span style='background-color: #eee;'>            return res;</span>
 422 |     | <span style='background-color: #eee;'>        }</span>
 423 |     | <span style='background-color: #eee;'>    }</span>
 424 |     | <span style='background-color: #eee;'></span>
 425 |     | <span style='background-color: #faa;'>    function proofAccount(</span>
 426 |     | <span style='background-color: #eee;'>        address account,</span>
 427 |     | <span style='background-color: #eee;'>        bytes32 stateRoot,</span>
 428 |     | <span style='background-color: #eee;'>        bytes memory proof</span>
 429 |     | <span style='background-color: #eee;'>    )</span>
 430 |     | <span style='background-color: #eee;'>        internal</span>
 431 |     | <span style='background-color: #eee;'>        pure</span>
 432 |     | <span style='background-color: #eee;'>        returns (uint256 nonce, uint256 balance, bytes32 storageHash, bytes32 codeHash)</span>
 433 |     | <span style='background-color: #eee;'>    {</span>
 434 |     | <span style='background-color: #faa;'>        BytesView accountRLP = verify(keccak256(abi.encodePacked(account)), 32, stateRoot, proof);</span>
 435 |     | <span style='background-color: #faa;'>        if (accountRLP.length() == 0) {</span>
 436 |     | <span style='background-color: #faa;'>            return (0, 0, bytes32(0), bytes32(0));</span>
 437 |     | <span style='background-color: #eee;'>        }</span>
 438 |     | <span style='background-color: #faa;'>        RLPItem item = RLP.requireRLPItem(accountRLP);</span>
 439 |     | <span style='background-color: #faa;'>        RLPIterator it = item.requireRLPItemIterator();</span>
 440 |     | <span style='background-color: #eee;'>        FsUtils.Assert(it.hasNext());</span>
 441 |     | <span style='background-color: #faa;'>        (item, it) = it.next();</span>
 442 |     | <span style='background-color: #faa;'>        nonce = item.requireBytesView().decodeScalar();</span>
 443 |     | <span style='background-color: #eee;'>        FsUtils.Assert(it.hasNext());</span>
 444 |     | <span style='background-color: #faa;'>        (item, it) = it.next();</span>
 445 |     | <span style='background-color: #faa;'>        balance = item.requireBytesView().decodeScalar();</span>
 446 |     | <span style='background-color: #eee;'>        FsUtils.Assert(it.hasNext());</span>
 447 |     | <span style='background-color: #faa;'>        (item, it) = it.next();</span>
 448 |     | <span style='background-color: #faa;'>        storageHash = item.requireBytesView().unsafeLoadBytes32(0);</span>
 449 |     | <span style='background-color: #eee;'>        FsUtils.Assert(it.hasNext());</span>
 450 |     | <span style='background-color: #faa;'>        (item, it) = it.next();</span>
 451 |     | <span style='background-color: #faa;'>        codeHash = item.requireBytesView().unsafeLoadBytes32(0);</span>
 452 |     | <span style='background-color: #eee;'>    }</span>
 453 |     | <span style='background-color: #eee;'></span>
 454 |     | <span style='background-color: #faa;'>    function proofStorageAt(</span>
 455 |     | <span style='background-color: #eee;'>        bytes32 slot,</span>
 456 |     | <span style='background-color: #eee;'>        bytes32 storageHash,</span>
 457 |     | <span style='background-color: #eee;'>        bytes memory proof</span>
 458 |     | <span style='background-color: #eee;'>    ) internal pure returns (uint256) {</span>
 459 |     | <span style='background-color: #faa;'>        BytesView valueRLP = verify(keccak256(abi.encodePacked(slot)), 32, storageHash, proof);</span>
 460 |     | <span style='background-color: #faa;'>        if (valueRLP.length() == 0) {</span>
 461 |     | <span style='background-color: #faa;'>            return 0;</span>
 462 |     | <span style='background-color: #eee;'>        }</span>
 463 |     | <span style='background-color: #faa;'>        RLPItem item = RLP.requireRLPItem(valueRLP);</span>
 464 |     | <span style='background-color: #faa;'>        BytesView storedAmount = item.requireBytesView();</span>
 465 |     | <span style='background-color: #faa;'>        return storedAmount.decodeScalar();</span>
 466 |     | <span style='background-color: #eee;'>    }</span>
 467 |     | <span style='background-color: #eee;'>}</span>
 468 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/oracles/ERC20ChainlinkValueOracle.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/Strings.sol&quot;;</span>
  6 |     | <span style='background-color: #eee;'>import &quot;../lib/FsUtils.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'>import &quot;../interfaces/IERC20ValueOracle.sol&quot;;</span>
  8 |     | <span style='background-color: #eee;'></span>
  9 |     | <span style='background-color: #eee;'>import {ImmutableGovernance} from &quot;../lib/ImmutableGovernance.sol&quot;;</span>
 10 |     | <span style='background-color: #faa;'></span>
 11 |     | <span style='background-color: #eee;'>contract ERC20ChainlinkValueOracle is ImmutableGovernance, IERC20ValueOracle {</span>
 12 |     | <span style='background-color: #eee;'>    AggregatorV3Interface priceOracle;</span>
 13 |     | <span style='background-color: #eee;'>    int256 immutable base;</span>
 14 |     | <span style='background-color: #faa;'>    int256 collateralFactor = 1 ether;</span>
 15 |     | <span style='background-color: #faa;'>    int256 borrowFactor = 1 ether;</span>
 16 |     | <span style='background-color: #eee;'></span>
 17 |     | <span style='background-color: #eee;'>    modifier checkDecimals(string memory label, uint8 decimals) {</span>
 18 |     | <span style='background-color: #faa;'>        if (decimals &lt; 3 || 18 &lt; decimals) {</span>
 19 |     | <span style='background-color: #eee;'>            // prettier-ignore</span>
 20 |     | <span style='background-color: #faa;'>            revert(string.concat(</span>
 21 |     | <span style='background-color: #eee;'>                &quot;Invalid &quot;, label, &quot;: must be within [3, 18] range while provided is &quot;,</span>
 22 |     | <span style='background-color: #faa;'>                Strings.toString(decimals)</span>
 23 |     | <span style='background-color: #eee;'>            ));</span>
 24 |     | <span style='background-color: #eee;'>        }</span>
 25 |     | <span style='background-color: #eee;'>        _;</span>
 26 |     | <span style='background-color: #eee;'>    }</span>
 27 |     | <span style='background-color: #eee;'></span>
 28 |     | <span style='background-color: #eee;'>    constructor(</span>
 29 |     | <span style='background-color: #eee;'>        address chainlink,</span>
 30 |     | <span style='background-color: #eee;'>        uint8 baseDecimals,</span>
 31 |     | <span style='background-color: #eee;'>        uint8 tokenDecimals,</span>
 32 |     | <span style='background-color: #eee;'>        int256 _collateralFactor,</span>
 33 |     | <span style='background-color: #eee;'>        int256 _borrowFactor,</span>
 34 |     | <span style='background-color: #eee;'>        address _owner</span>
 35 |     | <span style='background-color: #eee;'>    )</span>
 36 |     | <span style='background-color: #eee;'>        ImmutableGovernance(_owner)</span>
 37 |     | <span style='background-color: #eee;'>        checkDecimals(&quot;baseDecimals&quot;, baseDecimals)</span>
 38 |     | <span style='background-color: #eee;'>        checkDecimals(&quot;tokenDecimals&quot;, tokenDecimals)</span>
 39 |     | <span style='background-color: #eee;'>    {</span>
 40 |     | <span style='background-color: #faa;'>        priceOracle = AggregatorV3Interface(FsUtils.nonNull(chainlink));</span>
 41 |     | <span style='background-color: #faa;'>        base = int256(10) ** (tokenDecimals + priceOracle.decimals() - baseDecimals);</span>
 42 |     | <span style='background-color: #eee;'>        collateralFactor = _collateralFactor;</span>
 43 |     | <span style='background-color: #eee;'>        borrowFactor = _borrowFactor;</span>
 44 |     | <span style='background-color: #eee;'>    }</span>
 45 |     | <span style='background-color: #eee;'></span>
 46 |     | <span style='background-color: #eee;'>    function setRiskFactors(</span>
 47 |     | <span style='background-color: #eee;'>        int256 _collateralFactor,</span>
 48 |     | <span style='background-color: #eee;'>        int256 _borrowFactor</span>
 49 |     | <span style='background-color: #eee;'>    ) external onlyGovernance {</span>
 50 |     | <span style='background-color: #eee;'>        collateralFactor = _collateralFactor;</span>
 51 |     | <span style='background-color: #faa;'>        borrowFactor = _borrowFactor;</span>
 52 |     | <span style='background-color: #eee;'>    }</span>
 53 |     | <span style='background-color: #eee;'></span>
 54 |     | <span style='background-color: #eee;'>    function calcValue(</span>
 55 |     | <span style='background-color: #eee;'>        int256 balance</span>
 56 |     | <span style='background-color: #eee;'>    ) external view override returns (int256 value, int256 riskAdjustedValue) {</span>
 57 |     | <span style='background-color: #faa;'>        (, int256 price, , , ) = priceOracle.latestRoundData();</span>
 58 |     | <span style='background-color: #faa;'>        value = (balance * price) / base;</span>
 59 |     | <span style='background-color: #faa;'>        if (balance &gt;= 0) {</span>
 60 |     | <span style='background-color: #faa;'>            riskAdjustedValue = (value * collateralFactor) / 1 ether;</span>
 61 |     | <span style='background-color: #eee;'>        } else {</span>
 62 |     | <span style='background-color: #faa;'>            riskAdjustedValue = (value * 1 ether) / borrowFactor;</span>
 63 |     | <span style='background-color: #eee;'>        }</span>
 64 |     | <span style='background-color: #eee;'>        return (value, riskAdjustedValue);</span>
 65 |     | <span style='background-color: #eee;'>    }</span>
 66 |     | <span style='background-color: #eee;'>}</span>
 67 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/oracles/UniV2Oracle.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>import {ImmutableGovernance} from &quot;../lib/ImmutableGovernance.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'>import {IERC20ValueOracle} from &quot;../interfaces/IERC20ValueOracle.sol&quot;;</span>
  8 |     | <span style='background-color: #eee;'>import {FsMath} from &quot;../lib/FsMath.sol&quot;;</span>
  9 |     | <span style='background-color: #eee;'>import {IDOS} from &quot;../interfaces/IDOS.sol&quot;;</span>
 10 |     | <span style='background-color: #eee;'>import {IDuoswapV2Pair} from &quot;../duoswapV2/interfaces/IDuoswapV2Pair.sol&quot;;</span>
 11 |     | <span style='background-color: #faa;'></span>
 12 |     | <span style='background-color: #eee;'>contract UniV2Oracle is ImmutableGovernance, IERC20ValueOracle {</span>
 13 |     | <span style='background-color: #faa;'>    IDOS public immutable dos;</span>
 14 |     | <span style='background-color: #faa;'>    IDuoswapV2Pair public immutable pair;</span>
 15 |     | <span style='background-color: #eee;'>    // address public immutable dSafe;</span>
 16 |     | <span style='background-color: #eee;'>    // address public immutable token0;</span>
 17 |     | <span style='background-color: #eee;'>    // address public immutable token1;</span>
 18 |     | <span style='background-color: #eee;'></span>
 19 |     | <span style='background-color: #eee;'>    mapping(address =&gt; IERC20ValueOracle) public erc20ValueOracle;</span>
 20 |     | <span style='background-color: #eee;'></span>
 21 |     | <span style='background-color: #eee;'>    constructor(address _dos, address _pair, address _owner) ImmutableGovernance(_owner) {</span>
 22 |     | <span style='background-color: #faa;'>        if (_dos == address(0) || _pair == address(0) || _owner == address(0)) {</span>
 23 |     | <span style='background-color: #faa;'>            revert(&quot;Zero address&quot;);</span>
 24 |     | <span style='background-color: #eee;'>        }</span>
 25 |     | <span style='background-color: #faa;'>        dos = IDOS(_dos);</span>
 26 |     | <span style='background-color: #faa;'>        pair = IDuoswapV2Pair(_pair);</span>
 27 |     | <span style='background-color: #eee;'></span>
 28 |     | <span style='background-color: #eee;'>        // dSafe = IUniswapV2Pair(_pair).dSafe();</span>
 29 |     | <span style='background-color: #eee;'>        // token0 = IUniswapV2Pair(_pair).token0();</span>
 30 |     | <span style='background-color: #eee;'>        // token1 = IUniswapV2Pair(_pair).token1();</span>
 31 |     | <span style='background-color: #eee;'>    }</span>
 32 |     | <span style='background-color: #eee;'></span>
 33 |     | <span style='background-color: #eee;'>    /// @notice Set the oracle for an underlying token</span>
 34 |     | <span style='background-color: #eee;'>    /// @param erc20 The underlying token</span>
 35 |     | <span style='background-color: #eee;'>    /// @param oracle The oracle for the underlying token</span>
 36 |     | <span style='background-color: #eee;'>    function setERC20ValueOracle(address erc20, address oracle) external onlyGovernance {</span>
 37 |     | <span style='background-color: #eee;'>        erc20ValueOracle[erc20] = IERC20ValueOracle(oracle);</span>
 38 |     | <span style='background-color: #eee;'>    }</span>
 39 |     | <span style='background-color: #eee;'></span>
 40 |     | <span style='background-color: #eee;'>    /// @notice Calculate the value of a uniswap pair token</span>
 41 |     | <span style='background-color: #eee;'>    /// @param amount The amount of the token</span>
 42 |     | <span style='background-color: #eee;'>    /// @return value The value of the uniswap pair token</span>
 43 |     | <span style='background-color: #eee;'>    /// @return riskAdjustedValue The risk adjusted value of the uniswap pair token</span>
 44 |     | <span style='background-color: #faa;'>    function calcValue(</span>
 45 |     | <span style='background-color: #eee;'>        int256 amount</span>
 46 |     | <span style='background-color: #eee;'>    ) external view override returns (int256 value, int256 riskAdjustedValue) {</span>
 47 |     | <span style='background-color: #faa;'>        uint256 totalSupply = pair.totalSupply();</span>
 48 |     | <span style='background-color: #faa;'>        if (totalSupply == 0) {</span>
 49 |     | <span style='background-color: #faa;'>            return (0, 0);</span>
 50 |     | <span style='background-color: #eee;'>        }</span>
 51 |     | <span style='background-color: #faa;'>        address dSafe = pair.dSafe();</span>
 52 |     | <span style='background-color: #faa;'>        address token0 = pair.token0();</span>
 53 |     | <span style='background-color: #faa;'>        address token1 = pair.token1();</span>
 54 |     | <span style='background-color: #eee;'></span>
 55 |     | <span style='background-color: #faa;'>        uint256 balance0 = uint256(IDOS(dos).getDAccountERC20(dSafe, IERC20(token0)));</span>
 56 |     | <span style='background-color: #faa;'>        uint256 balance1 = uint256(IDOS(dos).getDAccountERC20(dSafe, IERC20(token1)));</span>
 57 |     | <span style='background-color: #eee;'></span>
 58 |     | <span style='background-color: #faa;'>        (int256 price0, int256 adjustedPrice0) = erc20ValueOracle[token0].calcValue(</span>
 59 |     | <span style='background-color: #faa;'>            FsMath.safeCastToSigned(balance0)</span>
 60 |     | <span style='background-color: #eee;'>        );</span>
 61 |     | <span style='background-color: #faa;'>        (int256 price1, int256 adjustedPrice1) = erc20ValueOracle[token1].calcValue(</span>
 62 |     | <span style='background-color: #faa;'>            FsMath.safeCastToSigned(balance1)</span>
 63 |     | <span style='background-color: #eee;'>        );</span>
 64 |     | <span style='background-color: #eee;'></span>
 65 |     | <span style='background-color: #faa;'>        value = ((price0 + price1) * amount) / FsMath.safeCastToSigned(totalSupply);</span>
 66 |     | <span style='background-color: #eee;'>        riskAdjustedValue =</span>
 67 |     | <span style='background-color: #faa;'>            ((adjustedPrice0 + adjustedPrice1) * amount) /</span>
 68 |     | <span style='background-color: #faa;'>            FsMath.safeCastToSigned(totalSupply);</span>
 69 |     | <span style='background-color: #eee;'>        return (value, riskAdjustedValue);</span>
 70 |     | <span style='background-color: #eee;'>    }</span>
 71 |     | <span style='background-color: #eee;'>}</span>
 72 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/oracles/UniV3Oracle.sol</b>
<code>
   1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
   2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
   3 |     | <span style='background-color: #eee;'></span>
   4 |     | <span style='background-color: #eee;'>import &quot;../lib/ImmutableGovernance.sol&quot;;</span>
   5 |     | <span style='background-color: #eee;'>import &quot;../interfaces/IERC20ValueOracle.sol&quot;;</span>
   6 |     | <span style='background-color: #eee;'>import &quot;../interfaces/INFTValueOracle.sol&quot;;</span>
   7 |     | <span style='background-color: #eee;'>import &quot;../lib/FsMath.sol&quot;;</span>
   8 |     | <span style='background-color: #eee;'>import &quot;../lib/FsUtils.sol&quot;;</span>
   9 |     | <span style='background-color: #eee;'>import &quot;../external/interfaces/INonfungiblePositionManager.sol&quot;;</span>
  10 |     | <span style='background-color: #eee;'>import &quot;@uniswap/v3-core/contracts/interfaces/IUniswapV3Factory.sol&quot;;</span>
  11 |     | <span style='background-color: #eee;'>import &quot;@uniswap/v3-core/contracts/interfaces/IUniswapV3Pool.sol&quot;;</span>
  12 |     | <span style='background-color: #eee;'>import &quot;@uniswap/v3-core/contracts/libraries/FixedPoint96.sol&quot;;</span>
  13 |     | <span style='background-color: #eee;'></span>
  14 |     | <span style='background-color: #faa;'>// TickMath lib is inconsistent with solidity compiler version</span>
  15 |     | <span style='background-color: #eee;'>library TickMath {</span>
  16 |     | <span style='background-color: #eee;'>    /// @dev The minimum tick that may be passed to #getSqrtRatioAtTick computed from log base 1.0001 of 2**-128</span>
  17 |     | <span style='background-color: #faa;'>    int24 internal constant MIN_TICK = -887272;</span>
  18 |     | <span style='background-color: #eee;'>    /// @dev The maximum tick that may be passed to #getSqrtRatioAtTick computed from log base 1.0001 of 2**128</span>
  19 |     | <span style='background-color: #faa;'>    int24 internal constant MAX_TICK = -MIN_TICK;</span>
  20 |     | <span style='background-color: #eee;'></span>
  21 |     | <span style='background-color: #eee;'>    /// @dev The minimum value that can be returned from #getSqrtRatioAtTick. Equivalent to getSqrtRatioAtTick(MIN_TICK)</span>
  22 |     | <span style='background-color: #eee;'>    uint160 internal constant MIN_SQRT_RATIO = 4295128739;</span>
  23 |     | <span style='background-color: #eee;'>    /// @dev The maximum value that can be returned from #getSqrtRatioAtTick. Equivalent to getSqrtRatioAtTick(MAX_TICK)</span>
  24 |     | <span style='background-color: #eee;'>    uint160 internal constant MAX_SQRT_RATIO = 1461446703485210103287273052203988822378723970342;</span>
  25 |     | <span style='background-color: #eee;'></span>
  26 |     | <span style='background-color: #eee;'>    /// @notice Calculates sqrt(1.0001^tick) * 2^96</span>
  27 |     | <span style='background-color: #eee;'>    /// @dev Throws if |tick| &gt; max tick</span>
  28 |     | <span style='background-color: #eee;'>    /// @param tick The input tick for the above formula</span>
  29 |     | <span style='background-color: #eee;'>    /// @return sqrtPriceX96 A Fixed point Q64.96 number representing the sqrt of the ratio of the two erc20s (token1/token0)</span>
  30 |     | <span style='background-color: #eee;'>    /// at the given tick</span>
  31 |     | <span style='background-color: #faa;'>    function getSqrtRatioAtTick(int24 tick) internal pure returns (int256 sqrtPriceX96) {</span>
  32 |     | <span style='background-color: #faa;'>        uint256 absTick = tick &lt; 0 ? uint256(-int256(tick)) : uint256(int256(tick));</span>
  33 |     | <span style='background-color: #faa;'>        require(absTick &lt;= uint256(uint24(MAX_TICK)), &quot;T&quot;);</span>
  34 |     | <span style='background-color: #eee;'></span>
  35 |     | <span style='background-color: #faa;'>        uint256 ratio = absTick &amp; 0x1 != 0</span>
  36 |     | <span style='background-color: #faa;'>            ? 0xfffcb933bd6fad37aa2d162d1a594001</span>
  37 |     | <span style='background-color: #faa;'>            : 0x100000000000000000000000000000000;</span>
  38 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x2 != 0) ratio = (ratio * 0xfff97272373d413259a46990580e213a) &gt;&gt; 128;</span>
  39 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x4 != 0) ratio = (ratio * 0xfff2e50f5f656932ef12357cf3c7fdcc) &gt;&gt; 128;</span>
  40 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x8 != 0) ratio = (ratio * 0xffe5caca7e10e4e61c3624eaa0941cd0) &gt;&gt; 128;</span>
  41 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x10 != 0) ratio = (ratio * 0xffcb9843d60f6159c9db58835c926644) &gt;&gt; 128;</span>
  42 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x20 != 0) ratio = (ratio * 0xff973b41fa98c081472e6896dfb254c0) &gt;&gt; 128;</span>
  43 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x40 != 0) ratio = (ratio * 0xff2ea16466c96a3843ec78b326b52861) &gt;&gt; 128;</span>
  44 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x80 != 0) ratio = (ratio * 0xfe5dee046a99a2a811c461f1969c3053) &gt;&gt; 128;</span>
  45 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x100 != 0) ratio = (ratio * 0xfcbe86c7900a88aedcffc83b479aa3a4) &gt;&gt; 128;</span>
  46 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x200 != 0) ratio = (ratio * 0xf987a7253ac413176f2b074cf7815e54) &gt;&gt; 128;</span>
  47 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x400 != 0) ratio = (ratio * 0xf3392b0822b70005940c7a398e4b70f3) &gt;&gt; 128;</span>
  48 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x800 != 0) ratio = (ratio * 0xe7159475a2c29b7443b29c7fa6e889d9) &gt;&gt; 128;</span>
  49 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x1000 != 0) ratio = (ratio * 0xd097f3bdfd2022b8845ad8f792aa5825) &gt;&gt; 128;</span>
  50 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x2000 != 0) ratio = (ratio * 0xa9f746462d870fdf8a65dc1f90e061e5) &gt;&gt; 128;</span>
  51 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x4000 != 0) ratio = (ratio * 0x70d869a156d2a1b890bb3df62baf32f7) &gt;&gt; 128;</span>
  52 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x8000 != 0) ratio = (ratio * 0x31be135f97d08fd981231505542fcfa6) &gt;&gt; 128;</span>
  53 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x10000 != 0) ratio = (ratio * 0x9aa508b5b7a84e1c677de54f3e99bc9) &gt;&gt; 128;</span>
  54 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x20000 != 0) ratio = (ratio * 0x5d6af8dedb81196699c329225ee604) &gt;&gt; 128;</span>
  55 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x40000 != 0) ratio = (ratio * 0x2216e584f5fa1ea926041bedfe98) &gt;&gt; 128;</span>
  56 |     | <span style='background-color: #faa;'>        if (absTick &amp; 0x80000 != 0) ratio = (ratio * 0x48a170391f7dc42444e8fa2) &gt;&gt; 128;</span>
  57 |     | <span style='background-color: #eee;'></span>
  58 |     | <span style='background-color: #faa;'>        if (tick &gt; 0) ratio = type(uint256).max / ratio;</span>
  59 |     | <span style='background-color: #eee;'></span>
  60 |     | <span style='background-color: #eee;'>        // this divides by 1&lt;&lt;32 rounding up to go from a Q128.128 to a Q128.96.</span>
  61 |     | <span style='background-color: #eee;'>        // we then downcast because we know the result always fits within 160 bits due to our tick input constraint</span>
  62 |     | <span style='background-color: #eee;'>        // we round up in the division so getTickAtSqrtRatio of the output price is always consistent</span>
  63 |     | <span style='background-color: #faa;'>        sqrtPriceX96 = int256((ratio &gt;&gt; 32) + (ratio % (1 &lt;&lt; 32) == 0 ? 0 : 1));</span>
  64 |     | <span style='background-color: #eee;'>    }</span>
  65 |     | <span style='background-color: #eee;'>}</span>
  66 |     | <span style='background-color: #faa;'></span>
  67 |     | <span style='background-color: #eee;'>contract UniV3Oracle is ImmutableGovernance, INFTValueOracle {</span>
  68 |     | <span style='background-color: #faa;'>    INonfungiblePositionManager public immutable manager;</span>
  69 |     | <span style='background-color: #faa;'>    IUniswapV3Factory public immutable factory;</span>
  70 |     | <span style='background-color: #eee;'></span>
  71 |     | <span style='background-color: #faa;'>    int256 collateralFactor = 1 ether;</span>
  72 |     | <span style='background-color: #eee;'></span>
  73 |     | <span style='background-color: #faa;'>    mapping(address =&gt; IERC20ValueOracle) public erc20ValueOracle;</span>
  74 |     | <span style='background-color: #eee;'></span>
  75 |     | <span style='background-color: #faa;'>    int256 constant Q96 = int256(FixedPoint96.Q96);</span>
  76 |     | <span style='background-color: #eee;'></span>
  77 |     | <span style='background-color: #eee;'>    constructor(address _factory, address _manager, address _owner) ImmutableGovernance(_owner) {</span>
  78 |     | <span style='background-color: #faa;'>        manager = INonfungiblePositionManager(_manager);</span>
  79 |     | <span style='background-color: #faa;'>        factory = IUniswapV3Factory(_factory);</span>
  80 |     | <span style='background-color: #eee;'>    }</span>
  81 |     | <span style='background-color: #eee;'></span>
  82 |     | <span style='background-color: #eee;'>    function setERC20ValueOracle(address token, address oracle) external onlyGovernance {</span>
  83 |     | <span style='background-color: #faa;'>        erc20ValueOracle[token] = IERC20ValueOracle(oracle);</span>
  84 |     | <span style='background-color: #eee;'>    }</span>
  85 |     | <span style='background-color: #eee;'></span>
  86 |     | <span style='background-color: #eee;'>    function setCollateralFactor(int256 _collateralFactor) external onlyGovernance {</span>
  87 |     | <span style='background-color: #eee;'>        collateralFactor = _collateralFactor;</span>
  88 |     | <span style='background-color: #eee;'>    }</span>
  89 |     | <span style='background-color: #eee;'></span>
  90 |     | <span style='background-color: #eee;'>    function calcValue(uint256 tokenId) external view override returns (int256, int256) {</span>
  91 |     | <span style='background-color: #eee;'>        address token0;</span>
  92 |     | <span style='background-color: #eee;'>        address token1;</span>
  93 |     | <span style='background-color: #eee;'>        int256 liquidity;</span>
  94 |     | <span style='background-color: #eee;'>        int256 sqrtPrice;</span>
  95 |     | <span style='background-color: #eee;'>        int256 baseX;</span>
  96 |     | <span style='background-color: #eee;'>        int256 baseY;</span>
  97 |     | <span style='background-color: #eee;'>        {</span>
  98 |     | <span style='background-color: #eee;'>            (</span>
  99 |     | <span style='background-color: #eee;'>                ,</span>
 100 |     | <span style='background-color: #eee;'>                ,</span>
 101 |     | <span style='background-color: #eee;'>                address token0Tmp,</span>
 102 |     | <span style='background-color: #eee;'>                address token1Tmp,</span>
 103 |     | <span style='background-color: #eee;'>                uint24 fee,</span>
 104 |     | <span style='background-color: #eee;'>                int24 tickLower,</span>
 105 |     | <span style='background-color: #eee;'>                int24 tickUpper,</span>
 106 |     | <span style='background-color: #eee;'>                uint128 liquidityUnsigned,</span>
 107 |     | <span style='background-color: #eee;'>                ,</span>
 108 |     | <span style='background-color: #eee;'>                ,</span>
 109 |     | <span style='background-color: #eee;'>                ,</span>
 110 |     | <span style='background-color: #eee;'></span>
 111 |     | <span style='background-color: #faa;'>            ) = manager.positions(tokenId);</span>
 112 |     | <span style='background-color: #eee;'>            liquidity = int256(uint256(liquidityUnsigned));</span>
 113 |     | <span style='background-color: #faa;'>            IUniswapV3Pool pool = IUniswapV3Pool(factory.getPool(token0Tmp, token1Tmp, fee));</span>
 114 |     | <span style='background-color: #faa;'>            (uint160 sqrtPriceX96, , , , , , ) = pool.slot0();</span>
 115 |     | <span style='background-color: #eee;'>            sqrtPrice = int256(uint256(sqrtPriceX96));</span>
 116 |     | <span style='background-color: #eee;'>            token0 = token0Tmp;</span>
 117 |     | <span style='background-color: #eee;'>            token1 = token1Tmp;</span>
 118 |     | <span style='background-color: #faa;'>            int256 lowerSqrtPrice = TickMath.getSqrtRatioAtTick(tickLower);</span>
 119 |     | <span style='background-color: #faa;'>            int256 upperSqrtPrice = TickMath.getSqrtRatioAtTick(tickUpper);</span>
 120 |     | <span style='background-color: #eee;'>            // Clamp the price into the range</span>
 121 |     | <span style='background-color: #eee;'>            sqrtPrice = FsMath.clip(sqrtPrice, lowerSqrtPrice, upperSqrtPrice);</span>
 122 |     | <span style='background-color: #faa;'>            baseX = (liquidity * Q96) / upperSqrtPrice;</span>
 123 |     | <span style='background-color: #faa;'>            baseY = (lowerSqrtPrice * liquidity) / Q96;</span>
 124 |     | <span style='background-color: #eee;'>        }</span>
 125 |     | <span style='background-color: #eee;'>        // X token0 amount, Y token1 amount</span>
 126 |     | <span style='background-color: #eee;'>        // L = sqrt(X * Y)  p = Y / X</span>
 127 |     | <span style='background-color: #eee;'>        // Thus sqrt(p) * L = Y and sqrt(p) / L = X</span>
 128 |     | <span style='background-color: #eee;'></span>
 129 |     | <span style='background-color: #faa;'>        int256 amountY = (sqrtPrice * liquidity) / Q96 - baseY;</span>
 130 |     | <span style='background-color: #faa;'>        int256 amountX = (liquidity * Q96) / sqrtPrice - baseX;</span>
 131 |     | <span style='background-color: #eee;'></span>
 132 |     | <span style='background-color: #faa;'>        int256 value = 0;</span>
 133 |     | <span style='background-color: #faa;'>        int256 riskAdjustedValue;</span>
 134 |     | <span style='background-color: #eee;'>        {</span>
 135 |     | <span style='background-color: #eee;'>            IERC20ValueOracle valueOracle = erc20ValueOracle[token0];</span>
 136 |     | <span style='background-color: #faa;'>            if (address(valueOracle) != address(0)) {</span>
 137 |     | <span style='background-color: #faa;'>                (int256 assetValue, int256 adjustedAssetValue) = valueOracle.calcValue(amountX);</span>
 138 |     | <span style='background-color: #faa;'>                value += assetValue;</span>
 139 |     | <span style='background-color: #faa;'>                riskAdjustedValue += adjustedAssetValue;</span>
 140 |     | <span style='background-color: #eee;'>            }</span>
 141 |     | <span style='background-color: #eee;'>        }</span>
 142 |     | <span style='background-color: #eee;'>        {</span>
 143 |     | <span style='background-color: #eee;'>            IERC20ValueOracle valueOracle = erc20ValueOracle[token1];</span>
 144 |     | <span style='background-color: #faa;'>            if (address(valueOracle) != address(0)) {</span>
 145 |     | <span style='background-color: #faa;'>                (int256 assetValue, int256 adjustedAssetValue) = valueOracle.calcValue(amountY);</span>
 146 |     | <span style='background-color: #faa;'>                value += assetValue;</span>
 147 |     | <span style='background-color: #faa;'>                riskAdjustedValue += adjustedAssetValue;</span>
 148 |     | <span style='background-color: #eee;'>            }</span>
 149 |     | <span style='background-color: #eee;'>        }</span>
 150 |     | <span style='background-color: #faa;'>        riskAdjustedValue = (riskAdjustedValue * collateralFactor) / 1 ether;</span>
 151 |     | <span style='background-color: #eee;'>        return (value, riskAdjustedValue);</span>
 152 |     | <span style='background-color: #eee;'>    }</span>
 153 |     | <span style='background-color: #eee;'>}</span>
 154 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/testing/Echidna.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;../dos/DOS.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'>import &quot;../dos/DSafeProxy.sol&quot;;</span>
  6 |     | <span style='background-color: #eee;'>import &quot;../dos/VersionManager.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'>import &quot;../interfaces/IVersionManager.sol&quot;;</span>
  8 |     | <span style='background-color: #eee;'>import &quot;../lib/FsMath.sol&quot;;</span>
  9 |     | <span style='background-color: #eee;'>import &quot;../lib/FsUtils.sol&quot;;</span>
 10 |     | <span style='background-color: #eee;'>import &quot;../lib/ImmutableVersion.sol&quot;;</span>
 11 |     | <span style='background-color: #eee;'></span>
 12 |     | <span style='background-color: #faa;'>// echidna-test . --config echidna.yaml --contract Echidna</span>
 13 |     | <span style='background-color: #eee;'>contract Echidna {</span>
 14 |     | <span style='background-color: #eee;'>  constructor() public {</span>
 15 |     | <span style='background-color: #eee;'>    initDos();</span>
 16 |     | <span style='background-color: #eee;'>  }</span>
 17 |     | <span style='background-color: #eee;'></span>
 18 |     | <span style='background-color: #eee;'>  function testExp(int256 xa, int256 xb) public {</span>
 19 |     | <span style='background-color: #faa;'>    int256 x = xa*FsMath.FIXED_POINT_SCALE+xb;</span>
 20 |     | <span style='background-color: #faa;'>    int256 result = FsMath.exp(x);</span>
 21 |     | <span style='background-color: #eee;'>    int256 epsilon = int256(1)&lt;&lt;uint256(10); // 2^10, far less than FIXED_POINT_SCALE</span>
 22 |     | <span style='background-color: #eee;'></span>
 23 |     | <span style='background-color: #faa;'>    if (x &gt;= 0)</span>
 24 |     | <span style='background-color: #faa;'>      assert(result &gt;= FsMath.FIXED_POINT_SCALE);</span>
 25 |     | <span style='background-color: #faa;'>    if (x &gt;= epsilon)</span>
 26 |     | <span style='background-color: #faa;'>      assert(result &gt; FsMath.FIXED_POINT_SCALE);</span>
 27 |     | <span style='background-color: #faa;'>    if (x &lt;= 0)</span>
 28 |     | <span style='background-color: #faa;'>      assert(result &lt;= FsMath.FIXED_POINT_SCALE);</span>
 29 |     | <span style='background-color: #faa;'>    if (x &lt;= -epsilon)</span>
 30 |     | <span style='background-color: #faa;'>      assert(result &lt; FsMath.FIXED_POINT_SCALE);</span>
 31 |     | <span style='background-color: #eee;'>  }</span>
 32 |     | <span style='background-color: #eee;'></span>
 33 |     | <span style='background-color: #eee;'>  function testPow(int256 xa, int256 xb, int256 n) public {</span>
 34 |     | <span style='background-color: #faa;'>    int256 x = xa*FsMath.FIXED_POINT_SCALE+xb;</span>
 35 |     | <span style='background-color: #faa;'>    int256 result = FsMath.pow(x,n);</span>
 36 |     | <span style='background-color: #eee;'></span>
 37 |     | <span style='background-color: #faa;'>    int256 signExpected = FsMath.sign(x);</span>
 38 |     | <span style='background-color: #faa;'>    if (n % 2 == 0 &amp;&amp; signExpected == -1) // when n is even, x^n is positive</span>
 39 |     | <span style='background-color: #eee;'>      signExpected = 1;</span>
 40 |     | <span style='background-color: #eee;'></span>
 41 |     | <span style='background-color: #faa;'>    if (n == 0) // x^0 = 1</span>
 42 |     | <span style='background-color: #faa;'>      assert(result == FsMath.FIXED_POINT_SCALE);</span>
 43 |     | <span style='background-color: #faa;'>    else if (n &lt; 0 || (x &gt; -FsMath.FIXED_POINT_SCALE &amp;&amp; x &lt; FsMath.FIXED_POINT_SCALE)) // if n is negative or |x| &lt; 1, x^n can round to 0</span>
 44 |     | <span style='background-color: #faa;'>      assert(FsMath.sign(result) == signExpected || result == 0);</span>
 45 |     | <span style='background-color: #eee;'>    else</span>
 46 |     | <span style='background-color: #faa;'>      assert(FsMath.sign(result) == signExpected);</span>
 47 |     | <span style='background-color: #eee;'>  }</span>
 48 |     | <span style='background-color: #eee;'></span>
 49 |     | <span style='background-color: #eee;'>  function testSqrt(int256 xa, int256 xb) public {</span>
 50 |     | <span style='background-color: #faa;'>    int256 x = xa*FsMath.FIXED_POINT_SCALE+xb;</span>
 51 |     | <span style='background-color: #faa;'>    require(x &gt;= 0, &quot;Must be positive&quot;);</span>
 52 |     | <span style='background-color: #faa;'>    require(x &lt;= 100*FsMath.FIXED_POINT_SCALE, &quot;Too big&quot;);</span>
 53 |     | <span style='background-color: #eee;'>    int256 result = FsMath.sqrt(x);</span>
 54 |     | <span style='background-color: #eee;'></span>
 55 |     | <span style='background-color: #faa;'>    assert(result &gt;= 0);</span>
 56 |     | <span style='background-color: #faa;'>    if (x &gt;= FsMath.FIXED_POINT_SCALE)</span>
 57 |     | <span style='background-color: #faa;'>      assert(result &lt;= x);</span>
 58 |     | <span style='background-color: #eee;'>    else</span>
 59 |     | <span style='background-color: #faa;'>      assert(result &gt;= x);</span>
 60 |     | <span style='background-color: #eee;'>  }</span>
 61 |     | <span style='background-color: #eee;'></span>
 62 |     | <span style='background-color: #eee;'>  VersionManager public versionManager;</span>
 63 |     | <span style='background-color: #faa;'>  DOSConfig public dosConfig;</span>
 64 |     | <span style='background-color: #faa;'>  DOS public dos;</span>
 65 |     | <span style='background-color: #faa;'>  DSafeLogic public dSafeLogic;</span>
 66 |     | <span style='background-color: #eee;'>  DSafeProxy public proxy1_1;</span>
 67 |     | <span style='background-color: #faa;'>  DSafeProxy public proxy1_2;</span>
 68 |     | <span style='background-color: #faa;'>  DSafeProxy public proxy2_1;</span>
 69 |     | <span style='background-color: #faa;'>  DSafeProxy public proxy2_2;</span>
 70 |     | <span style='background-color: #faa;'>  DSafeProxy public proxy3_1;</span>
 71 |     | <span style='background-color: #faa;'>  DSafeProxy public proxy3_2;</span>
 72 |     | <span style='background-color: #eee;'>  function initDos() internal {</span>
 73 |     | <span style='background-color: #faa;'>    versionManager = new VersionManager(address(this));</span>
 74 |     | <span style='background-color: #faa;'>    dosConfig = new DOSConfig(address(this));</span>
 75 |     | <span style='background-color: #faa;'>    dos = new DOS(address(dosConfig), address(versionManager));</span>
 76 |     | <span style='background-color: #faa;'>    dSafeLogic = new DSafeLogic(address(dos));</span>
 77 |     | <span style='background-color: #eee;'></span>
 78 |     | <span style='background-color: #faa;'>    dosConfig.setVersionManager(address(versionManager));</span>
 79 |     | <span style='background-color: #eee;'></span>
 80 |     | <span style='background-color: #faa;'>    versionManager.addVersion(IVersionManager.Status.PRODUCTION, address(dSafeLogic));</span>
 81 |     | <span style='background-color: #faa;'>    string memory versionName = string(FsUtils.decodeFromBytes32(dSafeLogic.immutableVersion()));</span>
 82 |     | <span style='background-color: #faa;'>    versionManager.markRecommendedVersion(versionName);</span>
 83 |     | <span style='background-color: #eee;'></span>
 84 |     | <span style='background-color: #faa;'>    proxy1_1 = DSafeProxy(payable(dosConfig._createDSafe(address(0x10000))));</span>
 85 |     | <span style='background-color: #faa;'>    proxy1_2 = DSafeProxy(payable(dosConfig._createDSafe(address(0x10000))));</span>
 86 |     | <span style='background-color: #faa;'>    proxy2_1 = DSafeProxy(payable(dosConfig._createDSafe(address(0x20000))));</span>
 87 |     | <span style='background-color: #faa;'>    proxy2_2 = DSafeProxy(payable(dosConfig._createDSafe(address(0x20000))));</span>
 88 |     | <span style='background-color: #faa;'>    proxy3_1 = DSafeProxy(payable(dosConfig._createDSafe(address(0x30000))));</span>
 89 |     | <span style='background-color: #faa;'>    proxy3_2 = DSafeProxy(payable(dosConfig._createDSafe(address(0x30000))));</span>
 90 |     | <span style='background-color: #eee;'>  }</span>
 91 |     | <span style='background-color: #eee;'>}</span>
 92 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/testing/Echidna2.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;../dos/DOS.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'>import &quot;../dos/DSafeProxy.sol&quot;;</span>
  6 |     | <span style='background-color: #eee;'>import &quot;../dos/VersionManager.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'>import &quot;../interfaces/IVersionManager.sol&quot;;</span>
  8 |     | <span style='background-color: #eee;'>import &quot;../lib/FsMath.sol&quot;;</span>
  9 |     | <span style='background-color: #eee;'>import &quot;../lib/FsUtils.sol&quot;;</span>
 10 |     | <span style='background-color: #eee;'>import &quot;../lib/ImmutableVersion.sol&quot;;</span>
 11 | *r  | <span style='background-color: #afa;'></span>
 12 |     | <span style='background-color: #eee;'>contract Echidna2 {</span>
 13 |     | <span style='background-color: #eee;'>  // SETUP STUFF, I THINK I DID THIS PART RIGHT:</span>
 14 |     | <span style='background-color: #eee;'>  VersionManager public versionManager;</span>
 15 | *   | <span style='background-color: #afa;'>  DOSConfig public dosConfig;</span>
 16 | *   | <span style='background-color: #afa;'>  DOS public dos;</span>
 17 | *   | <span style='background-color: #afa;'>  DSafeLogic public dSafeLogic;</span>
 18 |     | <span style='background-color: #eee;'>  address public proxy1;</span>
 19 |     | <span style='background-color: #eee;'>  constructor() public {</span>
 20 |     | <span style='background-color: #faa;'>    versionManager = new VersionManager(address(this));</span>
 21 |     | <span style='background-color: #faa;'>    dosConfig = new DOSConfig(address(this));</span>
 22 |     | <span style='background-color: #faa;'>    dos = new DOS(address(dosConfig), address(versionManager));</span>
 23 |     | <span style='background-color: #faa;'>    dSafeLogic = new DSafeLogic(address(dos));</span>
 24 |     | <span style='background-color: #eee;'></span>
 25 |     | <span style='background-color: #faa;'>    dosConfig.setVersionManager(address(versionManager));</span>
 26 |     | <span style='background-color: #eee;'></span>
 27 |     | <span style='background-color: #faa;'>    versionManager.addVersion(IVersionManager.Status.PRODUCTION, address(dSafeLogic));</span>
 28 |     | <span style='background-color: #faa;'>    string memory versionName = string(FsUtils.decodeFromBytes32(dSafeLogic.immutableVersion()));</span>
 29 |     | <span style='background-color: #faa;'>    versionManager.markRecommendedVersion(versionName);</span>
 30 |     | <span style='background-color: #eee;'></span>
 31 |     | <span style='background-color: #eee;'>    // pretty sure everything up here is good</span>
 32 |     | <span style='background-color: #eee;'></span>
 33 |     | <span style='background-color: #faa;'>    proxy1 = dosConfig.createDSafe();</span>
 34 |     | <span style='background-color: #eee;'>  }</span>
 35 |     | <span style='background-color: #eee;'>  function ensureProxyNonzero() public { // fails in assert mode, meaning proxy1 is nonzero</span>
 36 | *   | <span style='background-color: #afa;'>    if (proxy1 != address(0))</span>
 37 |     | <span style='background-color: #eee;'>      assert(false);</span>
 38 |     | <span style='background-color: #eee;'>  }</span>
 39 |     | <span style='background-color: #eee;'>  // ONE OF THESE TWO SHOULD WORK:</span>
 40 |     | <span style='background-color: #eee;'>  function tryToCall1() public { // passes in assert mode, meaning the call isn&#39;t working</span>
 41 | r   | <span style='background-color: #ffa;'>    DSafeProxy(payable(proxy1)).executeBatch(new Call[](0));</span>
 42 |     | <span style='background-color: #eee;'>  }</span>
 43 |     | <span style='background-color: #eee;'>  function tryToCall2() public { // passes in assert mode, meaning the call isn&#39;t working</span>
 44 | r   | <span style='background-color: #ffa;'>    DSafeLogic(proxy1).executeBatch(new Call[](0));</span>
 45 |     | <span style='background-color: #eee;'>  }</span>
 46 |     | <span style='background-color: #eee;'>}</span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/testing/MockERC20Oracle.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;../interfaces/IERC20ValueOracle.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'>import &quot;../lib/ImmutableGovernance.sol&quot;;</span>
  6 |     | <span style='background-color: #faa;'></span>
  7 |     | <span style='background-color: #eee;'>contract MockERC20Oracle is IERC20ValueOracle, ImmutableGovernance {</span>
  8 |     | <span style='background-color: #eee;'>    int256 public price;</span>
  9 |     | <span style='background-color: #faa;'>    int256 collateralFactor = 1 ether;</span>
 10 |     | <span style='background-color: #eee;'></span>
 11 |     | <span style='background-color: #eee;'>    constructor(address owner) ImmutableGovernance(owner) {}</span>
 12 |     | <span style='background-color: #eee;'></span>
 13 |     | <span style='background-color: #eee;'>    function setPrice(</span>
 14 |     | <span style='background-color: #eee;'>        int256 _price,</span>
 15 |     | <span style='background-color: #eee;'>        uint256 baseDecimals,</span>
 16 |     | <span style='background-color: #eee;'>        uint256 decimals</span>
 17 |     | <span style='background-color: #eee;'>    ) external onlyGovernance {</span>
 18 |     | <span style='background-color: #faa;'>        price = (_price * (int256(10) ** (18 + baseDecimals - decimals))) / 1 ether;</span>
 19 |     | <span style='background-color: #eee;'>    }</span>
 20 |     | <span style='background-color: #eee;'></span>
 21 |     | <span style='background-color: #eee;'>    function setCollateralFactor(int256 _collateralFactor) external onlyGovernance {</span>
 22 |     | <span style='background-color: #eee;'>        collateralFactor = _collateralFactor;</span>
 23 |     | <span style='background-color: #eee;'>    }</span>
 24 |     | <span style='background-color: #eee;'></span>
 25 |     | <span style='background-color: #eee;'>    function calcValue(</span>
 26 |     | <span style='background-color: #eee;'>        int256 amount</span>
 27 |     | <span style='background-color: #eee;'>    ) external view override returns (int256 value, int256 riskAdjustedValue) {</span>
 28 |     | <span style='background-color: #faa;'>        value = (amount * price) / 1 ether;</span>
 29 |     | <span style='background-color: #faa;'>        riskAdjustedValue = (value * collateralFactor) / 1 ether;</span>
 30 |     | <span style='background-color: #eee;'>        return (value, riskAdjustedValue);</span>
 31 |     | <span style='background-color: #eee;'>    }</span>
 32 |     | <span style='background-color: #eee;'>}</span>
 33 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/testing/MockNFTOracle.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;../interfaces/INFTValueOracle.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/Strings.sol&quot;;</span>
  6 |     | <span style='background-color: #faa;'></span>
  7 |     | <span style='background-color: #eee;'>contract MockNFTOracle is INFTValueOracle {</span>
  8 |     | <span style='background-color: #eee;'>    mapping(uint256 =&gt; int256) prices;</span>
  9 |     | <span style='background-color: #faa;'>    int256 collateralFactor = 1 ether;</span>
 10 |     | <span style='background-color: #eee;'></span>
 11 |     | <span style='background-color: #eee;'>    function setPrice(uint256 tokenId, int256 price) external {</span>
 12 |     | <span style='background-color: #eee;'>        require(</span>
 13 |     | <span style='background-color: #faa;'>            price != -1,</span>
 14 |     | <span style='background-color: #eee;'>            &quot;Please, don&#39;t use -1 as NFT price - it&#39;s a reserved value used for early error detection&quot;</span>
 15 |     | <span style='background-color: #eee;'>        );</span>
 16 |     | <span style='background-color: #eee;'>        prices[tokenId] = price + 1;</span>
 17 |     | <span style='background-color: #eee;'>    }</span>
 18 |     | <span style='background-color: #eee;'></span>
 19 |     | <span style='background-color: #eee;'>    function setCollateralFactor(int256 _collateralFactor) external {</span>
 20 |     | <span style='background-color: #eee;'>        collateralFactor = _collateralFactor;</span>
 21 |     | <span style='background-color: #eee;'>    }</span>
 22 |     | <span style='background-color: #eee;'></span>
 23 |     | <span style='background-color: #eee;'>    function calcValue(uint256 tokenId) external view override returns (int256, int256) {</span>
 24 |     | <span style='background-color: #eee;'>        require(</span>
 25 |     | <span style='background-color: #faa;'>            prices[tokenId] &gt; 0,</span>
 26 |     | <span style='background-color: #eee;'>            string.concat(</span>
 27 |     | <span style='background-color: #eee;'>                &quot;Price for the NFT with tokenId &quot;,</span>
 28 |     | <span style='background-color: #faa;'>                Strings.toString(tokenId),</span>
 29 |     | <span style='background-color: #eee;'>                &quot; is not set&quot;</span>
 30 |     | <span style='background-color: #eee;'>            )</span>
 31 |     | <span style='background-color: #eee;'>        );</span>
 32 |     | <span style='background-color: #eee;'>        int256 value = prices[tokenId] - 1;</span>
 33 |     | <span style='background-color: #faa;'>        int256 riskAdjustedValue = (value * collateralFactor) / 1 ether;</span>
 34 |     | <span style='background-color: #eee;'>        return (value, riskAdjustedValue);</span>
 35 |     | <span style='background-color: #eee;'>    }</span>
 36 |     | <span style='background-color: #eee;'>}</span>
 37 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/testing/TestERC20.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.7;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;;</span>
  5 |     | <span style='background-color: #faa;'></span>
  6 |     | <span style='background-color: #eee;'>contract TestERC20 is ERC20 {</span>
  7 |     | <span style='background-color: #eee;'>    uint8 private immutable _decimals;</span>
  8 |     | <span style='background-color: #eee;'></span>
  9 |     | <span style='background-color: #eee;'>    constructor(string memory name, string memory symbol, uint8 deci) ERC20(name, symbol) {</span>
 10 |     | <span style='background-color: #faa;'>        _decimals = deci;</span>
 11 |     | <span style='background-color: #eee;'>    }</span>
 12 |     | <span style='background-color: #eee;'></span>
 13 |     | <span style='background-color: #eee;'>    function mint(address to, uint256 amount) external {</span>
 14 |     | <span style='background-color: #eee;'>        _mint(to, amount);</span>
 15 |     | <span style='background-color: #eee;'>    }</span>
 16 |     | <span style='background-color: #eee;'></span>
 17 |     | <span style='background-color: #eee;'>    function decimals() public view virtual override returns (uint8) {</span>
 18 |     | <span style='background-color: #faa;'>        return _decimals;</span>
 19 |     | <span style='background-color: #eee;'>    }</span>
 20 |     | <span style='background-color: #eee;'>}</span>
 21 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/testing/TestFsMath.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;../lib/FsMath.sol&quot;;</span>
  5 |     | <span style='background-color: #faa;'></span>
  6 |     | <span style='background-color: #eee;'>contract TestFsMath {</span>
  7 |     | <span style='background-color: #eee;'>    function abs(int256 value) external pure returns (uint256) {</span>
  8 |     | <span style='background-color: #eee;'>        return FsMath.abs(value);</span>
  9 |     | <span style='background-color: #eee;'>    }</span>
 10 |     | <span style='background-color: #eee;'></span>
 11 |     | <span style='background-color: #eee;'>    function sabs(int256 value) external pure returns (int256) {</span>
 12 |     | <span style='background-color: #faa;'>        return FsMath.sabs(value);</span>
 13 |     | <span style='background-color: #eee;'>    }</span>
 14 |     | <span style='background-color: #eee;'></span>
 15 |     | <span style='background-color: #eee;'>    function sign(int256 value) external pure returns (int256) {</span>
 16 |     | <span style='background-color: #faa;'>        return FsMath.sign(value);</span>
 17 |     | <span style='background-color: #eee;'>    }</span>
 18 |     | <span style='background-color: #eee;'></span>
 19 |     | <span style='background-color: #eee;'>    function min(int256 a, int256 b) external pure returns (int256) {</span>
 20 |     | <span style='background-color: #eee;'>        return FsMath.min(a, b);</span>
 21 |     | <span style='background-color: #eee;'>    }</span>
 22 |     | <span style='background-color: #eee;'></span>
 23 |     | <span style='background-color: #eee;'>    function max(int256 a, int256 b) external pure returns (int256) {</span>
 24 |     | <span style='background-color: #eee;'>        return FsMath.max(a, b);</span>
 25 |     | <span style='background-color: #eee;'>    }</span>
 26 |     | <span style='background-color: #eee;'></span>
 27 |     | <span style='background-color: #eee;'>    // Clip val into interval [lower, upper]</span>
 28 |     | <span style='background-color: #eee;'>    function clip(int256 val, int256 lower, int256 upper) external pure returns (int256) {</span>
 29 |     | <span style='background-color: #eee;'>        return FsMath.clip(val, lower, upper);</span>
 30 |     | <span style='background-color: #eee;'>    }</span>
 31 |     | <span style='background-color: #eee;'></span>
 32 |     | <span style='background-color: #eee;'>    function safeCastToSigned(uint256 x) external pure returns (int256) {</span>
 33 |     | <span style='background-color: #eee;'>        return FsMath.safeCastToSigned(x);</span>
 34 |     | <span style='background-color: #eee;'>    }</span>
 35 |     | <span style='background-color: #eee;'></span>
 36 |     | <span style='background-color: #eee;'>    function safeCastToUnsigned(int256 x) external pure returns (uint256) {</span>
 37 |     | <span style='background-color: #eee;'>        return FsMath.safeCastToUnsigned(x);</span>
 38 |     | <span style='background-color: #eee;'>    }</span>
 39 |     | <span style='background-color: #eee;'></span>
 40 |     | <span style='background-color: #eee;'>    function exp(int256 x) external pure returns (int256) {</span>
 41 |     | <span style='background-color: #faa;'>        return FsMath.exp(x);</span>
 42 |     | <span style='background-color: #eee;'>    }</span>
 43 |     | <span style='background-color: #eee;'></span>
 44 |     | <span style='background-color: #eee;'>    function sqrt(int256 x) external pure returns (int256) {</span>
 45 |     | <span style='background-color: #eee;'>        return FsMath.sqrt(x);</span>
 46 |     | <span style='background-color: #eee;'>    }</span>
 47 |     | <span style='background-color: #eee;'></span>
 48 |     | <span style='background-color: #eee;'>    function bitCount(uint256 x) external pure returns (uint256) {</span>
 49 |     | <span style='background-color: #faa;'>        return FsMath.bitCount(x);</span>
 50 |     | <span style='background-color: #eee;'>    }</span>
 51 |     | <span style='background-color: #eee;'>}</span>
 52 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/testing/TestNFT.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC721/ERC721.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/Counters.sol&quot;;</span>
  6 |     | <span style='background-color: #faa;'></span>
  7 |     | <span style='background-color: #eee;'>contract TestNFT is ERC721 {</span>
  8 |     | <span style='background-color: #eee;'>    using Counters for Counters.Counter;</span>
  9 |     | <span style='background-color: #eee;'>    Counters.Counter private tokenIdCounter;</span>
 10 |     | <span style='background-color: #eee;'></span>
 11 |     | <span style='background-color: #eee;'>    event Mint(uint256 tokenId);</span>
 12 |     | <span style='background-color: #eee;'></span>
 13 |     | <span style='background-color: #eee;'>    constructor(</span>
 14 |     | <span style='background-color: #eee;'>        string memory name,</span>
 15 |     | <span style='background-color: #eee;'>        string memory symbol,</span>
 16 |     | <span style='background-color: #eee;'>        uint256 initTokenId</span>
 17 |     | <span style='background-color: #eee;'>    ) ERC721(name, symbol) {</span>
 18 |     | <span style='background-color: #faa;'>        tokenIdCounter._value = initTokenId;</span>
 19 |     | <span style='background-color: #eee;'>    }</span>
 20 |     | <span style='background-color: #eee;'></span>
 21 |     | <span style='background-color: #eee;'>    function mint(address to) public returns (uint256) {</span>
 22 |     | <span style='background-color: #faa;'>        uint256 tokenId = tokenIdCounter.current();</span>
 23 |     | <span style='background-color: #eee;'>        tokenIdCounter.increment();</span>
 24 |     | <span style='background-color: #eee;'>        _mint(to, tokenId);</span>
 25 |     | <span style='background-color: #faa;'>        emit Mint(tokenId);</span>
 26 |     | <span style='background-color: #eee;'>        return tokenId;</span>
 27 |     | <span style='background-color: #eee;'>    }</span>
 28 |     | <span style='background-color: #eee;'>}</span>
 29 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/testing/TestTrie.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;../lib/Proofs.sol&quot;;</span>
  5 |     | <span style='background-color: #faa;'></span>
  6 |     | <span style='background-color: #eee;'>contract TestTrie {</span>
  7 |     | <span style='background-color: #eee;'>    function verify(</span>
  8 |     | <span style='background-color: #eee;'>        bytes calldata key,</span>
  9 |     | <span style='background-color: #eee;'>        bytes32 root,</span>
 10 |     | <span style='background-color: #eee;'>        bytes calldata proof</span>
 11 |     | <span style='background-color: #eee;'>    ) external pure returns (bytes memory) {</span>
 12 |     | <span style='background-color: #faa;'>        return BytesViewLib.toBytes(TrieLib.verify(bytes32(key), key.length, root, proof));</span>
 13 |     | <span style='background-color: #eee;'>    }</span>
 14 |     | <span style='background-color: #eee;'>}</span>
 15 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/testing/VotingTest.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;../governance/Voting.sol&quot;;</span>
  5 |     | <span style='background-color: #faa;'></span>
  6 |     | <span style='background-color: #eee;'>contract VotingTest is Voting {</span>
  7 |     | <span style='background-color: #faa;'>    bytes32 public mockBlockHash;</span>
  8 |     | <span style='background-color: #eee;'></span>
  9 |     | <span style='background-color: #eee;'>    constructor(</span>
 10 |     | <span style='background-color: #eee;'>        address hashNFT_,</span>
 11 |     | <span style='background-color: #eee;'>        address governanceToken_,</span>
 12 |     | <span style='background-color: #eee;'>        uint256 mappingSlot_,</span>
 13 |     | <span style='background-color: #eee;'>        uint256 totalSupplySlot_,</span>
 14 |     | <span style='background-color: #eee;'>        address governance_</span>
 15 |     | <span style='background-color: #eee;'>    ) Voting(hashNFT_, governanceToken_, mappingSlot_, totalSupplySlot_, governance_) {}</span>
 16 |     | <span style='background-color: #eee;'></span>
 17 |     | <span style='background-color: #eee;'>    function setMockBlockHash(bytes32 blockHash) external {</span>
 18 |     | <span style='background-color: #faa;'>        mockBlockHash = blockHash;</span>
 19 |     | <span style='background-color: #eee;'>    }</span>
 20 |     | <span style='background-color: #eee;'></span>
 21 |     | <span style='background-color: #eee;'>    function getBlockHash(uint256) internal view override returns (bytes32) {</span>
 22 |     | <span style='background-color: #faa;'>        return mockBlockHash;</span>
 23 |     | <span style='background-color: #eee;'>    }</span>
 24 |     | <span style='background-color: #eee;'>}</span>
 25 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/testing/external/WETH9.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>//SPDX-License-Identifier: UNLICENSED</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.7;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/utils/Address.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;;</span>
  6 |     | <span style='background-color: #faa;'></span>
  7 |     | <span style='background-color: #eee;'>contract WETH9 is ERC20 {</span>
  8 |     | <span style='background-color: #eee;'>    constructor() ERC20(&quot;Wrapped ETH&quot;, &quot;WETH&quot;) {}</span>
  9 |     | <span style='background-color: #eee;'></span>
 10 |     | <span style='background-color: #eee;'>    function deposit() external payable {</span>
 11 |     | <span style='background-color: #faa;'>        _mint(msg.sender, msg.value);</span>
 12 |     | <span style='background-color: #eee;'>    }</span>
 13 |     | <span style='background-color: #eee;'></span>
 14 |     | <span style='background-color: #eee;'>    function withdraw(uint256 amount) external {</span>
 15 |     | <span style='background-color: #faa;'>        _burn(msg.sender, amount);</span>
 16 |     | <span style='background-color: #eee;'></span>
 17 |     | <span style='background-color: #eee;'>        Address.sendValue(payable(msg.sender), amount);</span>
 18 |     | <span style='background-color: #eee;'>    }</span>
 19 |     | <span style='background-color: #eee;'></span>
 20 |     | <span style='background-color: #eee;'>    function mint(address to, uint256 amount) external {</span>
 21 |     | <span style='background-color: #faa;'>        _mint(to, amount);</span>
 22 |     | <span style='background-color: #eee;'>    }</span>
 23 |     | <span style='background-color: #eee;'>}</span>
 24 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/tokens/HashNFT.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;@openzeppelin/contracts/token/ERC1155/extensions/ERC1155Burnable.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'></span>
  6 |     | <span style='background-color: #eee;'>/// @title HashNFT a NFT for cryptographic proof of ownership.</span>
  7 |     | <span style='background-color: #eee;'>/// @notice A generic ownerless contract that allows fine grained access control,</span>
  8 |     | <span style='background-color: #eee;'>/// voting and other use cases build on top of.</span>
  9 |     | <span style='background-color: #eee;'>/// @dev The 256 bit tokenId of ERC1155 is used to store cryptographic hash of the</span>
 10 |     | <span style='background-color: #eee;'>/// an arbitrary digest and minter address. The cryptographic security of the hash</span>
 11 |     | <span style='background-color: #eee;'>/// provides the guarantees of the contract.</span>
 12 |     | <span style='background-color: #eee;'>/// 1) Each token id is associated with only one minter and digest.</span>
 13 |     | <span style='background-color: #eee;'>/// 2) Ownership of a token id implies the minter has granted (directly or indirectly)</span>
 14 |     | <span style='background-color: #eee;'>///    the ownership to the owner. (The minter can revoke the token at any time.</span>
 15 |     | <span style='background-color: #eee;'>/// 3) A minter (and only the minter) can revoke tokens it issued itself.</span>
 16 |     | <span style='background-color: #faa;'>/// 4) Everyone can burn tokens they own.</span>
 17 |     | <span style='background-color: #eee;'>contract HashNFT is ERC1155Burnable {</span>
 18 |     | <span style='background-color: #eee;'>    bytes constant HASHNFT_TYPESTRING = &quot;HashNFT(address minter,bytes32 digest)&quot;;</span>
 19 |     | <span style='background-color: #faa;'>    bytes32 constant HASHNFT_TYPEHASH = keccak256(HASHNFT_TYPESTRING);</span>
 20 |     | <span style='background-color: #eee;'></span>
 21 |     | <span style='background-color: #eee;'>    event Minted(uint256 indexed tokenId, address indexed minter, bytes32 indexed digest);</span>
 22 |     | <span style='background-color: #eee;'></span>
 23 |     | <span style='background-color: #eee;'>    constructor(string memory uri) ERC1155(uri) {}</span>
 24 |     | <span style='background-color: #eee;'></span>
 25 |     | <span style='background-color: #eee;'>    function mint(</span>
 26 |     | <span style='background-color: #eee;'>        address to,</span>
 27 |     | <span style='background-color: #eee;'>        bytes32 digest,</span>
 28 |     | <span style='background-color: #eee;'>        bytes calldata data</span>
 29 |     | <span style='background-color: #eee;'>    ) external returns (uint256 tokenId) {</span>
 30 |     | <span style='background-color: #faa;'>        tokenId = toTokenId(msg.sender, digest);</span>
 31 |     | <span style='background-color: #faa;'>        _mint(to, tokenId, 1, data);</span>
 32 |     | <span style='background-color: #faa;'>        emit Minted(tokenId, msg.sender, digest);</span>
 33 |     | <span style='background-color: #eee;'>    }</span>
 34 |     | <span style='background-color: #eee;'></span>
 35 |     | <span style='background-color: #eee;'>    // The minter can revoke tokens it minted.</span>
 36 |     | <span style='background-color: #eee;'>    function revoke(address from, bytes32 digest) external {</span>
 37 |     | <span style='background-color: #faa;'>        uint256 tokenId = toTokenId(msg.sender, digest);</span>
 38 |     | <span style='background-color: #faa;'>        _burn(from, tokenId, 1);</span>
 39 |     | <span style='background-color: #eee;'>    }</span>
 40 |     | <span style='background-color: #eee;'></span>
 41 |     | <span style='background-color: #eee;'>    // Crypto secure hash function, to ensure only valid digest are recognized</span>
 42 |     | <span style='background-color: #faa;'>    function toTokenId(address minter, bytes32 digest) public pure returns (uint256) {</span>
 43 |     | <span style='background-color: #faa;'>        return uint256(keccak256(abi.encode(HASHNFT_TYPEHASH, minter, digest)));</span>
 44 |     | <span style='background-color: #eee;'>    }</span>
 45 |     | <span style='background-color: #eee;'>}</span>
 46 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/contracts/utils/TypeChainGeneration.sol</b>
<code>
  1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: BUSL-1.1</span>
  2 |     | <span style='background-color: #eee;'>pragma solidity ^0.8.17;</span>
  3 |     | <span style='background-color: #eee;'></span>
  4 |     | <span style='background-color: #eee;'>import &quot;@uniswap/v3-core/contracts/interfaces/IUniswapV3Factory.sol&quot;;</span>
  5 |     | <span style='background-color: #eee;'>import &quot;@uniswap/v3-core/contracts/interfaces/IUniswapV3Pool.sol&quot;;</span>
  6 |     | <span style='background-color: #eee;'>import &quot;@uniswap/v3-periphery/contracts/interfaces/ISwapRouter.sol&quot;;</span>
  7 |     | <span style='background-color: #eee;'>// These unfortunately don&#39;t compile due to conflict with our version of openzeppelin</span>
  8 |     | <span style='background-color: #eee;'>// import &quot;@uniswap/v3-periphery/contracts/interfaces/INonfungiblePositionManager.sol&quot;;</span>
  9 |     | <span style='background-color: #eee;'>// import &quot;@uniswap/v3-periphery/contracts/interfaces/INonfungibleTokenPositionDescriptor.sol&quot;;</span>
 10 |     | <span style='background-color: #eee;'></span>
 11 |     | <span style='background-color: #eee;'>// Just here so solidity compiles and typechain generates the types</span>
 12 |     | <span style='background-color: #eee;'></span>

</code>
<br />

<b>/Users/elvisskozdopolj/Documents/GitHub/audit-futureswap-jan2023/node_modules/hardhat/console.sol</b>
<code>
    1 |     | <span style='background-color: #eee;'>// SPDX-License-Identifier: MIT</span>
    2 |     | <span style='background-color: #eee;'>pragma solidity &gt;= 0.4.22 &lt;0.9.0;</span>
    3 |     | <span style='background-color: #faa;'></span>
    4 |     | <span style='background-color: #eee;'>library console {</span>
    5 |     | <span style='background-color: #eee;'>	address constant CONSOLE_ADDRESS = address(0x000000000000000000636F6e736F6c652e6c6f67);</span>
    6 |     | <span style='background-color: #eee;'></span>
    7 |     | <span style='background-color: #eee;'>	function _sendLogPayload(bytes memory payload) private view {</span>
    8 |     | <span style='background-color: #eee;'>		uint256 payloadLength = payload.length;</span>
    9 |     | <span style='background-color: #eee;'>		address consoleAddress = CONSOLE_ADDRESS;</span>
   10 |     | <span style='background-color: #eee;'>		assembly {</span>
   11 |     | <span style='background-color: #eee;'>			let payloadStart := add(payload, 32)</span>
   12 |     | <span style='background-color: #eee;'>			let r := staticcall(gas(), consoleAddress, payloadStart, payloadLength, 0, 0)</span>
   13 |     | <span style='background-color: #eee;'>		}</span>
   14 |     | <span style='background-color: #eee;'>	}</span>
   15 |     | <span style='background-color: #eee;'></span>
   16 |     | <span style='background-color: #eee;'>	function log() internal view {</span>
   17 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log()&quot;));</span>
   18 |     | <span style='background-color: #eee;'>	}</span>
   19 |     | <span style='background-color: #eee;'></span>
   20 |     | <span style='background-color: #eee;'>	function logInt(int256 p0) internal view {</span>
   21 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(int256)&quot;, p0));</span>
   22 |     | <span style='background-color: #eee;'>	}</span>
   23 |     | <span style='background-color: #eee;'></span>
   24 |     | <span style='background-color: #eee;'>	function logUint(uint256 p0) internal view {</span>
   25 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256)&quot;, p0));</span>
   26 |     | <span style='background-color: #eee;'>	}</span>
   27 |     | <span style='background-color: #eee;'></span>
   28 |     | <span style='background-color: #eee;'>	function logString(string memory p0) internal view {</span>
   29 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string)&quot;, p0));</span>
   30 |     | <span style='background-color: #eee;'>	}</span>
   31 |     | <span style='background-color: #eee;'></span>
   32 |     | <span style='background-color: #eee;'>	function logBool(bool p0) internal view {</span>
   33 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool)&quot;, p0));</span>
   34 |     | <span style='background-color: #eee;'>	}</span>
   35 |     | <span style='background-color: #eee;'></span>
   36 |     | <span style='background-color: #eee;'>	function logAddress(address p0) internal view {</span>
   37 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address)&quot;, p0));</span>
   38 |     | <span style='background-color: #eee;'>	}</span>
   39 |     | <span style='background-color: #eee;'></span>
   40 |     | <span style='background-color: #eee;'>	function logBytes(bytes memory p0) internal view {</span>
   41 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes)&quot;, p0));</span>
   42 |     | <span style='background-color: #eee;'>	}</span>
   43 |     | <span style='background-color: #eee;'></span>
   44 |     | <span style='background-color: #eee;'>	function logBytes1(bytes1 p0) internal view {</span>
   45 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes1)&quot;, p0));</span>
   46 |     | <span style='background-color: #eee;'>	}</span>
   47 |     | <span style='background-color: #eee;'></span>
   48 |     | <span style='background-color: #eee;'>	function logBytes2(bytes2 p0) internal view {</span>
   49 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes2)&quot;, p0));</span>
   50 |     | <span style='background-color: #eee;'>	}</span>
   51 |     | <span style='background-color: #eee;'></span>
   52 |     | <span style='background-color: #eee;'>	function logBytes3(bytes3 p0) internal view {</span>
   53 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes3)&quot;, p0));</span>
   54 |     | <span style='background-color: #eee;'>	}</span>
   55 |     | <span style='background-color: #eee;'></span>
   56 |     | <span style='background-color: #eee;'>	function logBytes4(bytes4 p0) internal view {</span>
   57 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes4)&quot;, p0));</span>
   58 |     | <span style='background-color: #eee;'>	}</span>
   59 |     | <span style='background-color: #eee;'></span>
   60 |     | <span style='background-color: #eee;'>	function logBytes5(bytes5 p0) internal view {</span>
   61 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes5)&quot;, p0));</span>
   62 |     | <span style='background-color: #eee;'>	}</span>
   63 |     | <span style='background-color: #eee;'></span>
   64 |     | <span style='background-color: #eee;'>	function logBytes6(bytes6 p0) internal view {</span>
   65 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes6)&quot;, p0));</span>
   66 |     | <span style='background-color: #eee;'>	}</span>
   67 |     | <span style='background-color: #eee;'></span>
   68 |     | <span style='background-color: #eee;'>	function logBytes7(bytes7 p0) internal view {</span>
   69 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes7)&quot;, p0));</span>
   70 |     | <span style='background-color: #eee;'>	}</span>
   71 |     | <span style='background-color: #eee;'></span>
   72 |     | <span style='background-color: #eee;'>	function logBytes8(bytes8 p0) internal view {</span>
   73 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes8)&quot;, p0));</span>
   74 |     | <span style='background-color: #eee;'>	}</span>
   75 |     | <span style='background-color: #eee;'></span>
   76 |     | <span style='background-color: #eee;'>	function logBytes9(bytes9 p0) internal view {</span>
   77 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes9)&quot;, p0));</span>
   78 |     | <span style='background-color: #eee;'>	}</span>
   79 |     | <span style='background-color: #eee;'></span>
   80 |     | <span style='background-color: #eee;'>	function logBytes10(bytes10 p0) internal view {</span>
   81 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes10)&quot;, p0));</span>
   82 |     | <span style='background-color: #eee;'>	}</span>
   83 |     | <span style='background-color: #eee;'></span>
   84 |     | <span style='background-color: #eee;'>	function logBytes11(bytes11 p0) internal view {</span>
   85 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes11)&quot;, p0));</span>
   86 |     | <span style='background-color: #eee;'>	}</span>
   87 |     | <span style='background-color: #eee;'></span>
   88 |     | <span style='background-color: #eee;'>	function logBytes12(bytes12 p0) internal view {</span>
   89 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes12)&quot;, p0));</span>
   90 |     | <span style='background-color: #eee;'>	}</span>
   91 |     | <span style='background-color: #eee;'></span>
   92 |     | <span style='background-color: #eee;'>	function logBytes13(bytes13 p0) internal view {</span>
   93 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes13)&quot;, p0));</span>
   94 |     | <span style='background-color: #eee;'>	}</span>
   95 |     | <span style='background-color: #eee;'></span>
   96 |     | <span style='background-color: #eee;'>	function logBytes14(bytes14 p0) internal view {</span>
   97 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes14)&quot;, p0));</span>
   98 |     | <span style='background-color: #eee;'>	}</span>
   99 |     | <span style='background-color: #eee;'></span>
  100 |     | <span style='background-color: #eee;'>	function logBytes15(bytes15 p0) internal view {</span>
  101 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes15)&quot;, p0));</span>
  102 |     | <span style='background-color: #eee;'>	}</span>
  103 |     | <span style='background-color: #eee;'></span>
  104 |     | <span style='background-color: #eee;'>	function logBytes16(bytes16 p0) internal view {</span>
  105 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes16)&quot;, p0));</span>
  106 |     | <span style='background-color: #eee;'>	}</span>
  107 |     | <span style='background-color: #eee;'></span>
  108 |     | <span style='background-color: #eee;'>	function logBytes17(bytes17 p0) internal view {</span>
  109 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes17)&quot;, p0));</span>
  110 |     | <span style='background-color: #eee;'>	}</span>
  111 |     | <span style='background-color: #eee;'></span>
  112 |     | <span style='background-color: #eee;'>	function logBytes18(bytes18 p0) internal view {</span>
  113 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes18)&quot;, p0));</span>
  114 |     | <span style='background-color: #eee;'>	}</span>
  115 |     | <span style='background-color: #eee;'></span>
  116 |     | <span style='background-color: #eee;'>	function logBytes19(bytes19 p0) internal view {</span>
  117 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes19)&quot;, p0));</span>
  118 |     | <span style='background-color: #eee;'>	}</span>
  119 |     | <span style='background-color: #eee;'></span>
  120 |     | <span style='background-color: #eee;'>	function logBytes20(bytes20 p0) internal view {</span>
  121 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes20)&quot;, p0));</span>
  122 |     | <span style='background-color: #eee;'>	}</span>
  123 |     | <span style='background-color: #eee;'></span>
  124 |     | <span style='background-color: #eee;'>	function logBytes21(bytes21 p0) internal view {</span>
  125 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes21)&quot;, p0));</span>
  126 |     | <span style='background-color: #eee;'>	}</span>
  127 |     | <span style='background-color: #eee;'></span>
  128 |     | <span style='background-color: #eee;'>	function logBytes22(bytes22 p0) internal view {</span>
  129 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes22)&quot;, p0));</span>
  130 |     | <span style='background-color: #eee;'>	}</span>
  131 |     | <span style='background-color: #eee;'></span>
  132 |     | <span style='background-color: #eee;'>	function logBytes23(bytes23 p0) internal view {</span>
  133 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes23)&quot;, p0));</span>
  134 |     | <span style='background-color: #eee;'>	}</span>
  135 |     | <span style='background-color: #eee;'></span>
  136 |     | <span style='background-color: #eee;'>	function logBytes24(bytes24 p0) internal view {</span>
  137 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes24)&quot;, p0));</span>
  138 |     | <span style='background-color: #eee;'>	}</span>
  139 |     | <span style='background-color: #eee;'></span>
  140 |     | <span style='background-color: #eee;'>	function logBytes25(bytes25 p0) internal view {</span>
  141 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes25)&quot;, p0));</span>
  142 |     | <span style='background-color: #eee;'>	}</span>
  143 |     | <span style='background-color: #eee;'></span>
  144 |     | <span style='background-color: #eee;'>	function logBytes26(bytes26 p0) internal view {</span>
  145 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes26)&quot;, p0));</span>
  146 |     | <span style='background-color: #eee;'>	}</span>
  147 |     | <span style='background-color: #eee;'></span>
  148 |     | <span style='background-color: #eee;'>	function logBytes27(bytes27 p0) internal view {</span>
  149 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes27)&quot;, p0));</span>
  150 |     | <span style='background-color: #eee;'>	}</span>
  151 |     | <span style='background-color: #eee;'></span>
  152 |     | <span style='background-color: #eee;'>	function logBytes28(bytes28 p0) internal view {</span>
  153 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes28)&quot;, p0));</span>
  154 |     | <span style='background-color: #eee;'>	}</span>
  155 |     | <span style='background-color: #eee;'></span>
  156 |     | <span style='background-color: #eee;'>	function logBytes29(bytes29 p0) internal view {</span>
  157 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes29)&quot;, p0));</span>
  158 |     | <span style='background-color: #eee;'>	}</span>
  159 |     | <span style='background-color: #eee;'></span>
  160 |     | <span style='background-color: #eee;'>	function logBytes30(bytes30 p0) internal view {</span>
  161 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes30)&quot;, p0));</span>
  162 |     | <span style='background-color: #eee;'>	}</span>
  163 |     | <span style='background-color: #eee;'></span>
  164 |     | <span style='background-color: #eee;'>	function logBytes31(bytes31 p0) internal view {</span>
  165 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes31)&quot;, p0));</span>
  166 |     | <span style='background-color: #eee;'>	}</span>
  167 |     | <span style='background-color: #eee;'></span>
  168 |     | <span style='background-color: #eee;'>	function logBytes32(bytes32 p0) internal view {</span>
  169 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bytes32)&quot;, p0));</span>
  170 |     | <span style='background-color: #eee;'>	}</span>
  171 |     | <span style='background-color: #eee;'></span>
  172 |     | <span style='background-color: #eee;'>	function log(uint256 p0) internal view {</span>
  173 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256)&quot;, p0));</span>
  174 |     | <span style='background-color: #eee;'>	}</span>
  175 |     | <span style='background-color: #eee;'></span>
  176 |     | <span style='background-color: #eee;'>	function log(string memory p0) internal view {</span>
  177 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string)&quot;, p0));</span>
  178 |     | <span style='background-color: #eee;'>	}</span>
  179 |     | <span style='background-color: #eee;'></span>
  180 |     | <span style='background-color: #eee;'>	function log(bool p0) internal view {</span>
  181 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool)&quot;, p0));</span>
  182 |     | <span style='background-color: #eee;'>	}</span>
  183 |     | <span style='background-color: #eee;'></span>
  184 |     | <span style='background-color: #eee;'>	function log(address p0) internal view {</span>
  185 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address)&quot;, p0));</span>
  186 |     | <span style='background-color: #eee;'>	}</span>
  187 |     | <span style='background-color: #eee;'></span>
  188 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1) internal view {</span>
  189 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256)&quot;, p0, p1));</span>
  190 |     | <span style='background-color: #eee;'>	}</span>
  191 |     | <span style='background-color: #eee;'></span>
  192 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1) internal view {</span>
  193 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string)&quot;, p0, p1));</span>
  194 |     | <span style='background-color: #eee;'>	}</span>
  195 |     | <span style='background-color: #eee;'></span>
  196 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1) internal view {</span>
  197 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool)&quot;, p0, p1));</span>
  198 |     | <span style='background-color: #eee;'>	}</span>
  199 |     | <span style='background-color: #eee;'></span>
  200 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1) internal view {</span>
  201 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address)&quot;, p0, p1));</span>
  202 |     | <span style='background-color: #eee;'>	}</span>
  203 |     | <span style='background-color: #eee;'></span>
  204 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1) internal view {</span>
  205 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256)&quot;, p0, p1));</span>
  206 |     | <span style='background-color: #eee;'>	}</span>
  207 |     | <span style='background-color: #eee;'></span>
  208 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1) internal view {</span>
  209 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string)&quot;, p0, p1));</span>
  210 |     | <span style='background-color: #eee;'>	}</span>
  211 |     | <span style='background-color: #eee;'></span>
  212 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1) internal view {</span>
  213 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool)&quot;, p0, p1));</span>
  214 |     | <span style='background-color: #eee;'>	}</span>
  215 |     | <span style='background-color: #eee;'></span>
  216 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1) internal view {</span>
  217 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address)&quot;, p0, p1));</span>
  218 |     | <span style='background-color: #eee;'>	}</span>
  219 |     | <span style='background-color: #eee;'></span>
  220 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1) internal view {</span>
  221 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256)&quot;, p0, p1));</span>
  222 |     | <span style='background-color: #eee;'>	}</span>
  223 |     | <span style='background-color: #eee;'></span>
  224 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1) internal view {</span>
  225 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string)&quot;, p0, p1));</span>
  226 |     | <span style='background-color: #eee;'>	}</span>
  227 |     | <span style='background-color: #eee;'></span>
  228 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1) internal view {</span>
  229 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool)&quot;, p0, p1));</span>
  230 |     | <span style='background-color: #eee;'>	}</span>
  231 |     | <span style='background-color: #eee;'></span>
  232 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1) internal view {</span>
  233 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address)&quot;, p0, p1));</span>
  234 |     | <span style='background-color: #eee;'>	}</span>
  235 |     | <span style='background-color: #eee;'></span>
  236 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1) internal view {</span>
  237 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256)&quot;, p0, p1));</span>
  238 |     | <span style='background-color: #eee;'>	}</span>
  239 |     | <span style='background-color: #eee;'></span>
  240 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1) internal view {</span>
  241 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string)&quot;, p0, p1));</span>
  242 |     | <span style='background-color: #eee;'>	}</span>
  243 |     | <span style='background-color: #eee;'></span>
  244 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1) internal view {</span>
  245 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool)&quot;, p0, p1));</span>
  246 |     | <span style='background-color: #eee;'>	}</span>
  247 |     | <span style='background-color: #eee;'></span>
  248 |     | <span style='background-color: #eee;'>	function log(address p0, address p1) internal view {</span>
  249 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address)&quot;, p0, p1));</span>
  250 |     | <span style='background-color: #eee;'>	}</span>
  251 |     | <span style='background-color: #eee;'></span>
  252 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, uint256 p2) internal view {</span>
  253 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,uint256)&quot;, p0, p1, p2));</span>
  254 |     | <span style='background-color: #eee;'>	}</span>
  255 |     | <span style='background-color: #eee;'></span>
  256 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, string memory p2) internal view {</span>
  257 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,string)&quot;, p0, p1, p2));</span>
  258 |     | <span style='background-color: #eee;'>	}</span>
  259 |     | <span style='background-color: #eee;'></span>
  260 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, bool p2) internal view {</span>
  261 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,bool)&quot;, p0, p1, p2));</span>
  262 |     | <span style='background-color: #eee;'>	}</span>
  263 |     | <span style='background-color: #eee;'></span>
  264 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, address p2) internal view {</span>
  265 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,address)&quot;, p0, p1, p2));</span>
  266 |     | <span style='background-color: #eee;'>	}</span>
  267 |     | <span style='background-color: #eee;'></span>
  268 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, uint256 p2) internal view {</span>
  269 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,uint256)&quot;, p0, p1, p2));</span>
  270 |     | <span style='background-color: #eee;'>	}</span>
  271 |     | <span style='background-color: #eee;'></span>
  272 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, string memory p2) internal view {</span>
  273 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,string)&quot;, p0, p1, p2));</span>
  274 |     | <span style='background-color: #eee;'>	}</span>
  275 |     | <span style='background-color: #eee;'></span>
  276 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, bool p2) internal view {</span>
  277 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,bool)&quot;, p0, p1, p2));</span>
  278 |     | <span style='background-color: #eee;'>	}</span>
  279 |     | <span style='background-color: #eee;'></span>
  280 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, address p2) internal view {</span>
  281 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,address)&quot;, p0, p1, p2));</span>
  282 |     | <span style='background-color: #eee;'>	}</span>
  283 |     | <span style='background-color: #eee;'></span>
  284 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, uint256 p2) internal view {</span>
  285 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,uint256)&quot;, p0, p1, p2));</span>
  286 |     | <span style='background-color: #eee;'>	}</span>
  287 |     | <span style='background-color: #eee;'></span>
  288 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, string memory p2) internal view {</span>
  289 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,string)&quot;, p0, p1, p2));</span>
  290 |     | <span style='background-color: #eee;'>	}</span>
  291 |     | <span style='background-color: #eee;'></span>
  292 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, bool p2) internal view {</span>
  293 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,bool)&quot;, p0, p1, p2));</span>
  294 |     | <span style='background-color: #eee;'>	}</span>
  295 |     | <span style='background-color: #eee;'></span>
  296 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, address p2) internal view {</span>
  297 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,address)&quot;, p0, p1, p2));</span>
  298 |     | <span style='background-color: #eee;'>	}</span>
  299 |     | <span style='background-color: #eee;'></span>
  300 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, uint256 p2) internal view {</span>
  301 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,uint256)&quot;, p0, p1, p2));</span>
  302 |     | <span style='background-color: #eee;'>	}</span>
  303 |     | <span style='background-color: #eee;'></span>
  304 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, string memory p2) internal view {</span>
  305 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,string)&quot;, p0, p1, p2));</span>
  306 |     | <span style='background-color: #eee;'>	}</span>
  307 |     | <span style='background-color: #eee;'></span>
  308 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, bool p2) internal view {</span>
  309 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,bool)&quot;, p0, p1, p2));</span>
  310 |     | <span style='background-color: #eee;'>	}</span>
  311 |     | <span style='background-color: #eee;'></span>
  312 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, address p2) internal view {</span>
  313 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,address)&quot;, p0, p1, p2));</span>
  314 |     | <span style='background-color: #eee;'>	}</span>
  315 |     | <span style='background-color: #eee;'></span>
  316 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, uint256 p2) internal view {</span>
  317 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,uint256)&quot;, p0, p1, p2));</span>
  318 |     | <span style='background-color: #eee;'>	}</span>
  319 |     | <span style='background-color: #eee;'></span>
  320 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, string memory p2) internal view {</span>
  321 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,string)&quot;, p0, p1, p2));</span>
  322 |     | <span style='background-color: #eee;'>	}</span>
  323 |     | <span style='background-color: #eee;'></span>
  324 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, bool p2) internal view {</span>
  325 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,bool)&quot;, p0, p1, p2));</span>
  326 |     | <span style='background-color: #eee;'>	}</span>
  327 |     | <span style='background-color: #eee;'></span>
  328 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, address p2) internal view {</span>
  329 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,address)&quot;, p0, p1, p2));</span>
  330 |     | <span style='background-color: #eee;'>	}</span>
  331 |     | <span style='background-color: #eee;'></span>
  332 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, uint256 p2) internal view {</span>
  333 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,uint256)&quot;, p0, p1, p2));</span>
  334 |     | <span style='background-color: #eee;'>	}</span>
  335 |     | <span style='background-color: #eee;'></span>
  336 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, string memory p2) internal view {</span>
  337 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,string)&quot;, p0, p1, p2));</span>
  338 |     | <span style='background-color: #eee;'>	}</span>
  339 |     | <span style='background-color: #eee;'></span>
  340 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, bool p2) internal view {</span>
  341 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,bool)&quot;, p0, p1, p2));</span>
  342 |     | <span style='background-color: #eee;'>	}</span>
  343 |     | <span style='background-color: #eee;'></span>
  344 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, address p2) internal view {</span>
  345 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,address)&quot;, p0, p1, p2));</span>
  346 |     | <span style='background-color: #eee;'>	}</span>
  347 |     | <span style='background-color: #eee;'></span>
  348 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, uint256 p2) internal view {</span>
  349 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,uint256)&quot;, p0, p1, p2));</span>
  350 |     | <span style='background-color: #eee;'>	}</span>
  351 |     | <span style='background-color: #eee;'></span>
  352 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, string memory p2) internal view {</span>
  353 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,string)&quot;, p0, p1, p2));</span>
  354 |     | <span style='background-color: #eee;'>	}</span>
  355 |     | <span style='background-color: #eee;'></span>
  356 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, bool p2) internal view {</span>
  357 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,bool)&quot;, p0, p1, p2));</span>
  358 |     | <span style='background-color: #eee;'>	}</span>
  359 |     | <span style='background-color: #eee;'></span>
  360 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, address p2) internal view {</span>
  361 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,address)&quot;, p0, p1, p2));</span>
  362 |     | <span style='background-color: #eee;'>	}</span>
  363 |     | <span style='background-color: #eee;'></span>
  364 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, uint256 p2) internal view {</span>
  365 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,uint256)&quot;, p0, p1, p2));</span>
  366 |     | <span style='background-color: #eee;'>	}</span>
  367 |     | <span style='background-color: #eee;'></span>
  368 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, string memory p2) internal view {</span>
  369 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,string)&quot;, p0, p1, p2));</span>
  370 |     | <span style='background-color: #eee;'>	}</span>
  371 |     | <span style='background-color: #eee;'></span>
  372 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, bool p2) internal view {</span>
  373 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,bool)&quot;, p0, p1, p2));</span>
  374 |     | <span style='background-color: #eee;'>	}</span>
  375 |     | <span style='background-color: #eee;'></span>
  376 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, address p2) internal view {</span>
  377 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,address)&quot;, p0, p1, p2));</span>
  378 |     | <span style='background-color: #eee;'>	}</span>
  379 |     | <span style='background-color: #eee;'></span>
  380 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, uint256 p2) internal view {</span>
  381 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,uint256)&quot;, p0, p1, p2));</span>
  382 |     | <span style='background-color: #eee;'>	}</span>
  383 |     | <span style='background-color: #eee;'></span>
  384 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, string memory p2) internal view {</span>
  385 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,string)&quot;, p0, p1, p2));</span>
  386 |     | <span style='background-color: #eee;'>	}</span>
  387 |     | <span style='background-color: #eee;'></span>
  388 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, bool p2) internal view {</span>
  389 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,bool)&quot;, p0, p1, p2));</span>
  390 |     | <span style='background-color: #eee;'>	}</span>
  391 |     | <span style='background-color: #eee;'></span>
  392 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, address p2) internal view {</span>
  393 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,address)&quot;, p0, p1, p2));</span>
  394 |     | <span style='background-color: #eee;'>	}</span>
  395 |     | <span style='background-color: #eee;'></span>
  396 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, uint256 p2) internal view {</span>
  397 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,uint256)&quot;, p0, p1, p2));</span>
  398 |     | <span style='background-color: #eee;'>	}</span>
  399 |     | <span style='background-color: #eee;'></span>
  400 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, string memory p2) internal view {</span>
  401 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,string)&quot;, p0, p1, p2));</span>
  402 |     | <span style='background-color: #eee;'>	}</span>
  403 |     | <span style='background-color: #eee;'></span>
  404 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, bool p2) internal view {</span>
  405 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,bool)&quot;, p0, p1, p2));</span>
  406 |     | <span style='background-color: #eee;'>	}</span>
  407 |     | <span style='background-color: #eee;'></span>
  408 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, address p2) internal view {</span>
  409 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,address)&quot;, p0, p1, p2));</span>
  410 |     | <span style='background-color: #eee;'>	}</span>
  411 |     | <span style='background-color: #eee;'></span>
  412 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, uint256 p2) internal view {</span>
  413 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,uint256)&quot;, p0, p1, p2));</span>
  414 |     | <span style='background-color: #eee;'>	}</span>
  415 |     | <span style='background-color: #eee;'></span>
  416 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, string memory p2) internal view {</span>
  417 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,string)&quot;, p0, p1, p2));</span>
  418 |     | <span style='background-color: #eee;'>	}</span>
  419 |     | <span style='background-color: #eee;'></span>
  420 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, bool p2) internal view {</span>
  421 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,bool)&quot;, p0, p1, p2));</span>
  422 |     | <span style='background-color: #eee;'>	}</span>
  423 |     | <span style='background-color: #eee;'></span>
  424 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, address p2) internal view {</span>
  425 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,address)&quot;, p0, p1, p2));</span>
  426 |     | <span style='background-color: #eee;'>	}</span>
  427 |     | <span style='background-color: #eee;'></span>
  428 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, uint256 p2) internal view {</span>
  429 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,uint256)&quot;, p0, p1, p2));</span>
  430 |     | <span style='background-color: #eee;'>	}</span>
  431 |     | <span style='background-color: #eee;'></span>
  432 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, string memory p2) internal view {</span>
  433 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,string)&quot;, p0, p1, p2));</span>
  434 |     | <span style='background-color: #eee;'>	}</span>
  435 |     | <span style='background-color: #eee;'></span>
  436 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, bool p2) internal view {</span>
  437 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,bool)&quot;, p0, p1, p2));</span>
  438 |     | <span style='background-color: #eee;'>	}</span>
  439 |     | <span style='background-color: #eee;'></span>
  440 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, address p2) internal view {</span>
  441 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,address)&quot;, p0, p1, p2));</span>
  442 |     | <span style='background-color: #eee;'>	}</span>
  443 |     | <span style='background-color: #eee;'></span>
  444 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, uint256 p2) internal view {</span>
  445 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,uint256)&quot;, p0, p1, p2));</span>
  446 |     | <span style='background-color: #eee;'>	}</span>
  447 |     | <span style='background-color: #eee;'></span>
  448 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, string memory p2) internal view {</span>
  449 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,string)&quot;, p0, p1, p2));</span>
  450 |     | <span style='background-color: #eee;'>	}</span>
  451 |     | <span style='background-color: #eee;'></span>
  452 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, bool p2) internal view {</span>
  453 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,bool)&quot;, p0, p1, p2));</span>
  454 |     | <span style='background-color: #eee;'>	}</span>
  455 |     | <span style='background-color: #eee;'></span>
  456 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, address p2) internal view {</span>
  457 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,address)&quot;, p0, p1, p2));</span>
  458 |     | <span style='background-color: #eee;'>	}</span>
  459 |     | <span style='background-color: #eee;'></span>
  460 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, uint256 p2) internal view {</span>
  461 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,uint256)&quot;, p0, p1, p2));</span>
  462 |     | <span style='background-color: #eee;'>	}</span>
  463 |     | <span style='background-color: #eee;'></span>
  464 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, string memory p2) internal view {</span>
  465 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,string)&quot;, p0, p1, p2));</span>
  466 |     | <span style='background-color: #eee;'>	}</span>
  467 |     | <span style='background-color: #eee;'></span>
  468 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, bool p2) internal view {</span>
  469 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,bool)&quot;, p0, p1, p2));</span>
  470 |     | <span style='background-color: #eee;'>	}</span>
  471 |     | <span style='background-color: #eee;'></span>
  472 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, address p2) internal view {</span>
  473 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,address)&quot;, p0, p1, p2));</span>
  474 |     | <span style='background-color: #eee;'>	}</span>
  475 |     | <span style='background-color: #eee;'></span>
  476 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, uint256 p2) internal view {</span>
  477 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,uint256)&quot;, p0, p1, p2));</span>
  478 |     | <span style='background-color: #eee;'>	}</span>
  479 |     | <span style='background-color: #eee;'></span>
  480 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, string memory p2) internal view {</span>
  481 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,string)&quot;, p0, p1, p2));</span>
  482 |     | <span style='background-color: #eee;'>	}</span>
  483 |     | <span style='background-color: #eee;'></span>
  484 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, bool p2) internal view {</span>
  485 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,bool)&quot;, p0, p1, p2));</span>
  486 |     | <span style='background-color: #eee;'>	}</span>
  487 |     | <span style='background-color: #eee;'></span>
  488 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, address p2) internal view {</span>
  489 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,address)&quot;, p0, p1, p2));</span>
  490 |     | <span style='background-color: #eee;'>	}</span>
  491 |     | <span style='background-color: #eee;'></span>
  492 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, uint256 p2) internal view {</span>
  493 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,uint256)&quot;, p0, p1, p2));</span>
  494 |     | <span style='background-color: #eee;'>	}</span>
  495 |     | <span style='background-color: #eee;'></span>
  496 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, string memory p2) internal view {</span>
  497 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,string)&quot;, p0, p1, p2));</span>
  498 |     | <span style='background-color: #eee;'>	}</span>
  499 |     | <span style='background-color: #eee;'></span>
  500 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, bool p2) internal view {</span>
  501 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,bool)&quot;, p0, p1, p2));</span>
  502 |     | <span style='background-color: #eee;'>	}</span>
  503 |     | <span style='background-color: #eee;'></span>
  504 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, address p2) internal view {</span>
  505 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,address)&quot;, p0, p1, p2));</span>
  506 |     | <span style='background-color: #eee;'>	}</span>
  507 |     | <span style='background-color: #eee;'></span>
  508 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, uint256 p2, uint256 p3) internal view {</span>
  509 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,uint256,uint256)&quot;, p0, p1, p2, p3));</span>
  510 |     | <span style='background-color: #eee;'>	}</span>
  511 |     | <span style='background-color: #eee;'></span>
  512 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, uint256 p2, string memory p3) internal view {</span>
  513 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,uint256,string)&quot;, p0, p1, p2, p3));</span>
  514 |     | <span style='background-color: #eee;'>	}</span>
  515 |     | <span style='background-color: #eee;'></span>
  516 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, uint256 p2, bool p3) internal view {</span>
  517 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,uint256,bool)&quot;, p0, p1, p2, p3));</span>
  518 |     | <span style='background-color: #eee;'>	}</span>
  519 |     | <span style='background-color: #eee;'></span>
  520 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, uint256 p2, address p3) internal view {</span>
  521 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,uint256,address)&quot;, p0, p1, p2, p3));</span>
  522 |     | <span style='background-color: #eee;'>	}</span>
  523 |     | <span style='background-color: #eee;'></span>
  524 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, string memory p2, uint256 p3) internal view {</span>
  525 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,string,uint256)&quot;, p0, p1, p2, p3));</span>
  526 |     | <span style='background-color: #eee;'>	}</span>
  527 |     | <span style='background-color: #eee;'></span>
  528 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, string memory p2, string memory p3) internal view {</span>
  529 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,string,string)&quot;, p0, p1, p2, p3));</span>
  530 |     | <span style='background-color: #eee;'>	}</span>
  531 |     | <span style='background-color: #eee;'></span>
  532 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, string memory p2, bool p3) internal view {</span>
  533 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,string,bool)&quot;, p0, p1, p2, p3));</span>
  534 |     | <span style='background-color: #eee;'>	}</span>
  535 |     | <span style='background-color: #eee;'></span>
  536 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, string memory p2, address p3) internal view {</span>
  537 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,string,address)&quot;, p0, p1, p2, p3));</span>
  538 |     | <span style='background-color: #eee;'>	}</span>
  539 |     | <span style='background-color: #eee;'></span>
  540 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, bool p2, uint256 p3) internal view {</span>
  541 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,bool,uint256)&quot;, p0, p1, p2, p3));</span>
  542 |     | <span style='background-color: #eee;'>	}</span>
  543 |     | <span style='background-color: #eee;'></span>
  544 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, bool p2, string memory p3) internal view {</span>
  545 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,bool,string)&quot;, p0, p1, p2, p3));</span>
  546 |     | <span style='background-color: #eee;'>	}</span>
  547 |     | <span style='background-color: #eee;'></span>
  548 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, bool p2, bool p3) internal view {</span>
  549 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,bool,bool)&quot;, p0, p1, p2, p3));</span>
  550 |     | <span style='background-color: #eee;'>	}</span>
  551 |     | <span style='background-color: #eee;'></span>
  552 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, bool p2, address p3) internal view {</span>
  553 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,bool,address)&quot;, p0, p1, p2, p3));</span>
  554 |     | <span style='background-color: #eee;'>	}</span>
  555 |     | <span style='background-color: #eee;'></span>
  556 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, address p2, uint256 p3) internal view {</span>
  557 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,address,uint256)&quot;, p0, p1, p2, p3));</span>
  558 |     | <span style='background-color: #eee;'>	}</span>
  559 |     | <span style='background-color: #eee;'></span>
  560 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, address p2, string memory p3) internal view {</span>
  561 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,address,string)&quot;, p0, p1, p2, p3));</span>
  562 |     | <span style='background-color: #eee;'>	}</span>
  563 |     | <span style='background-color: #eee;'></span>
  564 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, address p2, bool p3) internal view {</span>
  565 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,address,bool)&quot;, p0, p1, p2, p3));</span>
  566 |     | <span style='background-color: #eee;'>	}</span>
  567 |     | <span style='background-color: #eee;'></span>
  568 |     | <span style='background-color: #eee;'>	function log(uint256 p0, uint256 p1, address p2, address p3) internal view {</span>
  569 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,uint256,address,address)&quot;, p0, p1, p2, p3));</span>
  570 |     | <span style='background-color: #eee;'>	}</span>
  571 |     | <span style='background-color: #eee;'></span>
  572 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, uint256 p2, uint256 p3) internal view {</span>
  573 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,uint256,uint256)&quot;, p0, p1, p2, p3));</span>
  574 |     | <span style='background-color: #eee;'>	}</span>
  575 |     | <span style='background-color: #eee;'></span>
  576 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, uint256 p2, string memory p3) internal view {</span>
  577 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,uint256,string)&quot;, p0, p1, p2, p3));</span>
  578 |     | <span style='background-color: #eee;'>	}</span>
  579 |     | <span style='background-color: #eee;'></span>
  580 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, uint256 p2, bool p3) internal view {</span>
  581 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,uint256,bool)&quot;, p0, p1, p2, p3));</span>
  582 |     | <span style='background-color: #eee;'>	}</span>
  583 |     | <span style='background-color: #eee;'></span>
  584 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, uint256 p2, address p3) internal view {</span>
  585 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,uint256,address)&quot;, p0, p1, p2, p3));</span>
  586 |     | <span style='background-color: #eee;'>	}</span>
  587 |     | <span style='background-color: #eee;'></span>
  588 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, string memory p2, uint256 p3) internal view {</span>
  589 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,string,uint256)&quot;, p0, p1, p2, p3));</span>
  590 |     | <span style='background-color: #eee;'>	}</span>
  591 |     | <span style='background-color: #eee;'></span>
  592 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, string memory p2, string memory p3) internal view {</span>
  593 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,string,string)&quot;, p0, p1, p2, p3));</span>
  594 |     | <span style='background-color: #eee;'>	}</span>
  595 |     | <span style='background-color: #eee;'></span>
  596 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, string memory p2, bool p3) internal view {</span>
  597 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,string,bool)&quot;, p0, p1, p2, p3));</span>
  598 |     | <span style='background-color: #eee;'>	}</span>
  599 |     | <span style='background-color: #eee;'></span>
  600 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, string memory p2, address p3) internal view {</span>
  601 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,string,address)&quot;, p0, p1, p2, p3));</span>
  602 |     | <span style='background-color: #eee;'>	}</span>
  603 |     | <span style='background-color: #eee;'></span>
  604 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, bool p2, uint256 p3) internal view {</span>
  605 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,bool,uint256)&quot;, p0, p1, p2, p3));</span>
  606 |     | <span style='background-color: #eee;'>	}</span>
  607 |     | <span style='background-color: #eee;'></span>
  608 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, bool p2, string memory p3) internal view {</span>
  609 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,bool,string)&quot;, p0, p1, p2, p3));</span>
  610 |     | <span style='background-color: #eee;'>	}</span>
  611 |     | <span style='background-color: #eee;'></span>
  612 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, bool p2, bool p3) internal view {</span>
  613 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,bool,bool)&quot;, p0, p1, p2, p3));</span>
  614 |     | <span style='background-color: #eee;'>	}</span>
  615 |     | <span style='background-color: #eee;'></span>
  616 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, bool p2, address p3) internal view {</span>
  617 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,bool,address)&quot;, p0, p1, p2, p3));</span>
  618 |     | <span style='background-color: #eee;'>	}</span>
  619 |     | <span style='background-color: #eee;'></span>
  620 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, address p2, uint256 p3) internal view {</span>
  621 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,address,uint256)&quot;, p0, p1, p2, p3));</span>
  622 |     | <span style='background-color: #eee;'>	}</span>
  623 |     | <span style='background-color: #eee;'></span>
  624 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, address p2, string memory p3) internal view {</span>
  625 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,address,string)&quot;, p0, p1, p2, p3));</span>
  626 |     | <span style='background-color: #eee;'>	}</span>
  627 |     | <span style='background-color: #eee;'></span>
  628 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, address p2, bool p3) internal view {</span>
  629 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,address,bool)&quot;, p0, p1, p2, p3));</span>
  630 |     | <span style='background-color: #eee;'>	}</span>
  631 |     | <span style='background-color: #eee;'></span>
  632 |     | <span style='background-color: #eee;'>	function log(uint256 p0, string memory p1, address p2, address p3) internal view {</span>
  633 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,string,address,address)&quot;, p0, p1, p2, p3));</span>
  634 |     | <span style='background-color: #eee;'>	}</span>
  635 |     | <span style='background-color: #eee;'></span>
  636 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, uint256 p2, uint256 p3) internal view {</span>
  637 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,uint256,uint256)&quot;, p0, p1, p2, p3));</span>
  638 |     | <span style='background-color: #eee;'>	}</span>
  639 |     | <span style='background-color: #eee;'></span>
  640 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, uint256 p2, string memory p3) internal view {</span>
  641 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,uint256,string)&quot;, p0, p1, p2, p3));</span>
  642 |     | <span style='background-color: #eee;'>	}</span>
  643 |     | <span style='background-color: #eee;'></span>
  644 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, uint256 p2, bool p3) internal view {</span>
  645 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,uint256,bool)&quot;, p0, p1, p2, p3));</span>
  646 |     | <span style='background-color: #eee;'>	}</span>
  647 |     | <span style='background-color: #eee;'></span>
  648 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, uint256 p2, address p3) internal view {</span>
  649 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,uint256,address)&quot;, p0, p1, p2, p3));</span>
  650 |     | <span style='background-color: #eee;'>	}</span>
  651 |     | <span style='background-color: #eee;'></span>
  652 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, string memory p2, uint256 p3) internal view {</span>
  653 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,string,uint256)&quot;, p0, p1, p2, p3));</span>
  654 |     | <span style='background-color: #eee;'>	}</span>
  655 |     | <span style='background-color: #eee;'></span>
  656 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, string memory p2, string memory p3) internal view {</span>
  657 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,string,string)&quot;, p0, p1, p2, p3));</span>
  658 |     | <span style='background-color: #eee;'>	}</span>
  659 |     | <span style='background-color: #eee;'></span>
  660 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, string memory p2, bool p3) internal view {</span>
  661 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,string,bool)&quot;, p0, p1, p2, p3));</span>
  662 |     | <span style='background-color: #eee;'>	}</span>
  663 |     | <span style='background-color: #eee;'></span>
  664 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, string memory p2, address p3) internal view {</span>
  665 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,string,address)&quot;, p0, p1, p2, p3));</span>
  666 |     | <span style='background-color: #eee;'>	}</span>
  667 |     | <span style='background-color: #eee;'></span>
  668 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, bool p2, uint256 p3) internal view {</span>
  669 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,bool,uint256)&quot;, p0, p1, p2, p3));</span>
  670 |     | <span style='background-color: #eee;'>	}</span>
  671 |     | <span style='background-color: #eee;'></span>
  672 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, bool p2, string memory p3) internal view {</span>
  673 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,bool,string)&quot;, p0, p1, p2, p3));</span>
  674 |     | <span style='background-color: #eee;'>	}</span>
  675 |     | <span style='background-color: #eee;'></span>
  676 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, bool p2, bool p3) internal view {</span>
  677 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,bool,bool)&quot;, p0, p1, p2, p3));</span>
  678 |     | <span style='background-color: #eee;'>	}</span>
  679 |     | <span style='background-color: #eee;'></span>
  680 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, bool p2, address p3) internal view {</span>
  681 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,bool,address)&quot;, p0, p1, p2, p3));</span>
  682 |     | <span style='background-color: #eee;'>	}</span>
  683 |     | <span style='background-color: #eee;'></span>
  684 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, address p2, uint256 p3) internal view {</span>
  685 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,address,uint256)&quot;, p0, p1, p2, p3));</span>
  686 |     | <span style='background-color: #eee;'>	}</span>
  687 |     | <span style='background-color: #eee;'></span>
  688 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, address p2, string memory p3) internal view {</span>
  689 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,address,string)&quot;, p0, p1, p2, p3));</span>
  690 |     | <span style='background-color: #eee;'>	}</span>
  691 |     | <span style='background-color: #eee;'></span>
  692 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, address p2, bool p3) internal view {</span>
  693 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,address,bool)&quot;, p0, p1, p2, p3));</span>
  694 |     | <span style='background-color: #eee;'>	}</span>
  695 |     | <span style='background-color: #eee;'></span>
  696 |     | <span style='background-color: #eee;'>	function log(uint256 p0, bool p1, address p2, address p3) internal view {</span>
  697 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,bool,address,address)&quot;, p0, p1, p2, p3));</span>
  698 |     | <span style='background-color: #eee;'>	}</span>
  699 |     | <span style='background-color: #eee;'></span>
  700 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, uint256 p2, uint256 p3) internal view {</span>
  701 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,uint256,uint256)&quot;, p0, p1, p2, p3));</span>
  702 |     | <span style='background-color: #eee;'>	}</span>
  703 |     | <span style='background-color: #eee;'></span>
  704 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, uint256 p2, string memory p3) internal view {</span>
  705 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,uint256,string)&quot;, p0, p1, p2, p3));</span>
  706 |     | <span style='background-color: #eee;'>	}</span>
  707 |     | <span style='background-color: #eee;'></span>
  708 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, uint256 p2, bool p3) internal view {</span>
  709 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,uint256,bool)&quot;, p0, p1, p2, p3));</span>
  710 |     | <span style='background-color: #eee;'>	}</span>
  711 |     | <span style='background-color: #eee;'></span>
  712 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, uint256 p2, address p3) internal view {</span>
  713 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,uint256,address)&quot;, p0, p1, p2, p3));</span>
  714 |     | <span style='background-color: #eee;'>	}</span>
  715 |     | <span style='background-color: #eee;'></span>
  716 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, string memory p2, uint256 p3) internal view {</span>
  717 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,string,uint256)&quot;, p0, p1, p2, p3));</span>
  718 |     | <span style='background-color: #eee;'>	}</span>
  719 |     | <span style='background-color: #eee;'></span>
  720 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, string memory p2, string memory p3) internal view {</span>
  721 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,string,string)&quot;, p0, p1, p2, p3));</span>
  722 |     | <span style='background-color: #eee;'>	}</span>
  723 |     | <span style='background-color: #eee;'></span>
  724 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, string memory p2, bool p3) internal view {</span>
  725 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,string,bool)&quot;, p0, p1, p2, p3));</span>
  726 |     | <span style='background-color: #eee;'>	}</span>
  727 |     | <span style='background-color: #eee;'></span>
  728 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, string memory p2, address p3) internal view {</span>
  729 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,string,address)&quot;, p0, p1, p2, p3));</span>
  730 |     | <span style='background-color: #eee;'>	}</span>
  731 |     | <span style='background-color: #eee;'></span>
  732 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, bool p2, uint256 p3) internal view {</span>
  733 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,bool,uint256)&quot;, p0, p1, p2, p3));</span>
  734 |     | <span style='background-color: #eee;'>	}</span>
  735 |     | <span style='background-color: #eee;'></span>
  736 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, bool p2, string memory p3) internal view {</span>
  737 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,bool,string)&quot;, p0, p1, p2, p3));</span>
  738 |     | <span style='background-color: #eee;'>	}</span>
  739 |     | <span style='background-color: #eee;'></span>
  740 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, bool p2, bool p3) internal view {</span>
  741 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,bool,bool)&quot;, p0, p1, p2, p3));</span>
  742 |     | <span style='background-color: #eee;'>	}</span>
  743 |     | <span style='background-color: #eee;'></span>
  744 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, bool p2, address p3) internal view {</span>
  745 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,bool,address)&quot;, p0, p1, p2, p3));</span>
  746 |     | <span style='background-color: #eee;'>	}</span>
  747 |     | <span style='background-color: #eee;'></span>
  748 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, address p2, uint256 p3) internal view {</span>
  749 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,address,uint256)&quot;, p0, p1, p2, p3));</span>
  750 |     | <span style='background-color: #eee;'>	}</span>
  751 |     | <span style='background-color: #eee;'></span>
  752 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, address p2, string memory p3) internal view {</span>
  753 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,address,string)&quot;, p0, p1, p2, p3));</span>
  754 |     | <span style='background-color: #eee;'>	}</span>
  755 |     | <span style='background-color: #eee;'></span>
  756 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, address p2, bool p3) internal view {</span>
  757 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,address,bool)&quot;, p0, p1, p2, p3));</span>
  758 |     | <span style='background-color: #eee;'>	}</span>
  759 |     | <span style='background-color: #eee;'></span>
  760 |     | <span style='background-color: #eee;'>	function log(uint256 p0, address p1, address p2, address p3) internal view {</span>
  761 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(uint256,address,address,address)&quot;, p0, p1, p2, p3));</span>
  762 |     | <span style='background-color: #eee;'>	}</span>
  763 |     | <span style='background-color: #eee;'></span>
  764 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, uint256 p2, uint256 p3) internal view {</span>
  765 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,uint256,uint256)&quot;, p0, p1, p2, p3));</span>
  766 |     | <span style='background-color: #eee;'>	}</span>
  767 |     | <span style='background-color: #eee;'></span>
  768 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, uint256 p2, string memory p3) internal view {</span>
  769 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,uint256,string)&quot;, p0, p1, p2, p3));</span>
  770 |     | <span style='background-color: #eee;'>	}</span>
  771 |     | <span style='background-color: #eee;'></span>
  772 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, uint256 p2, bool p3) internal view {</span>
  773 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,uint256,bool)&quot;, p0, p1, p2, p3));</span>
  774 |     | <span style='background-color: #eee;'>	}</span>
  775 |     | <span style='background-color: #eee;'></span>
  776 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, uint256 p2, address p3) internal view {</span>
  777 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,uint256,address)&quot;, p0, p1, p2, p3));</span>
  778 |     | <span style='background-color: #eee;'>	}</span>
  779 |     | <span style='background-color: #eee;'></span>
  780 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, string memory p2, uint256 p3) internal view {</span>
  781 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,string,uint256)&quot;, p0, p1, p2, p3));</span>
  782 |     | <span style='background-color: #eee;'>	}</span>
  783 |     | <span style='background-color: #eee;'></span>
  784 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, string memory p2, string memory p3) internal view {</span>
  785 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,string,string)&quot;, p0, p1, p2, p3));</span>
  786 |     | <span style='background-color: #eee;'>	}</span>
  787 |     | <span style='background-color: #eee;'></span>
  788 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, string memory p2, bool p3) internal view {</span>
  789 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,string,bool)&quot;, p0, p1, p2, p3));</span>
  790 |     | <span style='background-color: #eee;'>	}</span>
  791 |     | <span style='background-color: #eee;'></span>
  792 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, string memory p2, address p3) internal view {</span>
  793 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,string,address)&quot;, p0, p1, p2, p3));</span>
  794 |     | <span style='background-color: #eee;'>	}</span>
  795 |     | <span style='background-color: #eee;'></span>
  796 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, bool p2, uint256 p3) internal view {</span>
  797 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,bool,uint256)&quot;, p0, p1, p2, p3));</span>
  798 |     | <span style='background-color: #eee;'>	}</span>
  799 |     | <span style='background-color: #eee;'></span>
  800 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, bool p2, string memory p3) internal view {</span>
  801 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,bool,string)&quot;, p0, p1, p2, p3));</span>
  802 |     | <span style='background-color: #eee;'>	}</span>
  803 |     | <span style='background-color: #eee;'></span>
  804 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, bool p2, bool p3) internal view {</span>
  805 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,bool,bool)&quot;, p0, p1, p2, p3));</span>
  806 |     | <span style='background-color: #eee;'>	}</span>
  807 |     | <span style='background-color: #eee;'></span>
  808 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, bool p2, address p3) internal view {</span>
  809 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,bool,address)&quot;, p0, p1, p2, p3));</span>
  810 |     | <span style='background-color: #eee;'>	}</span>
  811 |     | <span style='background-color: #eee;'></span>
  812 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, address p2, uint256 p3) internal view {</span>
  813 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,address,uint256)&quot;, p0, p1, p2, p3));</span>
  814 |     | <span style='background-color: #eee;'>	}</span>
  815 |     | <span style='background-color: #eee;'></span>
  816 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, address p2, string memory p3) internal view {</span>
  817 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,address,string)&quot;, p0, p1, p2, p3));</span>
  818 |     | <span style='background-color: #eee;'>	}</span>
  819 |     | <span style='background-color: #eee;'></span>
  820 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, address p2, bool p3) internal view {</span>
  821 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,address,bool)&quot;, p0, p1, p2, p3));</span>
  822 |     | <span style='background-color: #eee;'>	}</span>
  823 |     | <span style='background-color: #eee;'></span>
  824 |     | <span style='background-color: #eee;'>	function log(string memory p0, uint256 p1, address p2, address p3) internal view {</span>
  825 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,uint256,address,address)&quot;, p0, p1, p2, p3));</span>
  826 |     | <span style='background-color: #eee;'>	}</span>
  827 |     | <span style='background-color: #eee;'></span>
  828 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, uint256 p2, uint256 p3) internal view {</span>
  829 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,uint256,uint256)&quot;, p0, p1, p2, p3));</span>
  830 |     | <span style='background-color: #eee;'>	}</span>
  831 |     | <span style='background-color: #eee;'></span>
  832 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, uint256 p2, string memory p3) internal view {</span>
  833 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,uint256,string)&quot;, p0, p1, p2, p3));</span>
  834 |     | <span style='background-color: #eee;'>	}</span>
  835 |     | <span style='background-color: #eee;'></span>
  836 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, uint256 p2, bool p3) internal view {</span>
  837 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,uint256,bool)&quot;, p0, p1, p2, p3));</span>
  838 |     | <span style='background-color: #eee;'>	}</span>
  839 |     | <span style='background-color: #eee;'></span>
  840 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, uint256 p2, address p3) internal view {</span>
  841 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,uint256,address)&quot;, p0, p1, p2, p3));</span>
  842 |     | <span style='background-color: #eee;'>	}</span>
  843 |     | <span style='background-color: #eee;'></span>
  844 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, string memory p2, uint256 p3) internal view {</span>
  845 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,string,uint256)&quot;, p0, p1, p2, p3));</span>
  846 |     | <span style='background-color: #eee;'>	}</span>
  847 |     | <span style='background-color: #eee;'></span>
  848 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, string memory p2, string memory p3) internal view {</span>
  849 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,string,string)&quot;, p0, p1, p2, p3));</span>
  850 |     | <span style='background-color: #eee;'>	}</span>
  851 |     | <span style='background-color: #eee;'></span>
  852 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, string memory p2, bool p3) internal view {</span>
  853 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,string,bool)&quot;, p0, p1, p2, p3));</span>
  854 |     | <span style='background-color: #eee;'>	}</span>
  855 |     | <span style='background-color: #eee;'></span>
  856 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, string memory p2, address p3) internal view {</span>
  857 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,string,address)&quot;, p0, p1, p2, p3));</span>
  858 |     | <span style='background-color: #eee;'>	}</span>
  859 |     | <span style='background-color: #eee;'></span>
  860 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, bool p2, uint256 p3) internal view {</span>
  861 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,bool,uint256)&quot;, p0, p1, p2, p3));</span>
  862 |     | <span style='background-color: #eee;'>	}</span>
  863 |     | <span style='background-color: #eee;'></span>
  864 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, bool p2, string memory p3) internal view {</span>
  865 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,bool,string)&quot;, p0, p1, p2, p3));</span>
  866 |     | <span style='background-color: #eee;'>	}</span>
  867 |     | <span style='background-color: #eee;'></span>
  868 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, bool p2, bool p3) internal view {</span>
  869 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,bool,bool)&quot;, p0, p1, p2, p3));</span>
  870 |     | <span style='background-color: #eee;'>	}</span>
  871 |     | <span style='background-color: #eee;'></span>
  872 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, bool p2, address p3) internal view {</span>
  873 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,bool,address)&quot;, p0, p1, p2, p3));</span>
  874 |     | <span style='background-color: #eee;'>	}</span>
  875 |     | <span style='background-color: #eee;'></span>
  876 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, address p2, uint256 p3) internal view {</span>
  877 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,address,uint256)&quot;, p0, p1, p2, p3));</span>
  878 |     | <span style='background-color: #eee;'>	}</span>
  879 |     | <span style='background-color: #eee;'></span>
  880 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, address p2, string memory p3) internal view {</span>
  881 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,address,string)&quot;, p0, p1, p2, p3));</span>
  882 |     | <span style='background-color: #eee;'>	}</span>
  883 |     | <span style='background-color: #eee;'></span>
  884 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, address p2, bool p3) internal view {</span>
  885 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,address,bool)&quot;, p0, p1, p2, p3));</span>
  886 |     | <span style='background-color: #eee;'>	}</span>
  887 |     | <span style='background-color: #eee;'></span>
  888 |     | <span style='background-color: #eee;'>	function log(string memory p0, string memory p1, address p2, address p3) internal view {</span>
  889 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,string,address,address)&quot;, p0, p1, p2, p3));</span>
  890 |     | <span style='background-color: #eee;'>	}</span>
  891 |     | <span style='background-color: #eee;'></span>
  892 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, uint256 p2, uint256 p3) internal view {</span>
  893 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,uint256,uint256)&quot;, p0, p1, p2, p3));</span>
  894 |     | <span style='background-color: #eee;'>	}</span>
  895 |     | <span style='background-color: #eee;'></span>
  896 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, uint256 p2, string memory p3) internal view {</span>
  897 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,uint256,string)&quot;, p0, p1, p2, p3));</span>
  898 |     | <span style='background-color: #eee;'>	}</span>
  899 |     | <span style='background-color: #eee;'></span>
  900 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, uint256 p2, bool p3) internal view {</span>
  901 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,uint256,bool)&quot;, p0, p1, p2, p3));</span>
  902 |     | <span style='background-color: #eee;'>	}</span>
  903 |     | <span style='background-color: #eee;'></span>
  904 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, uint256 p2, address p3) internal view {</span>
  905 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,uint256,address)&quot;, p0, p1, p2, p3));</span>
  906 |     | <span style='background-color: #eee;'>	}</span>
  907 |     | <span style='background-color: #eee;'></span>
  908 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, string memory p2, uint256 p3) internal view {</span>
  909 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,string,uint256)&quot;, p0, p1, p2, p3));</span>
  910 |     | <span style='background-color: #eee;'>	}</span>
  911 |     | <span style='background-color: #eee;'></span>
  912 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, string memory p2, string memory p3) internal view {</span>
  913 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,string,string)&quot;, p0, p1, p2, p3));</span>
  914 |     | <span style='background-color: #eee;'>	}</span>
  915 |     | <span style='background-color: #eee;'></span>
  916 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, string memory p2, bool p3) internal view {</span>
  917 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,string,bool)&quot;, p0, p1, p2, p3));</span>
  918 |     | <span style='background-color: #eee;'>	}</span>
  919 |     | <span style='background-color: #eee;'></span>
  920 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, string memory p2, address p3) internal view {</span>
  921 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,string,address)&quot;, p0, p1, p2, p3));</span>
  922 |     | <span style='background-color: #eee;'>	}</span>
  923 |     | <span style='background-color: #eee;'></span>
  924 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, bool p2, uint256 p3) internal view {</span>
  925 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,bool,uint256)&quot;, p0, p1, p2, p3));</span>
  926 |     | <span style='background-color: #eee;'>	}</span>
  927 |     | <span style='background-color: #eee;'></span>
  928 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, bool p2, string memory p3) internal view {</span>
  929 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,bool,string)&quot;, p0, p1, p2, p3));</span>
  930 |     | <span style='background-color: #eee;'>	}</span>
  931 |     | <span style='background-color: #eee;'></span>
  932 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, bool p2, bool p3) internal view {</span>
  933 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,bool,bool)&quot;, p0, p1, p2, p3));</span>
  934 |     | <span style='background-color: #eee;'>	}</span>
  935 |     | <span style='background-color: #eee;'></span>
  936 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, bool p2, address p3) internal view {</span>
  937 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,bool,address)&quot;, p0, p1, p2, p3));</span>
  938 |     | <span style='background-color: #eee;'>	}</span>
  939 |     | <span style='background-color: #eee;'></span>
  940 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, address p2, uint256 p3) internal view {</span>
  941 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,address,uint256)&quot;, p0, p1, p2, p3));</span>
  942 |     | <span style='background-color: #eee;'>	}</span>
  943 |     | <span style='background-color: #eee;'></span>
  944 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, address p2, string memory p3) internal view {</span>
  945 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,address,string)&quot;, p0, p1, p2, p3));</span>
  946 |     | <span style='background-color: #eee;'>	}</span>
  947 |     | <span style='background-color: #eee;'></span>
  948 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, address p2, bool p3) internal view {</span>
  949 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,address,bool)&quot;, p0, p1, p2, p3));</span>
  950 |     | <span style='background-color: #eee;'>	}</span>
  951 |     | <span style='background-color: #eee;'></span>
  952 |     | <span style='background-color: #eee;'>	function log(string memory p0, bool p1, address p2, address p3) internal view {</span>
  953 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,bool,address,address)&quot;, p0, p1, p2, p3));</span>
  954 |     | <span style='background-color: #eee;'>	}</span>
  955 |     | <span style='background-color: #eee;'></span>
  956 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, uint256 p2, uint256 p3) internal view {</span>
  957 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,uint256,uint256)&quot;, p0, p1, p2, p3));</span>
  958 |     | <span style='background-color: #eee;'>	}</span>
  959 |     | <span style='background-color: #eee;'></span>
  960 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, uint256 p2, string memory p3) internal view {</span>
  961 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,uint256,string)&quot;, p0, p1, p2, p3));</span>
  962 |     | <span style='background-color: #eee;'>	}</span>
  963 |     | <span style='background-color: #eee;'></span>
  964 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, uint256 p2, bool p3) internal view {</span>
  965 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,uint256,bool)&quot;, p0, p1, p2, p3));</span>
  966 |     | <span style='background-color: #eee;'>	}</span>
  967 |     | <span style='background-color: #eee;'></span>
  968 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, uint256 p2, address p3) internal view {</span>
  969 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,uint256,address)&quot;, p0, p1, p2, p3));</span>
  970 |     | <span style='background-color: #eee;'>	}</span>
  971 |     | <span style='background-color: #eee;'></span>
  972 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, string memory p2, uint256 p3) internal view {</span>
  973 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,string,uint256)&quot;, p0, p1, p2, p3));</span>
  974 |     | <span style='background-color: #eee;'>	}</span>
  975 |     | <span style='background-color: #eee;'></span>
  976 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, string memory p2, string memory p3) internal view {</span>
  977 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,string,string)&quot;, p0, p1, p2, p3));</span>
  978 |     | <span style='background-color: #eee;'>	}</span>
  979 |     | <span style='background-color: #eee;'></span>
  980 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, string memory p2, bool p3) internal view {</span>
  981 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,string,bool)&quot;, p0, p1, p2, p3));</span>
  982 |     | <span style='background-color: #eee;'>	}</span>
  983 |     | <span style='background-color: #eee;'></span>
  984 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, string memory p2, address p3) internal view {</span>
  985 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,string,address)&quot;, p0, p1, p2, p3));</span>
  986 |     | <span style='background-color: #eee;'>	}</span>
  987 |     | <span style='background-color: #eee;'></span>
  988 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, bool p2, uint256 p3) internal view {</span>
  989 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,bool,uint256)&quot;, p0, p1, p2, p3));</span>
  990 |     | <span style='background-color: #eee;'>	}</span>
  991 |     | <span style='background-color: #eee;'></span>
  992 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, bool p2, string memory p3) internal view {</span>
  993 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,bool,string)&quot;, p0, p1, p2, p3));</span>
  994 |     | <span style='background-color: #eee;'>	}</span>
  995 |     | <span style='background-color: #eee;'></span>
  996 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, bool p2, bool p3) internal view {</span>
  997 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,bool,bool)&quot;, p0, p1, p2, p3));</span>
  998 |     | <span style='background-color: #eee;'>	}</span>
  999 |     | <span style='background-color: #eee;'></span>
 1000 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, bool p2, address p3) internal view {</span>
 1001 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,bool,address)&quot;, p0, p1, p2, p3));</span>
 1002 |     | <span style='background-color: #eee;'>	}</span>
 1003 |     | <span style='background-color: #eee;'></span>
 1004 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, address p2, uint256 p3) internal view {</span>
 1005 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,address,uint256)&quot;, p0, p1, p2, p3));</span>
 1006 |     | <span style='background-color: #eee;'>	}</span>
 1007 |     | <span style='background-color: #eee;'></span>
 1008 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, address p2, string memory p3) internal view {</span>
 1009 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,address,string)&quot;, p0, p1, p2, p3));</span>
 1010 |     | <span style='background-color: #eee;'>	}</span>
 1011 |     | <span style='background-color: #eee;'></span>
 1012 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, address p2, bool p3) internal view {</span>
 1013 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,address,bool)&quot;, p0, p1, p2, p3));</span>
 1014 |     | <span style='background-color: #eee;'>	}</span>
 1015 |     | <span style='background-color: #eee;'></span>
 1016 |     | <span style='background-color: #eee;'>	function log(string memory p0, address p1, address p2, address p3) internal view {</span>
 1017 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(string,address,address,address)&quot;, p0, p1, p2, p3));</span>
 1018 |     | <span style='background-color: #eee;'>	}</span>
 1019 |     | <span style='background-color: #eee;'></span>
 1020 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, uint256 p2, uint256 p3) internal view {</span>
 1021 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,uint256,uint256)&quot;, p0, p1, p2, p3));</span>
 1022 |     | <span style='background-color: #eee;'>	}</span>
 1023 |     | <span style='background-color: #eee;'></span>
 1024 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, uint256 p2, string memory p3) internal view {</span>
 1025 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,uint256,string)&quot;, p0, p1, p2, p3));</span>
 1026 |     | <span style='background-color: #eee;'>	}</span>
 1027 |     | <span style='background-color: #eee;'></span>
 1028 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, uint256 p2, bool p3) internal view {</span>
 1029 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,uint256,bool)&quot;, p0, p1, p2, p3));</span>
 1030 |     | <span style='background-color: #eee;'>	}</span>
 1031 |     | <span style='background-color: #eee;'></span>
 1032 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, uint256 p2, address p3) internal view {</span>
 1033 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,uint256,address)&quot;, p0, p1, p2, p3));</span>
 1034 |     | <span style='background-color: #eee;'>	}</span>
 1035 |     | <span style='background-color: #eee;'></span>
 1036 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, string memory p2, uint256 p3) internal view {</span>
 1037 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,string,uint256)&quot;, p0, p1, p2, p3));</span>
 1038 |     | <span style='background-color: #eee;'>	}</span>
 1039 |     | <span style='background-color: #eee;'></span>
 1040 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, string memory p2, string memory p3) internal view {</span>
 1041 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,string,string)&quot;, p0, p1, p2, p3));</span>
 1042 |     | <span style='background-color: #eee;'>	}</span>
 1043 |     | <span style='background-color: #eee;'></span>
 1044 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, string memory p2, bool p3) internal view {</span>
 1045 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,string,bool)&quot;, p0, p1, p2, p3));</span>
 1046 |     | <span style='background-color: #eee;'>	}</span>
 1047 |     | <span style='background-color: #eee;'></span>
 1048 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, string memory p2, address p3) internal view {</span>
 1049 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,string,address)&quot;, p0, p1, p2, p3));</span>
 1050 |     | <span style='background-color: #eee;'>	}</span>
 1051 |     | <span style='background-color: #eee;'></span>
 1052 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, bool p2, uint256 p3) internal view {</span>
 1053 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,bool,uint256)&quot;, p0, p1, p2, p3));</span>
 1054 |     | <span style='background-color: #eee;'>	}</span>
 1055 |     | <span style='background-color: #eee;'></span>
 1056 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, bool p2, string memory p3) internal view {</span>
 1057 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,bool,string)&quot;, p0, p1, p2, p3));</span>
 1058 |     | <span style='background-color: #eee;'>	}</span>
 1059 |     | <span style='background-color: #eee;'></span>
 1060 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, bool p2, bool p3) internal view {</span>
 1061 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,bool,bool)&quot;, p0, p1, p2, p3));</span>
 1062 |     | <span style='background-color: #eee;'>	}</span>
 1063 |     | <span style='background-color: #eee;'></span>
 1064 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, bool p2, address p3) internal view {</span>
 1065 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,bool,address)&quot;, p0, p1, p2, p3));</span>
 1066 |     | <span style='background-color: #eee;'>	}</span>
 1067 |     | <span style='background-color: #eee;'></span>
 1068 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, address p2, uint256 p3) internal view {</span>
 1069 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,address,uint256)&quot;, p0, p1, p2, p3));</span>
 1070 |     | <span style='background-color: #eee;'>	}</span>
 1071 |     | <span style='background-color: #eee;'></span>
 1072 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, address p2, string memory p3) internal view {</span>
 1073 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,address,string)&quot;, p0, p1, p2, p3));</span>
 1074 |     | <span style='background-color: #eee;'>	}</span>
 1075 |     | <span style='background-color: #eee;'></span>
 1076 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, address p2, bool p3) internal view {</span>
 1077 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,address,bool)&quot;, p0, p1, p2, p3));</span>
 1078 |     | <span style='background-color: #eee;'>	}</span>
 1079 |     | <span style='background-color: #eee;'></span>
 1080 |     | <span style='background-color: #eee;'>	function log(bool p0, uint256 p1, address p2, address p3) internal view {</span>
 1081 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,uint256,address,address)&quot;, p0, p1, p2, p3));</span>
 1082 |     | <span style='background-color: #eee;'>	}</span>
 1083 |     | <span style='background-color: #eee;'></span>
 1084 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, uint256 p2, uint256 p3) internal view {</span>
 1085 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,uint256,uint256)&quot;, p0, p1, p2, p3));</span>
 1086 |     | <span style='background-color: #eee;'>	}</span>
 1087 |     | <span style='background-color: #eee;'></span>
 1088 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, uint256 p2, string memory p3) internal view {</span>
 1089 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,uint256,string)&quot;, p0, p1, p2, p3));</span>
 1090 |     | <span style='background-color: #eee;'>	}</span>
 1091 |     | <span style='background-color: #eee;'></span>
 1092 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, uint256 p2, bool p3) internal view {</span>
 1093 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,uint256,bool)&quot;, p0, p1, p2, p3));</span>
 1094 |     | <span style='background-color: #eee;'>	}</span>
 1095 |     | <span style='background-color: #eee;'></span>
 1096 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, uint256 p2, address p3) internal view {</span>
 1097 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,uint256,address)&quot;, p0, p1, p2, p3));</span>
 1098 |     | <span style='background-color: #eee;'>	}</span>
 1099 |     | <span style='background-color: #eee;'></span>
 1100 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, string memory p2, uint256 p3) internal view {</span>
 1101 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,string,uint256)&quot;, p0, p1, p2, p3));</span>
 1102 |     | <span style='background-color: #eee;'>	}</span>
 1103 |     | <span style='background-color: #eee;'></span>
 1104 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, string memory p2, string memory p3) internal view {</span>
 1105 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,string,string)&quot;, p0, p1, p2, p3));</span>
 1106 |     | <span style='background-color: #eee;'>	}</span>
 1107 |     | <span style='background-color: #eee;'></span>
 1108 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, string memory p2, bool p3) internal view {</span>
 1109 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,string,bool)&quot;, p0, p1, p2, p3));</span>
 1110 |     | <span style='background-color: #eee;'>	}</span>
 1111 |     | <span style='background-color: #eee;'></span>
 1112 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, string memory p2, address p3) internal view {</span>
 1113 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,string,address)&quot;, p0, p1, p2, p3));</span>
 1114 |     | <span style='background-color: #eee;'>	}</span>
 1115 |     | <span style='background-color: #eee;'></span>
 1116 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, bool p2, uint256 p3) internal view {</span>
 1117 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,bool,uint256)&quot;, p0, p1, p2, p3));</span>
 1118 |     | <span style='background-color: #eee;'>	}</span>
 1119 |     | <span style='background-color: #eee;'></span>
 1120 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, bool p2, string memory p3) internal view {</span>
 1121 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,bool,string)&quot;, p0, p1, p2, p3));</span>
 1122 |     | <span style='background-color: #eee;'>	}</span>
 1123 |     | <span style='background-color: #eee;'></span>
 1124 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, bool p2, bool p3) internal view {</span>
 1125 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,bool,bool)&quot;, p0, p1, p2, p3));</span>
 1126 |     | <span style='background-color: #eee;'>	}</span>
 1127 |     | <span style='background-color: #eee;'></span>
 1128 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, bool p2, address p3) internal view {</span>
 1129 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,bool,address)&quot;, p0, p1, p2, p3));</span>
 1130 |     | <span style='background-color: #eee;'>	}</span>
 1131 |     | <span style='background-color: #eee;'></span>
 1132 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, address p2, uint256 p3) internal view {</span>
 1133 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,address,uint256)&quot;, p0, p1, p2, p3));</span>
 1134 |     | <span style='background-color: #eee;'>	}</span>
 1135 |     | <span style='background-color: #eee;'></span>
 1136 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, address p2, string memory p3) internal view {</span>
 1137 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,address,string)&quot;, p0, p1, p2, p3));</span>
 1138 |     | <span style='background-color: #eee;'>	}</span>
 1139 |     | <span style='background-color: #eee;'></span>
 1140 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, address p2, bool p3) internal view {</span>
 1141 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,address,bool)&quot;, p0, p1, p2, p3));</span>
 1142 |     | <span style='background-color: #eee;'>	}</span>
 1143 |     | <span style='background-color: #eee;'></span>
 1144 |     | <span style='background-color: #eee;'>	function log(bool p0, string memory p1, address p2, address p3) internal view {</span>
 1145 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,string,address,address)&quot;, p0, p1, p2, p3));</span>
 1146 |     | <span style='background-color: #eee;'>	}</span>
 1147 |     | <span style='background-color: #eee;'></span>
 1148 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, uint256 p2, uint256 p3) internal view {</span>
 1149 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,uint256,uint256)&quot;, p0, p1, p2, p3));</span>
 1150 |     | <span style='background-color: #eee;'>	}</span>
 1151 |     | <span style='background-color: #eee;'></span>
 1152 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, uint256 p2, string memory p3) internal view {</span>
 1153 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,uint256,string)&quot;, p0, p1, p2, p3));</span>
 1154 |     | <span style='background-color: #eee;'>	}</span>
 1155 |     | <span style='background-color: #eee;'></span>
 1156 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, uint256 p2, bool p3) internal view {</span>
 1157 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,uint256,bool)&quot;, p0, p1, p2, p3));</span>
 1158 |     | <span style='background-color: #eee;'>	}</span>
 1159 |     | <span style='background-color: #eee;'></span>
 1160 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, uint256 p2, address p3) internal view {</span>
 1161 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,uint256,address)&quot;, p0, p1, p2, p3));</span>
 1162 |     | <span style='background-color: #eee;'>	}</span>
 1163 |     | <span style='background-color: #eee;'></span>
 1164 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, string memory p2, uint256 p3) internal view {</span>
 1165 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,string,uint256)&quot;, p0, p1, p2, p3));</span>
 1166 |     | <span style='background-color: #eee;'>	}</span>
 1167 |     | <span style='background-color: #eee;'></span>
 1168 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, string memory p2, string memory p3) internal view {</span>
 1169 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,string,string)&quot;, p0, p1, p2, p3));</span>
 1170 |     | <span style='background-color: #eee;'>	}</span>
 1171 |     | <span style='background-color: #eee;'></span>
 1172 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, string memory p2, bool p3) internal view {</span>
 1173 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,string,bool)&quot;, p0, p1, p2, p3));</span>
 1174 |     | <span style='background-color: #eee;'>	}</span>
 1175 |     | <span style='background-color: #eee;'></span>
 1176 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, string memory p2, address p3) internal view {</span>
 1177 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,string,address)&quot;, p0, p1, p2, p3));</span>
 1178 |     | <span style='background-color: #eee;'>	}</span>
 1179 |     | <span style='background-color: #eee;'></span>
 1180 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, bool p2, uint256 p3) internal view {</span>
 1181 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,bool,uint256)&quot;, p0, p1, p2, p3));</span>
 1182 |     | <span style='background-color: #eee;'>	}</span>
 1183 |     | <span style='background-color: #eee;'></span>
 1184 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, bool p2, string memory p3) internal view {</span>
 1185 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,bool,string)&quot;, p0, p1, p2, p3));</span>
 1186 |     | <span style='background-color: #eee;'>	}</span>
 1187 |     | <span style='background-color: #eee;'></span>
 1188 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, bool p2, bool p3) internal view {</span>
 1189 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,bool,bool)&quot;, p0, p1, p2, p3));</span>
 1190 |     | <span style='background-color: #eee;'>	}</span>
 1191 |     | <span style='background-color: #eee;'></span>
 1192 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, bool p2, address p3) internal view {</span>
 1193 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,bool,address)&quot;, p0, p1, p2, p3));</span>
 1194 |     | <span style='background-color: #eee;'>	}</span>
 1195 |     | <span style='background-color: #eee;'></span>
 1196 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, address p2, uint256 p3) internal view {</span>
 1197 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,address,uint256)&quot;, p0, p1, p2, p3));</span>
 1198 |     | <span style='background-color: #eee;'>	}</span>
 1199 |     | <span style='background-color: #eee;'></span>
 1200 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, address p2, string memory p3) internal view {</span>
 1201 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,address,string)&quot;, p0, p1, p2, p3));</span>
 1202 |     | <span style='background-color: #eee;'>	}</span>
 1203 |     | <span style='background-color: #eee;'></span>
 1204 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, address p2, bool p3) internal view {</span>
 1205 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,address,bool)&quot;, p0, p1, p2, p3));</span>
 1206 |     | <span style='background-color: #eee;'>	}</span>
 1207 |     | <span style='background-color: #eee;'></span>
 1208 |     | <span style='background-color: #eee;'>	function log(bool p0, bool p1, address p2, address p3) internal view {</span>
 1209 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,bool,address,address)&quot;, p0, p1, p2, p3));</span>
 1210 |     | <span style='background-color: #eee;'>	}</span>
 1211 |     | <span style='background-color: #eee;'></span>
 1212 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, uint256 p2, uint256 p3) internal view {</span>
 1213 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,uint256,uint256)&quot;, p0, p1, p2, p3));</span>
 1214 |     | <span style='background-color: #eee;'>	}</span>
 1215 |     | <span style='background-color: #eee;'></span>
 1216 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, uint256 p2, string memory p3) internal view {</span>
 1217 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,uint256,string)&quot;, p0, p1, p2, p3));</span>
 1218 |     | <span style='background-color: #eee;'>	}</span>
 1219 |     | <span style='background-color: #eee;'></span>
 1220 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, uint256 p2, bool p3) internal view {</span>
 1221 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,uint256,bool)&quot;, p0, p1, p2, p3));</span>
 1222 |     | <span style='background-color: #eee;'>	}</span>
 1223 |     | <span style='background-color: #eee;'></span>
 1224 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, uint256 p2, address p3) internal view {</span>
 1225 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,uint256,address)&quot;, p0, p1, p2, p3));</span>
 1226 |     | <span style='background-color: #eee;'>	}</span>
 1227 |     | <span style='background-color: #eee;'></span>
 1228 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, string memory p2, uint256 p3) internal view {</span>
 1229 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,string,uint256)&quot;, p0, p1, p2, p3));</span>
 1230 |     | <span style='background-color: #eee;'>	}</span>
 1231 |     | <span style='background-color: #eee;'></span>
 1232 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, string memory p2, string memory p3) internal view {</span>
 1233 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,string,string)&quot;, p0, p1, p2, p3));</span>
 1234 |     | <span style='background-color: #eee;'>	}</span>
 1235 |     | <span style='background-color: #eee;'></span>
 1236 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, string memory p2, bool p3) internal view {</span>
 1237 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,string,bool)&quot;, p0, p1, p2, p3));</span>
 1238 |     | <span style='background-color: #eee;'>	}</span>
 1239 |     | <span style='background-color: #eee;'></span>
 1240 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, string memory p2, address p3) internal view {</span>
 1241 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,string,address)&quot;, p0, p1, p2, p3));</span>
 1242 |     | <span style='background-color: #eee;'>	}</span>
 1243 |     | <span style='background-color: #eee;'></span>
 1244 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, bool p2, uint256 p3) internal view {</span>
 1245 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,bool,uint256)&quot;, p0, p1, p2, p3));</span>
 1246 |     | <span style='background-color: #eee;'>	}</span>
 1247 |     | <span style='background-color: #eee;'></span>
 1248 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, bool p2, string memory p3) internal view {</span>
 1249 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,bool,string)&quot;, p0, p1, p2, p3));</span>
 1250 |     | <span style='background-color: #eee;'>	}</span>
 1251 |     | <span style='background-color: #eee;'></span>
 1252 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, bool p2, bool p3) internal view {</span>
 1253 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,bool,bool)&quot;, p0, p1, p2, p3));</span>
 1254 |     | <span style='background-color: #eee;'>	}</span>
 1255 |     | <span style='background-color: #eee;'></span>
 1256 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, bool p2, address p3) internal view {</span>
 1257 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,bool,address)&quot;, p0, p1, p2, p3));</span>
 1258 |     | <span style='background-color: #eee;'>	}</span>
 1259 |     | <span style='background-color: #eee;'></span>
 1260 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, address p2, uint256 p3) internal view {</span>
 1261 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,address,uint256)&quot;, p0, p1, p2, p3));</span>
 1262 |     | <span style='background-color: #eee;'>	}</span>
 1263 |     | <span style='background-color: #eee;'></span>
 1264 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, address p2, string memory p3) internal view {</span>
 1265 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,address,string)&quot;, p0, p1, p2, p3));</span>
 1266 |     | <span style='background-color: #eee;'>	}</span>
 1267 |     | <span style='background-color: #eee;'></span>
 1268 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, address p2, bool p3) internal view {</span>
 1269 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,address,bool)&quot;, p0, p1, p2, p3));</span>
 1270 |     | <span style='background-color: #eee;'>	}</span>
 1271 |     | <span style='background-color: #eee;'></span>
 1272 |     | <span style='background-color: #eee;'>	function log(bool p0, address p1, address p2, address p3) internal view {</span>
 1273 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(bool,address,address,address)&quot;, p0, p1, p2, p3));</span>
 1274 |     | <span style='background-color: #eee;'>	}</span>
 1275 |     | <span style='background-color: #eee;'></span>
 1276 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, uint256 p2, uint256 p3) internal view {</span>
 1277 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,uint256,uint256)&quot;, p0, p1, p2, p3));</span>
 1278 |     | <span style='background-color: #eee;'>	}</span>
 1279 |     | <span style='background-color: #eee;'></span>
 1280 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, uint256 p2, string memory p3) internal view {</span>
 1281 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,uint256,string)&quot;, p0, p1, p2, p3));</span>
 1282 |     | <span style='background-color: #eee;'>	}</span>
 1283 |     | <span style='background-color: #eee;'></span>
 1284 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, uint256 p2, bool p3) internal view {</span>
 1285 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,uint256,bool)&quot;, p0, p1, p2, p3));</span>
 1286 |     | <span style='background-color: #eee;'>	}</span>
 1287 |     | <span style='background-color: #eee;'></span>
 1288 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, uint256 p2, address p3) internal view {</span>
 1289 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,uint256,address)&quot;, p0, p1, p2, p3));</span>
 1290 |     | <span style='background-color: #eee;'>	}</span>
 1291 |     | <span style='background-color: #eee;'></span>
 1292 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, string memory p2, uint256 p3) internal view {</span>
 1293 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,string,uint256)&quot;, p0, p1, p2, p3));</span>
 1294 |     | <span style='background-color: #eee;'>	}</span>
 1295 |     | <span style='background-color: #eee;'></span>
 1296 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, string memory p2, string memory p3) internal view {</span>
 1297 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,string,string)&quot;, p0, p1, p2, p3));</span>
 1298 |     | <span style='background-color: #eee;'>	}</span>
 1299 |     | <span style='background-color: #eee;'></span>
 1300 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, string memory p2, bool p3) internal view {</span>
 1301 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,string,bool)&quot;, p0, p1, p2, p3));</span>
 1302 |     | <span style='background-color: #eee;'>	}</span>
 1303 |     | <span style='background-color: #eee;'></span>
 1304 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, string memory p2, address p3) internal view {</span>
 1305 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,string,address)&quot;, p0, p1, p2, p3));</span>
 1306 |     | <span style='background-color: #eee;'>	}</span>
 1307 |     | <span style='background-color: #eee;'></span>
 1308 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, bool p2, uint256 p3) internal view {</span>
 1309 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,bool,uint256)&quot;, p0, p1, p2, p3));</span>
 1310 |     | <span style='background-color: #eee;'>	}</span>
 1311 |     | <span style='background-color: #eee;'></span>
 1312 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, bool p2, string memory p3) internal view {</span>
 1313 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,bool,string)&quot;, p0, p1, p2, p3));</span>
 1314 |     | <span style='background-color: #eee;'>	}</span>
 1315 |     | <span style='background-color: #eee;'></span>
 1316 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, bool p2, bool p3) internal view {</span>
 1317 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,bool,bool)&quot;, p0, p1, p2, p3));</span>
 1318 |     | <span style='background-color: #eee;'>	}</span>
 1319 |     | <span style='background-color: #eee;'></span>
 1320 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, bool p2, address p3) internal view {</span>
 1321 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,bool,address)&quot;, p0, p1, p2, p3));</span>
 1322 |     | <span style='background-color: #eee;'>	}</span>
 1323 |     | <span style='background-color: #eee;'></span>
 1324 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, address p2, uint256 p3) internal view {</span>
 1325 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,address,uint256)&quot;, p0, p1, p2, p3));</span>
 1326 |     | <span style='background-color: #eee;'>	}</span>
 1327 |     | <span style='background-color: #eee;'></span>
 1328 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, address p2, string memory p3) internal view {</span>
 1329 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,address,string)&quot;, p0, p1, p2, p3));</span>
 1330 |     | <span style='background-color: #eee;'>	}</span>
 1331 |     | <span style='background-color: #eee;'></span>
 1332 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, address p2, bool p3) internal view {</span>
 1333 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,address,bool)&quot;, p0, p1, p2, p3));</span>
 1334 |     | <span style='background-color: #eee;'>	}</span>
 1335 |     | <span style='background-color: #eee;'></span>
 1336 |     | <span style='background-color: #eee;'>	function log(address p0, uint256 p1, address p2, address p3) internal view {</span>
 1337 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,uint256,address,address)&quot;, p0, p1, p2, p3));</span>
 1338 |     | <span style='background-color: #eee;'>	}</span>
 1339 |     | <span style='background-color: #eee;'></span>
 1340 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, uint256 p2, uint256 p3) internal view {</span>
 1341 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,uint256,uint256)&quot;, p0, p1, p2, p3));</span>
 1342 |     | <span style='background-color: #eee;'>	}</span>
 1343 |     | <span style='background-color: #eee;'></span>
 1344 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, uint256 p2, string memory p3) internal view {</span>
 1345 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,uint256,string)&quot;, p0, p1, p2, p3));</span>
 1346 |     | <span style='background-color: #eee;'>	}</span>
 1347 |     | <span style='background-color: #eee;'></span>
 1348 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, uint256 p2, bool p3) internal view {</span>
 1349 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,uint256,bool)&quot;, p0, p1, p2, p3));</span>
 1350 |     | <span style='background-color: #eee;'>	}</span>
 1351 |     | <span style='background-color: #eee;'></span>
 1352 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, uint256 p2, address p3) internal view {</span>
 1353 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,uint256,address)&quot;, p0, p1, p2, p3));</span>
 1354 |     | <span style='background-color: #eee;'>	}</span>
 1355 |     | <span style='background-color: #eee;'></span>
 1356 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, string memory p2, uint256 p3) internal view {</span>
 1357 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,string,uint256)&quot;, p0, p1, p2, p3));</span>
 1358 |     | <span style='background-color: #eee;'>	}</span>
 1359 |     | <span style='background-color: #eee;'></span>
 1360 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, string memory p2, string memory p3) internal view {</span>
 1361 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,string,string)&quot;, p0, p1, p2, p3));</span>
 1362 |     | <span style='background-color: #eee;'>	}</span>
 1363 |     | <span style='background-color: #eee;'></span>
 1364 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, string memory p2, bool p3) internal view {</span>
 1365 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,string,bool)&quot;, p0, p1, p2, p3));</span>
 1366 |     | <span style='background-color: #eee;'>	}</span>
 1367 |     | <span style='background-color: #eee;'></span>
 1368 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, string memory p2, address p3) internal view {</span>
 1369 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,string,address)&quot;, p0, p1, p2, p3));</span>
 1370 |     | <span style='background-color: #eee;'>	}</span>
 1371 |     | <span style='background-color: #eee;'></span>
 1372 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, bool p2, uint256 p3) internal view {</span>
 1373 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,bool,uint256)&quot;, p0, p1, p2, p3));</span>
 1374 |     | <span style='background-color: #eee;'>	}</span>
 1375 |     | <span style='background-color: #eee;'></span>
 1376 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, bool p2, string memory p3) internal view {</span>
 1377 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,bool,string)&quot;, p0, p1, p2, p3));</span>
 1378 |     | <span style='background-color: #eee;'>	}</span>
 1379 |     | <span style='background-color: #eee;'></span>
 1380 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, bool p2, bool p3) internal view {</span>
 1381 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,bool,bool)&quot;, p0, p1, p2, p3));</span>
 1382 |     | <span style='background-color: #eee;'>	}</span>
 1383 |     | <span style='background-color: #eee;'></span>
 1384 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, bool p2, address p3) internal view {</span>
 1385 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,bool,address)&quot;, p0, p1, p2, p3));</span>
 1386 |     | <span style='background-color: #eee;'>	}</span>
 1387 |     | <span style='background-color: #eee;'></span>
 1388 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, address p2, uint256 p3) internal view {</span>
 1389 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,address,uint256)&quot;, p0, p1, p2, p3));</span>
 1390 |     | <span style='background-color: #eee;'>	}</span>
 1391 |     | <span style='background-color: #eee;'></span>
 1392 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, address p2, string memory p3) internal view {</span>
 1393 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,address,string)&quot;, p0, p1, p2, p3));</span>
 1394 |     | <span style='background-color: #eee;'>	}</span>
 1395 |     | <span style='background-color: #eee;'></span>
 1396 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, address p2, bool p3) internal view {</span>
 1397 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,address,bool)&quot;, p0, p1, p2, p3));</span>
 1398 |     | <span style='background-color: #eee;'>	}</span>
 1399 |     | <span style='background-color: #eee;'></span>
 1400 |     | <span style='background-color: #eee;'>	function log(address p0, string memory p1, address p2, address p3) internal view {</span>
 1401 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,string,address,address)&quot;, p0, p1, p2, p3));</span>
 1402 |     | <span style='background-color: #eee;'>	}</span>
 1403 |     | <span style='background-color: #eee;'></span>
 1404 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, uint256 p2, uint256 p3) internal view {</span>
 1405 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,uint256,uint256)&quot;, p0, p1, p2, p3));</span>
 1406 |     | <span style='background-color: #eee;'>	}</span>
 1407 |     | <span style='background-color: #eee;'></span>
 1408 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, uint256 p2, string memory p3) internal view {</span>
 1409 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,uint256,string)&quot;, p0, p1, p2, p3));</span>
 1410 |     | <span style='background-color: #eee;'>	}</span>
 1411 |     | <span style='background-color: #eee;'></span>
 1412 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, uint256 p2, bool p3) internal view {</span>
 1413 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,uint256,bool)&quot;, p0, p1, p2, p3));</span>
 1414 |     | <span style='background-color: #eee;'>	}</span>
 1415 |     | <span style='background-color: #eee;'></span>
 1416 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, uint256 p2, address p3) internal view {</span>
 1417 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,uint256,address)&quot;, p0, p1, p2, p3));</span>
 1418 |     | <span style='background-color: #eee;'>	}</span>
 1419 |     | <span style='background-color: #eee;'></span>
 1420 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, string memory p2, uint256 p3) internal view {</span>
 1421 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,string,uint256)&quot;, p0, p1, p2, p3));</span>
 1422 |     | <span style='background-color: #eee;'>	}</span>
 1423 |     | <span style='background-color: #eee;'></span>
 1424 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, string memory p2, string memory p3) internal view {</span>
 1425 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,string,string)&quot;, p0, p1, p2, p3));</span>
 1426 |     | <span style='background-color: #eee;'>	}</span>
 1427 |     | <span style='background-color: #eee;'></span>
 1428 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, string memory p2, bool p3) internal view {</span>
 1429 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,string,bool)&quot;, p0, p1, p2, p3));</span>
 1430 |     | <span style='background-color: #eee;'>	}</span>
 1431 |     | <span style='background-color: #eee;'></span>
 1432 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, string memory p2, address p3) internal view {</span>
 1433 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,string,address)&quot;, p0, p1, p2, p3));</span>
 1434 |     | <span style='background-color: #eee;'>	}</span>
 1435 |     | <span style='background-color: #eee;'></span>
 1436 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, bool p2, uint256 p3) internal view {</span>
 1437 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,bool,uint256)&quot;, p0, p1, p2, p3));</span>
 1438 |     | <span style='background-color: #eee;'>	}</span>
 1439 |     | <span style='background-color: #eee;'></span>
 1440 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, bool p2, string memory p3) internal view {</span>
 1441 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,bool,string)&quot;, p0, p1, p2, p3));</span>
 1442 |     | <span style='background-color: #eee;'>	}</span>
 1443 |     | <span style='background-color: #eee;'></span>
 1444 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, bool p2, bool p3) internal view {</span>
 1445 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,bool,bool)&quot;, p0, p1, p2, p3));</span>
 1446 |     | <span style='background-color: #eee;'>	}</span>
 1447 |     | <span style='background-color: #eee;'></span>
 1448 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, bool p2, address p3) internal view {</span>
 1449 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,bool,address)&quot;, p0, p1, p2, p3));</span>
 1450 |     | <span style='background-color: #eee;'>	}</span>
 1451 |     | <span style='background-color: #eee;'></span>
 1452 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, address p2, uint256 p3) internal view {</span>
 1453 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,address,uint256)&quot;, p0, p1, p2, p3));</span>
 1454 |     | <span style='background-color: #eee;'>	}</span>
 1455 |     | <span style='background-color: #eee;'></span>
 1456 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, address p2, string memory p3) internal view {</span>
 1457 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,address,string)&quot;, p0, p1, p2, p3));</span>
 1458 |     | <span style='background-color: #eee;'>	}</span>
 1459 |     | <span style='background-color: #eee;'></span>
 1460 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, address p2, bool p3) internal view {</span>
 1461 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,address,bool)&quot;, p0, p1, p2, p3));</span>
 1462 |     | <span style='background-color: #eee;'>	}</span>
 1463 |     | <span style='background-color: #eee;'></span>
 1464 |     | <span style='background-color: #eee;'>	function log(address p0, bool p1, address p2, address p3) internal view {</span>
 1465 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,bool,address,address)&quot;, p0, p1, p2, p3));</span>
 1466 |     | <span style='background-color: #eee;'>	}</span>
 1467 |     | <span style='background-color: #eee;'></span>
 1468 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, uint256 p2, uint256 p3) internal view {</span>
 1469 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,uint256,uint256)&quot;, p0, p1, p2, p3));</span>
 1470 |     | <span style='background-color: #eee;'>	}</span>
 1471 |     | <span style='background-color: #eee;'></span>
 1472 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, uint256 p2, string memory p3) internal view {</span>
 1473 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,uint256,string)&quot;, p0, p1, p2, p3));</span>
 1474 |     | <span style='background-color: #eee;'>	}</span>
 1475 |     | <span style='background-color: #eee;'></span>
 1476 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, uint256 p2, bool p3) internal view {</span>
 1477 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,uint256,bool)&quot;, p0, p1, p2, p3));</span>
 1478 |     | <span style='background-color: #eee;'>	}</span>
 1479 |     | <span style='background-color: #eee;'></span>
 1480 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, uint256 p2, address p3) internal view {</span>
 1481 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,uint256,address)&quot;, p0, p1, p2, p3));</span>
 1482 |     | <span style='background-color: #eee;'>	}</span>
 1483 |     | <span style='background-color: #eee;'></span>
 1484 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, string memory p2, uint256 p3) internal view {</span>
 1485 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,string,uint256)&quot;, p0, p1, p2, p3));</span>
 1486 |     | <span style='background-color: #eee;'>	}</span>
 1487 |     | <span style='background-color: #eee;'></span>
 1488 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, string memory p2, string memory p3) internal view {</span>
 1489 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,string,string)&quot;, p0, p1, p2, p3));</span>
 1490 |     | <span style='background-color: #eee;'>	}</span>
 1491 |     | <span style='background-color: #eee;'></span>
 1492 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, string memory p2, bool p3) internal view {</span>
 1493 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,string,bool)&quot;, p0, p1, p2, p3));</span>
 1494 |     | <span style='background-color: #eee;'>	}</span>
 1495 |     | <span style='background-color: #eee;'></span>
 1496 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, string memory p2, address p3) internal view {</span>
 1497 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,string,address)&quot;, p0, p1, p2, p3));</span>
 1498 |     | <span style='background-color: #eee;'>	}</span>
 1499 |     | <span style='background-color: #eee;'></span>
 1500 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, bool p2, uint256 p3) internal view {</span>
 1501 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,bool,uint256)&quot;, p0, p1, p2, p3));</span>
 1502 |     | <span style='background-color: #eee;'>	}</span>
 1503 |     | <span style='background-color: #eee;'></span>
 1504 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, bool p2, string memory p3) internal view {</span>
 1505 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,bool,string)&quot;, p0, p1, p2, p3));</span>
 1506 |     | <span style='background-color: #eee;'>	}</span>
 1507 |     | <span style='background-color: #eee;'></span>
 1508 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, bool p2, bool p3) internal view {</span>
 1509 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,bool,bool)&quot;, p0, p1, p2, p3));</span>
 1510 |     | <span style='background-color: #eee;'>	}</span>
 1511 |     | <span style='background-color: #eee;'></span>
 1512 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, bool p2, address p3) internal view {</span>
 1513 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,bool,address)&quot;, p0, p1, p2, p3));</span>
 1514 |     | <span style='background-color: #eee;'>	}</span>
 1515 |     | <span style='background-color: #eee;'></span>
 1516 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, address p2, uint256 p3) internal view {</span>
 1517 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,address,uint256)&quot;, p0, p1, p2, p3));</span>
 1518 |     | <span style='background-color: #eee;'>	}</span>
 1519 |     | <span style='background-color: #eee;'></span>
 1520 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, address p2, string memory p3) internal view {</span>
 1521 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,address,string)&quot;, p0, p1, p2, p3));</span>
 1522 |     | <span style='background-color: #eee;'>	}</span>
 1523 |     | <span style='background-color: #eee;'></span>
 1524 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, address p2, bool p3) internal view {</span>
 1525 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,address,bool)&quot;, p0, p1, p2, p3));</span>
 1526 |     | <span style='background-color: #eee;'>	}</span>
 1527 |     | <span style='background-color: #eee;'></span>
 1528 |     | <span style='background-color: #eee;'>	function log(address p0, address p1, address p2, address p3) internal view {</span>
 1529 |     | <span style='background-color: #eee;'>		_sendLogPayload(abi.encodeWithSignature(&quot;log(address,address,address,address)&quot;, p0, p1, p2, p3));</span>
 1530 |     | <span style='background-color: #eee;'>	}</span>
 1531 |     | <span style='background-color: #eee;'></span>
 1532 |     | <span style='background-color: #eee;'>}</span>
 1533 |     | <span style='background-color: #eee;'></span>

</code>
<br />

